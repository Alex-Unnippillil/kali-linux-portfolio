let e;var r,n=(r=import.meta.url,async function(e={}){e.ready=new Promise((e,r)=>{n=e,t=r});var n,t,s,a,_,i,o,u,c,l,p,m,f,y,S,C,b,d=Object.assign({},e),g="object"==typeof window,R="function"==typeof importScripts,E="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,h="";if(E){let{createRequire:r}=await import("module");var T=r(import.meta.url),A=T("fs"),M=T("path");h=R?M.dirname(h)+"/":T("url").fileURLToPath(new URL("./",import.meta.url)),s=(e,r)=>(e=X(e)?new URL(e):M.normalize(e),A.readFileSync(e,r?void 0:"utf8")),_=e=>{var r=s(e,!0);return r.buffer||(r=new Uint8Array(r)),r},a=(e,r,n,t=!0)=>{e=X(e)?new URL(e):M.normalize(e),A.readFile(e,t?void 0:"utf8",(e,s)=>{e?n(e):r(t?s.buffer:s)})},!e.thisProgram&&process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),e.inspect=()=>"[Emscripten Module object]"}else(g||R)&&(R?h=self.location.href:"undefined"!=typeof document&&document.currentScript&&(h=document.currentScript.src),r&&(h=r),h=0!==h.indexOf("blob:")?h.substr(0,h.replace(/[?#].*/,"").lastIndexOf("/")+1):"",s=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.send(null),r.responseText},R&&(_=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),a=(e,r,n)=>{var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="arraybuffer",t.onload=()=>{if(200==t.status||0==t.status&&t.response)return void r(t.response);n()},t.onerror=n,t.send(null)});e.print||console.log.bind(console);var O=e.printErr||console.error.bind(console);Object.assign(e,d),d=null,e.arguments&&e.arguments,e.thisProgram&&e.thisProgram,e.quit&&e.quit,e.wasmBinary&&(i=e.wasmBinary),e.noExitRuntime,"object"!=typeof WebAssembly&&N("no native wasm support detected");var P=!1,w=[],I=[],v=[],D=0,H=null;function N(r){e.onAbort&&e.onAbort(r),O(r="Aborted("+r+")"),P=!0,r+=". Build with -sASSERTIONS for more info.";var n=new WebAssembly.RuntimeError(r);throw t(n),n}function U(e){return e.startsWith("data:application/octet-stream;base64,")}function X(e){return e.startsWith("file://")}function L(e){if(e==S&&i)return new Uint8Array(i);if(_)return _(e);throw"both async and sync fetching of the wasm failed"}function F(e,r,n){return(function(e){if(!i&&(g||R)){if("function"==typeof fetch&&!X(e))return fetch(e,{credentials:"same-origin"}).then(r=>{if(!r.ok)throw"failed to load wasm binary file at '"+e+"'";return r.arrayBuffer()}).catch(()=>L(e));else if(a)return new Promise((r,n)=>{a(e,e=>r(new Uint8Array(e)),n)})}return Promise.resolve().then(()=>L(e))})(e).then(e=>WebAssembly.instantiate(e,r)).then(e=>e).then(n,e=>{O(`failed to asynchronously prepare wasm: ${e}`),N(e)})}e.locateFile?U(S="capstone.wasm")||(b=S,S=e.locateFile?e.locateFile(b,h):h+b):S=new URL("capstone.wasm",import.meta.url).href;var G=r=>{for(;r.length>0;)r.shift()(e)},z=r=>e["_"+r],x="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,W=(e,r)=>e?((e,r,n)=>{for(var t=r+n,s=r;e[s]&&!(s>=t);)++s;if(s-r>16&&e.buffer&&x)return x.decode(e.subarray(r,s));for(var a="";r<s;){var _=e[r++];if(!(128&_)){a+=String.fromCharCode(_);continue}var i=63&e[r++];if((224&_)==192){a+=String.fromCharCode((31&_)<<6|i);continue}var o=63&e[r++];if((_=(240&_)==224?(15&_)<<12|i<<6|o:(7&_)<<18|i<<12|o<<6|63&e[r++])<65536)a+=String.fromCharCode(_);else{var u=_-65536;a+=String.fromCharCode(55296|u>>10,56320|1023&u)}}return a})(u,e,r):"",V=(e,r,n,t,s)=>{var a,_={string:e=>{var r,n,t,s=0;return null!=e&&0!==e&&(n=(e=>{for(var r=0,n=0;n<e.length;++n){var t=e.charCodeAt(n);t<=127?r++:t<=2047?r+=2:t>=55296&&t<=57343?(r+=4,++n):r+=3}return r})(r=e)+1,t=q(n),((e,r,n,t)=>{if(t>0){for(var s=n+t-1,a=0;a<e.length;++a){var _=e.charCodeAt(a);if(_>=55296&&_<=57343&&(_=65536+((1023&_)<<10)|1023&e.charCodeAt(++a)),_<=127){if(n>=s)break;r[n++]=_}else if(_<=2047){if(n+1>=s)break;r[n++]=192|_>>6,r[n++]=128|63&_}else if(_<=65535){if(n+2>=s)break;r[n++]=224|_>>12,r[n++]=128|_>>6&63,r[n++]=128|63&_}else{if(n+3>=s)break;r[n++]=240|_>>18,r[n++]=128|_>>12&63,r[n++]=128|_>>6&63,r[n++]=128|63&_}}return r[n]=0}})(r,u,t,n),s=t),s},array:e=>{var r=q(e.length);return o.set(e,r),r}},i=z(e),c=[],l=0;if(t)for(var p=0;p<t.length;p++){var m=_[n[p]];m?(0===l&&(l=k()),c[p]=m(t[p])):c[p]=t[p]}var f=i.apply(null,c);return a=f,0!==l&&$(l),f="string"===r?W(a):"boolean"===r?!!a:a},B={b:(e,r,n)=>u.copyWithin(e,r,r+n),a:e=>{u.length,N("OOM")}},j=function(){var r,n,s,a={a:B};function _(r,n){if(e.HEAP8=o=new Int8Array(t=(j=r.exports).c.buffer),e.HEAP16=c=new Int16Array(t),e.HEAPU8=u=new Uint8Array(t),e.HEAPU16=new Uint16Array(t),e.HEAP32=l=new Int32Array(t),e.HEAPU32=p=new Uint32Array(t),e.HEAPF32=m=new Float32Array(t),e.HEAPF64=y=new Float64Array(t),e.HEAP64=f=new BigInt64Array(t),e.HEAPU64=new BigUint64Array(t),s=j.d,I.unshift(s),D--,e.monitorRunDependencies&&e.monitorRunDependencies(D),0==D&&H){var t,s,a=H;H=null,a()}return j}if(D++,e.monitorRunDependencies&&e.monitorRunDependencies(D),e.instantiateWasm)try{return e.instantiateWasm(a,_)}catch(e){O(`Module.instantiateWasm callback failed with error: ${e}`),t(e)}return(r=i,n=S,s=function(e){_(e.instance)},!r&&"function"==typeof WebAssembly.instantiateStreaming&&!U(n)&&!X(n)&&!E&&"function"==typeof fetch?fetch(n,{credentials:"same-origin"}).then(e=>WebAssembly.instantiateStreaming(e,a).then(s,function(e){return O(`wasm streaming compile failed: ${e}`),O("falling back to ArrayBuffer instantiation"),F(n,a,s)})):F(n,a,s)).catch(t),{}}();e._cs_version=(r,n)=>(e._cs_version=j.e)(r,n),e._cs_support=r=>(e._cs_support=j.f)(r),e._cs_errno=r=>(e._cs_errno=j.g)(r),e._cs_strerror=r=>(e._cs_strerror=j.h)(r),e._cs_open=(r,n,t)=>(e._cs_open=j.i)(r,n,t),e._cs_close=r=>(e._cs_close=j.j)(r),e._cs_option=(r,n,t)=>(e._cs_option=j.k)(r,n,t),e._cs_disasm=(r,n,t,s,a,_)=>(e._cs_disasm=j.l)(r,n,t,s,a,_),e._cs_free=(r,n)=>(e._cs_free=j.m)(r,n),e._cs_malloc=r=>(e._cs_malloc=j.n)(r),e._cs_reg_name=(r,n)=>(e._cs_reg_name=j.o)(r,n),e._cs_insn_name=(r,n)=>(e._cs_insn_name=j.p)(r,n),e._cs_group_name=(r,n)=>(e._cs_group_name=j.q)(r,n),e._cs_insn_group=(r,n,t)=>(e._cs_insn_group=j.r)(r,n,t),e._cs_reg_read=(r,n,t)=>(e._cs_reg_read=j.s)(r,n,t),e._cs_reg_write=(r,n,t)=>(e._cs_reg_write=j.t)(r,n,t),e._cs_op_count=(r,n,t)=>(e._cs_op_count=j.u)(r,n,t),e._cs_op_index=(r,n,t,s)=>(e._cs_op_index=j.v)(r,n,t,s),e._cs_regs_access=(r,n,t,s,a,_)=>(e._cs_regs_access=j.w)(r,n,t,s,a,_),e._malloc=r=>(e._malloc=j.x)(r),e._free=r=>(e._free=j.y)(r);var k=()=>(k=j.z)(),$=e=>($=j.A)(e),q=e=>(q=j.B)(e);function Y(){if(!(D>0)){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;){var r;r=e.preRun.shift(),w.unshift(r)}G(w),D>0||(e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),t()},1)):t())}function t(){if(!C&&(C=!0,e.calledRun=!0,!P)){if(G(I),n(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;){var r;r=e.postRun.shift(),v.unshift(r)}G(v)}}}if(e.ccall=V,e.cwrap=(e,r,n,t)=>{var s=!n||n.every(e=>"number"===e||"boolean"===e);return"string"!==r&&s&&!t?z(e):function(){return V(e,r,n,arguments)}},e.getValue=function(e,r="i8"){switch(r.endsWith("*")&&(r="*"),r){case"i1":case"i8":return o[0|e];case"i16":return c[e>>1];case"i32":return l[e>>2];case"i64":return f[e>>3];case"float":return m[e>>2];case"double":return y[e>>3];case"*":return p[e>>2];default:N(`invalid type for getValue: ${r}`)}},e.UTF8ToString=W,H=function e(){C||Y(),C||(H=e)},e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return Y(),e.ready}),t=Object.freeze({__proto__:null,CS_AC_INVALID:0,CS_AC_READ:1,CS_AC_WRITE:2,CS_API_MAJOR:5,CS_API_MINOR:0,CS_ARCH_ALL:65535,CS_ARCH_ARM:0,CS_ARCH_ARM64:1,CS_ARCH_M680X:10,CS_ARCH_M68K:8,CS_ARCH_MAX:11,CS_ARCH_MIPS:2,CS_ARCH_PPC:4,CS_ARCH_SPARC:5,CS_ARCH_SYSZ:6,CS_ARCH_TMS320C64X:9,CS_ARCH_X86:3,CS_ARCH_XCORE:7,CS_ERR_ARCH:2,CS_ERR_CSH:4,CS_ERR_DETAIL:7,CS_ERR_DIET:10,CS_ERR_HANDLE:3,CS_ERR_MEM:1,CS_ERR_MEMSETUP:8,CS_ERR_MODE:5,CS_ERR_OK:0,CS_ERR_OPTION:6,CS_ERR_SKIPDATA:11,CS_ERR_VERSION:9,CS_ERR_X86_ATT:12,CS_ERR_X86_INTEL:13,CS_GRP_CALL:2,CS_GRP_INT:4,CS_GRP_INVALID:0,CS_GRP_IRET:5,CS_GRP_JUMP:1,CS_GRP_PRIVILEGE:6,CS_GRP_RET:3,CS_MODE_16:2,CS_MODE_32:4,CS_MODE_64:8,CS_MODE_ARM:0,CS_MODE_BIG_ENDIAN:-0x80000000,CS_MODE_LITTLE_ENDIAN:0,CS_MODE_M680X_6301:2,CS_MODE_M680X_6309:4,CS_MODE_M680X_6800:8,CS_MODE_M680X_6801:16,CS_MODE_M680X_6805:32,CS_MODE_M680X_6808:64,CS_MODE_M680X_6809:128,CS_MODE_M680X_6811:256,CS_MODE_M680X_CPU12:512,CS_MODE_M680X_HCS08:1024,CS_MODE_MCLASS:32,CS_MODE_MICRO:16,CS_MODE_MIPS2:128,CS_MODE_MIPS3:32,CS_MODE_MIPS32:4,CS_MODE_MIPS32R6:64,CS_MODE_MIPS64:8,CS_MODE_QPX:16,CS_MODE_THUMB:16,CS_MODE_V8:64,CS_MODE_V9:16,CS_OPT_DETAIL:2,CS_OPT_MODE:3,CS_OPT_OFF:0,CS_OPT_ON:3,CS_OPT_SYNTAX:1,CS_OPT_SYNTAX_ATT:2,CS_OPT_SYNTAX_INTEL:1,CS_OPT_SYNTAX_NOREGNAME:3,CS_OP_FP:4,CS_OP_IMM:2,CS_OP_INVALID:0,CS_OP_MEM:3,CS_OP_REG:1,CS_SUPPORT_DIET:65536,CS_SUPPORT_X86_REDUCE:65537});function s(e){switch(e){case"*":case"i32":case"float":return 4;case"i1":case"i8":return 1;case"i16":return 2;case"i64":case"double":return 8;default:throw Error(`Unsupported type: ${e}`)}}function a(e,r){let n=e%r;return n?r-n:0}let _={cs_open:{returnType:"number",argTypes:["number","number","number"]},cs_disasm:{returnType:"number",argTypes:["number","array","number","number","number","number"]},cs_free:{returnType:null,argTypes:["number","number"]},cs_close:{returnType:"number",argTypes:["number"]},cs_option:{returnType:"number",argTypes:["number","number","number"]},cs_reg_name:{returnType:"string",argTypes:["number","number"]},cs_op_count:{returnType:"number",argTypes:["number","number","number"]},cs_op_index:{returnType:"number",argTypes:["number","number","number","number"]},cs_insn_name:{returnType:"string",argTypes:["number","number"]},cs_group_name:{returnType:"string",argTypes:["number","number"]},cs_insn_group:{returnType:"boolean",argTypes:["number","number","number"]},cs_reg_read:{returnType:"boolean",argTypes:["number","number","number"]},cs_reg_write:{returnType:"boolean",argTypes:["number","number","number"]},cs_errno:{returnType:"number",argTypes:["number"]},cs_version:{returnType:"number",argTypes:["number","number"]},cs_support:{returnType:"boolean",argTypes:["number"]},cs_strerror:{returnType:"string",argTypes:["number"]},cs_regs_access:{returnType:"number",argTypes:["number","number","number","number","number","number"]},malloc:{returnType:"number",argTypes:["number"]},free:{returnType:null,argTypes:["number"]}},i=[{name:"id",type:"i32"},{name:"address",type:"i64"},{name:"size",type:"i16"},{name:"bytes",type:"bytes",size:24},{name:"mnemonic",type:"string",size:32},{name:"opStr",type:"string",size:160},{type:"i32"}],o=i.reduce((e,r)=>{let n="string"===r.type||"bytes"===r.type?r.size:s(r.type),t="string"===r.type||"bytes"===r.type?0:a(e,n);return e+t+n},0);class u{get handle(){return e.getValue(this.handle_ptr,"*")}setOption(e,r){return u.call("cs_option",this.handle,e,r)}close(){let e=u.call("cs_close",this.handle_ptr);if(0!==e)throw Error(`Failed to close capstone: ${u.strError(e)}`);this.handle_ptr=null}static readInsn(r){var n;let t,_=(n=e,t=0,i.reduce((e,_)=>{let i,o;return("string"===_.type?(o=_.size,i=n.UTF8ToString(r+t,o)):"bytes"===_.type?(o=_.size,i=n.HEAPU8.slice(r+t,r+t+o)):(o=s(_.type),t+=a(t,o),i=n.getValue(r+t,_.type)),t+=o,_.name)?{...e,[_.name]:i}:e},{}));return _.bytes=_.bytes.subarray(0,_.size),_}disasm(r,n={}){let{address:t=0,count:s=0}=n,a=u.call("malloc",4),_=u.call("cs_disasm",this.handle,r,r.length,BigInt(t),s,a);if(0===_)throw u.call("free",a),Error(`Failed to disassemble, error: ${u.strError(this.errNo())}`);let i=e.getValue(a,"*"),c=[];for(let e=0;e<_;e++){let r=u.readInsn(i+e*o);r.address<=Number.MAX_SAFE_INTEGER&&(r.address=Number(r.address)),c.push(r)}return u.call("cs_free",i,_),u.call("free",a),c}getRegName(e){return u.call("cs_reg_name",this.handle,e)}getInsnName(e){return u.call("cs_insn_name",this.handle,e)}getGroupName(e){return u.call("cs_group_name",this.handle,e)}errNo(){return u.call("cs_errno",this.handle)}static call(r,...n){let t=_[r];return e.ccall(r,t.returnType,t.argTypes,n)}static version(){let e=this.call("cs_version");return{major:e>>8,minor:255&e}}static support(e){return this.call("cs_support",e)}static strError(e){return this.call("cs_strerror",e)}constructor(e,r){this.arch=e,this.mode=r,this.handle_ptr=u.call("malloc",4);let n=u.call("cs_open",e,r,this.handle_ptr);if(0!==n)throw Error(`Failed to initialize capstone: ${u.strError(n)}`)}}async function c(r){e||(e=await n(r))}export{u as Capstone,t as Const,c as loadCapstone};