"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5726],{1472:(e,t,r)=>{r.d(t,{getDailySeed:()=>l}),r(31730).isBrowser&&"BroadcastChannel"in self&&new BroadcastChannel("sync");let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,r=t.toISOString().split("T")[0],l=(e=>{let t=0;for(let r=0;r<e.length;r+=1)t=31*t+e.charCodeAt(r)>>>0;return t.toString(16)})("".concat(e,":").concat(r));try{window.localStorage.setItem("".concat("dailySeed:").concat(e),l)}catch(e){}return l}},31730:(e,t,r)=>{r.d(t,{hasIndexedDB:()=>n,isBrowser:()=>l});let l="undefined"!=typeof document,n=l&&"undefined"!=typeof indexedDB},45726:(e,t,r)=>{r.r(t),r.d(t,{default:()=>h});var l=r(37876),n=r(14232);let a=e=>{let t=[],r=0;return e.forEach(e=>{1===e?r+=1:r&&(t.push(r),r=0)}),r&&t.push(r),t.length?t:[]},c=(e,t)=>{if(!e.length)return[Array(t).fill(0)];let[r,...l]=e,n=[];for(let e=0;e<=t-r;e++){let a=Array(e).fill(0).concat(Array(r).fill(1));l.length?c(l,t-e-r-1).forEach(e=>n.push(a.concat([0],e))):a.length<t?n.push(a.concat(Array(t-a.length).fill(0))):n.push(a)}return n},i=(e,t)=>c(e,t.length).filter(e=>t.every((t,r)=>1===t?1===e[r]:-1!==t||0===e[r])),o=(e,t)=>{let r=i(e,t);if(!r.length)return[];let l=[];for(let e=0;e<t.length;e++){let n=r[0][e];r.every(t=>t[e]===n)&&(0===t[e]||2===t[e])&&l.push({index:e,value:n?1:-1})}return l},u=[{name:"Full",rows:[[5],[5],[5],[5],[5]],cols:[[5],[5],[5],[5],[5]],grid:[[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1]]},{name:"Diamond",rows:[[1],[3],[5],[3],[1]],cols:[[1],[3],[5],[3],[1]],grid:[[0,0,1,0,0],[0,1,1,1,0],[1,1,1,1,1],[0,1,1,1,0],[0,0,1,0,0]]},{name:"Border",rows:[[5],[1,1],[1,1,1],[1,1],[5]],cols:[[5],[1,1],[1,1,1],[1,1],[5]],grid:[[1,1,1,1,1],[1,0,0,0,1],[1,0,1,0,1],[1,0,0,0,1],[1,1,1,1,1]]}];var s=r(1472);let f=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(0===t.length)return l;let n=(e=>{let t=0;for(let r=0;r<e.length;r+=1)t=31*t+e.charCodeAt(r)>>>0;return t})((0,s.getDailySeed)(e,r))%t.length;return t[n]},h=()=>{let e=(0,n.useMemo)(()=>f("nonogram",u),[]),t=(null==e?void 0:e.rows)||[],r=(null==e?void 0:e.cols)||[],c=t.length,s=r.length,h=(null==e?void 0:e.grid)||[],[g,d]=(0,n.useState)(Array(c).fill(0)),[m,y]=(0,n.useState)(Array(s).fill(0)),[p,v]=(0,n.useState)(Array(c).fill(!1)),[b,S]=(0,n.useState)(Array(s).fill(!1)),x=(0,n.useRef)(Array(c).fill(0)),w=(0,n.useRef)(Array(s).fill(0)),k=(0,n.useRef)(Array(c).fill(0)),A=(0,n.useRef)(Array(s).fill(0)),C=(0,n.useRef)(Array(c).fill(0)),E=(0,n.useRef)(Array(s).fill(0)),R=(0,n.useRef)(Array(c).fill(0)),M=(0,n.useRef)(Array(s).fill(0)),[j,T]=(0,n.useState)(""),[N,D]=(0,n.useState)(!1),[P,O]=(0,n.useState)(()=>Array(c).fill(0).map(()=>Array(s).fill(0))),B=(0,n.useRef)(P);(0,n.useEffect)(()=>{B.current=P},[P]);let I=(0,n.useRef)(null),F=(0,n.useRef)(),[J,L]=(0,n.useState)("paint"),[W,_]=(0,n.useState)(!1),[q,H]=(0,n.useState)(!0),[z,X]=(0,n.useState)(!1),[Y,G]=(0,n.useState)(0),[K,Q]=(0,n.useState)(null),[U,V]=(0,n.useState)(0),Z=(0,n.useRef)(Date.now()),$=(0,n.useRef)(!1);(0,n.useEffect)(()=>{let e=localStorage.getItem("nonogramHighScore");e&&Q(parseInt(e,10)),el()},[el]);let ee=(0,n.useCallback)(()=>{if(q)try{let e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator();t.frequency.value=880,t.connect(e.destination),t.start(),t.stop(e.currentTime+.05)}catch(e){}},[q]),et=(0,n.useCallback)(e=>{if(((e,t,r)=>{let l=e.every((e,r)=>JSON.stringify(a(e))===JSON.stringify(t[r])),n=r.every((t,r)=>JSON.stringify(a(e.map(e=>e[r])))===JSON.stringify(t));return l&&n})(e,t,r)&&!$.current){$.current=!0;let e=Math.floor((Date.now()-Z.current)/1e3);G(e),(null===K||e<K)&&(localStorage.setItem("nonogramHighScore",String(e)),Q(e)),ee(),alert("Puzzle solved!")}},[t,r,K,ee]),er=(0,n.useCallback)((e,l,n)=>{W||$.current||(B.current[e][l]!==n&&(1===n&&1!==h[e][l]||-1===n&&1===h[e][l])&&V(e=>e+1),O(a=>{let c=a.map(e=>e.slice());if(z&&(1===n&&1!==h[e][l]||-1===n&&1===h[e][l])||c[e][l]===n)return a;c[e][l]=n;let o=((e,t,r)=>{let l=!0,n=e.map(e=>e.slice());for(;l;)l=!1,t.forEach((e,t)=>{let r=i(e,n[t]);1===r.length&&r[0].forEach((e,r)=>{let a=e?1:-1;n[t][r]!==a&&(n[t][r]=a,l=!0)})}),r.forEach((e,t)=>{let r=i(e,n.map(e=>e[t]));1===r.length&&r[0].forEach((e,r)=>{let a=e?1:-1;n[r][t]!==a&&(n[r][t]=a,l=!0)})});return n})(c,t,r);return et(o),o}),ee())},[W,z,h,et,ee,t,r]),el=(0,n.useCallback)(()=>{O(Array(c).fill(0).map(()=>Array(s).fill(0))),Z.current=Date.now(),G(0),$.current=!1,_(!1),V(0)},[c,s]);(0,n.useEffect)(()=>{let e=window.matchMedia("(prefers-reduced-motion: reduce)"),t=()=>D(e.matches);return t(),e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[]),(0,n.useEffect)(()=>{let e=t.map((e,t)=>{let r=0,l=0,n=!1;for(let e=0;e<s;e++)1===h[t][e]?(l+=1,1===P[t][e]&&(r+=1)):1===P[t][e]&&(r-=1,n=!0);return{target:l?Math.max(0,Math.min(1,r/l)):1,error:n}}),l=r.map((e,t)=>{let r=0,l=0,n=!1;for(let e=0;e<c;e++)1===h[e][t]?(l+=1,1===P[e][t]&&(r+=1)):1===P[e][t]&&(r-=1,n=!0);return{target:l?Math.max(0,Math.min(1,r/l)):1,error:n}});d(e.map(e=>e.target)),y(l.map(e=>e.target)),v(e.map(e=>e.error)),S(l.map(e=>e.error));let n="";e.forEach((e,t)=>{let{target:r}=e;1===r&&R.current[t]<1&&(n="Row ".concat(t+1," solved"),C.current[t]=30),R.current[t]=r}),l.forEach((e,t)=>{let{target:r}=e;1===r&&M.current[t]<1&&(n="Column ".concat(t+1," solved"),E.current[t]=30),M.current[t]=r}),n&&T(n)},[P,t,r,c,s,h]),(0,n.useEffect)(()=>{let e=I.current,l=e.getContext("2d");e.width=60+30*s+1,e.height=60+30*c+1;let n=()=>{l.clearRect(0,0,e.width,e.height),x.current=x.current.map((e,t)=>{let r=g[t];return N?r:e+(r-e)*.1}),w.current=w.current.map((e,t)=>{let r=m[t];return N?r:e+(r-e)*.1}),k.current=k.current.map((e,t)=>{let r=+(1===g[t]);return N?r:e+(r-e)*.2}),A.current=A.current.map((e,t)=>{let r=+(1===m[t]);return N?r:e+(r-e)*.2}),C.current=C.current.map(e=>e>0?e-1:0),E.current=E.current.map(e=>e>0?e-1:0),x.current.forEach((e,t)=>{l.fillStyle=p[t]?"#b91c1c":"#15803d",l.fillRect(0,60+30*t,60*e,30)}),w.current.forEach((e,t)=>{l.fillStyle=b[t]?"#b91c1c":"#1e40af",l.fillRect(60+30*t,0,30,60*e)}),l.fillStyle="#000",l.font="16px monospace",l.textAlign="right",t.forEach((e,t)=>{let r=e.join(" "),n=60+30*t+21,a=C.current[t];if(p[t])l.fillStyle="#b91c1c";else if(a>0){let e=.5+.5*Math.sin(a/30*Math.PI*4);l.fillStyle="rgba(34,197,94,".concat(e,")")}else l.fillStyle="#000";l.fillText(r,56,n);let c=l.measureText(r).width,i=k.current[t];i>0&&(l.strokeStyle="#a00",l.lineWidth=2,l.beginPath(),l.moveTo(56-c,n-8),l.lineTo(56-c+c*i,n-8),l.stroke(),l.lineWidth=1,l.strokeStyle="#000")}),l.textAlign="center",r.forEach((e,t)=>{let r=60+30*t+15,n=E.current[t];e.slice().reverse().forEach((e,a)=>{if(b[t])l.fillStyle="#b91c1c";else if(n>0){let e=.5+.5*Math.sin(n/30*Math.PI*4);l.fillStyle="rgba(59,130,246,".concat(e,")")}else l.fillStyle="#000";l.fillText(String(e),r,56-16*a)});let a=A.current[t];if(a>0){let t=56-(e.length-1)*16-8;l.strokeStyle="#a00",l.lineWidth=2,l.beginPath(),l.moveTo(r,t),l.lineTo(r,t+(64-t)*a),l.stroke(),l.lineWidth=1,l.strokeStyle="#000"}}),l.strokeStyle="#000";for(let e=0;e<=c;e++)l.beginPath(),l.moveTo(60,60+30*e),l.lineTo(60+30*s,60+30*e),l.stroke();for(let e=0;e<=s;e++)l.beginPath(),l.moveTo(60+30*e,60),l.lineTo(60+30*e,60+30*c),l.stroke();B.current.forEach((e,t)=>{e.forEach((e,r)=>{let n=60+30*r,a=60+30*t;1===e?(l.fillStyle=1===h[t][r]?"#222":"#b91c1c",l.fillRect(n+1,a+1,29,29)):-1===e&&(l.strokeStyle="#a00",l.beginPath(),l.moveTo(n+4,a+4),l.lineTo(n+30-4,a+30-4),l.moveTo(n+30-4,a+4),l.lineTo(n+4,a+30-4),l.stroke(),l.strokeStyle="#000")})}),W?(l.fillStyle="rgba(0,0,0,0.5)",l.fillRect(0,0,e.width,e.height),l.fillStyle="#fff",l.textAlign="center",l.fillText("Paused",e.width/2,e.height/2)):$.current||G(Math.floor((Date.now()-Z.current)/1e3)),F.current=requestAnimationFrame(n)};return F.current=requestAnimationFrame(n),()=>cancelAnimationFrame(F.current)},[t,r,W,c,s,g,m,p,b,N,h]);let en=(0,n.useRef)(!1),ea=(0,n.useRef)(0),ec=(0,n.useRef)({i:0,j:0}),ei=(0,n.useRef)(null),eo=(0,n.useCallback)(e=>{let t=I.current.getBoundingClientRect(),r=e.clientX-t.left-60;return{i:Math.floor((e.clientY-t.top-60)/30),j:Math.floor(r/30)}},[]),eu=(0,n.useCallback)(e=>{e.preventDefault();let{i:t,j:r}=eo(e);if(t<0||t>=c||r<0||r>=s)return;en.current=!0,ec.current={i:t,j:r},ei.current=null;let l=B.current[t][r];2===e.button?ea.current=-1===l?0:-1:"paint"===J?ea.current=+(1!==l):ea.current=-1===l?0:-1,er(t,r,ea.current)},[eo,c,s,J,er]),es=(0,n.useCallback)(e=>{if(!en.current)return;let{i:t,j:r}=eo(e);if(t<0||t>=c||r<0||r>=s)return;if(null===ei.current)if(t===ec.current.i&&r===ec.current.j)return;else ei.current=Math.abs(t-ec.current.i)>Math.abs(r-ec.current.j)?"col":"row";let l=t,n=r;"row"===ei.current?l=ec.current.i:"col"===ei.current&&(n=ec.current.j),er(l,n,ea.current)},[eo,c,s,er]);(0,n.useEffect)(()=>{let e=()=>{en.current=!1};return window.addEventListener("mouseup",e),()=>window.removeEventListener("mouseup",e)},[]);let ef=(0,n.useCallback)(()=>{let e=((e,t,r)=>{for(let t=0;t<e.length;t++){let l=o(e[t],r[t]).filter(e=>1===e.value);if(l.length)return{i:t,j:l[0].index,value:1}}for(let e=0;e<t.length;e++){let l=r.map(t=>t[e]),n=o(t[e],l).filter(e=>1===e.value);if(n.length)return{i:n[0].index,j:e,value:1}}return null})(t,r,B.current);e&&er(e.i,e.j,e.value)},[t,r,er]);return(0,l.jsxs)("div",{className:"h-full w-full flex flex-col items-center justify-center bg-ub-cool-grey text-white select-none",children:[(0,l.jsx)("div",{className:"sr-only","aria-live":"polite",children:j}),(0,l.jsxs)("div",{className:"sr-only",children:[g.map((e,t)=>(0,l.jsx)("div",{role:"progressbar","aria-valuenow":Math.round(100*e),"aria-valuemin":0,"aria-valuemax":100,"aria-label":"Row ".concat(t+1," progress"),"aria-valuetext":p[t]?"error":void 0},"r".concat(t))),m.map((e,t)=>(0,l.jsx)("div",{role:"progressbar","aria-valuenow":Math.round(100*e),"aria-valuemin":0,"aria-valuemax":100,"aria-label":"Column ".concat(t+1," progress"),"aria-valuetext":b[t]?"error":void 0},"c".concat(t)))]}),(0,l.jsxs)("div",{className:"mb-2",children:["Time: ",Y,"s",null!==K&&" | Best: ".concat(K,"s")," | Mistakes: ".concat(U)]}),(0,l.jsx)("canvas",{ref:I,onMouseDown:eu,onMouseMove:es,onContextMenu:e=>e.preventDefault(),className:"bg-gray-200"}),(0,l.jsxs)("div",{className:"mt-2 space-x-2",children:[(0,l.jsxs)("button",{className:"px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded",onClick:()=>L("paint"===J?"mark":"paint"),children:["Mode: ","paint"===J?"Paint":"Mark"]}),(0,l.jsx)("button",{className:"px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded",onClick:el,children:"Reset"}),(0,l.jsx)("button",{className:"px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded",onClick:ef,children:"Hint"}),(0,l.jsx)("button",{className:"px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded",onClick:()=>_(e=>!e),children:W?"Resume":"Pause"}),(0,l.jsxs)("button",{className:"px-3 py-1 rounded ".concat(q?"bg-gray-700 hover:bg-gray-600":"bg-gray-500"),onClick:()=>H(e=>!e),children:["Sound: ",q?"On":"Off"]}),(0,l.jsxs)("button",{className:"px-3 py-1 rounded ".concat(z?"bg-gray-700 hover:bg-gray-600":"bg-gray-500"),onClick:()=>X(e=>!e),children:["Strict: ",z?"On":"Off"]})]})]})}}}]);