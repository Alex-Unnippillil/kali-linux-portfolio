"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3819],{16924:(e,t,r)=>{r.d(t,{default:()=>n});var a=r(14232);function n(e,t){let r=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let a=r.current;if(!a)return;let n=a.getContext("2d");if(!n)return;let l=()=>{let r=(()=>{let e=a.parentElement;if(!e)return null;let{clientWidth:t,clientHeight:r}=e;if(t>0&&r>0)return e;let n=e.closest("[data-game-viewport]");if(n)return n;let l=e.closest(".windowMainScreen");return null!=l?l:e})();if(!r)return;let{clientWidth:l,clientHeight:s}=r;if(l<=0||s<=0)return;let o=Math.min(l/e,s/t),c=e*o,i=t*o,u=window.devicePixelRatio||1;a.style.width="".concat(c,"px"),a.style.height="".concat(i,"px"),a.width=Math.floor(c*u),a.height=Math.floor(i*u),n.setTransform(u*o,0,0,u*o,0,0)};l();let s=a.parentElement,o=null==s?void 0:s.closest("[data-game-viewport]"),c=null==s?void 0:s.closest(".windowMainScreen"),i="undefined"!=typeof ResizeObserver?new ResizeObserver(l):null;return s&&i&&i.observe(s),o&&i&&o!==s&&i.observe(o),c&&i&&c!==s&&i.observe(c),window.addEventListener("resize",l),()=>{window.removeEventListener("resize",l),null==i||i.disconnect()}},[e,t]),r}},63819:(e,t,r)=>{r.r(t),r.d(t,{default:()=>N});var a=r(37876),n=r(14232),l=r(70994),s=r(44716),o=r(66893),c=r(99372),i=r(95220),u=r(16924),d=r(90209),f=r(67817);let b={x:-1,y:-1},h=e=>e.x<0||e.y<0,p=e=>"".concat(e.x,",").concat(e.y),g=(e,t)=>{let r=[];for(let a=0;a<t;a+=1)for(let n=0;n<t;n+=1){let t="".concat(n,",").concat(a);e.has(t)||r.push({x:n,y:a})}return r},m=function(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random;return null!=(t=e[Math.floor(r()*e.length)])?t:{...b}},y=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.random,n=new Set;e.forEach(e=>n.add(p(e))),t.forEach(e=>n.add(p(e)));let l=g(n,r);return l.length?m(l,a):{...b}},x=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Math.random,l=new Set;e.forEach(e=>l.add(p(e))),r.forEach(e=>l.add(p(e))),h(t)||l.add(p(t));let s=g(l,a);return s.length?m(s,n):{...b}};var v=r(98306);let k={classic:{label:"Neon Classic",background:["#020617","#0f172a","#1e293b"],snake:{head:"#4ade80",mid:"#22c55e",tail:"#14532d"},colorblindSnake:{head:"#facc15",mid:"#fbbf24",tail:"#b45309"},food:"#fb7185",colorblindFood:"#60a5fa",particles:"#f97316",milestone:"#fde047",gridAccent:"rgba(45,212,191,0.25)"},midnight:{label:"Midnight Alloy",background:["#020617","#111827","#0f172a"],snake:{head:"#38bdf8",mid:"#0ea5e9",tail:"#075985"},colorblindSnake:{head:"#f97316",mid:"#ea580c",tail:"#9a3412"},food:"#facc15",colorblindFood:"#f472b6",particles:"#38bdf8",milestone:"#a78bfa",gridAccent:"rgba(56,189,248,0.22)"},dusk:{label:"Solar Dusk",background:["#111827","#1f2937","#0f172a"],snake:{head:"#f87171",mid:"#f97316",tail:"#b45309"},colorblindSnake:{head:"#34d399",mid:"#22c55e",tail:"#166534"},food:"#38bdf8",colorblindFood:"#a855f7",particles:"#fbbf24",milestone:"#f472b6",gridAccent:"rgba(248,113,113,0.2)"}},w=(e,t,r)=>Math.min(Math.max(e,t),r),j=e=>{let t=parseInt(e.replace("#",""),16);return{r:t>>16&255,g:t>>8&255,b:255&t}},S=(e,t)=>{let{r,g:a,b:n}=j(e);return"rgba(".concat(r,", ").concat(a,", ").concat(n,", ").concat(t,")")},C=(e,t,r)=>{let a=j(e),n=j(t);return(e=>{let{r:t,g:r,b:a}=e;return"#".concat([t,r,a].map(e=>w(Math.round(e),0,255).toString(16).padStart(2,"0")).join(""))})({r:a.r+(n.r-a.r)*r,g:a.g+(n.g-a.g)*r,b:a.b+(n.b-a.b)*r})},N=function(){var e;let{windowMeta:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=null==(e=null==t?void 0:t.isFocused)||e,b=(0,f.default)(),p=(0,u.default)(320,320),g=(0,n.useRef)(null),m=(0,n.useRef)([]),j=(0,n.useRef)(null),[N]=(0,i.default)("snake:obstacles",[],e=>Array.isArray(e)),[R,M]=(0,i.default)("snake:obstaclesEnabled",!0,e=>"boolean"==typeof e),E=(0,n.useCallback)(()=>"".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,10)),[]),P=(0,n.useCallback)(function(e){var t,r;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e||E();v.default.reset(n);let l=null!=(t=a.obstaclesEnabled)?t:R,s=null!=(r=a.obstaclePack)?r:N;return(e=>{var t,r,a,n,l,s,o,c;let i=null!=(r=null==e?void 0:e.gridSize)?r:20,u=null!=(a=null==e||null==(t=e.snake)?void 0:t.map(e=>({...e})))?a:[{x:2,y:2},{x:1,y:2},{x:0,y:2}],d=null!=(s=null==e?void 0:e.food)?s:(null==e?void 0:e.randomFood)?e.randomFood(u,null!=(n=null==e?void 0:e.obstacles)?n:[],i,null==e?void 0:e.random):y(u,null!=(l=null==e?void 0:e.obstacles)?l:[],i,null==e?void 0:e.random),f=null!=(o=null==e?void 0:e.obstacleCount)?o:(null==e?void 0:e.obstacles)?e.obstacles.length:5,b=null!=(c=null==e?void 0:e.randomObstacle)?c:x,p=(e=>{var t;let r=[];(null==(t=e.existing)?void 0:t.length)&&e.existing.forEach(e=>{h(e)||r.push({...e})});for(let t=r.length;t<e.count;t+=1){let t=e.generator(e.snake,e.food,r,e.gridSize,e.random);if(h(t))break;r.push(t)}return r})({snake:u,food:d,existing:null==e?void 0:e.obstacles,count:f,gridSize:i,generator:b,random:null==e?void 0:e.random});return{snake:u,food:d,obstacles:p}})({obstacles:l&&s.length?s:[],obstacleCount:l&&!s.length?5:0,random:v.default.random})},[N,R,E]),T=(0,n.useRef)(""),A=(0,n.useRef)(null);A.current||(T.current=E(),A.current=P(T.current));let O=(0,n.useRef)(A.current.snake.map(e=>({...e,scale:1}))),I=(0,n.useRef)({...A.current.food}),K=(0,n.useRef)(A.current.obstacles.map(e=>({...e}))),_=(0,n.useRef)({x:1,y:0}),z=(0,n.useRef)([]),D=(0,n.useRef)(0),G=(0,n.useRef)(!0),F=(0,n.useRef)(0),L=(0,n.useRef)(null),W=(0,c.default)(),H=(0,d.default)(),[V,q]=(0,n.useState)(!0),[B,J]=(0,i.default)("snake:wrap",!1,e=>"boolean"==typeof e),[U,Y]=(0,i.default)("snake:skin","classic",e=>"string"==typeof e&&Object.prototype.hasOwnProperty.call(k,e)),[Q,X]=(0,i.default)("snake:colorblind",!1,e=>"boolean"==typeof e),[Z,$]=(0,i.default)("snake:sound",!0,e=>"boolean"==typeof e),[ee,et]=(0,i.default)("snake:baseSpeed",120,e=>"number"==typeof e),[er,ea]=(0,n.useState)(ee),[en,el]=(0,n.useState)(0),[es,eo]=(0,n.useState)(!1),[ec,ei]=(0,n.useState)(!1),[eu,ed]=(0,i.default)("snake:highScore",0,e=>"number"==typeof e),ef=(0,n.useRef)(ee),{save:eb,load:eh,list:ep,remove:eg}=(0,o.useSaveSlots)("snake-replay"),[em,ey]=(0,n.useState)(""),[ex,ev]=(0,i.default)("snake:touchControls",b,e=>"boolean"==typeof e),ek=(0,n.useRef)(!1),ew=(0,n.useRef)(!1),ej=(0,n.useRef)("inputs"),eS=(0,n.useRef)([]),eC=(0,n.useRef)(0),eN=(0,n.useRef)([]),eR=(0,n.useRef)(0),eM=(0,n.useRef)([]),eE=(0,n.useRef)(0),[eP,eT]=(0,n.useState)(!1),[eA,eO]=(0,n.useState)(!1),eI=(0,n.useMemo)(()=>{let e=k[U]||k.classic,t=Q&&e.colorblindSnake||e.snake;return{...e,snakePalette:t,foodColor:Q&&e.colorblindFood||e.food}},[U,Q]),eK=(0,n.useCallback)(()=>{H||(eT(!0),j.current&&clearTimeout(j.current),j.current=setTimeout(()=>{eT(!1),j.current=null},900))},[H]),e_=(0,n.useCallback)(function(e){let{milestone:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(H)return;let r=t?56:28,a=t?2.6:1.6,n=16*e.x+8,l=16*e.y+8,s=t?eI.milestone:eI.particles;for(let e=0;e<r;e+=1){let o=2*Math.PI*e/r+Math.random()*Math.PI*.25,c=(.5*Math.random()+.4)*a;m.current.push({x:n,y:l,vx:Math.cos(o)*c,vy:Math.sin(o)*c,life:t?1.4+.4*Math.random():.7+.3*Math.random(),initialLife:t?1.8:.9,size:t?2.5*Math.random()+2:1.8*Math.random()+1,color:s,glow:t,gravity:t?.25:.4})}},[H,eI]),ez=(0,n.useCallback)(e=>{if(!m.current.length)return;let t=w(60*e,0,3);for(let r=m.current.length-1;r>=0;r-=1){let a=m.current[r];if(a.life-=e,a.life<=0){m.current.splice(r,1);continue}a.x+=a.vx*t,a.y+=a.vy*t,a.vx*=.96,a.vy=.94*a.vy+a.gravity*t*.6}},[]);(0,n.useEffect)(()=>{ef.current=er},[er]),(0,n.useEffect)(()=>{F.current=en},[en]),(0,n.useEffect)(()=>()=>{j.current&&clearTimeout(j.current)},[]),(0,n.useEffect)(()=>{[{oldKey:"snake_wrap",newKey:"snake:wrap",setter:J,validator:e=>"boolean"==typeof e},{oldKey:"snake_skin",newKey:"snake:skin",setter:Y,validator:e=>"string"==typeof e&&Object.prototype.hasOwnProperty.call(k,e)},{oldKey:"snake_colorblind_mode",newKey:"snake:colorblind",setter:X,validator:e=>"boolean"==typeof e},{oldKey:"snake_sound",newKey:"snake:sound",setter:$,validator:e=>"boolean"==typeof e},{oldKey:"snake_base_speed",newKey:"snake:baseSpeed",setter:et,validator:e=>"number"==typeof e},{oldKey:"snake_highscore",newKey:"snake:highScore",setter:ed,validator:e=>"number"==typeof e},{oldKey:"snake_touch_controls",newKey:"snake:touchControls",setter:ev,validator:e=>"boolean"==typeof e},{oldKey:"snake_obstacles_enabled",newKey:"snake:obstaclesEnabled",setter:M,validator:e=>"boolean"==typeof e}].forEach(e=>{let{oldKey:t,newKey:r,setter:a,validator:n}=e;try{let e=window.localStorage.getItem(r);if(null!==e)return;let l=window.localStorage.getItem(t);if(null===l)return;let s=JSON.parse(l);if(n&&!n(s))return;window.localStorage.setItem(r,JSON.stringify(s)),a(s),window.localStorage.removeItem(t)}catch(e){}})},[J,Y,X,$,et,ed,ev,M]),(0,n.useEffect)(()=>{H&&(m.current=[],eT(!1),j.current&&(clearTimeout(j.current),j.current=null))},[H]),(0,n.useEffect)(()=>{if(H){eO(!0),G.current&&(G.current=!1,q(!1));return}eA&&(eO(!1),es||ec||!r||(G.current=!0,q(!0)))},[H,eA,es,ec,r]);let eD=(0,n.useCallback)(e=>{if(Z)try{let t=L.current||new(window.AudioContext||window.webkitAudioContext);L.current=t;let r=t.createOscillator(),a=t.createGain();r.frequency.value=e,r.connect(a),a.connect(t.destination),a.gain.setValueAtTime(.2,t.currentTime),a.gain.exponentialRampToValueAtTime(.001,t.currentTime+.15),r.start(),r.stop(t.currentTime+.15)}catch(e){}},[Z]),eG=(0,n.useCallback)(()=>{let e=g.current;if(!e)return;e.clearRect(0,0,320,320);let[t,r,a]=eI.background,n=e.createLinearGradient(0,0,0,320);n.addColorStop(0,t),n.addColorStop(.5,r),n.addColorStop(1,a),e.fillStyle=n,e.fillRect(0,0,320,320),e.save(),e.lineWidth=.35,e.strokeStyle=eI.gridAccent,e.beginPath();for(let t=1;t<20;t+=1){let r=16*t+.5;e.moveTo(r,0),e.lineTo(r,320),e.moveTo(0,r),e.lineTo(320,r)}e.stroke(),e.restore();let l=[],s=O.current[0].x,o=O.current[0].y,c=_.current,i=z.current;for(let e=0;e<5;e+=1){if(i[e]&&(c=i[e]),s+=c.x,o+=c.y,B)s=(s+20)%20,o=(o+20)%20;else if(s<0||o<0||s>=20||o>=20)break;l.push({x:s,y:o})}l.length&&(e.fillStyle=Q?"rgba(125,211,252,0.35)":"rgba(74,222,128,0.35)",l.forEach(t=>{e.fillRect(16*t.x,16*t.y,16,16)})),K.current.forEach(t=>{let r=16*t.x,a=16*t.y,n=e.createLinearGradient(r,a,r+16,a+16);n.addColorStop(0,"rgba(148,163,184,0.75)"),n.addColorStop(1,"rgba(71,85,105,0.95)"),e.fillStyle=n,e.fillRect(r,a,16,16),e.strokeStyle="rgba(15,23,42,0.6)",e.strokeRect(r+.5,a+.5,15,15)});let u=I.current,d=16*u.x+8,f=16*u.y+8,b=e.createRadialGradient(d,f,3.2,d,f,12.8);b.addColorStop(0,"#fff9"),b.addColorStop(.45,eI.foodColor),b.addColorStop(1,S(eI.foodColor,.1)),e.fillStyle=b,e.beginPath(),e.arc(d,f,7.2,0,2*Math.PI),e.fill(),Q&&(e.strokeStyle="#f8fafc",e.lineWidth=1.2,e.beginPath(),e.moveTo(d-3.2,f),e.lineTo(d+3.2,f),e.moveTo(d,f-3.2),e.lineTo(d,f+3.2),e.stroke());let h=O.current;h.forEach((t,r)=>{var a;let n=null!=(a=t.scale)?a:1,l=16*n,s=(16-l)/2,o=16*t.x+s,c=16*t.y+s,i=h.length<=1?0:r/(h.length-1||1),u=C(eI.snakePalette.mid,eI.snakePalette.tail,i),d=C(eI.snakePalette.head,eI.snakePalette.mid,Math.sqrt(i)),f=e.createLinearGradient(o,c,o+l,c+l);f.addColorStop(0,d),f.addColorStop(1,u),e.fillStyle=f,e.fillRect(o,c,l,l),e.strokeStyle=S("#0f172a",.25),e.lineWidth=.8,e.strokeRect(o+.4,c+.4,l-.8,l-.8),Q&&(e.strokeStyle=S("#0f172a",.5),e.setLineDash([2,2]),e.beginPath(),e.moveTo(o,c+l/2),e.lineTo(o+l,c+l/2),e.stroke(),e.setLineDash([])),n<1&&(t.scale=H?1:Math.min(1,n+.1))});let p=h[0];if(p&&!H){e.save(),e.globalCompositeOperation="lighter";let t=16*p.x+8,r=16*p.y+8,a=e.createRadialGradient(t,r,4.8,t,r,80);a.addColorStop(0,S(eI.snakePalette.head,.55)),a.addColorStop(.4,S(eI.snakePalette.mid,.25)),a.addColorStop(1,"rgba(15,23,42,0)"),e.fillStyle=a,e.fillRect(0,0,320,320),e.restore()}m.current.length&&(e.save(),m.current.forEach(t=>{let r=w(t.life/t.initialLife,0,1),a=w(r+.1,0,1);if(t.glow){let r=e.createRadialGradient(t.x,t.y,0,t.x,t.y,4*t.size);r.addColorStop(0,S(t.color,a)),r.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=r,e.globalAlpha=.6*a,e.fillRect(t.x-4*t.size,t.y-4*t.size,8*t.size,8*t.size)}e.globalAlpha=a,e.fillStyle=S(t.color,w(a+.2,0,1)),e.beginPath(),e.arc(t.x,t.y,t.size,0,2*Math.PI),e.fill()}),e.restore())},[B,Q,eI,H]);(0,n.useEffect)(()=>{var e;g.current=null==(e=p.current)?void 0:e.getContext("2d"),eG()},[eG,p]);let eF=(0,n.useCallback)(()=>{if(ek.current&&"frames"===ej.current){var e;let t=eS.current,r=eC.current;if(!t||r>=t.length){ek.current=!1,G.current=!1,q(!1);return}let a=t[r];eC.current+=1,O.current=a.snake.map(e=>({...e})),I.current={...a.food},K.current=a.obstacles.map(e=>({...e}));let n=null!=(e=a.score)?e:0;F.current=n,el(n);return}if(ek.current){let e=eN.current;for(;eR.current<e.length&&e[eR.current].stepIndex===eE.current;)z.current.push(e[eR.current].dir),eR.current+=1}if(z.current.length){let e=z.current.shift();e&&(_.current.x+e.x!==0||_.current.y+e.y!==0)&&(_.current=e)}let t={...I.current},r=((e,t,r)=>{var a,n;let l=r.gridSize;if(h(e.food))return{state:e,grew:!1,collision:"none",won:!0};let s=e.snake.map(e=>({...e})),o=e.obstacles.map(e=>({...e})),c=o.map(e=>({...e})),i={...e.food},u=s[0],d=u.x+t.x,f=u.y+t.y;if(r.wrap)d<0&&(d=l-1),d>=l&&(d=0),f<0&&(f=l-1),f>=l&&(f=0);else if(d<0||d>=l||f<0||f>=l)return{state:e,grew:!1,collision:"wall",won:!1};let b=d===i.x&&f===i.y,p=b?s:s.slice(0,-1);for(let t=0;t<p.length;t+=1)if(p[t].x===d&&p[t].y===f)return{state:e,grew:!1,collision:"self",won:!1};for(let t=0;t<o.length;t+=1)if(o[t].x===d&&o[t].y===f)return{state:e,grew:!1,collision:"obstacle",won:!1};let g=[{x:d,y:f},...s];b||g.pop();let m=null!=(a=r.randomFood)?a:y,x=null!=(n=r.random)?n:Math.random,v=b?m(g,c,l,x):i,k=!1,w=o.map(e=>({...e}));if(b){if(h(v))k=!0;else if(r.randomObstacle){let e=(0,r.randomObstacle)(g,v,c,l,x);h(e)||w.push(e)}}return{state:{snake:g,food:v,obstacles:w},grew:b,collision:"none",won:k}})({snake:O.current.map(e=>({x:e.x,y:e.y})),food:{...I.current},obstacles:K.current.map(e=>({x:e.x,y:e.y}))},_.current,{wrap:B,gridSize:20,random:v.default.random});if("none"!==r.collision){W.danger(),eo(!0),ei(!1),G.current=!1,q(!1),ek.current=!1,eD(120);return}let a=r.state.snake.map(e=>({...e,scale:1}));if(r.grew&&!H&&a.length&&(a[0].scale=0),O.current=a,I.current={...r.state.food},K.current=r.state.obstacles.map(e=>({...e})),r.grew){let e=F.current+1;F.current=e,el(e),W.score(),eD(440),ea(e=>Math.max(50,.95*e)),e_(t),e>0&&e%5==0&&(eK(),a.length&&e_(a[0],{milestone:!0}))}eE.current+=1,r.won&&(ek.current=!1,ei(!0),eo(!1),G.current=!1,q(!1),eD(620))},[B,eD,W,H,q,ea,e_,eK]),eL=(0,n.useCallback)(e=>{if(H||ez(e),D.current+=1e3*e,D.current<ef.current)return void eG();for(;D.current>=ef.current&&(D.current-=ef.current,eF(),G.current););eG()},[eF,eG,ez,H]);(0,n.useEffect)(()=>{G.current=V},[V]),(0,n.useEffect)(()=>{if(!r&&V){ew.current=!0,G.current=!1,q(!1);return}!r||!ew.current||es||ec||eA||(ew.current=!1,G.current=!0,q(!0))},[r,V,es,ec,eA]),(0,o.useGameLoop)(eL,V);let eW=(0,n.useCallback)(e=>{let{x:t,y:r}=e;if(ek.current||es||ec)return;let a=z.current,n=a.length?a[a.length-1]:_.current;(n.x+t!==0||n.y+r!==0)&&(a.length>=3||(a.push({x:t,y:r}),eM.current.push({stepIndex:eE.current,dir:{x:t,y:r}})))},[es,ec]);(0,s.default)(eW,"snake",{preventDefault:!0,isFocused:r,targetRef:p}),(0,n.useEffect)(()=>{(es||ec)&&en>eu&&ed(en)},[es,ec,en,eu,ed]),(0,n.useEffect)(()=>{es&&W.gameOver()},[es,W]),(0,n.useEffect)(()=>{(es||ec)&&!ek.current&&(eM.current.length||eE.current>0)&&eb("replay-".concat(Date.now()),{seed:T.current,settings:{wrap:B,obstaclesEnabled:R,obstaclePack:N,baseSpeed:ee,skinId:U},inputs:eM.current})},[es,ec,eb,B,R,N,ee,U]);let eH=(0,n.useCallback)(()=>{let e=E();T.current=e;let t=P(e);O.current=t.snake.map(e=>({...e,scale:1})),I.current={...t.food},K.current=t.obstacles.map(e=>({...e})),_.current={x:1,y:0},z.current=[],ek.current=!1,ej.current="inputs",eS.current=[],eC.current=0,eN.current=[],eR.current=0,eM.current=[],eE.current=0,D.current=0;let a=!H&&r;G.current=a,el(0),F.current=0,eo(!1),ei(!1),q(a),ea(ee),ef.current=ee,m.current=[],eT(!1),eO(H),j.current&&(clearTimeout(j.current),j.current=null),eG()},[ee,P,eG,r,E,H]),eV=(0,n.useCallback)(e=>{let t=eh(e);if(!t)return;let a=Array.isArray(t.frames)&&t.frames.length>0;ej.current=a?"frames":"inputs",eS.current=a?t.frames:[],eC.current=0,eN.current=t.inputs||[],eR.current=0,eE.current=0,eM.current=[],ek.current=!0;let n=t.settings||{};void 0!==n.wrap&&J(n.wrap),void 0!==n.obstaclesEnabled&&M(n.obstaclesEnabled),void 0!==n.baseSpeed?(et(n.baseSpeed),ea(n.baseSpeed),ef.current=n.baseSpeed):(ea(ee),ef.current=ee),void 0!==n.skinId&&Y(n.skinId);let l=t.seed||E();T.current=l;let s=P(l,n);O.current=s.snake.map(e=>({...e,scale:1})),K.current=s.obstacles.map(e=>({...e})),I.current={...s.food},_.current={x:1,y:0},z.current=[],D.current=0;let o=!H&&r;if(eO(H),q(o),G.current=o,eo(!1),ei(!1),a){var c;let e=t.frames[0];O.current=e.snake.map(e=>({...e})),K.current=e.obstacles.map(e=>({...e})),I.current={...e.food};let r=null!=(c=e.score)?c:0;F.current=r,el(r)}else F.current=0,el(0)},[ee,P,r,eh,E,H,et,M,Y,ea,J]),eq=(0,n.useCallback)(e=>{if(e){G.current=!1,q(!1);return}!eA&&(!ek.current&&(es||ec)||(G.current=!0,q(!0)))},[es,ec,eA]),eB=(0,n.useCallback)(e=>{let t=Number(e.target.value);et(t),ea(t)},[et,ea]),eJ=(0,n.useCallback)(()=>ed(0),[ed]),eU=ep(),eY=(0,a.jsxs)("div",{className:"space-y-3 text-sm text-slate-100",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center justify-between gap-2",children:[(0,a.jsx)("span",{children:"Wrap"}),(0,a.jsx)("input",{type:"checkbox",className:"h-4 w-4",checked:B,"aria-label":"Wrap",onChange:e=>J(e.target.checked)})]}),(0,a.jsxs)("label",{className:"flex items-center justify-between gap-2",children:[(0,a.jsx)("span",{children:"Obstacles"}),(0,a.jsx)("input",{type:"checkbox",className:"h-4 w-4",checked:R,"aria-label":"Obstacles",onChange:e=>{M(e.target.checked),eH()}})]}),(0,a.jsxs)("label",{className:"flex items-center justify-between gap-2",children:[(0,a.jsx)("span",{children:"Sound"}),(0,a.jsx)("input",{type:"checkbox",className:"h-4 w-4",checked:Z,"aria-label":"Sound",onChange:e=>$(e.target.checked)})]}),(0,a.jsxs)("label",{className:"flex items-center justify-between gap-2",children:[(0,a.jsx)("span",{children:"Haptics"}),(0,a.jsx)("input",{type:"checkbox",className:"h-4 w-4",checked:W.enabled,"aria-label":"Haptics",onChange:W.toggle})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{htmlFor:"snake-skin",className:"flex items-center justify-between gap-2",children:[(0,a.jsx)("span",{children:"Skin"}),(0,a.jsx)("select",{id:"snake-skin",className:"bg-gray-800/80 rounded px-2 py-1 focus:outline-none focus:ring",value:U,onChange:e=>Y(e.target.value),children:Object.entries(k).map(e=>{let[t,r]=e;return(0,a.jsx)("option",{value:t,children:r.label},t)})})]}),(0,a.jsxs)("label",{className:"flex items-center justify-between gap-2",children:[(0,a.jsx)("span",{children:"Colorblind assist"}),(0,a.jsx)("input",{type:"checkbox",className:"h-4 w-4",checked:Q,"aria-label":"Colorblind assist",onChange:e=>X(e.target.checked)})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{htmlFor:"snake-speed",className:"flex flex-col gap-2",children:[(0,a.jsxs)("span",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Base speed"}),(0,a.jsxs)("span",{className:"text-xs text-slate-400",children:[ee,"ms"]})]}),(0,a.jsx)("input",{id:"snake-speed",type:"range",min:"50",max:"300",step:"10",value:ee,onChange:eB,"aria-label":"Base speed",className:"accent-emerald-400"})]}),(0,a.jsxs)("label",{className:"flex items-center justify-between gap-2",children:[(0,a.jsx)("span",{children:"Touch D-pad"}),(0,a.jsx)("input",{type:"checkbox",className:"h-4 w-4",checked:ex,"aria-label":"Touch D-pad",onChange:e=>ev(e.target.checked)})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{htmlFor:"snake-replay",className:"flex items-center justify-between gap-2",children:[(0,a.jsx)("span",{children:"Replay"}),(0,a.jsxs)("select",{id:"snake-replay",className:"bg-gray-800/80 rounded px-2 py-1 focus:outline-none focus:ring",value:em,onChange:e=>ey(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Select"}),eU.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"button",className:"flex-1 px-3 py-1 bg-gray-700/80 rounded shadow-sm transition hover:bg-gray-600 focus:outline-none focus:ring disabled:opacity-50",onClick:()=>eV(em),disabled:!em,children:"Play"}),(0,a.jsx)("button",{type:"button",className:"flex-1 px-3 py-1 bg-gray-700/80 rounded shadow-sm transition hover:bg-gray-600 focus:outline-none focus:ring disabled:opacity-50",onClick:()=>{eg(em),ey("")},disabled:!em,children:"Delete"})]})]}),(0,a.jsx)("button",{type:"button",className:"w-full px-3 py-1 bg-gray-700/80 rounded shadow-sm transition hover:bg-gray-600 focus:outline-none focus:ring",onClick:eJ,children:"Reset high score"})]});return(0,a.jsx)(l.default,{gameId:"snake",score:en,highScore:eu,onPauseChange:eq,onRestart:eH,pauseHotkeys:[" ","space","spacebar"],restartHotkeys:["r"],settingsPanel:eY,isFocused:r,children:(0,a.jsxs)("div",{className:"h-full w-full flex flex-col items-center justify-center bg-ub-cool-grey text-white select-none px-3 pb-4",children:[(0,a.jsx)("p",{id:"snake-instructions",className:"sr-only",children:"Use arrow keys or swipe to move. Press Space to pause and R to restart."}),(0,a.jsxs)("div",{className:"relative flex flex-col items-center",children:[(0,a.jsx)("canvas",{ref:p,className:"bg-gray-900/80 border border-gray-700/70 shadow-xl w-full h-full rounded",tabIndex:0,"aria-label":"Snake game board","aria-describedby":"snake-instructions"}),eA&&!es&&!ec&&(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3 bg-black/70 text-center px-4",role:"status","aria-live":"polite",children:[(0,a.jsx)("div",{className:"text-lg font-semibold text-slate-100",children:"Reduced motion is enabled. Press Resume to play."}),(0,a.jsx)("button",{type:"button",className:"px-4 py-1.5 bg-emerald-500/90 text-slate-900 font-semibold rounded shadow-sm transition hover:bg-emerald-400 focus:outline-none focus:ring",onClick:()=>{eO(!1),es||ec||!r||(G.current=!0,q(!0))},children:"Resume"})]}),es&&(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3 bg-black/70 text-center px-4",role:"status","aria-live":"polite",children:[(0,a.jsx)("div",{className:"text-2xl font-semibold text-rose-200",children:"Game Over"}),(0,a.jsx)("div",{className:"text-sm text-slate-200",children:"Press R or Restart to try again."})]}),ec&&(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3 bg-black/70 text-center px-4",role:"status","aria-live":"polite",children:[(0,a.jsx)("div",{className:"text-2xl font-semibold text-emerald-200",children:"You win!"}),(0,a.jsx)("div",{className:"text-sm text-slate-200",children:"Press R or Restart to play again."})]}),eP&&(0,a.jsxs)("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 rounded-full bg-emerald-500/80 px-4 py-1 text-sm font-semibold text-slate-900 shadow-lg backdrop-blur",role:"status","aria-live":"polite",children:["Milestone ",en,"!"]})]}),ex&&(0,a.jsxs)("div",{className:"mt-4 grid grid-cols-3 gap-2 text-lg",children:[(0,a.jsx)("div",{}),(0,a.jsx)("button",{type:"button",onPointerDown:()=>eW({x:0,y:-1}),className:"h-12 w-12 rounded bg-gray-800/80 shadow-sm transition hover:bg-gray-700 focus:outline-none focus:ring","aria-label":"Move up",children:"↑"}),(0,a.jsx)("div",{}),(0,a.jsx)("button",{type:"button",onPointerDown:()=>eW({x:-1,y:0}),className:"h-12 w-12 rounded bg-gray-800/80 shadow-sm transition hover:bg-gray-700 focus:outline-none focus:ring","aria-label":"Move left",children:"←"}),(0,a.jsx)("button",{type:"button",onPointerDown:()=>eW({x:0,y:1}),className:"h-12 w-12 rounded bg-gray-800/80 shadow-sm transition hover:bg-gray-700 focus:outline-none focus:ring","aria-label":"Move down",children:"↓"}),(0,a.jsx)("button",{type:"button",onPointerDown:()=>eW({x:1,y:0}),className:"h-12 w-12 rounded bg-gray-800/80 shadow-sm transition hover:bg-gray-700 focus:outline-none focus:ring","aria-label":"Move right",children:"→"})]})]})})}},67817:(e,t,r)=>{r.d(t,{default:()=>l});var a=r(14232);let n=()=>"function"==typeof window.matchMedia?window.matchMedia("(pointer: coarse)").matches:"ontouchstart"in window||navigator.maxTouchPoints>0;function l(){let[e,t]=(0,a.useState)(n);return(0,a.useEffect)(()=>{var e,r,a;let n=null==(e=(r=window).matchMedia)?void 0:e.call(r,"(pointer: coarse)");if(!n)return;let l=e=>{t(e.matches)};return null==(a=n.addEventListener)||a.call(n,"change",l),()=>{var e;null==(e=n.removeEventListener)||e.call(n,"change",l)}},[]),e}},85687:(e,t,r)=>{r.d(t,{patterns:()=>l,supportsVibration:()=>a,vibrate:()=>n});let a=()=>"undefined"!=typeof navigator&&"function"==typeof navigator.vibrate,n=e=>{if("false"===window.localStorage.getItem("haptics"))return;let t=Array.isArray(e)?e.reduce((e,t)=>e+(t>0?t:0),0):e;try{a()&&navigator.vibrate(e);if("undefined"!=typeof navigator&&"getGamepads"in navigator&&Array.from(navigator.getGamepads?navigator.getGamepads():[]).some(e=>e&&e.vibrationActuator&&"function"==typeof e.vibrationActuator.playEffect))try{for(let e of navigator.getGamepads())e&&e.vibrationActuator&&e.vibrationActuator.playEffect("dual-rumble",{duration:t,strongMagnitude:1,weakMagnitude:1})}catch(e){}}catch(e){}},l={score:[20],danger:[40,80,40],gameOver:[100,30,100]}},99372:(e,t,r)=>{r.d(t,{default:()=>s});var a=r(14232),n=r(74273),l=r(85687);function s(){let{haptics:e,setHaptics:t}=(0,n.useSettings)(),r=(0,a.useCallback)(t=>{e&&(0,l.supportsVibration)()&&(0,l.vibrate)(t)},[e]),s=(0,a.useCallback)(()=>r(l.patterns.score),[r]),o=(0,a.useCallback)(()=>r(l.patterns.danger),[r]),c=(0,a.useCallback)(()=>r(l.patterns.gameOver),[r]),i=(0,a.useCallback)(()=>t(!e),[t,e]);return{enabled:e,toggle:i,vibrate:r,score:s,danger:o,gameOver:c}}}}]);