(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3897],{28529:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/qr",function(){return a(67840)}])},31730:(e,t,a)=>{"use strict";a.d(t,{hasIndexedDB:()=>l,isBrowser:()=>r});let r="undefined"!=typeof document,l=r&&"undefined"!=typeof indexedDB},65578:(e,t,a)=>{"use strict";a.d(t,{clearScans:()=>u,loadLastGeneration:()=>x,loadLastScan:()=>m,loadScans:()=>o,saveLastGeneration:()=>b,saveLastScan:()=>h,saveScans:()=>d});var r=a(31730);let l="qrScans",s="qrLastScan",i="qrLastGeneration",n="qr-scans.json",c=r.isBrowser&&"storage"in navigator&&!!navigator.storage.getDirectory,o=async()=>{if(!r.isBrowser)return[];if(c)try{let e=await navigator.storage.getDirectory(),t=await e.getFileHandle(n),a=await t.getFile();return JSON.parse(await a.text())}catch(e){return[]}try{return JSON.parse(localStorage.getItem(l)||"[]")}catch(e){return[]}},d=async e=>{if(r.isBrowser){if(c){let t=await navigator.storage.getDirectory(),a=await t.getFileHandle(n,{create:!0}),r=await a.createWritable();await r.write(JSON.stringify(e)),await r.close();return}localStorage.setItem(l,JSON.stringify(e))}},u=async()=>{if(r.isBrowser){if(c){try{let e=await navigator.storage.getDirectory();await e.removeEntry(n)}catch(e){}return}localStorage.removeItem(l)}},m=()=>r.isBrowser&&localStorage.getItem(s)||"",h=e=>{r.isBrowser&&localStorage.setItem(s,e)},x=()=>r.isBrowser&&localStorage.getItem(i)||"",b=e=>{r.isBrowser&&localStorage.setItem(i,e)}},67840:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var r=a(37876),l=a(54587),s=a.n(l),i=a(14232),n=a(43617);function c(e){let{tabs:t,active:a,onChange:l,className:s=""}=e;return(0,r.jsx)("div",{role:"tablist",className:"flex ".concat(s).trim(),children:t.map(e=>(0,r.jsx)("button",{role:"tab","aria-selected":a===e.id,tabIndex:a===e.id?0:-1,onClick:()=>l(e.id),className:"px-4 py-2 focus:outline-none ".concat(a===e.id?"bg-ub-orange text-white":"text-ubt-grey"),children:e.label},e.id))})}var o=a(75758),d=a(65578);let u=[{id:"text",label:"Text"},{id:"url",label:"URL"},{id:"wifi",label:"Wi-Fi"},{id:"vcard",label:"vCard"}],m=()=>{let[e,t]=(0,i.useState)("text"),[l,m]=(0,i.useState)(""),[h,x]=(0,i.useState)(""),[b,g]=(0,i.useState)(""),[p,w]=(0,i.useState)(""),[f,v]=(0,i.useState)("WPA"),[j,N]=(0,i.useState)(""),[y,S]=(0,i.useState)(""),[C,q]=(0,i.useState)(""),[E,k]=(0,i.useState)(""),[D,F]=(0,i.useState)(""),[I,R]=(0,i.useState)(""),[L,O]=(0,i.useState)("qr"),[B,A]=(0,i.useState)(""),[_,P]=(0,i.useState)([]),[U,G]=(0,i.useState)(""),[W,T]=(0,i.useState)([]),[Q,V]=(0,i.useState)(""),H=(0,i.useRef)(null),J=async t=>{t.preventDefault();let a="",r="qr";switch(e){case"text":a=l,r="text";break;case"url":a=h,r="url";break;case"wifi":a="WIFI:T:".concat(f,";S:").concat(b,";P:").concat(p,";;"),r="wifi";break;case"vcard":{let e=j.trim().split(" "),t=e.shift()||"",l=e.pop()||"",s=e.join(" "),i=["BEGIN:VCARD","VERSION:3.0","N:".concat(l,";").concat(t,";").concat(s,";;"),"FN:".concat(j)];y&&i.push("ORG:".concat(y)),C&&i.push("TEL;TYPE=CELL:".concat(C)),E&&i.push("EMAIL:".concat(E)),i.push("END:VCARD"),a=i.join("\n"),r="vcard"}}if(!a){G("Please fill in required fields"),F(""),R("");return}try{let e=await n.toDataURL(a),t=await n.toString(a,{type:"svg"});F(e),R(t),O(r),G("")}catch(e){G("Failed to generate QR code"),F(""),R("")}};(0,i.useEffect)(()=>{(0,d.loadScans)().then(P)},[]),(0,i.useEffect)(()=>{let e=H.current,t=!0,r=0;return(async()=>{if(!navigator.mediaDevices)return G("Camera API not supported");try{let i=await navigator.mediaDevices.getUserMedia({video:Q?{deviceId:{exact:Q}}:{facingMode:"environment"}});if(!t)return void i.getTracks().forEach(e=>e.stop());e&&(e.srcObject=i,await e.play());let n=(await navigator.mediaDevices.enumerateDevices()).filter(e=>"videoinput"===e.kind);if(T(n),!Q&&n.length)V(n[0].deviceId);else if(Q&&!n.some(e=>e.deviceId===Q)){var l,s;V(null!=(s=null==(l=n[0])?void 0:l.deviceId)?s:"")}if("BarcodeDetector"in window){let e=new window.BarcodeDetector({formats:["qr_code"]}),a=async()=>{if(t){try{if(H.current){let t=await e.detect(H.current);if(t[0]){let e=t[0].rawValue;A(e),P(t=>[...t,e])}}}catch(e){}r=requestAnimationFrame(a)}};a()}else{let l=(await a.e(8067).then(a.t.bind(a,21746,23))).default,s=async()=>{if(t){try{if(e&&e.readyState===e.HAVE_ENOUGH_DATA){let t=document.createElement("canvas");t.width=e.videoWidth,t.height=e.videoHeight;let a=t.getContext("2d");if(a){a.drawImage(e,0,0,t.width,t.height);let r=a.getImageData(0,0,t.width,t.height),s=l(r.data,t.width,t.height);s&&(A(s.data),P(e=>[...e,s.data]))}}}catch(e){}r=requestAnimationFrame(s)}};s()}}catch(e){e instanceof DOMException&&"NotAllowedError"===e.name?G("Camera access was denied"):G("Could not start camera")}})(),()=>{t=!1,r&&cancelAnimationFrame(r),e&&e.srcObject&&(e.srcObject.getTracks().forEach(e=>e.stop()),e.srcObject=null)}},[Q]),(0,i.useEffect)(()=>{(0,d.saveScans)(_)},[_]);let M=async()=>{P([]),await (0,d.clearScans)()};return(0,r.jsxs)("div",{className:"flex min-h-screen flex-col items-center justify-center gap-8 p-4",children:[(0,r.jsxs)("div",{className:"w-full max-w-md",children:[(0,r.jsx)(c,{tabs:u,active:e,onChange:t,className:"mb-4 justify-center"}),"text"===e&&(0,r.jsxs)("form",{onSubmit:J,className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm",htmlFor:"qr-text",children:"Text"}),(0,r.jsx)("input",{id:"qr-text",type:"text",value:l,onChange:e=>m(e.target.value),"aria-label":"QR text",className:"w-full rounded border p-2"}),(0,r.jsx)("button",{type:"submit",className:"w-full rounded bg-blue-600 p-2 text-white",children:"Generate"})]}),"url"===e&&(0,r.jsxs)("form",{onSubmit:J,className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm",htmlFor:"qr-url",children:"URL"}),(0,r.jsx)("input",{id:"qr-url",type:"url",value:h,onChange:e=>x(e.target.value),"aria-label":"QR URL",className:"w-full rounded border p-2"}),(0,r.jsx)("button",{type:"submit",className:"w-full rounded bg-blue-600 p-2 text-white",children:"Generate"})]}),"wifi"===e&&(0,r.jsxs)("form",{onSubmit:J,className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-sm",htmlFor:"qr-ssid",children:["SSID",(0,r.jsx)("input",{id:"qr-ssid",type:"text",value:b,onChange:e=>g(e.target.value),"aria-label":"Wi-Fi SSID",className:"mt-1 w-full rounded border p-2"})]}),(0,r.jsxs)("label",{className:"block text-sm",htmlFor:"qr-wifi-password",children:["Password",(0,r.jsx)("input",{id:"qr-wifi-password",type:"text",value:p,onChange:e=>w(e.target.value),"aria-label":"Wi-Fi password",className:"mt-1 w-full rounded border p-2"})]}),(0,r.jsxs)("label",{className:"block text-sm",htmlFor:"qr-wifi-type",children:["Encryption",(0,r.jsxs)("select",{id:"qr-wifi-type",value:f,onChange:e=>v(e.target.value),"aria-label":"Wi-Fi encryption",className:"mt-1 w-full rounded border p-2",children:[(0,r.jsx)("option",{value:"WPA",children:"WPA/WPA2"}),(0,r.jsx)("option",{value:"WEP",children:"WEP"}),(0,r.jsx)("option",{value:"nopass",children:"None"})]})]}),(0,r.jsx)("button",{type:"submit",className:"w-full rounded bg-blue-600 p-2 text-white",children:"Generate"})]}),"vcard"===e&&(0,r.jsxs)("form",{onSubmit:J,className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-sm",htmlFor:"qr-vcard-name",children:["Full Name",(0,r.jsx)("input",{id:"qr-vcard-name",type:"text",value:j,onChange:e=>N(e.target.value),"aria-label":"vCard full name",className:"mt-1 w-full rounded border p-2"})]}),(0,r.jsxs)("label",{className:"block text-sm",htmlFor:"qr-vcard-org",children:["Organization",(0,r.jsx)("input",{id:"qr-vcard-org",type:"text",value:y,onChange:e=>S(e.target.value),"aria-label":"vCard organization",className:"mt-1 w-full rounded border p-2"})]}),(0,r.jsxs)("label",{className:"block text-sm",htmlFor:"qr-vcard-phone",children:["Phone",(0,r.jsx)("input",{id:"qr-vcard-phone",type:"tel",value:C,onChange:e=>q(e.target.value),"aria-label":"vCard phone number",className:"mt-1 w-full rounded border p-2"})]}),(0,r.jsxs)("label",{className:"block text-sm",htmlFor:"qr-vcard-email",children:["Email",(0,r.jsx)("input",{id:"qr-vcard-email",type:"email",value:E,onChange:e=>k(e.target.value),"aria-label":"vCard email address",className:"mt-1 w-full rounded border p-2"})]}),(0,r.jsx)("button",{type:"submit",className:"w-full rounded bg-blue-600 p-2 text-white",children:"Generate"})]}),U&&(0,r.jsx)(o.default,{className:"mt-2",children:U}),(0,r.jsxs)("div",{className:"mt-4 flex flex-col items-center gap-2",children:[D?(0,r.jsx)(s(),{src:D,alt:"Generated QR code",width:192,height:192,sizes:"192px",className:"h-48 w-48"}):(0,r.jsx)("div",{className:"flex h-48 w-48 items-center justify-center rounded border border-dashed text-xs text-gray-500",children:"Generate a QR code to preview it here."}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>{if(!D)return;let e=document.createElement("a");e.href=D,e.download="".concat(L,".png"),e.click()},className:"rounded bg-blue-600 p-2 text-white disabled:cursor-not-allowed disabled:bg-blue-600/50",disabled:!D,children:"Download QR image"}),(0,r.jsx)("button",{onClick:()=>{if(!I)return;let e=new Blob([I],{type:"image/svg+xml"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="".concat(L,".svg"),a.click(),URL.revokeObjectURL(t)},className:"rounded bg-green-600 p-2 text-white disabled:cursor-not-allowed disabled:bg-green-600/50",disabled:!I,children:"Download SVG"})]})]})]}),(0,r.jsxs)("div",{className:"w-full max-w-md",children:[(0,r.jsxs)("label",{className:"mb-2 block text-sm",htmlFor:"qr-camera",children:["Camera",(0,r.jsxs)("select",{id:"qr-camera",value:Q,onChange:e=>V(e.target.value),"aria-label":"Camera selector",className:"mt-1 w-full rounded border p-2",children:[0===W.length&&(0,r.jsx)("option",{value:"",children:"Default camera"}),W.map((e,t)=>(0,r.jsx)("option",{value:e.deviceId,children:e.label||"Camera ".concat(t+1)},e.deviceId))]})]}),(0,r.jsx)("video",{ref:H,className:"h-48 w-full rounded border","aria-label":"QR scanner preview"}),B&&(0,r.jsxs)("p",{className:"mt-2 text-center text-sm",children:["Decoded: ",B]}),_.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("ul",{className:"mt-2 max-h-40 overflow-y-auto rounded border p-2 text-sm",children:_.map((e,t)=>(0,r.jsx)("li",{children:e},t))}),(0,r.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>{if(!_.length)return;let e=new Blob(["data\n"+_.map(e=>'"'.concat(e.replace(/"/g,'""'),'"')).join("\n")],{type:"text/csv"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="qr-scans.csv",a.click(),URL.revokeObjectURL(t)},className:"flex-1 rounded bg-green-600 p-2 text-white",children:"Export CSV"}),(0,r.jsx)("button",{onClick:M,className:"flex-1 rounded bg-red-600 p-2 text-white",children:"Clear"})]})]})]})]})}},75758:(e,t,a)=>{"use strict";a.d(t,{default:()=>l});var r=a(37876);a(14232);let l=e=>{let{id:t,className:a="",role:l="status",ariaLive:s,children:i}=e;return(0,r.jsx)("p",{id:t,role:l,"aria-live":null!=s?s:"alert"===l?"assertive":"polite",className:"text-red-600 text-sm mt-2 ".concat(a).trim(),children:i})}}},e=>{e.O(0,[4587,3617,636,6593,8792],()=>e(e.s=28529)),_N_E=e.O()}]);