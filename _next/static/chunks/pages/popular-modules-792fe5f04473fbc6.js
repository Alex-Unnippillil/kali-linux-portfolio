(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9603],{32644:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/popular-modules",function(){return t(41208)}])},41208:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var a=t(37876),r=t(14232);let o=JSON.parse('[{"id":"port-scan","name":"Port Scanner","description":"Scans for open network ports","tags":["network","scanner"],"log":[{"level":"info","message":"Starting port scan..."},{"level":"success","message":"Found open port 22 on 192.168.0.1"},{"level":"info","message":"Scan complete."}],"results":[{"target":"192.168.0.1","status":"Ports 22,80 open"},{"target":"192.168.0.2","status":"No open ports"}],"data":"Open ports discovered on the target host","inputs":["Target IP or range"],"lab":"https://tryhackme.com/room/rpnmap","options":[{"name":"target","label":"Target"},{"name":"ports","label":"Ports"}]},{"id":"bruteforce","name":"Brute Force","description":"Attempts common passwords","tags":["attack","password"],"log":[{"level":"info","message":"Starting brute force..."},{"level":"warning","message":"Tried 100 passwords"},{"level":"error","message":"No valid credentials found."}],"results":[{"target":"admin@example.com","status":"Login failed"},{"target":"root@example.com","status":"Login failed"}],"data":"Accounts that accept guessed credentials","inputs":["Target service or account","Password list"],"lab":"https://tryhackme.com/room/hydra","options":[{"name":"user","label":"User"},{"name":"wordlist","label":"Wordlist"}]},{"id":"vuln-check","name":"Vuln Check","description":"Checks for known CVEs","tags":["vulnerability","scanner"],"log":[{"level":"info","message":"Checking for vulnerabilities..."},{"level":"success","message":"CVE-2024-1234 found on host1"},{"level":"info","message":"Check complete."}],"results":[{"target":"host1","status":"CVE-2024-1234"},{"target":"host2","status":"No issues"}],"data":"Known vulnerabilities present on a host","inputs":["Target host"],"lab":"https://tryhackme.com/room/vulnversity","options":[{"name":"target","label":"Target"}]}]'),l={version:"1.0.0"},n=()=>{let[e,s]=(0,r.useState)(o),[t,n]=(0,r.useState)(l.version),[i,c]=(0,r.useState)(""),[d,u]=(0,r.useState)(!1),[p,m]=(0,r.useState)(""),[x,h]=(0,r.useState)(""),[g,f]=(0,r.useState)(null),[b,j]=(0,r.useState)({}),[v,w]=(0,r.useState)(""),k=Array.from(new Set(e.flatMap(e=>e.tags))),y=p?e.filter(e=>e.tags.includes(p)):e;y=x?y.filter(e=>e.name.toLowerCase().includes(x.toLowerCase())||e.description.toLowerCase().includes(x.toLowerCase())):y;let N=g?"".concat(g.id).concat(Object.entries(b).filter(e=>{let[,s]=e;return s}).map(e=>{let[s,t]=e;return" --".concat(s," ").concat(t)}).join("")):"",C=g?g.log.filter(e=>e.message.toLowerCase().includes(v.toLowerCase())):[];(0,r.useEffect)(()=>{let e=!1;return(async()=>{try{let s=await fetch("/api/modules/update?version=".concat(t)),a=await s.json();e||u(!!a.needsUpdate)}catch(s){e||u(!1)}})(),()=>{e=!0}},[t]);let L=async()=>{try{let e=await fetch("/api/modules/update?version=".concat(t));if(!e.ok)throw Error("Failed to check for updates");let a=await e.json();if(a.needsUpdate){let e=await fetch("/api/modules/index");if(!e.ok)throw Error("Failed to load modules");let t=await e.json();s(t),n(a.latest),c("Updated to v".concat(a.latest))}else c("Already up to date");u(!1)}catch(e){c("Update failed"),u(!1)}},S={info:"text-blue-300",success:"text-green-400",error:"text-red-400",warning:"text-yellow-300"},_={info:(0,a.jsx)("svg",{className:"w-6 h-6 text-blue-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z"})}),success:(0,a.jsxs)("svg",{className:"w-6 h-6 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"})]}),warning:(0,a.jsx)("svg",{className:"w-6 h-6 text-yellow-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M4.93 19h14.14c1.2 0 1.94-1.3 1.34-2.33L13.34 4.67c-.6-1.04-2.08-1.04-2.68 0L3.59 16.67c-.6 1.03-.15 2.33 1.34 2.33z"})}),error:(0,a.jsxs)("svg",{className:"w-6 h-6 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 2a10 10 0 100 20 10 10 0 000-20z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 9l-6 6m0-6l6 6"})]})};return(0,a.jsxs)("div",{className:"p-4 space-y-4 bg-ub-cool-grey text-white min-h-screen",children:[(0,a.jsx)("p",{className:"text-sm",children:"All modules are simulated; no network activity occurs. This interface is non-operational."}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:L,className:"px-2 py-1 text-sm rounded bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-400",children:"Update Modules"}),(0,a.jsxs)("span",{className:"text-xs",children:["v",t]}),d&&(0,a.jsx)("span",{className:"text-xs text-yellow-300",children:"Update available"})]}),i&&(0,a.jsx)("p",{className:"text-sm",children:i}),(0,a.jsx)("input",{type:"text",placeholder:"Search modules",value:x,onChange:e=>h(e.target.value),className:"w-full p-2 text-black rounded","aria-label":"Search modules"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)("button",{onClick:()=>m(""),className:"px-2 py-1 text-sm rounded focus:outline-none focus:ring-2 focus:ring-blue-400 ".concat(""===p?"bg-blue-600":"bg-gray-700"),children:"All"}),k.map(e=>(0,a.jsx)("button",{onClick:()=>m(e),className:"px-2 py-1 text-sm rounded focus:outline-none focus:ring-2 focus:ring-blue-400 ".concat(p===e?"bg-blue-600":"bg-gray-700"),children:e},e))]}),(0,a.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:y.map(e=>(0,a.jsxs)("button",{onClick:()=>(e=>{f(e),j(Object.fromEntries(e.options.map(e=>[e.name,""]))),w("")})(e),className:"p-3 text-left bg-ub-grey rounded border border-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-400",children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-300",children:e.description}),(0,a.jsx)("div",{className:"mt-2 flex flex-wrap gap-1",children:e.tags.map(e=>(0,a.jsx)("span",{className:"px-2 py-0.5 text-xs rounded bg-gray-700",children:e},e))})]},e.id))}),g?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("form",{className:"space-y-2",children:g.options.map(e=>(0,a.jsxs)("label",{className:"block text-sm",children:[e.label,(0,a.jsx)("input",{"aria-label":e.label,type:"text",value:b[e.name],onChange:s=>j({...b,[e.name]:s.target.value}),className:"w-full p-1 mt-1 text-black rounded"})]},e.name))}),(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("pre",{"data-testid":"command-preview",className:"flex-1 bg-black text-green-400 p-2 overflow-auto font-mono",children:N}),(0,a.jsx)("button",{type:"button",onClick:()=>{"undefined"!=typeof navigator&&navigator.clipboard&&navigator.clipboard.writeText(N)},className:"px-2 py-1 text-sm rounded bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-400",children:"Copy"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("label",{className:"block text-sm",children:["Filter logs",(0,a.jsx)("input",{placeholder:"Filter logs",type:"text",value:v,onChange:e=>w(e.target.value),className:"w-full p-1 mt-1 text-black rounded","aria-label":"Filter logs"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>{let e=C.map(e=>e.message).join("\n");"undefined"!=typeof navigator&&navigator.clipboard&&navigator.clipboard.writeText(e)},className:"px-2 py-1 text-sm rounded bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-400",children:"Copy Logs"}),(0,a.jsx)("ol",{className:"border-l-2 border-gray-700 pl-4 space-y-2",role:"log",children:C.map((e,s)=>(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[_[e.level]||_.info,(0,a.jsx)("span",{className:"px-2 py-1 rounded-full bg-gray-700 text-sm font-mono ".concat(S[e.level]||S.info),children:e.message})]},s))})]}),(0,a.jsxs)("table",{className:"min-w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"border px-2 py-1",children:"Target"}),(0,a.jsx)("th",{className:"border px-2 py-1",children:"Result"})]})}),(0,a.jsx)("tbody",{children:g.results.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"border px-2 py-1",children:e.target}),(0,a.jsx)("td",{className:"border px-2 py-1",children:e.status})]},e.target))})]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("h4",{className:"font-semibold mt-2",children:"Data Retrieved"}),(0,a.jsx)("p",{children:g.data}),(0,a.jsx)("h4",{className:"font-semibold mt-2",children:"Required Inputs"}),(0,a.jsx)("ul",{className:"list-disc list-inside",children:g.inputs.map(e=>(0,a.jsx)("li",{children:e},e))}),(0,a.jsx)("a",{href:g.lab,target:"_blank",rel:"noopener noreferrer",className:"underline text-blue-300",children:"Practice Lab"})]})]}):(0,a.jsx)("p",{children:"Select a module to view logs and results."})]})},i=()=>(0,a.jsx)(n,{})}},e=>{e.O(0,[636,6593,8792],()=>e(e.s=32644)),_N_E=e.O()}]);