(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3332,8644],{4454:(e,t,i)=>{"use strict";i.d(t,{useTheme:()=>r});var n=i(14232),s=i(43239);let r=()=>{let[e,t]=(0,n.useState)(()=>(0,s.getTheme)());return(0,n.useEffect)(()=>{let e=e=>{if(e.key===s.THEME_KEY){let e=(0,s.getTheme)();t(e),(0,s.setTheme)(e)}};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),{theme:e,setTheme:e=>{t(e),(0,s.setTheme)(e)}}}},16760:(e,t,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return i(45354)}])},37603:(e,t,i)=>{"use strict";var n=i(99742);i(72552);var s=i(14232),r=function(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}(s),o=void 0!==n&&n.env&&!0,a=function(e){return"[object String]"===Object.prototype.toString.call(e)},l=function(){function e(e){var t=void 0===e?{}:e,i=t.name,n=void 0===i?"stylesheet":i,s=t.optimizeForSpeed,r=void 0===s?o:s;d(a(n),"`name` must be a string"),this._name=n,this._deletedRulePlaceholder="#"+n+"-deleted-rule____{}",d("boolean"==typeof r,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=r,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var l=document.querySelector('meta[property="csp-nonce"]');this._nonce=l?l.getAttribute("content"):null}var t,i=e.prototype;return i.setOptimizeForSpeed=function(e){d("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),d(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},i.isOptimizeForSpeed=function(){return this._optimizeForSpeed},i.inject=function(){var e=this;if(d(!this._injected,"sheet already injected"),this._injected=!0,this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(o||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,i){return"number"==typeof i?e._serverSheet.cssRules[i]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),i},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},i.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},i.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},i.insertRule=function(e,t){if(d(a(e),"`insertRule` accepts only strings"),this._optimizeForSpeed){var i=this.getSheet();"number"!=typeof t&&(t=i.cssRules.length);try{i.insertRule(e,t)}catch(t){return o||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var n=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,n))}return this._rulesCount++},i.replaceRule=function(e,t){if(this._optimizeForSpeed){var i=this.getSheet();if(t.trim()||(t=this._deletedRulePlaceholder),!i.cssRules[e])return e;i.deleteRule(e);try{i.insertRule(t,e)}catch(n){o||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),i.insertRule(this._deletedRulePlaceholder,e)}}else{var n=this._tags[e];d(n,"old rule at index `"+e+"` not found"),n.textContent=t}return e},i.deleteRule=function(e){if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];d(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},i.flush=function(){this._injected=!1,this._rulesCount=0,this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]},i.cssRules=function(){var e=this;return this._tags.reduce(function(t,i){return i?t=t.concat(Array.prototype.map.call(e.getSheetForTag(i).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},i.makeStyleTag=function(e,t,i){t&&d(a(t),"makeStyleTag accepts only strings as second parameter");var n=document.createElement("style");this._nonce&&n.setAttribute("nonce",this._nonce),n.type="text/css",n.setAttribute("data-"+e,""),t&&n.appendChild(document.createTextNode(t));var s=document.head||document.getElementsByTagName("head")[0];return i?s.insertBefore(n,i):s.appendChild(n),n},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}();function d(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var c=function(e){for(var t=5381,i=e.length;i;)t=33*t^e.charCodeAt(--i);return t>>>0},u={};function h(e,t){if(!t)return"jsx-"+e;var i=String(t),n=e+i;return u[n]||(u[n]="jsx-"+c(e+"-"+i)),u[n]}function p(e,t){var i=e+t;return u[i]||(u[i]=t.replace(/__jsx-style-dynamic-selector/g,e)),u[i]}var m=function(){function e(e){var t=void 0===e?{}:e,i=t.styleSheet,n=void 0===i?null:i,s=t.optimizeForSpeed,r=void 0!==s&&s;this._sheet=n||new l({name:"styled-jsx",optimizeForSpeed:r}),this._sheet.inject(),n&&"boolean"==typeof r&&(this._sheet.setOptimizeForSpeed(r),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var i=this.getIdAndRules(e),n=i.styleId,s=i.rules;if(n in this._instancesCounts){this._instancesCounts[n]+=1;return}var r=s.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[n]=r,this._instancesCounts[n]=1},t.remove=function(e){var t=this,i=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(i in this._instancesCounts,"styleId: `"+i+"` not found"),this._instancesCounts[i]-=1,this._instancesCounts[i]<1){var n=this._fromServer&&this._fromServer[i];n?(n.parentNode.removeChild(n),delete this._fromServer[i]):(this._indices[i].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[i]),delete this._instancesCounts[i]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],i=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return i[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,i;return t=this.cssRules(),void 0===(i=e)&&(i={}),t.map(function(e){var t=e[0],n=e[1];return r.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:i.nonce?i.nonce:void 0,dangerouslySetInnerHTML:{__html:n}})})},t.getIdAndRules=function(e){var t=e.children,i=e.dynamic,n=e.id;if(i){var s=h(n,i);return{styleId:s,rules:Array.isArray(t)?t.map(function(e){return p(s,e)}):[p(s,t)]}}return{styleId:h(n),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),f=s.createContext(null);f.displayName="StyleSheetContext";var g=r.default.useInsertionEffect||r.default.useLayoutEffect,w=new m;function v(e){var t=w||s.useContext(f);return t&&g(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)]),null}v.dynamic=function(e){return e.map(function(e){return h(e[0],e[1])}).join(" ")},t.style=v},45354:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>tW});var n=i(37876),s=i(65006),r=i(99742);function o(){return"1"!==r.env.NEXT_PUBLIC_SHOW_BETA?null:(0,n.jsx)("button",{type:"button",className:"fixed bottom-4 right-4 rounded bg-yellow-500/90 px-2 py-1 text-xs font-semibold text-black",children:"Beta"})}var a=i(14232),l=i(54587),d=i.n(l),c=i(74273);let u=["Securing environment","Loading offensive simulations","Calibrating desktop widgets"],h=function(e){let{reducedMotion:t}=(0,c.useSettings)(),[i,s]=(0,a.useState)("boolean"==typeof t&&t),r=e.visible||e.isShutDown,o=r?"visible opacity-100":"invisible opacity-0",[l,h]=(0,a.useState)(0),p=e.visible&&!e.isShutDown;return(0,a.useEffect)(()=>{if("boolean"==typeof t)return void s(t);let e=window.matchMedia("(prefers-reduced-motion: reduce)"),i=()=>s(e.matches);return i(),e.addEventListener("change",i),()=>e.removeEventListener("change",i)},[t]),(0,a.useEffect)(()=>{let t=null;return p?e.disableMessageSequence?h(0):(h(0),t=window.setInterval(()=>{h(e=>e>=u.length-1?(window.clearInterval(t),e):e+1)},360)):h(0),()=>{null!==t&&window.clearInterval(t)}},[p,e.disableMessageSequence]),(0,n.jsx)("div",{role:"status","aria-live":"polite","aria-busy":p,style:{...r?{zIndex:"2147483647"}:{zIndex:"-20"},contentVisibility:"auto"},className:"".concat(o," absolute inset-0 select-none overflow-hidden ").concat(i?"transition-opacity duration-200":"transition-opacity duration-700"),children:(0,n.jsxs)("div",{className:"".concat(o," relative flex h-full w-full flex-col items-center justify-center gap-12 bg-[#030712] text-slate-100"),children:[(0,n.jsxs)("div",{className:"pointer-events-none absolute inset-0",children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-slate-900 via-[#030712] to-black"}),(0,n.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(56,189,248,0.22),_transparent_58%)]"}),(0,n.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_bottom,_rgba(15,118,110,0.18),_transparent_60%)]"})]}),(0,n.jsxs)("div",{className:"relative flex flex-col items-center gap-6 px-6 text-center",children:[(0,n.jsx)("span",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Initializing workspace"}),(0,n.jsxs)("div",{className:"".concat(o," relative"),children:[(0,n.jsx)("div",{className:"absolute -inset-6 rounded-full bg-sky-500/20 blur-3xl","aria-hidden":!0}),(0,n.jsx)(d(),{width:360,height:360,className:"w-48 md:w-64",src:"/themes/Yaru/status/icons8-kali-linux.svg",alt:"Kali Linux logo",sizes:"(max-width: 768px) 12rem, 16rem",priority:!0})]}),(0,n.jsx)("span",{className:"text-4xl font-semibold tracking-[0.35em] text-sky-200 md:text-5xl",children:"KALI"})]}),(0,n.jsxs)("div",{className:"relative flex flex-col items-center gap-6 px-6",children:[(0,n.jsx)("button",{type:"button",onClick:e.turnOn,disabled:!e.isShutDown,"aria-disabled":!e.isShutDown,className:"group relative flex h-20 w-20 items-center justify-center rounded-full border border-slate-700/40 ".concat(i?"transition-colors duration-150":"transition duration-300"," focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-400/70 ").concat(e.isShutDown?"cursor-pointer hover:border-sky-400/60 ".concat(i?"":"hover:scale-105"):"cursor-default opacity-80"),"aria-label":e.isShutDown?"Start Kali desktop":"Booting Kali desktop",children:e.isShutDown?(0,n.jsx)("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-slate-100 text-slate-900 transition group-hover:bg-white",children:(0,n.jsx)(d(),{width:32,height:32,src:"/themes/Yaru/status/power-button.svg",alt:"Power button",sizes:"32px",priority:!0})}):(0,n.jsxs)("div",{className:"relative flex h-14 w-14 items-center justify-center",children:[(0,n.jsx)("div",{className:"absolute inset-0 rounded-full border border-slate-700/40"}),(0,n.jsx)("div",{className:"absolute inset-0 rounded-full border-4 border-sky-400/80 border-t-transparent border-l-transparent ".concat(i?"":"animate-[spin_2.6s_linear_infinite]")}),(0,n.jsx)("div",{className:"absolute inset-[30%] rounded-full bg-slate-900"})]})}),(0,n.jsx)("ul",{className:"flex flex-col gap-2 text-sm text-slate-300",children:u.map((e,t)=>{let s=p&&t===l,r=p&&t<l,o=i?"transition-none duration-0":"transition-all duration-500";return(0,n.jsxs)("li",{"data-state":s?"active":r?"complete":"upcoming",className:"flex items-center gap-3 ".concat(o," ").concat(s?"translate-x-0 text-sky-100 drop-shadow-[0_0_16px_rgba(56,189,248,0.55)]":r?"translate-x-0 text-slate-400 opacity-80":"translate-x-2 text-slate-500 opacity-60"),children:[(0,n.jsx)("span",{className:"inline-flex h-2 w-2 rounded-full ".concat(o," ").concat(s?"bg-sky-400/80 shadow-[0_0_12px_rgba(56,189,248,0.7)]":r?"bg-emerald-400/70 shadow-[0_0_6px_rgba(16,185,129,0.6)]":"bg-slate-600/60"," ").concat(!i&&s?"animate-[pulse_2s_ease-in-out_infinite]":""),"aria-hidden":!0}),(0,n.jsx)("span",{className:"".concat(i?"transition-none duration-0":"transition-opacity duration-500"," ").concat(s?"opacity-100":"opacity-80"),children:e})]},e)})})]}),(0,n.jsxs)("div",{className:"relative mb-6 flex gap-4 text-xs uppercase tracking-[0.4em] text-slate-500",children:[(0,n.jsx)("a",{className:"transition hover:text-slate-200",href:"https://www.linkedin.com/in/unnippillil/",rel:"noopener noreferrer",target:"_blank",children:"LinkedIn"}),(0,n.jsx)("span",{className:"text-slate-600",children:"•"}),(0,n.jsx)("a",{className:"transition hover:text-slate-200",href:"https://github.com/Alex-Unnippillil",rel:"noopener noreferrer",target:"_blank",children:"GitHub"})]})]})})};var p=i(18847),m=i.n(p),f=i(90058),g=i(19866),w=i(70236),v=i(33618);let x=()=>{},b=a.createContext({baseZIndex:200,registerWindow:x,unregisterWindow:x,focusWindow:x,getZIndex:()=>200}),y=(e,t)=>{switch(t.type){case"REGISTER":{let i=t.id;if(!i||e.registry[i])return e;let n=e.next+1;return{next:n,registry:{...e.registry,[i]:n}}}case"FOCUS":{let i=t.id;if(!i)return e;let n=e.registry[i];if(n&&n===e.next)return e;let s=e.next+1;return{next:s,registry:{...e.registry,[i]:s}}}case"UNREGISTER":{let i=t.id;if(!i||!e.registry[i])return e;let{[i]:n,...s}=e.registry;return{next:e.next,registry:s}}default:return e}},k={next:200,registry:{}},S=e=>{let{children:t}=e,[i,s]=a.useReducer(y,k),r=a.useCallback(e=>{s({type:"REGISTER",id:e})},[]),o=a.useCallback(e=>{s({type:"UNREGISTER",id:e})},[]),l=a.useCallback(e=>{s({type:"FOCUS",id:e})},[]),d=a.useCallback(e=>{var t;return e&&null!=(t=i.registry[e])?t:200},[i.registry]),c=a.useMemo(()=>({baseZIndex:200,registerWindow:r,unregisterWindow:o,focusWindow:l,getZIndex:d}),[r,o,l,d]);return(0,n.jsx)(b.Provider,{value:c,children:t})},j=e=>{if("string"!=typeof e)return null;let t=parseFloat(e);return Number.isFinite(t)?t:null},A=a.memo(a.forwardRef((e,t)=>{let{id:i,focus:s,isFocused:r,zIndex:o,onPositionChange:l,onSizeChange:d,...c}=e,u=(0,a.useRef)(null),{baseZIndex:h,registerWindow:p,unregisterWindow:m,focusWindow:f,getZIndex:g}=a.useContext(b),x=null!=i?i:null,y=(0,a.useCallback)(e=>{u.current=e,t&&("function"==typeof t?t(e):t.current=e)},[t]),k=(0,a.useCallback)((e,t)=>{"function"==typeof d&&d(i,e,t)},[i,d]),S=(0,a.useCallback)(()=>{var t,n,s,r;let o=u.current,a=o&&"function"==typeof o.getWindowNode?o.getWindowNode():null;if(!a||"function"!=typeof a.getBoundingClientRect)return;let d=a.getBoundingClientRect(),c=(0,v.measureWindowTopOffset)(),h=window.visualViewport,p=null!=(t=null==h?void 0:h.width)?t:window.innerWidth,m=null!=(n=null==h?void 0:h.height)?n:window.innerHeight,f=null!=(s=null==h?void 0:h.offsetLeft)?s:0,g=null!=(r=null==h?void 0:h.offsetTop)?r:0,w=(e=>{let t=e.style;if(!t)return null;if("function"==typeof t.getPropertyValue){let e=j(t.getPropertyValue("--window-transform-x")),i=j(t.getPropertyValue("--window-transform-y"));if(null!==e&&null!==i)return{x:e,y:i}}let i=t.transform;if("string"==typeof i&&i.length){let e=/translate\(([-\d.]+)px,\s*([-\d.]+)px\)/.exec(i);if(e){let t=parseFloat(e[1]),i=parseFloat(e[2]);if(Number.isFinite(t)&&Number.isFinite(i))return{x:t,y:i}}}return null})(a),x={x:"number"==typeof e.initialX?e.initialX+f:f,y:(0,v.clampWindowTopPosition)(e.initialY,g+c)},b=w||x,y=(0,v.clampWindowPositionWithinViewport)(b,d,{viewportWidth:p,viewportHeight:m,viewportLeft:f,viewportTop:g,topOffset:c});y&&(y.x!==b.x||y.y!==b.y)&&(a.style.transform="translate(".concat(y.x,"px, ").concat(y.y,"px)"),"function"==typeof a.style.setProperty?(a.style.setProperty("--window-transform-x","".concat(y.x,"px")),a.style.setProperty("--window-transform-y","".concat(y.y,"px"))):(a.style["--window-transform-x"]="".concat(y.x,"px"),a.style["--window-transform-y"]="".concat(y.y,"px")),"function"==typeof l&&l(i,y.x,y.y))},[e.initialX,e.initialY,l,i]);(0,a.useEffect)(()=>{if(x)return p(x),()=>{m(x)}},[x,p,m]),(0,a.useEffect)(()=>{x&&r&&f(x)},[x,r,f]);let A=(0,a.useCallback)(e=>{let t=null!=e?e:x;t?(f(t),"function"==typeof s&&s(t)):"function"==typeof s&&s(null!=e?e:void 0)},[s,f,x]),I=x?g(x):h;return(0,a.useEffect)(()=>{let e=null,t=()=>{e=null,S()},i=()=>{e||(e=window.requestAnimationFrame(t))};return window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i),e&&window.cancelAnimationFrame(e)}},[S]),(0,n.jsx)(w.default,{ref:y,...c,id:i,focus:A,isFocused:r,zIndex:I,onSizeChange:k})}));A.displayName="DesktopWindow";class I extends a.Component{render(){let{draggable:e=!0,isBeingDragged:t=!1,onPointerDown:i,onPointerMove:s,onPointerCancel:r,style:o,onKeyDown:a,onBlur:l,onFocus:c,assistiveHint:u,assistiveHintId:h,isSelected:p=!1,isHovered:m=!1,accentVariables:f={},launchOnClick:g=!1}=this.props,w=this.state.dragging||t,v=u?h||"app-".concat(this.props.id,"-instructions"):void 0,x=e=>{"function"==typeof this.props.onPointerUp&&this.props.onPointerUp(e),null!=e&&e.defaultPrevented||(null==e?void 0:e.pointerType)==="touch"&&this.handleActivate(e)},b={};p?(b.background="var(--desktop-icon-selection-bg, rgba(56, 189, 248, 0.18))",b.boxShadow="var(--desktop-icon-selection-glow, 0 0 0 1px rgba(56,189,248,0.7), 0 4px 16px rgba(15,118,110,0.45))",b.borderColor="var(--desktop-icon-selection-border, rgba(165, 243, 252, 0.9))",b.fontWeight=600):m&&(b.background="var(--desktop-icon-hover-bg, rgba(56, 189, 248, 0.12))",b.borderColor="var(--desktop-icon-hover-border, rgba(165, 243, 252, 0.35))");let y={...f,...o,width:"var(--desktop-icon-width, 6rem)",minWidth:"var(--desktop-icon-width, 6rem)",minHeight:"var(--desktop-icon-height, 5.5rem)",height:"auto",padding:"var(--desktop-icon-padding, 0.25rem)",fontSize:"var(--desktop-icon-font-size, 0.75rem)",gap:"var(--desktop-icon-gap, 0.375rem)",borderColor:"transparent",...b},k={textShadow:"0 1px 3px rgba(0,0,0,0.75)",lineHeight:"var(--desktop-icon-line-height, 1.1rem)",...o},S=this.props.tooltip||this.props.displayName||this.props.name;return(0,n.jsxs)("div",{role:"button","aria-label":this.props.name,"aria-disabled":this.props.disabled,"aria-pressed":p?"true":"false","data-context":"app","data-app-id":this.props.id,draggable:e,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onPointerDown:i,onPointerMove:s,onPointerUp:x,onPointerCancel:r,onClick:e=>{("function"!=typeof this.props.onClick||(this.props.onClick(e),!e.defaultPrevented))&&g&&this.handleActivate(e)},title:S,style:y,className:(this.state.launching?" app-icon-launch ":"")+(w?" opacity-70 ":"")+" m-px z-10 outline-none rounded select-none flex flex-col justify-start items-center text-center text-white transition-colors transition-shadow duration-150 ease-out border focus-visible:ring-2 focus-visible:ring-sky-300/70 ",id:"app-"+this.props.id,onDoubleClick:this.openApp,onKeyDown:e=>{"function"==typeof a&&(a(e),e.defaultPrevented)||("Enter"===e.key||" "===e.key)&&(e.preventDefault(),this.openApp())},onFocus:e=>{this.handlePrefetch(),"function"==typeof c&&c(e)},onBlur:l,tabIndex:this.props.disabled?-1:0,onMouseEnter:this.handlePrefetch,"aria-describedby":v,children:[(0,n.jsx)(d(),{width:48,height:48,className:"mb-1",style:{width:"var(--desktop-icon-image, 2.5rem)",height:"var(--desktop-icon-image, 2.5rem)",maxWidth:"var(--desktop-icon-image, 2.5rem)",maxHeight:"var(--desktop-icon-image, 2.5rem)"},src:this.props.icon.replace("./","/"),alt:"Kali "+this.props.name,sizes:"(max-width: 768px) 48px, 64px"}),(0,n.jsx)("span",{className:"leading-tight "+(p?"font-semibold":"font-normal"),style:k,children:this.props.displayName||this.props.name}),u?(0,n.jsx)("span",{id:v,className:"sr-only",children:u}):null]})}constructor(){super(),this.handleDragStart=e=>{this.setState({dragging:!0});let t=this.props.dragPayload;if(t&&(null==e?void 0:e.dataTransfer)){let i=t.section||"launcher";e.dataTransfer.effectAllowed=t.effectAllowed||"copy",e.dataTransfer.setData("application/x-taskbar-app-id",t.id),e.dataTransfer.setData("application/x-taskbar-section",i),e.dataTransfer.setData("text/plain",t.id)}"function"==typeof this.props.onDragStart&&this.props.onDragStart(e)},this.handleDragEnd=e=>{this.setState({dragging:!1}),"function"==typeof this.props.onDragEnd&&this.props.onDragEnd(e)},this.openApp=()=>{this.props.disabled||(this.setState({launching:!0},()=>{setTimeout(()=>this.setState({launching:!1}),300)}),"function"==typeof this.props.openApp&&this.props.openApp(this.props.id))},this.handlePrefetch=()=>{this.state.prefetched||"function"!=typeof this.props.prefetch||(this.props.prefetch(),this.setState({prefetched:!0}))},this.handleActivate=e=>{!this.props.disabled&&(this.state.dragging||this.props.isBeingDragged||(e&&"function"==typeof e.preventDefault&&e.preventDefault(),this.openApp()))},this.state={launching:!1,dragging:!1,prefetched:!1}}}var C=i(25180),P=i.n(C);let N=e=>{let{title:t,controls:i,onDoubleClick:s}=e;return(0,n.jsxs)("div",{className:"flex items-center justify-between bg-slate-900 px-3 py-2 text-sm font-semibold text-white",role:"banner",onDoubleClick:s,"data-window-titlebar":"","data-window-drag-handle":"",children:[(0,n.jsx)("span",{className:"truncate",title:t,children:t}),(0,n.jsx)("div",{className:"flex items-center gap-2",children:i})]})},_=w.WindowEditButtons||(e=>{let{minimize:t,maximize:i,close:s,allowMaximize:r=!0}=e;return(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{type:"button","aria-label":"Window minimize",onClick:t,children:"_"}),r&&(0,n.jsx)("button",{type:"button","aria-label":"Window maximize",onClick:i,children:"☐"}),(0,n.jsx)("button",{type:"button","aria-label":"Window close",onClick:s,children:"\xd7"})]})}),E={minimized:!1,maximized:!1};function M(e){let{id:t,title:i,open:s,minimized:r=E.minimized,maximized:o=E.maximized,onMinimize:a,onMaximize:l,onClose:d,allowMaximize:c=!0,overlayRef:u,contentRef:h,overlayClassName:p,frameClassName:m,bodyClassName:f,ariaLabel:g,ariaLabelledBy:w,ariaDescribedBy:v,ariaModal:x=!0,children:b}=e,y=s&&!r,k=["fixed inset-0 z-[60] flex items-center justify-center px-4 py-12 sm:py-16",p,y?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"].filter(Boolean).join(" "),S=["relative flex h-full max-h-full w-full flex-col overflow-hidden focus:outline-none",P().windowFrame,P().windowFrameActive,o?P().windowFrameMaximized:"",r?P().windowFrameMinimized:"",m].filter(Boolean).join(" "),j=["flex-1 overflow-auto",f].filter(Boolean).join(" "),A=()=>{"function"==typeof l&&l()},I=(0,n.jsx)(_,{minimize:()=>{"function"==typeof a&&a()},maximize:A,isMaximised:!!o,close:()=>{"function"==typeof d&&d()},id:t,allowMaximize:c});return(0,n.jsx)("div",{ref:u,className:k,"aria-hidden":!y,children:(0,n.jsxs)("div",{id:t,ref:h,className:S,role:"dialog","aria-modal":x,"aria-label":g,"aria-labelledby":w,"aria-describedby":v,tabIndex:-1,children:[(0,n.jsx)(N,{title:i,onDoubleClick:l?A:void 0,controls:I}),(0,n.jsx)("div",{className:j,children:b})]})})}var L=i(17311),z=i(27528),D=i(79746);let T="launcherFavorites",O="/themes/Yaru/system/folder.png",F={exactTitle:100,startsWith:80,word:60,tag:40,description:20},R=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[...e].sort((e,t)=>e.title.localeCompare(t.title))},W=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>=1536?6:e>=1280?5:e>=1024?4:e>=768?3:e>=640?2:1},B=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t.length)return e;let i=t.filter(Boolean).map(e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|");if(!i)return e;let s=RegExp("(".concat(i,")"),"gi");return e.split(s).map((e,t)=>e.match(s)?(0,n.jsx)("mark",{className:"rounded bg-sky-300/20 px-1 text-sky-200",children:e},"".concat(e,"-").concat(t)):e)},K=e=>{let{apps:t,columns:i,renderTile:s}=e,r=a.useMemo(()=>((e,t)=>{if(!e.length)return[];let i=[];for(let n=0;n<e.length;n+=t)i.push(e.slice(n,n+t));return i})(t,i),[t,i]),o=Math.min(176*r.length,560);return r.length?(0,n.jsx)(L.default,{data:r,height:o,itemHeight:176,itemKey:e=>e.map(e=>e.id).join("-"),children:e=>(0,n.jsx)("div",{className:"w-full",style:{display:"grid",gridTemplateColumns:"repeat(".concat(i,", minmax(0, 1fr))"),gap:"1rem"},children:e.map(e=>s(e))})}):null},U=(e,t)=>{if(z.safeLocalStorage)try{z.safeLocalStorage.setItem(e,JSON.stringify(t))}catch(e){}},q=(e,t,i)=>{let n=[],s=new Set;return(e.forEach(e=>{!t.has(e)||s.has(e)||(s.add(e),n.push(e))}),"number"==typeof i)?n.slice(0,i):n};class H extends a.Component{componentDidMount(){let{apps:e=[],games:t=[]}=this.props,i=[...e];t.forEach(e=>{i.some(t=>t.id===e.id)||i.push(e)});let n=R(i),s=new Set(n.map(e=>e.id)),r=q((e=>{if(!z.safeLocalStorage)return[];try{let t=JSON.parse(z.safeLocalStorage.getItem(e)||"[]");if(Array.isArray(t))return t.filter(e=>"string"==typeof e)}catch(e){}return[]})(T),s),o=q((0,D.readRecentAppIds)(),s,10);U(T,r),(0,D.writeRecentAppIds)(o),this.setState({apps:n,unfilteredApps:n,favorites:r,recents:o,columnCount:W(window.innerWidth)}),this.handleResize=()=>{this.setState({columnCount:W(window.innerWidth)})},window.addEventListener("resize",this.handleResize)}componentWillUnmount(){this.handleResize&&window.removeEventListener("resize",this.handleResize)}render(){let{apps:e,favorites:t,recents:i}=this.state,{searchInputRef:s,headingId:r="all-apps-title"}=this.props,o=new Map(e.map(e=>[e.id,e]));this.appIndexMap=new Map(e.map((e,t)=>[e.id,t]));let a=R(t.map(e=>o.get(e)).filter(Boolean)),l=i.map(e=>o.get(e)).filter(Boolean),d=Object.values(f.APP_CATEGORIES).map(e=>({...e,icon:e.icon||O,items:[]})),c=new Map(d.map(e=>[e.id,e])),u=new Set;e.forEach(e=>{let t=e.category?c.get(e.category):null;t&&(t.items.push(e),u.add(e.id))});let h=e.filter(e=>!u.has(e.id));h.length&&d.push({id:"other",title:"Additional Apps",description:"Tools that do not fit into the main folders.",icon:O,accent:"#94a3b8",match:()=>!1,items:R(h)});let p=d.map(e=>({...e,items:R(e.items||[])})).filter(e=>e.items.length>0),m=a.length>0||l.length>0||p.length>0,g=!!this.state.query;return(0,n.jsxs)("div",{className:"flex w-full flex-col items-center text-white",onKeyDown:this.handleKeyDown,children:[(0,n.jsx)("header",{className:"w-full px-4 sm:px-6 md:px-8",children:(0,n.jsxs)("div",{className:"mx-auto flex w-full max-w-5xl flex-col gap-6 rounded-3xl border bg-slate-900/70 p-6 backdrop-blur-xl",style:{borderColor:"color-mix(in srgb, var(--color-accent), transparent 55%)",boxShadow:"0 35px 80px -45px color-mix(in srgb, var(--color-accent), transparent 35%)",background:"linear-gradient(145deg, color-mix(in srgb, var(--color-accent), transparent 75%) 0%, rgba(15,23,42,0.85) 45%, rgba(15,23,42,0.7) 100%)"},children:[(0,n.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,n.jsx)("span",{className:"text-xs font-semibold uppercase tracking-[0.35em] text-white/60",children:"Launcher"}),(0,n.jsx)("h1",{id:r,className:"text-3xl font-semibold tracking-tight",style:{color:"var(--color-accent)"},children:"All applications"})]}),(0,n.jsxs)("div",{className:"w-full max-w-3xl",children:[(0,n.jsx)("label",{className:"sr-only",htmlFor:"".concat(r,"-search"),children:"Search applications"}),(0,n.jsx)("input",{id:"".concat(r,"-search"),ref:s,className:"w-full rounded-2xl border bg-slate-950/60 px-4 py-3 text-base shadow-lg transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--color-accent)]",style:{borderColor:"color-mix(in srgb, var(--color-accent), transparent 55%)",boxShadow:"0 0 0 1px color-mix(in srgb, var(--color-accent), transparent 75%) inset"},placeholder:"Search",value:this.state.query,onChange:this.handleChange,onKeyDown:this.handleKeyDown,"aria-label":"Search applications"})]})]})}),(0,n.jsxs)("div",{className:"mx-auto mt-10 flex w-full max-w-6xl flex-col items-stretch px-4 pb-12 sm:px-6 md:px-8 lg:px-10 xl:px-0",children:[this.renderSection("Pinned",a),this.renderSection("Suggested",l),p.length?(0,n.jsx)("div",{className:"mx-auto w-full space-y-6",children:p.map(e=>this.renderFolder(e,g))}):null,!m&&(0,n.jsx)("p",{className:"mt-6 text-center text-sm text-white/70",children:"No applications match your search."})]})]})}constructor(){var e;super(),e=this,this.handleChange=e=>{let t=e.target.value,{unfilteredApps:i}=this.state,n="string"==typeof t?t:"",{results:s,matches:r}=((e,t)=>{if(!t.trim())return{results:R(e),matches:{}};let i=t.trim().toLowerCase().split(/\s+/).filter(Boolean),n={};return{results:e.map(e=>{let s=((e,t,i)=>{let n=e.title.toLowerCase(),s=(e.description||"").toLowerCase(),r=(e.tags||[]).map(e=>e.toLowerCase()),o=(e.capabilities||[]).map(e=>e.toLowerCase()),a=n.split(/\s+/),l=new Set,d=0;return n===t?(d+=F.exactTitle,l.add(t)):n.startsWith(t)&&(d+=F.startsWith,l.add(t)),i.forEach(e=>{if(a.some(t=>t.startsWith(e))){d+=F.word,l.add(e);return}if(r.some(t=>t.includes(e))||o.some(t=>t.includes(e))){d+=F.tag,l.add(e);return}s.includes(e)&&(d+=F.description,l.add(e))}),{score:d,matchedTokens:[...l]}})(e,t.toLowerCase(),i);return s.score>0&&(n[e.id]=s),{app:e,score:s.score}}).filter(e=>{let{score:t}=e;return t>0}).sort((e,t)=>t.score!==e.score?t.score-e.score:e.app.title.localeCompare(t.app.title)).map(e=>{let{app:t}=e;return t}),matches:n}})(i,n);this.setState({query:n,apps:s,searchMatches:r,focusedIndex:null})},this.openApp=e=>{this.setState(t=>{let i=q((0,D.addRecentApp)(e),new Set(t.unfilteredApps.map(e=>e.id)),10);return(0,D.writeRecentAppIds)(i),{recents:i}},()=>{"function"==typeof this.props.openApp&&this.props.openApp(e)})},this.handleToggleFavorite=(e,t)=>{e.preventDefault(),e.stopPropagation(),this.setState(e=>{let i=e.favorites.includes(t)?e.favorites.filter(e=>e!==t):[...e.favorites,t];return U(T,i),{favorites:i}})},this.handleToggleFavoriteById=e=>{this.setState(t=>{let i=t.favorites.includes(e)?t.favorites.filter(t=>t!==e):[...t.favorites,e];return U(T,i),{favorites:i}})},this.handleKeyDown=e=>{var t;let{apps:i,focusedIndex:n,columnCount:s}=this.state;if(!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter"].includes(e.key)||(null==(t=e.target)?void 0:t.tagName)==="INPUT"&&["ArrowLeft","ArrowRight"].includes(e.key)||!i.length)return;if("Enter"===e.key&&null!==n){e.preventDefault();let t=i[n];return t?e.ctrlKey?void this.handleToggleFavoriteById(t.id):void this.openApp(t.id):void 0}if("ArrowDown"===e.key&&null===n){e.preventDefault(),this.focusAppIndex(0);return}if(null===n)return;let r=n,o=s||1;switch(e.key){case"ArrowUp":r=Math.max(0,n-o);break;case"ArrowDown":r=Math.min(i.length-1,n+o);break;case"ArrowLeft":r=Math.max(0,n-1);break;case"ArrowRight":r=Math.min(i.length-1,n+1)}r!==n&&(e.preventDefault(),this.focusAppIndex(r))},this.focusAppIndex=e=>{this.setState({focusedIndex:e},()=>{let t=this.state.apps[e];if(!t)return;let i=document.getElementById("app-".concat(t.id));i&&"function"==typeof i.focus&&i.focus()})},this.renderAppTile=(e,t)=>{var i;let s=this.state.favorites.includes(e.id),r=!1!==e.prefetchOnHover,o=this.state.searchMatches[e.id],a=o?o.matchedTokens:[],l=B(e.title,a);return(0,n.jsxs)("div",{className:"relative flex w-full items-center justify-center rounded-2xl border border-white/10 bg-slate-900/70 p-3 shadow-lg transition hover:border-sky-300/70 focus-within:ring-2 focus-within:ring-sky-300/70",onFocus:()=>{"number"==typeof t&&this.setState({focusedIndex:t})},children:[(0,n.jsx)("button",{type:"button","aria-pressed":s,"aria-label":s?"Remove ".concat(e.title," from favorites"):"Add ".concat(e.title," to favorites"),onClick:t=>this.handleToggleFavorite(t,e.id),className:"absolute right-3 top-3 text-lg transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 ".concat(s?"text-yellow-300":"text-white/60 hover:text-white"),children:"★"}),(0,n.jsx)(I,{name:e.title,id:e.id,icon:e.icon,openApp:()=>this.openApp(e.id),disabled:e.disabled,displayName:l,isSelected:this.state.focusedIndex===t,onFocus:()=>{"number"==typeof t&&this.setState({focusedIndex:t})},prefetch:r?null==(i=e.screen)?void 0:i.prefetch:void 0})]},e.id)},this.renderSection=(e,t)=>t.length?(0,n.jsx)("section",{"aria-label":"".concat(e," apps"),className:"w-full",children:(0,n.jsxs)("div",{className:"mb-8 rounded-3xl border bg-slate-900/65 p-5 shadow-xl backdrop-blur-xl",style:{borderColor:"color-mix(in srgb, var(--color-accent), transparent 65%)",boxShadow:"0 20px 52px -30px color-mix(in srgb, var(--color-accent), transparent 55%)"},children:[(0,n.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,n.jsx)("h2",{className:"text-base font-semibold uppercase tracking-[0.35em] text-white/80",children:e}),(0,n.jsxs)("span",{className:"text-xs font-semibold uppercase tracking-[0.35em] text-white/50",children:[t.length," ",1===t.length?"app":"apps"]})]}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(K,{apps:t,columns:this.state.columnCount,renderTile:e=>{var t;let i=null==(t=this.appIndexMap)?void 0:t.get(e.id);return this.renderAppTile(e,i)}})})]})},e):null,this.renderFolder=function(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t||!t.items||!t.items.length)return null;let s=t.accent||"#38bdf8",r="".concat(t.items.length," ").concat(1===t.items.length?"app":"apps");return(0,n.jsxs)("details",{className:"group/folder w-full rounded-3xl border bg-slate-900/65 p-4 text-white shadow-xl backdrop-blur-xl transition",open:i||t.defaultOpen,style:{borderColor:"color-mix(in srgb, ".concat(s,", transparent 68%)"),boxShadow:"0 22px 60px -30px color-mix(in srgb, ".concat(s,", transparent 60%)")},children:[(0,n.jsxs)("summary",{className:"flex cursor-pointer flex-col gap-4 rounded-2xl px-3 py-2 text-left transition hover:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 sm:flex-row sm:items-center sm:justify-between",style:{background:"linear-gradient(135deg, color-mix(in srgb, ".concat(s,", transparent 82%) 0%, rgba(15,23,42,0.92) 45%, rgba(15,23,42,0.75) 100%)"),listStyle:"none"},children:[(0,n.jsxs)("span",{className:"flex items-center gap-3",children:[(0,n.jsx)("span",{className:"flex h-12 w-12 items-center justify-center overflow-hidden rounded-2xl bg-slate-800/70 ring-1 ring-white/10",children:(0,n.jsx)("img",{src:t.icon,alt:"",className:"h-9 w-9 object-contain","aria-hidden":"true"})}),(0,n.jsxs)("span",{className:"flex flex-col",children:[(0,n.jsx)("span",{className:"text-lg font-semibold",children:t.title}),t.description?(0,n.jsx)("span",{className:"text-xs font-normal text-white/60",children:t.description}):null]})]}),(0,n.jsx)("span",{className:"text-xs font-semibold uppercase tracking-[0.35em]",style:{color:"color-mix(in srgb, ".concat(s,", white 25%)")},children:r})]}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(K,{apps:t.items,columns:e.state.columnCount,renderTile:t=>{var i;let n=null==(i=e.appIndexMap)?void 0:i.get(t.id);return e.renderAppTile(t,n)}})})]},t.id)},this.state={query:"",apps:[],unfilteredApps:[],favorites:[],recents:[],searchMatches:{},focusedIndex:null,columnCount:1}}}class V extends a.Component{componentDidMount(){let{apps:e=[],games:t=[]}=this.props,i=[...e];t.forEach(e=>{i.some(t=>t.id===e.id)||i.push(e)}),this.setState({apps:i,unfilteredApps:i})}render(){let{onRequestClose:e}=this.props;return(0,n.jsxs)("div",{className:"flex h-full flex-col gap-6 text-white",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,n.jsx)("label",{className:"sr-only",htmlFor:"shortcut-selector-search",children:"Search applications"}),(0,n.jsx)("input",{id:"shortcut-selector-search",className:"w-full rounded-2xl border border-white/10 bg-black/30 px-4 py-2 text-base shadow-inner focus:outline-none focus-visible:ring-2 focus-visible:ring-white/60",placeholder:"Search",value:this.state.query,onChange:this.handleChange,"aria-label":"Search applications"})]}),(0,n.jsx)("div",{className:"grid flex-1 grid-cols-3 gap-6 overflow-y-auto pb-6 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8",children:this.renderApps()}),(0,n.jsx)("div",{className:"flex justify-end",children:(0,n.jsx)("button",{type:"button",className:"rounded-full bg-white/10 px-4 py-2 text-sm font-medium text-white transition hover:bg-white/20 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70",onClick:e,children:"Cancel"})})]})}constructor(){super(),this.handleChange=e=>{let t=e.target.value,{unfilteredApps:i}=this.state,n=""===t||null===t?i:i.filter(e=>e.title.toLowerCase().includes(t.toLowerCase()));this.setState({query:t,apps:n})},this.selectApp=e=>{"function"==typeof this.props.onSelect&&this.props.onSelect(e)},this.renderApps=()=>(this.state.apps||[]).map(e=>{var t;let i=!1!==e.prefetchOnHover;return(0,n.jsx)(I,{name:e.title,id:e.id,icon:e.icon,openApp:()=>this.selectApp(e.id),disabled:e.disabled,prefetch:i?null==(t=e.screen)?void 0:t.prefetch:void 0},e.id)}),this.state={query:"",apps:[],unfilteredApps:[]}}}let Y=(e,t)=>t<=0?0:(e%t+t)%t;function G(e){var t;let{windows:i=[],onSelect:s,onClose:r,containerRef:o}=e,[l,d]=(0,a.useState)(""),[c,u]=(0,a.useState)(0),[h,p]=(0,a.useState)(!1),m=(0,a.useRef)(null),f=(0,a.useRef)(null),g=null!=o?o:m,w=(0,a.useMemo)(()=>{let e=l.trim().toLowerCase();return e?i.filter(t=>(t.title||t.id||"").toString().toLowerCase().includes(e)):i},[l,i]);(0,a.useEffect)(()=>{u(e=>w.length?Math.min(e,w.length-1):0)},[w]),(0,a.useEffect)(()=>{u(0)},[i]),(0,a.useEffect)(()=>{g.current&&g.current.focus()},[g]),(0,a.useEffect)(()=>{if(h){var e;null==(e=f.current)||e.focus()}},[h]),(0,a.useEffect)(()=>{let e=e=>{if("Alt"===e.key){let e=w[c];e&&"function"==typeof s?s(e.id):"function"==typeof r&&r()}};return window.addEventListener("keyup",e),()=>window.removeEventListener("keyup",e)},[w,c,s,r]);let v=e=>{let t=w[e];t&&"function"==typeof s&&s(t.id)},x=e=>{let{key:t,shiftKey:i,ctrlKey:n,metaKey:s}=e,o=w.length;if(o)if("Tab"===t){e.preventDefault();let t=i?-1:1;u(e=>Y(e+t,o))}else"ArrowRight"===t||"ArrowDown"===t?(e.preventDefault(),u(e=>Y(e+1,o))):"ArrowLeft"===t||"ArrowUp"===t?(e.preventDefault(),u(e=>Y(e-1,o))):"Home"===t?(e.preventDefault(),u(0)):"End"===t?(e.preventDefault(),u(o-1)):"Enter"===t?(e.preventDefault(),v(c)):"Escape"===t?(e.preventDefault(),"function"==typeof r&&r()):(!h&&"/"===t||"f"===t&&(n||s))&&(e.preventDefault(),p(!0))};return(0,n.jsx)("div",{ref:g,tabIndex:-1,onKeyDown:e=>{h&&e.target===f.current||x(e)},className:"flex h-full w-full flex-col focus:outline-none text-white",role:"presentation",children:(0,n.jsxs)("div",{className:"flex flex-col gap-4 rounded-xl border border-white/10 bg-ub-grey/80 p-6 shadow-2xl",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold tracking-wide",children:"Switch windows"}),(0,n.jsx)("div",{className:"flex items-center gap-2 text-sm",children:h?(0,n.jsx)("button",{type:"button",onClick:()=>{var e;p(!1),d(""),null==(e=g.current)||e.focus()},className:"rounded-md px-2 py-1 bg-white/10 hover:bg-white/20 transition",children:"Hide search"}):(0,n.jsx)("button",{type:"button",onClick:()=>p(!0),className:"rounded-md px-2 py-1 bg-white/10 hover:bg-white/20 transition",children:"Search"})})]}),h&&(0,n.jsx)("div",{children:(0,n.jsx)("input",{ref:f,value:l,onChange:e=>{d(e.target.value),u(0)},onKeyDown:e=>{if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Tab","Home","End","Enter"].includes(e.key))return void x(e);"Escape"===e.key&&(l?(e.preventDefault(),d("")):"function"==typeof r&&(e.preventDefault(),r()))},placeholder:"Filter windows","aria-label":"Filter windows",className:"w-full rounded-md bg-black/40 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-ub-orange"})}),(0,n.jsxs)("div",{className:"flex gap-4 overflow-x-auto pb-2",role:"listbox","aria-label":"Open windows","aria-activedescendant":(null==(t=w[c])?void 0:t.id)?"window-switcher-".concat(w[c].id):void 0,children:[w.map((e,t)=>{let i=t===c;return(0,n.jsx)("button",{id:"window-switcher-".concat(e.id),type:"button",className:"flex-shrink-0 w-[280px] rounded-xl border-2 transition focus:outline-none focus:ring-2 focus:ring-ub-orange ".concat(i?"border-ub-orange bg-white/10 shadow-xl":"border-transparent bg-white/5 hover:bg-white/10"),onClick:()=>{u(t),v(t)},onMouseEnter:()=>u(t),role:"option","aria-selected":i,"aria-label":e.title||e.id,children:(0,n.jsxs)("div",{className:"flex h-full flex-col text-left",children:[(0,n.jsxs)("div",{className:"relative overflow-hidden rounded-t-xl bg-black/70",style:{height:180},children:[e.preview?(0,n.jsx)("img",{src:e.preview,alt:"".concat(e.title," preview"),className:"h-full w-full object-cover"}):(0,n.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-gradient-to-br from-white/10 to-white/5",children:e.icon?(0,n.jsx)("img",{src:e.icon,alt:"",className:"h-12 w-12"}):(0,n.jsx)("span",{className:"text-xs text-white/60",children:"No preview"})}),e.icon&&(0,n.jsx)("div",{className:"absolute bottom-3 left-3 flex h-12 w-12 items-center justify-center rounded-xl bg-black/70 shadow-lg",children:(0,n.jsx)("img",{src:e.icon,alt:"",className:"h-8 w-8"})})]}),(0,n.jsx)("div",{className:"truncate px-4 py-3 text-sm font-medium",children:e.title||e.id})]})},e.id)}),!w.length&&(0,n.jsx)("div",{className:"w-full text-center text-sm text-white/70",children:"No windows match your search."})]})]})})}let X={window:{label:"Recent Windows"},app:{label:"Applications"},action:{label:"Settings & Actions"}},J=(()=>{if("undefined"==typeof navigator)return!1;let e=navigator.platform||"",t=navigator.userAgent||"";return/Mac|iPhone|iPad|iPod/i.test(e||t)})()?"⌘":"Ctrl",Z=(e,t)=>e.map(e=>({...e,icon:(e=>{if(!e||"string"!=typeof e)return;if(/^(https?:|data:)/i.test(e))return e;let t=e.replace(/^\.\//,"").replace(/^\/+/,"");return t?"/".concat(t):void 0})(e.icon),type:t}));function $(e){let{open:t,apps:i,recentWindows:s,settingsActions:r,onSelect:o,onClose:l}=e,[d,c]=(0,a.useState)(""),[u,h]=(0,a.useState)(0),p=(0,a.useRef)(null),m=(0,a.useRef)(null),f=(0,a.useRef)([]),g=(0,a.useMemo)(()=>[{type:"window",label:X.window.label,items:Z(s,"window")},{type:"app",label:X.app.label,items:Z(i,"app")},{type:"action",label:X.action.label,items:Z(r,"action")}],[i,s,r]),w=(0,a.useMemo)(()=>{let e=d.trim().toLowerCase();return g.map(t=>({...t,items:t.items.filter(t=>!e||[t.title,t.subtitle,...t.keywords||[]].filter(Boolean).map(e=>e.toString().toLowerCase()).some(t=>t.includes(e)))}))},[d,g]),v=(0,a.useMemo)(()=>{let e=[];return w.forEach(t=>{t.items.forEach(t=>{e.push(t)})}),e},[w]),x=(0,a.useMemo)(()=>{let e=new Map;return v.forEach((t,i)=>{e.set("".concat(t.type,":").concat(t.id),i)}),e},[v]);(0,a.useEffect)(()=>{if(!t){c(""),h(0);return}let e=window.requestAnimationFrame(()=>{var e;null==(e=p.current)||e.focus({preventScroll:!0})});return()=>window.cancelAnimationFrame(e)},[t]),(0,a.useEffect)(()=>{if(t){if(!v.length)return void h(-1);h(0)}},[d,v.length,t]),(0,a.useEffect)(()=>{f.current=f.current.slice(0,v.length)},[v.length]),(0,a.useEffect)(()=>{if(u<0)return;let e=f.current[u];e&&e.scrollIntoView({block:"nearest"})},[u,v]);let b=e=>{let t=v[e];t&&o(t)},y=e=>{if(!t)return;let{key:i}=e,n=v.length;if(!n){"Escape"!==i||d||(e.preventDefault(),l());return}"ArrowDown"===i?(e.preventDefault(),h(e=>{let t=e+1;return t>=n?0:t})):"ArrowUp"===i?(e.preventDefault(),h(e=>e<=0?n-1:e-1)):"Home"===i?(e.preventDefault(),h(0)):"End"===i?(e.preventDefault(),h(n-1)):"Enter"===i?(e.preventDefault(),u>=0&&b(u)):"Escape"===i&&(d?(e.preventDefault(),c("")):(e.preventDefault(),l()))},k=u>=0&&v[u]?"command-palette-option-".concat(v[u].type,"-").concat(v[u].id):void 0;return(0,n.jsxs)("div",{className:"flex h-full w-full flex-col gap-4 bg-slate-950/70 p-6 text-white",children:[(0,n.jsxs)("header",{className:"space-y-2",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold tracking-wide",children:"Command Palette"}),(0,n.jsx)("p",{className:"text-sm text-white/70",children:"Search across applications, recent windows, and settings. Use the arrow keys to navigate and Enter to run a command."})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"command-palette-search",className:"sr-only",children:"Search commands"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{ref:p,id:"command-palette-search",type:"text",value:d,onChange:e=>c(e.target.value),onKeyDown:e=>{new Set(["ArrowDown","ArrowUp","Home","End","Enter","Escape"]).has(e.key)&&y(e)},placeholder:"Search apps, windows, and settings",autoComplete:"off",spellCheck:!1,className:"w-full rounded-lg border border-white/10 bg-white/10 px-4 py-2 text-sm text-white shadow-inner focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-400/60","aria-label":"Search commands"}),(0,n.jsxs)("span",{className:"pointer-events-none absolute inset-y-0 right-2 hidden items-center gap-1 rounded-md border border-white/10 bg-black/40 px-2 text-xs font-medium text-white/60 sm:flex",children:[(0,n.jsx)("kbd",{className:"font-sans text-[10px] uppercase tracking-wide text-white/60",children:J}),(0,n.jsx)("kbd",{className:"font-sans text-[10px] uppercase tracking-wide text-white/60",children:"Space"})]})]})]}),(0,n.jsx)("div",{ref:m,role:"listbox","aria-label":"Command palette results","aria-activedescendant":k,tabIndex:-1,className:"relative flex-1 overflow-y-auto rounded-xl border border-white/10 bg-white/5 p-2",onKeyDown:e=>{e.target!==p.current&&y(e)},children:0===v.length?(0,n.jsx)("p",{className:"px-3 py-6 text-center text-sm text-white/60",children:"No matching commands."}):w.map(e=>e.items.length?(0,n.jsxs)("div",{className:"mb-4 last:mb-0",children:[(0,n.jsx)("p",{className:"px-3 pb-2 text-xs font-semibold uppercase tracking-wider text-white/50",children:e.label}),(0,n.jsx)("div",{className:"space-y-1",children:e.items.map(e=>{var t;let i="".concat(e.type,":").concat(e.id),s=null!=(t=x.get(i))?t:-1,r="command-palette-option-".concat(e.type,"-").concat(e.id),o=s===u;return(0,n.jsxs)("button",{ref:e=>{s>=0&&(f.current[s]=e)},type:"button",id:r,role:"option","aria-selected":o,className:"flex w-full items-center gap-3 rounded-lg border px-3 py-2 text-left text-sm transition ".concat(o?"border-sky-400/70 bg-sky-500/20 shadow-[0_0_0_1px_rgba(14,165,233,0.45)]":"border-white/5 bg-black/20 hover:border-white/15 hover:bg-white/10"),onClick:()=>{s>=0&&b(s)},onMouseEnter:()=>{s>=0&&h(s)},children:[(0,n.jsx)("span",{className:"flex h-9 w-9 items-center justify-center rounded-md bg-white/10 text-white/70",children:e.icon?(0,n.jsx)("img",{src:e.icon,alt:"",className:"h-5 w-5","aria-hidden":"true"}):(0,n.jsx)("span",{"aria-hidden":"true",className:"text-base font-semibold",children:e.title.charAt(0).toUpperCase()})}),(0,n.jsxs)("span",{className:"flex min-w-0 flex-1 flex-col",children:[(0,n.jsx)("span",{className:"truncate font-medium text-white",children:e.title}),e.subtitle?(0,n.jsx)("span",{className:"truncate text-xs text-white/60",children:e.subtitle}):null]}),(0,n.jsx)("span",{className:"text-[11px] font-medium uppercase tracking-wider text-white/40",children:X[e.type].label})]},r)})})]},e.type):null)}),(0,n.jsxs)("footer",{className:"flex items-center justify-between text-[11px] uppercase tracking-wider text-white/40",children:[(0,n.jsx)("span",{children:"Press Esc to close"}),(0,n.jsx)("span",{children:"Enter to launch"})]})]})}let Q=new Set,ee={error:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let n=t.map(e=>{if(e instanceof Error)return e.stack||e.message;if("object"==typeof e)try{return JSON.stringify(e)}catch(e){}return String(e)}).join(" ");Q.has(n)||(Q.add(n),console.error(...t))}};function et(){return(0,n.jsx)("div",{className:"flex justify-center w-full",children:(0,n.jsx)("div",{className:" border-t border-gray-900 py-1 w-2/5"})})}let ei=function(e){let[t,i]=(0,a.useState)(!1),[s,r]=(0,a.useState)(!1),o=e.iconSizePreset||"medium",l=e.iconSizeBucket,d=e.iconSizeBucketLabel||"current display",c="function"==typeof e.setIconSizePreset?e.setIconSizePreset:()=>{};(0,a.useEffect)(()=>(r(!0),document.addEventListener("fullscreenchange",h),()=>{document.removeEventListener("fullscreenchange",h)}),[]);let u=()=>{e.openApp("settings")},h=()=>{document.fullscreenElement?i(!0):i(!1)};return(0,n.jsxs)("div",{id:"desktop-menu",role:"menu","aria-label":"Desktop context menu",className:(e.active?" block ":" hidden ")+" cursor-default w-56 context-menu-bg border text-left font-light border-gray-900 rounded text-white py-4 absolute z-50 text-sm shadow-lg backdrop-blur-sm",children:[(0,n.jsxs)("button",{onClick:e.addNewFolder,type:"button",role:"menuitem","aria-label":"New Folder",className:"w-full text-left py-0.5 hover:bg-ub-warm-grey hover:bg-opacity-20 mb-1.5 flex items-center justify-between group",children:[(0,n.jsx)("span",{className:"ml-5",children:"New Folder"}),(0,n.jsx)("span",{className:"mr-4 text-xs text-gray-500 group-hover:text-gray-400",children:"Ctrl+Shift+N"})]}),(0,n.jsx)("button",{onClick:e.openShortcutSelector,type:"button",role:"menuitem","aria-label":"Create Shortcut",className:"w-full text-left py-0.5 hover:bg-ub-warm-grey hover:bg-opacity-20 mb-1.5",children:(0,n.jsx)("span",{className:"ml-5",children:"Create Shortcut..."})}),(0,n.jsx)(et,{}),(0,n.jsx)("div",{className:"px-5 pb-1 text-xs tracking-wide uppercase text-ub-warm-grey text-opacity-80",children:"View"}),(0,n.jsx)("div",{className:"px-5 pb-2 text-[0.65rem] uppercase tracking-wide text-ub-warm-grey text-opacity-60",suppressHydrationWarning:!0,children:"Applies to ".concat(s?d:"current display")}),[{value:"small",label:"Small Icons"},{value:"medium",label:"Medium Icons"},{value:"large",label:"Large Icons"}].map(e=>{let t=o===e.value;return(0,n.jsxs)("button",{onClick:()=>c(e.value,{bucketId:l}),type:"button",role:"menuitemradio","aria-checked":t,className:(t?" text-ubt-blue ":"")+" group w-full text-left py-0.5 hover:bg-ub-warm-grey hover:bg-opacity-20 mb-1.5 flex items-center justify-between",children:[(0,n.jsx)("span",{className:"ml-5",children:e.label}),(0,n.jsx)("span",{"aria-hidden":"true",className:(t?" opacity-100 ":" opacity-0 group-hover:opacity-60 group-focus-visible:opacity-60 ")+" mr-5 text-xs transition-opacity",children:"✓"})]},e.value)}),(0,n.jsx)(et,{}),(0,n.jsx)("div",{role:"menuitem","aria-label":"Paste","aria-disabled":"true",className:"w-full py-0.5 hover:bg-ub-warm-grey hover:bg-opacity-20 mb-1.5 text-gray-400",children:(0,n.jsx)("span",{className:"ml-5",children:"Paste"})}),(0,n.jsx)(et,{}),(0,n.jsx)("div",{role:"menuitem","aria-label":"Show Desktop in Files","aria-disabled":"true",className:"w-full py-0.5 hover:bg-ub-warm-grey hover:bg-opacity-20 mb-1.5 text-gray-400",children:(0,n.jsx)("span",{className:"ml-5",children:"Show Desktop in Files"})}),(0,n.jsxs)("button",{onClick:()=>{e.openApp("terminal")},type:"button",role:"menuitem","aria-label":"Open in Terminal",className:"w-full text-left py-0.5 hover:bg-ub-warm-grey hover:bg-opacity-20 mb-1.5 flex items-center justify-between group",children:[(0,n.jsx)("span",{className:"ml-5",children:"Open in Terminal"}),(0,n.jsx)("span",{className:"mr-4 text-xs text-gray-500 group-hover:text-gray-400",children:"Ctrl+Alt+T"})]}),(0,n.jsx)(et,{}),(0,n.jsx)("button",{onClick:u,type:"button",role:"menuitem","aria-label":"Change Background",className:"w-full text-left py-0.5 hover:bg-ub-warm-grey hover:bg-opacity-20 mb-1.5",children:(0,n.jsx)("span",{className:"ml-5",children:"Change Background..."})}),(0,n.jsx)(et,{}),(0,n.jsx)("div",{role:"menuitem","aria-label":"Display Settings","aria-disabled":"true",className:"w-full py-0.5 hover:bg-ub-warm-grey hover:bg-opacity-20 mb-1.5 text-gray-400",children:(0,n.jsx)("span",{className:"ml-5",children:"Display Settings"})}),(0,n.jsx)("button",{onClick:u,type:"button",role:"menuitem","aria-label":"Settings",className:"w-full text-left py-0.5 hover:bg-ub-warm-grey hover:bg-opacity-20 mb-1.5",children:(0,n.jsx)("span",{className:"ml-5",children:"Settings"})}),(0,n.jsx)(et,{}),(0,n.jsx)("button",{onClick:()=>{try{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}catch(e){ee.error(e)}},type:"button",role:"menuitem","aria-label":t?"Exit Full Screen":"Enter Full Screen",className:"w-full text-left py-0.5 hover:bg-ub-warm-grey hover:bg-opacity-20 mb-1.5",children:(0,n.jsxs)("span",{className:"ml-5",children:[t?"Exit":"Enter"," Full Screen"]})}),(0,n.jsx)(et,{}),(0,n.jsx)("button",{onClick:e.clearSession,type:"button",role:"menuitem","aria-label":"Clear Session",className:"w-full text-left py-0.5 hover:bg-ub-warm-grey hover:bg-opacity-20 mb-1.5",children:(0,n.jsx)("span",{className:"ml-5",children:"Clear Session"})})]})},en=e=>!(e.tabIndex<0||e.hasAttribute("disabled")||"true"===e.getAttribute("aria-hidden")||e.closest('[aria-hidden="true"]')||e instanceof HTMLInputElement&&"hidden"===e.type),es=function(e,t){let{initialFocusRef:i,restoreFocusRef:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,a.useEffect)(()=>{var s;if(!t)return;let r=e.current;if(!r)return;let o=()=>Array.from(r.querySelectorAll('a[href],area[href],button:not([disabled]),input:not([disabled]):not([type="hidden"]),select:not([disabled]),textarea:not([disabled]),iframe,object,embed,[contenteditable="true"],[tabindex]:not([tabindex="-1"])')).filter(en),a=()=>{let e=null==i?void 0:i.current,t=o(),n=e&&r.contains(e)&&en(e)?e:t[0];if(!n)return null;if(n.focus(),(n instanceof HTMLInputElement||n instanceof HTMLTextAreaElement)&&"function"==typeof n.setSelectionRange){let e=n.value.length;n.setSelectionRange(e,e)}return n},l=document.activeElement,d=null!=(s=null==n?void 0:n.current)?s:null;a();let c=window.setTimeout(()=>{a()},0),u=()=>{r.contains(document.activeElement)||a()},h=window.requestAnimationFrame(u),p=window.setTimeout(u,120),m=window.setInterval(u,50),f=e=>{if("Tab"!==e.key)return;let t=e.target instanceof HTMLElement?e.target:null,i=document.activeElement,n=t&&r.contains(t)?t:i&&r.contains(i)?i:null;if(!n)return;let s=o();if(0===s.length)return void e.preventDefault();let a=s[0],l=s[s.length-1];if(e.shiftKey){n===a&&(e.preventDefault(),l.focus({preventScroll:!0}));return}n===l&&(e.preventDefault(),a.focus({preventScroll:!0}))};window.addEventListener("keydown",f,!0);let g=e=>{let t=e.target,i=t instanceof Node?t:document.activeElement instanceof Node?document.activeElement:null;!i||r.contains(i)||a()};return window.addEventListener("focus",g,!0),()=>{window.cancelAnimationFrame(h),window.clearTimeout(p),window.clearInterval(m),window.clearTimeout(c),window.removeEventListener("keydown",f,!0),window.removeEventListener("focus",g,!0);let e=null!=d?d:l;e&&e.isConnected&&e.focus({preventScroll:!0})}},[t,e,i,n])};function er(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"horizontal";(0,a.useEffect)(()=>{let n=e.current;if(!n||!t)return;let s=Array.from(n.querySelectorAll('[role="tab"], [role="menuitem"], [role="option"]'));if(0===s.length)return;let r=s.findIndex(e=>0===e.tabIndex);-1===r&&(r=0),s.forEach((e,t)=>e.tabIndex=t===r?0:-1);let o=e=>{let t="horizontal"===i?["ArrowRight","ArrowDown"]:["ArrowDown"],n="horizontal"===i?["ArrowLeft","ArrowUp"]:["ArrowUp"];t.includes(e.key)?(e.preventDefault(),r=(r+1)%s.length,s.forEach((e,t)=>e.tabIndex=t===r?0:-1),s[r].focus()):n.includes(e.key)&&(e.preventDefault(),r=(r-1+s.length)%s.length,s.forEach((e,t)=>e.tabIndex=t===r?0:-1),s[r].focus())};return n.addEventListener("keydown",o),()=>{n.removeEventListener("keydown",o)}},[e,t,i])}function eo(){return(0,n.jsx)("div",{className:"flex justify-center w-full",children:(0,n.jsx)("div",{className:" border-t border-gray-900 py-1 w-2/5"})})}let ea=function(e){let t=(0,a.useRef)(null);return es(t,e.active),er(t,e.active,"vertical"),(0,n.jsxs)("div",{id:"default-menu",role:"menu","aria-hidden":!e.active,ref:t,onKeyDown:t=>{"Escape"===t.key&&e.onClose&&e.onClose()},className:(e.active?" block ":" hidden ")+" cursor-default w-52 context-menu-bg border text-left border-gray-900 rounded text-white py-4 absolute z-50 text-sm",children:[(0,n.jsx)(eo,{}),(0,n.jsx)("a",{rel:"noopener noreferrer",href:"https://www.linkedin.com/in/unnippillil/",target:"_blank",role:"menuitem","aria-label":"Linkedin",className:"w-full block cursor-default py-0.5 hover:bg-gray-700 mb-1.5",children:(0,n.jsx)("span",{className:"ml-5",children:(0,n.jsx)("strong",{children:"Linkedin"})})}),(0,n.jsx)("a",{rel:"noopener noreferrer",href:"https://github.com/Alex-Unnippillil",target:"_blank",role:"menuitem","aria-label":"Github",className:"w-full block cursor-default py-0.5 hover:bg-gray-700 mb-1.5",children:(0,n.jsx)("span",{className:"ml-5",children:(0,n.jsx)("strong",{children:"Github"})})}),(0,n.jsx)("a",{rel:"noopener noreferrer",href:"mailto:alex.j.unnippillil@gmail.com",target:"_blank",role:"menuitem","aria-label":"Contact Me",className:"w-full block cursor-default py-0.5 hover:bg-gray-700 mb-1.5",children:(0,n.jsx)("span",{className:"ml-5",children:"Contact Me"})}),(0,n.jsx)(eo,{}),(0,n.jsx)("button",{type:"button",onClick:()=>{localStorage.clear(),window.location.reload()},role:"menuitem","aria-label":"Reset Kali Linux",className:"w-full text-left cursor-default py-0.5 hover:bg-gray-700 mb-1.5",children:(0,n.jsx)("span",{className:"ml-5",children:"Reset Kali Linux"})})]})},el=function(e){let t=(0,a.useRef)(null);return es(t,e.active),er(t,e.active,"vertical"),(0,n.jsx)("div",{id:"app-menu",role:"menu","aria-hidden":!e.active,ref:t,onKeyDown:t=>{"Escape"===t.key&&e.onClose&&e.onClose()},className:(e.active?" block ":" hidden ")+" cursor-default w-52 context-menu-bg border text-left border-gray-900 rounded text-white py-4 absolute z-50 text-sm",children:(0,n.jsx)("button",{type:"button",onClick:()=>{e.pinned?e.unpinApp&&e.unpinApp():e.pinApp&&e.pinApp()},role:"menuitem","aria-label":e.pinned?"Unpin from Favorites":"Pin to Favorites",className:"w-full text-left cursor-default py-0.5 hover:bg-gray-700 mb-1.5",children:(0,n.jsx)("span",{className:"ml-5",children:e.pinned?"Unpin from Favorites":"Pin to Favorites"})})})},ed=function(e){let t=(0,a.useRef)(null);es(t,e.active),er(t,e.active,"vertical");let i=Array.isArray(e.workspaces)?e.workspaces:[],s=i.length>1,r=!1!==e.allowMaximize;return(0,n.jsxs)("div",{id:"taskbar-menu",role:"menu","aria-hidden":!e.active,ref:t,onKeyDown:t=>{"Escape"===t.key&&e.onCloseMenu&&e.onCloseMenu()},className:(e.active?" block ":" hidden ")+" cursor-default w-52 context-menu-bg border text-left border-gray-900 rounded text-white py-2 absolute z-50 text-sm",children:[e.supportsNewWindow?(0,n.jsx)("button",{type:"button",onClick:()=>{e.onNewWindow&&e.onNewWindow(),e.onCloseMenu&&e.onCloseMenu()},role:"menuitem","aria-label":"Open new window",className:"w-full text-left cursor-default py-0.5 hover:bg-gray-700 mb-1.5",children:(0,n.jsx)("span",{className:"ml-5",children:"New window"})}):null,(0,n.jsx)("button",{type:"button",onClick:()=>{e.pinned?e.onUnpin&&e.onUnpin():e.onPin&&e.onPin(),e.onCloseMenu&&e.onCloseMenu()},role:"menuitem","aria-label":e.pinned?"Unpin from taskbar":"Pin to taskbar",className:"w-full text-left cursor-default py-0.5 hover:bg-gray-700 mb-1.5",children:(0,n.jsx)("span",{className:"ml-5",children:e.pinned?"Unpin from taskbar":"Pin to taskbar"})}),(0,n.jsx)("button",{type:"button",onClick:()=>{e.onMinimize&&e.onMinimize(),e.onCloseMenu&&e.onCloseMenu()},role:"menuitem","aria-label":e.minimized?"Restore Window":"Minimize Window",className:"w-full text-left cursor-default py-0.5 hover:bg-gray-700 mb-1.5",children:(0,n.jsx)("span",{className:"ml-5",children:e.minimized?"Restore":"Minimize"})}),(0,n.jsx)("button",{type:"button",onClick:()=>{e.isMaximized?e.onRestore&&e.onRestore():e.onMaximize&&e.onMaximize(),e.onCloseMenu&&e.onCloseMenu()},role:"menuitem","aria-label":e.isMaximized?"Restore Window size":"Maximize Window",disabled:!r,"aria-disabled":!r,className:"w-full text-left cursor-default py-0.5 hover:bg-gray-700 mb-1.5 ".concat(r?"":"opacity-50 cursor-not-allowed"),children:(0,n.jsx)("span",{className:"ml-5",children:e.isMaximized?"Restore":"Maximize"})}),s?(0,n.jsxs)("div",{className:"my-2 border-t border-white/10",children:[(0,n.jsx)("p",{className:"px-5 py-1 text-xs uppercase tracking-wide text-white/60",children:"Move to workspace"}),i.map(t=>(0,n.jsx)("button",{type:"button",onClick:()=>{e.onMoveWorkspace&&e.onMoveWorkspace(t.id),e.onCloseMenu&&e.onCloseMenu()},role:"menuitem","aria-label":"Move to workspace ".concat(t.label||t.id+1),disabled:t.id===e.activeWorkspace,"aria-disabled":t.id===e.activeWorkspace,className:"w-full text-left cursor-default py-0.5 hover:bg-gray-700 mb-1.5 ".concat(t.id===e.activeWorkspace?"opacity-50 cursor-not-allowed":""),children:(0,n.jsxs)("span",{className:"ml-5",children:["Workspace ",t.label||t.id+1]})},t.id))]}):null,(0,n.jsx)("button",{type:"button",onClick:()=>{e.onClose&&e.onClose(),e.onCloseMenu&&e.onCloseMenu()},role:"menuitem","aria-label":"Close Window",className:"w-full text-left cursor-default py-0.5 hover:bg-gray-700 mb-1.5",children:(0,n.jsx)("span",{className:"ml-5",children:"Close"})})]})};var ec=i(69241);let eu={minimized:"from-sky-500/90 via-sky-500/80 to-sky-600/90",closed:"from-slate-600/90 via-slate-600/80 to-slate-700/90"},eh={minimized:"bg-sky-400/20 text-sky-100",closed:"bg-slate-500/25 text-slate-100"},ep="focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900 focus-visible:ring-sky-300";function em(e){let{label:t,entries:i,open:s,onToggle:r,onActivate:o,emptyLabel:a,anchor:l,accent:c,actionLabel:u,onRemove:h}=e,p=(0,ec.default)("pointer-events-auto fixed bottom-4 z-[240] w-[calc(50vw-0.75rem)] md:w-[18rem] max-w-[92vw] text-sm text-white drop-shadow-xl","left"===l?"left-2 md:left-4":"right-2 md:right-4"),m=(0,ec.default)("flex w-full items-center justify-between rounded-lg border border-white/10 bg-gradient-to-br px-3 py-2",eu[c]),f=(0,ec.default)("flex w-full items-center justify-between rounded-lg px-3 py-2 text-left font-medium text-white/90 transition-colors hover:text-white",ep),g=(0,ec.default)("mt-2 overflow-hidden rounded-lg border border-white/10 bg-slate-950/80 backdrop-blur",s?"max-h-64 opacity-100":"max-h-0 opacity-0","transition-all duration-200 ease-out"),w=i.length,v=u||("minimized"===c?"Restore window":"Reopen window");return(0,n.jsxs)("aside",{className:p,"aria-label":"".concat(t," panel"),children:[(0,n.jsx)("div",{className:m,children:(0,n.jsxs)("button",{type:"button",onClick:r,"aria-expanded":s,className:f,children:[(0,n.jsx)("span",{children:t}),(0,n.jsx)("span",{className:(0,ec.default)("ml-2 inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold",eh[c]),children:w})]})}),(0,n.jsx)("div",{className:g,"aria-hidden":!s,children:(0,n.jsx)("ul",{className:"flex max-h-64 flex-col gap-1 overflow-y-auto p-2",role:"list",children:0===w?(0,n.jsx)("li",{className:"px-2 py-4 text-center text-xs text-white/60",children:a}):i.map(e=>(0,n.jsxs)("li",{className:"group flex items-center gap-2 rounded-md px-2 py-1 hover:bg-white/5",children:[(0,n.jsxs)("button",{type:"button",onClick:()=>o(e.id),className:(0,ec.default)("flex flex-1 items-center gap-3 rounded-md px-1 py-1 text-left transition-colors hover:text-white/95",ep),children:[function(e){var t,i;if(e.icon)return(0,n.jsx)(d(),{src:e.icon.replace("./","/"),alt:"",width:32,height:32,className:"h-8 w-8 flex-shrink-0 rounded"});let s=(null==(i=e.title)||null==(t=i.charAt(0))?void 0:t.toUpperCase())||"…";return(0,n.jsx)("span",{className:"flex h-8 w-8 flex-shrink-0 items-center justify-center rounded bg-slate-700/80 text-base font-semibold",children:s})}(e),(0,n.jsxs)("span",{className:"flex flex-col text-left",children:[(0,n.jsx)("span",{className:"text-sm font-semibold leading-tight",children:e.title}),(0,n.jsx)("span",{className:"text-[0.7rem] uppercase tracking-wide text-white/60",children:v})]})]}),h?(0,n.jsx)("button",{type:"button","aria-label":"Remove ".concat(e.title," from ").concat(t),onClick:()=>h(e.id),className:(0,ec.default)("rounded-full p-1 text-white/60 transition-colors hover:bg-white/10 hover:text-white",ep),children:(0,n.jsx)("span",{"aria-hidden":"true",children:"\xd7"})}):null]},e.id))})})]})}function ef(e){return(0,n.jsx)(em,{...e,anchor:"left",accent:"minimized"})}function eg(e){return(0,n.jsx)(em,{...e,anchor:"right",accent:"closed"})}var ew=i(72082),ev=i(63115);let ex=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),eb="taskbar-pinned-apps",ey=e=>Array.isArray(e)?e.filter(e=>e&&void 0!==e.id):[],ek=e=>{if(!e)return[];if(Array.isArray(e))return ey(e);if("string"==typeof e)try{let t=JSON.parse(e);return ek(t)}catch(e){return[]}if("object"==typeof e){let t=e.kind||e.type;return t&&t!==eb?[]:ey(e.items)}return[]};var eS=i(12865),ej=i(95220);let eA=m()(()=>i.e(5223).then(i.bind(i,55223)),{loadableGenerated:{webpack:()=>[55223]},ssr:!1}),eI="desktop_folder_contents",eC=e=>{if(!e)return null;if("string"==typeof e)return{id:e,title:e};if("object"==typeof e&&"string"==typeof e.id){let t="string"==typeof e.title?e.title:e.id,i="string"==typeof e.icon?e.icon:void 0;return{id:e.id,title:t,icon:i}}return null},eP=()=>z.safeLocalStorage?z.safeLocalStorage:"undefined"!=typeof localStorage?localStorage:void 0,eN=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"desktop_window_sizes",t=eP();if(!t)return{};try{let i=t.getItem(e);if(!i)return{};let n=JSON.parse(i);if(!n||"object"!=typeof n)return{};let s={};return Object.entries(n).forEach(e=>{let[t,i]=e;if(!i||"object"!=typeof i)return;let n=Number(i.width),r=Number(i.height);Number.isFinite(n)&&Number.isFinite(r)&&(s[t]={width:n,height:r})}),s}catch(e){return{}}},e_=Object.freeze({launcher:{id:"overlay-launcher",title:"All Applications",icon:"/themes/Yaru/system/view-app-grid-symbolic.svg"},shortcutSelector:{id:"overlay-shortcut-selector",title:"Add to Desktop",icon:"/themes/Yaru/system/user-desktop.png"},windowSwitcher:{id:"overlay-window-switcher",title:"Window Switcher",icon:"/themes/Yaru/window/window-restore-symbolic.svg"},commandPalette:{id:"overlay-command-palette",title:"Command Palette",icon:"/themes/Yaru/apps/word-search.svg"}}),eE=Object.values(e_),eM=e_.launcher.id,eL=e_.shortcutSelector.id,ez=e_.windowSwitcher.id,eD=e_.commandPalette.id,eT=Object.freeze({accent:"accent",primary:"accent",brand:"accent",info:"info",information:"info",success:"success",positive:"success",complete:"success",done:"success",warning:"warning",caution:"warning",danger:"danger",critical:"danger",error:"danger",alert:"danger",neutral:"neutral",muted:"neutral",default:"accent"}),eO=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return"number"!=typeof e||Number.isNaN(e)||e<t?t:e>i?i:e},eF=e=>{let t={};return eE.forEach(i=>{let{id:n}=i;t[n]=e}),t};class eR extends a.Component{normalizeTheme(e){let t=this.defaultThemeConfig||{};if(!e)return{...t};let i={id:e.id||t.id||"default",accent:e.accent||t.accent||"#1793d1",wallpaperUrl:e.useKaliWallpaper?null:e.wallpaperUrl||e.fallbackWallpaperUrl||t.wallpaperUrl||t.fallbackWallpaperUrl||null,fallbackWallpaperUrl:e.fallbackWallpaperUrl||t.fallbackWallpaperUrl||null,wallpaperName:e.wallpaperName||t.wallpaperName||null,overlay:void 0!==e.overlay?e.overlay:t.overlay,useKaliWallpaper:"boolean"==typeof e.useKaliWallpaper?e.useKaliWallpaper:!!t.useKaliWallpaper};return i.wallpaperUrl||i.useKaliWallpaper||(i.wallpaperUrl=i.fallbackWallpaperUrl||null),i}themesAreEqual(e,t){return!!e&&!!t&&e.id===t.id&&e.accent===t.accent&&e.wallpaperUrl===t.wallpaperUrl&&e.fallbackWallpaperUrl===t.fallbackWallpaperUrl&&e.wallpaperName===t.wallpaperName&&e.overlay===t.overlay&&e.useKaliWallpaper===t.useKaliWallpaper}getWorkspaceTheme(e){let t=this.workspaceThemes&&this.workspaceThemes[e];return t?{...t}:this.normalizeTheme(this.props.desktopTheme)}setWorkspaceTheme(e,t){this.workspaceThemes||(this.workspaceThemes=[]),this.workspaceThemes[e]=this.normalizeTheme(t)}refreshAppRegistry(){let e=new Map,t=new Set;f.default.forEach(i=>{e.set(i.id,i),t.add(i.id)}),this.overlayRegistry.forEach(i=>{let n={id:i.id,title:i.title,icon:i.icon,isOverlay:!0};e.set(i.id,n),t.add(i.id)}),this.appMap=e,this.validAppIds=t}componentDidMount(){this._isMounted=!0,(0,ew.logPageView)("/desktop","Custom Title"),window.addEventListener("workspace-select",this.handleExternalWorkspaceSelect),window.addEventListener("workspace-request",this.broadcastWorkspaceState),window.addEventListener("taskbar-command",this.handleExternalTaskbarCommand),window.addEventListener("taskbar-preview-request",this.handleTaskbarPreviewRequest),window.addEventListener("app-badge",this.handleAppBadgeEvent),this.broadcastWorkspaceState(),this.broadcastIconSizePreset(this.state.iconSizePreset),this.hydrateFromStorage(),this.savedIconPositions=this.loadDesktopIconPositions(),this.setupViewportObserver(),this.initializeDefaultFolders(()=>{this.fetchAppsData(()=>{let e=this.props.session||{},t={};if(e.windows&&e.windows.length){let i=(0,v.measureWindowTopOffset)();e.windows.forEach(e=>{let{id:n,x:s,y:r}=e;t[n]={x:s,y:(0,v.clampWindowTopPosition)(r,i)}}),this.setWorkspaceState({window_positions:t},()=>{e.windows.forEach(e=>{let{id:t}=e;return this.openApp(t)})})}else this.openApp("about")}),this.checkForNewFolders(),this.checkForAppShortcuts(),this.updateTrashIcon()}),this.setContextListeners(),this.setEventListeners(),window.addEventListener("trash-change",this.updateTrashIcon),window.addEventListener("resize",this.handleViewportResize),document.addEventListener("keydown",this.handleGlobalShortcut),document.addEventListener("keyup",this.handleGlobalShortcutKeyup),window.addEventListener("open-app",this.handleOpenAppEvent),this.setupPointerMediaWatcher(),this.setupGestureListeners(),this.activateWindowFocusTrap()}componentDidUpdate(e,t){var i,n;((null==e?void 0:e.density)!==this.props.density||(null==e?void 0:e.fontScale)!==this.props.fontScale||(null==e?void 0:e.largeHitAreas)!==this.props.largeHitAreas)&&this.applyIconLayoutFromSettings(this.props)&&this.realignIconPositions();let s=null==(i=t.overlayWindows)?void 0:i[eM],r=null==(n=this.state.overlayWindows)?void 0:n[eM];(t.activeWorkspace!==this.state.activeWorkspace||t.closed_windows!==this.state.closed_windows||t.focused_windows!==this.state.focused_windows||t.minimized_windows!==this.state.minimized_windows||t.workspaces!==this.state.workspaces||t.appBadges!==this.state.appBadges||(null==s?void 0:s.open)!==(null==r?void 0:r.open)||(null==s?void 0:s.transitionState)!==(null==r?void 0:r.transitionState))&&this.broadcastWorkspaceState();let o=this.normalizeTheme(this.props.desktopTheme),a=this.workspaceThemes&&this.workspaceThemes[this.state.activeWorkspace]||null,l=!this.themesAreEqual(a,o),d=!this.themesAreEqual(this.state.currentTheme,o);l&&this.setWorkspaceTheme(this.state.activeWorkspace,o),d&&this.setState({currentTheme:o}),(l||d)&&(this.defaultThemeConfig={...this.defaultThemeConfig,...o});let c=!!(null==s?void 0:s.open),u=!!(null==r?void 0:r.open);!c&&u?(this.activateAllAppsFocusTrap(),this.focusAllAppsSearchInput()):c&&!u&&(this.deactivateAllAppsFocusTrap(),this.restoreFocusToPreviousElement())}componentWillUnmount(){this._isMounted=!1,this.removeEventListeners(),this.removeContextListeners(),document.removeEventListener("keydown",this.handleGlobalShortcut),document.removeEventListener("keyup",this.handleGlobalShortcutKeyup),window.removeEventListener("trash-change",this.updateTrashIcon),window.removeEventListener("open-app",this.handleOpenAppEvent),window.removeEventListener("resize",this.handleViewportResize),this.detachIconKeyboardListeners(),window.removeEventListener("workspace-select",this.handleExternalWorkspaceSelect),window.removeEventListener("workspace-request",this.broadcastWorkspaceState),window.removeEventListener("taskbar-command",this.handleExternalTaskbarCommand),window.removeEventListener("taskbar-preview-request",this.handleTaskbarPreviewRequest),window.removeEventListener("app-badge",this.handleAppBadgeEvent),this.teardownGestureListeners(),this.teardownPointerMediaWatcher(),this.teardownViewportObserver(),this.liveRegionTimeout&&(clearTimeout(this.liveRegionTimeout),this.liveRegionTimeout=null),this.allAppsCloseTimeout&&(clearTimeout(this.allAppsCloseTimeout),this.allAppsCloseTimeout=null),this.allAppsEnterRaf&&"function"==typeof cancelAnimationFrame&&(cancelAnimationFrame(this.allAppsEnterRaf),this.allAppsEnterRaf=null),this.deactivateAllAppsFocusTrap(),this.deactivateWindowFocusTrap()}render(){let e=this.state.currentTheme||this.normalizeTheme(this.props.desktopTheme),t=e&&e.accent?e.accent:"#1793d1",i=e&&(e.wallpaperUrl||e.fallbackWallpaperUrl)||"",s=e&&e.overlay?e.overlay:"none",r=eS.DESKTOP_TOP_PADDING-(eS.WINDOW_TOP_MARGIN+eS.WINDOW_TOP_INSET),o=eS.WINDOW_TOP_MARGIN+eS.WINDOW_TOP_INSET,a={paddingTop:"calc(var(--desktop-navbar-height, ".concat(r,"px) + ").concat(o,"px)"),minHeight:"100dvh","--desktop-accent":t,"--desktop-wallpaper":i?'url("'.concat(i,'")'):"none","--desktop-overlay":s},l=this.state.overlayWindows||{};l.launcher,l.shortcutSelector,l.windowSwitcher;let d=this.getMinimizedWindowEntries(),c=this.getClosedWindowEntries(),u=this.state.mounted&&(this.state.minimizedShelfOpen||d.length>0),h=this.state.mounted&&(this.state.closedShelfOpen||c.length>0),p=this.state.context_app,m=p?this.getAppById(p):null,f=!!p&&this.getPinnedAppIds().includes(p),g=p?this.getWindowStateForMenu(p):null,w=!!(m&&m.supportsMultiWindow),v=!m||!1!==m.allowMaximize;return(0,n.jsxs)("main",{id:"desktop",role:"main",ref:this.desktopRef,className:" min-h-screen h-full w-full flex flex-col items-end justify-start content-start flex-wrap-reverse bg-transparent relative overflow-hidden overscroll-none window-parent",style:a,children:[(0,n.jsx)("div",{id:"window-area",className:"absolute h-full w-full bg-transparent","data-context":"desktop-area",children:this.renderWindows()}),(0,n.jsx)(eA,{theme:e}),this.renderDesktopApps(),(0,n.jsx)(ei,{active:this.state.context_menus.desktop,openApp:this.openApp,addNewFolder:this.addNewFolder,openShortcutSelector:this.openShortcutSelector,iconSizePreset:this.state.iconSizePreset,iconSizeBucket:this.state.iconSizeBucket,iconSizeBucketLabel:this.getViewportBucketLabel(this.state.iconSizeBucket),setIconSizePreset:this.setIconSizePreset,clearSession:()=>{this.props.clearSession(),window.location.reload()}}),(0,n.jsx)(ea,{active:this.state.context_menus.default,onClose:this.hideAllContextMenu}),(0,n.jsx)(el,{active:this.state.context_menus.app,pinned:this.initFavourite[this.state.context_app],pinApp:()=>this.pinApp(this.state.context_app),unpinApp:()=>this.unpinApp(this.state.context_app),onClose:this.hideAllContextMenu}),(0,n.jsx)(ed,{active:this.state.context_menus.taskbar,minimized:!!p&&this.state.minimized_windows[p],pinned:f,supportsNewWindow:w,isMaximized:"maximized"===g,allowMaximize:v,workspaces:this.state.workspaces,activeWorkspace:this.state.activeWorkspace,onMinimize:()=>{if(!p)return;let e=this.isOverlayId(p);this.state.minimized_windows[p]?e?this.openOverlay(p,{transitionState:"entered"}):this.openApp(p):e?this.minimizeOverlay(p):this.hasMinimised(p)},onMaximize:()=>{p&&(this.isOverlayId(p)?this.toggleOverlayMaximize(p):this.dispatchWindowCommand(p,"ArrowUp"))},onRestore:()=>{p&&(this.isOverlayId(p)?this.toggleOverlayMaximize(p):this.dispatchWindowCommand(p,"ArrowDown"))},onPin:()=>{p&&this.pinApp(p)},onUnpin:()=>{p&&this.unpinApp(p)},onNewWindow:()=>{p&&this.openApp(p)},onMoveWorkspace:e=>{p&&this.moveAppToWorkspace(p,e)},onClose:()=>{p&&(this.isOverlayId(p)?this.closeOverlay(p):this.closeApp(p))},onCloseMenu:this.hideAllContextMenu}),this.state.showNameBar?this.renderNameBar():null,u?(0,n.jsx)(ef,{label:"Minimized windows",entries:d,open:this.state.minimizedShelfOpen,onToggle:this.toggleMinimizedShelf,onActivate:this.handleMinimizedWindowActivate,emptyLabel:"No windows are minimized"}):null,h?(0,n.jsx)(eg,{label:"Application List",entries:c,open:this.state.closedShelfOpen,onToggle:this.toggleClosedShelf,onActivate:this.handleClosedWindowActivate,onRemove:this.dismissClosedWindowEntry,emptyLabel:"No recently closed apps"}):null,this.renderOverlayWindows(),(0,n.jsx)("div",{className:"sr-only",role:"status","aria-live":"polite","aria-atomic":"true",children:this.state.liveRegionMessage})]})}constructor(e={}){var t;super(e),t=this,this.createEmptyWorkspaceState=()=>({focused_windows:eF(!1),closed_windows:eF(!0),minimized_windows:eF(!1),window_positions:{},window_sizes:{}}),this.cloneWorkspaceState=e=>({focused_windows:{...e.focused_windows},closed_windows:{...e.closed_windows},minimized_windows:{...e.minimized_windows},window_positions:{...e.window_positions},window_sizes:{...e.window_sizes||{}}}),this.getActiveUserId=()=>{let{user:e}=this.props||{};if(e&&"object"==typeof e){if(e.id)return String(e.id);if(e.userId)return String(e.userId);if(e.username)return String(e.username);if(e.email)return String(e.email)}if(!z.safeLocalStorage)return"default";for(let e of["active-user-id","active-user","desktop-user","current-user","session-user"]){let t=z.safeLocalStorage.getItem(e);if(t)return String(t)}return"default"},this.getTaskbarOrderStorageKey=()=>{let e=this.getActiveUserId();return"".concat(this.taskbarOrderKeyBase,":").concat(e)},this.loadTaskbarOrder=()=>{if(!z.safeLocalStorage)return[];try{let e=z.safeLocalStorage.getItem(this.getTaskbarOrderStorageKey());if(!e)return[];let t=JSON.parse(e);if(Array.isArray(t))return t.filter(e=>"string"==typeof e)}catch(e){}return[]},this.persistTaskbarOrder=e=>{if(z.safeLocalStorage)try{z.safeLocalStorage.setItem(this.getTaskbarOrderStorageKey(),JSON.stringify(e))}catch(e){}},this.normalizePinnedAppIds=e=>{let t=new Set(f.default.map(e=>e.id)),i=Array.isArray(e)?e:[],n=[],s=new Set;return i.forEach(e=>{!("string"!=typeof e||s.has(e))&&t.has(e)&&(n.push(e),s.add(e))}),n},this.loadPinnedAppIds=()=>{let e=this.normalizePinnedAppIds(f.default.filter(e=>e.favourite).map(e=>e.id));if(!z.safeLocalStorage)return e;let t=null;try{t=z.safeLocalStorage.getItem(this.pinnedStorageKey)}catch(e){t=null}if(!t)return this.hasStoredPinnedAppIds=!1,e;try{let e=JSON.parse(t);if(Array.isArray(e)){let t=this.normalizePinnedAppIds(e);return this.hasStoredPinnedAppIds=!0,t}}catch(e){}return this.hasStoredPinnedAppIds=!1,e},this.persistPinnedAppIds=e=>{if(z.safeLocalStorage)try{z.safeLocalStorage.setItem(this.pinnedStorageKey,JSON.stringify(Array.isArray(e)?e:[])),this.hasStoredPinnedAppIds=!0}catch(e){}},this.getPinnedAppIds=()=>{var e;return Array.isArray(null==(e=this.state)?void 0:e.pinnedAppIds)?[...this.state.pinnedAppIds]:[]},this.applyPinnedFlags=e=>{let t=new Set(Array.isArray(e)?e:[]);f.default.forEach(e=>{e.favourite=t.has(e.id)})},this.syncInitFavourite=e=>{let t={};f.default.forEach(i=>{t[i.id]=e.has(i.id)}),this.initFavourite=t},this.syncFavouriteAppsWithPinned=e=>{let t=new Set(f.default.map(e=>e.id));this.setState(i=>{let n=i.favourite_apps||{},s=i.closed_windows||{},r={...n},o=!1;return(t.forEach(t=>{let i=e.has(t),n=!1===s[t],a=r[t];i?!0!==a&&(r[t]=!0,o=!0):n?void 0===a&&n&&(r[t]=!0,o=!0):!1!==a&&(r[t]=!1,o=!0),void 0!==a||i||n||(r[t]=!1,o=!0)}),Object.keys(r).forEach(e=>{t.has(e)||(delete r[e],o=!0)}),o)?{favourite_apps:r}:null},()=>{this.saveSession()})},this.setPinnedAppIds=function(e){var i;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{persist:s=!0,broadcast:r=!0,force:o=!1,syncFavourite:a=!0}=n,l=t.normalizePinnedAppIds(e),d=Array.isArray(null==(i=t.state)?void 0:i.pinnedAppIds)?t.state.pinnedAppIds:[],c=o||l.length!==d.length||l.some((e,t)=>d[t]!==e),u=new Set(l),h=()=>{s&&t.persistPinnedAppIds(l),t.applyPinnedFlags(l),t.syncInitFavourite(u),a&&t.syncFavouriteAppsWithPinned(u),r&&t.broadcastWorkspaceState()};return c?t.setState({pinnedAppIds:l},h):h(),l},this.insertPinnedAppId=function(e,t,i){let n,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Array.isArray(e)?e.filter(e=>e!==t):[];if(i){let e=r.indexOf(i);n=-1===e?r.length:e,s&&-1!==e&&(n=e+1)}else n=s?r.length:0;return n<0&&(n=0),n>r.length&&(n=r.length),r.splice(n,0,t),r},this.getNormalizedTaskbarOrder=(e,t)=>{let i=Array.isArray(t)?t:this.state.taskbarOrder||[],n=[],s=new Set;return i.forEach(t=>{"string"==typeof t&&!s.has(t)&&e.includes(t)&&(n.push(t),s.add(t))}),e.forEach(e=>{s.has(e)||(n.push(e),s.add(e))}),n},this.setTaskbarOrder=e=>{Array.isArray(e)&&this.setState(t=>{let i=t.taskbarOrder||[];return i.length===e.length&&i.every((t,i)=>t===e[i])?null:{taskbarOrder:e}},()=>{let e=this.state.taskbarOrder||[];this.persistTaskbarOrder(e)})},this.getCurrentRunningAppIds=()=>{let{closed_windows:e={}}=this.state;return f.default.filter(t=>!1===e[t.id]).map(e=>e.id)},this.getIconSizePresetConfig=e=>{var t;return e&&this.iconSizePresets&&this.iconSizePresets[e]?this.iconSizePresets[e]:(null==(t=this.iconSizePresets)?void 0:t.medium)||{dimensions:{width:96,height:88},spacing:{row:112,column:128},padding:{top:eS.DESKTOP_TOP_PADDING,right:24,bottom:120,left:24}}},this.getViewportBucketId=e=>{let t=Number.isFinite(e)?e:0;return t<640?"lt-640":t>=1024?"gte-1024":"lt-1024"},this.getViewportBucketLabel=e=>{if(!this.iconSizePresetBuckets)return"current display";let t=this.iconSizePresetBuckets.find(t=>t.id===e);return t?t.label:"current display"},this.loadStoredIconPresetMap=()=>{let e={};if(!z.safeLocalStorage)return e;try{let t=z.safeLocalStorage.getItem(this.iconSizePresetStorageKey);if(!t)return e;let i=JSON.parse(t);if(!i||"object"!=typeof i)return e;return(Array.isArray(this.iconSizePresetBuckets)?this.iconSizePresetBuckets:[]).forEach(t=>{var n;let{id:s}=t;if(!s)return;let r=i[s];r&&(null==(n=this.iconSizePresets)?void 0:n[r])&&(e[s]=r)}),e}catch(t){return e}},this.getStoredIconSizePreset=function(){var e,i;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null==(e=t.state)?void 0:e.iconSizeBucket,s=n||"gte-1024",r="lt-640"===s?"tiny":"lt-1024"===s?"small":"medium";if(t.iconSizePresetMap&&t.iconSizePresetMap[s])return t.iconSizePresetMap[s];if(!z.safeLocalStorage)return r;try{let e=t.loadStoredIconPresetMap();if(t.iconSizePresetMap=e,e[s])return e[s];let n=z.safeLocalStorage.getItem(t.iconSizePresetLegacyKey);if(n&&(null==(i=t.iconSizePresets)?void 0:i[n]))return t.iconSizePresetMap={...t.iconSizePresetMap||{},[s]:n},t.persistIconSizePreset(n,s),n}catch(e){}return r},this.persistIconSizePreset=function(e){var i,n;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null==(n=t.state)?void 0:n.iconSizeBucket;if(!z.safeLocalStorage)return;let r=(null==(i=t.iconSizePresets)?void 0:i[e])?e:"medium",o={...t.iconSizePresetMap||{}};o[s||"gte-1024"]=r;try{z.safeLocalStorage.setItem(t.iconSizePresetStorageKey,JSON.stringify(o)),z.safeLocalStorage.removeItem(t.iconSizePresetLegacyKey),t.iconSizePresetMap=o}catch(e){}},this.broadcastIconSizePreset=function(e){var i;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null==(i=t.state)?void 0:i.iconSizeBucket;window.dispatchEvent(new CustomEvent("desktop-icon-size",{detail:{preset:e,bucket:n}}))},this.handleViewportBucketChange=function(e){var i;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{force:s=!1}=n||{},r=Number.isFinite(e)?e:0;t.latestViewportWidth=r;let o=t.getViewportBucketId(r),a=null==(i=t.state)?void 0:i.iconSizeBucket;if(!s&&o===a)return;let l=t.getStoredIconSizePreset(o);t.setIconSizePreset(l,{bucketId:o,persist:!1})},this.setupViewportObserver=()=>{let e=this.desktopRef&&this.desktopRef.current?this.desktopRef.current:null,t=e&&"function"==typeof e.getBoundingClientRect?e.getBoundingClientRect().width:"number"==typeof window.innerWidth?window.innerWidth:0;if("undefined"==typeof ResizeObserver||!e)return void this.handleViewportBucketChange(t,{force:!0});this.viewportResizeObserver&&"function"==typeof this.viewportResizeObserver.disconnect&&this.viewportResizeObserver.disconnect();let i=new ResizeObserver(t=>{var i;let n=t&&t.length?t[0]:null,s=null==n||null==(i=n.contentRect)?void 0:i.width,r=Number.isFinite(s)?s:null;null===r&&(r=e&&"function"==typeof e.getBoundingClientRect?e.getBoundingClientRect().width:"number"==typeof window.innerWidth?window.innerWidth:0),this.handleViewportBucketChange(r)});i.observe(e),this.viewportResizeObserver=i,this.handleViewportBucketChange(t,{force:!0})},this.teardownViewportObserver=()=>{this.viewportResizeObserver&&"function"==typeof this.viewportResizeObserver.disconnect&&this.viewportResizeObserver.disconnect(),this.viewportResizeObserver=null},this.commitWorkspacePartial=(e,t)=>{let i="number"==typeof t?t:this.state.activeWorkspace,n={...this.workspaceSnapshots[i]||this.createEmptyWorkspaceState()};Object.entries(e).forEach(e=>{let[t,i]=e;this.workspaceKeys.has(t)&&(n[t]=i)}),this.workspaceSnapshots[i]=n},this.mergeWorkspaceMaps=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=i?Array.from(i):Array.from(new Set([...Object.keys(t),...Object.keys(e)])),s={};return n.forEach(i=>{Object.prototype.hasOwnProperty.call(e,i)?s[i]=e[i]:Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=t[i])}),s},this.setupPointerMediaWatcher=()=>{if("function"!=typeof window.matchMedia)return void this.configureTouchTargets(!1);let e=window.matchMedia("(pointer: coarse)");this.pointerMedia=e;let t=e=>{this.configureTouchTargets(e.matches)};this.pointerMediaListener=t,this.configureTouchTargets(e.matches),"function"==typeof e.addEventListener?e.addEventListener("change",t):"function"==typeof e.addListener&&e.addListener(t)},this.teardownPointerMediaWatcher=()=>{if(!this.pointerMedia)return;let e=this.pointerMediaListener;e&&("function"==typeof this.pointerMedia.removeEventListener?this.pointerMedia.removeEventListener("change",e):"function"==typeof this.pointerMedia.removeListener&&this.pointerMedia.removeListener(e)),this.pointerMedia=null,this.pointerMediaListener=null},this.configureTouchTargets=e=>{this.currentPointerIsCoarse=!!e;let t=this.getIconSizePresetConfig(this.state.iconSizePreset);this.baseIconDimensions={...t.dimensions},this.baseIconGridSpacing={...t.spacing},this.baseDesktopPadding={...t.padding},this.applyIconLayoutFromSettings(this.props)&&this.realignIconPositions()},this.applyIconLayoutFromSettings=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.props,i=(null==e?void 0:e.density)==="compact"?"compact":"regular",n="number"==typeof(null==e?void 0:e.fontScale)?e.fontScale:1,s=Number.isFinite(n)?n:1,r=!!(null==e?void 0:e.largeHitAreas),o=(e,t,i)=>Math.min(Math.max(Number.isFinite(e)?e:t,t),i),a=o(s,.85,1.6),l=t.currentPointerIsCoarse?1.08:1,d=r||t.currentPointerIsCoarse?1.12:1,c=r||t.currentPointerIsCoarse?1.15:1,u=a*("compact"===i?.9:1)*d*l,h=a*("compact"===i?.88:1)*c*l,p=a*("compact"===i?.92:1)*c*l,m=t.getIconSizePresetConfig(t.state.iconSizePreset),f=t.baseIconDimensions||m.dimensions,g=t.baseIconGridSpacing||m.spacing,w=t.baseDesktopPadding||m.padding,x={width:o(Math.round(f.width*u),72,192),height:o(Math.round(f.height*u),64,176)},b={row:o(Math.round(g.row*h),96,256),column:o(Math.round(g.column*h),108,288)},y=(0,v.getSafeAreaInsets)(),k={top:o(Math.round(w.top*p),40,256),right:o(Math.round(w.right*p),16,220),bottom:o(Math.round(w.bottom*p),72,384),left:o(Math.round(w.left*p),16,220)},S={top:k.top+y.top,right:k.right+y.right,bottom:k.bottom+y.bottom,left:k.left+y.left},j=t.iconSizePresets.medium.dimensions,A=(null==j?void 0:j.width)?f.width/j.width:1,I=a*("compact"===i?.95:1),C=(.25*A*c).toFixed(3),P=(.375*A*c).toFixed(3),N=(.75*A*I).toFixed(3),_=Math.max(1.05,1.1*A*I).toFixed(3),E=o(Math.round(Math.round(.5*(f.width||96))*u),32,128),M={"--desktop-icon-width":"".concat(x.width,"px"),"--desktop-icon-height":"".concat(x.height,"px"),"--desktop-icon-padding":"".concat(C,"rem"),"--desktop-icon-gap":"".concat(P,"rem"),"--desktop-icon-font-size":"".concat(N,"rem"),"--desktop-icon-image":"".concat(E,"px"),"--desktop-icon-line-height":"".concat(_,"rem")},L=x.width!==t.iconDimensions.width||x.height!==t.iconDimensions.height||b.row!==t.iconGridSpacing.row||b.column!==t.iconGridSpacing.column||S.top!==t.desktopPadding.top||S.right!==t.desktopPadding.right||S.bottom!==t.desktopPadding.bottom||S.left!==t.desktopPadding.left;return t.desktopIconVariables=M,L&&(t.iconDimensions=x,t.iconGridSpacing=b,t.desktopPadding=S),L},this.handleViewportResize=()=>{this.configureTouchTargets(this.currentPointerIsCoarse),this.realignIconPositions();let e="number"==typeof window.innerWidth?window.innerWidth:0,t="number"==typeof window.innerHeight?window.innerHeight:0;this.handleViewportBucketChange(e);let i=(0,v.measureWindowTopOffset)(),n=this.state.closed_windows||{},s={...this.state.window_positions||{}},r=!1;Object.keys(n).forEach(o=>{if(!1!==n[o])return;let a="undefined"!=typeof document?document.getElementById(o):null,l=s[o];if(!l&&a){let e=(e=>{if(!e||!e.style)return null;let t=e=>{if("string"!=typeof e)return null;let t=parseFloat(e);return Number.isFinite(t)?t:null};if("function"==typeof e.style.getPropertyValue){let i=t(e.style.getPropertyValue("--window-transform-x")),n=t(e.style.getPropertyValue("--window-transform-y"));if(null!==i&&null!==n)return{x:i,y:n}}if("string"==typeof e.style.transform){let t=/translate\(([-\d.]+)px,\s*([-\d.]+)px\)/.exec(e.style.transform);if(t){let e=parseFloat(t[1]),i=parseFloat(t[2]);if(Number.isFinite(e)&&Number.isFinite(i))return{x:e,y:i}}}return null})(a);e&&(l=e,s[o]={...e})}if(!l)return;let d=a&&"function"==typeof a.getBoundingClientRect?a.getBoundingClientRect():null,c=(0,v.clampWindowPositionWithinViewport)(l,d,{viewportWidth:e,viewportHeight:t,topOffset:i});c&&(c.x!==l.x||c.y!==l.y)&&(s[o]={x:c.x,y:c.y},r=!0)}),r&&this.setWorkspaceState({window_positions:s},this.saveSession)},this.computeTouchCentroid=e=>{if(!e||0===e.length)return null;let t=Array.from(e),i=t.reduce((e,t)=>(e.x+=t.clientX,e.y+=t.clientY,e),{x:0,y:0});return{x:i.x/t.length,y:i.y/t.length}},this.setupGestureListeners=()=>{let e=this.desktopRef&&this.desktopRef.current?this.desktopRef.current:null;if(!e||(this.gestureRoot&&this.gestureRoot!==e&&this.teardownGestureListeners(),this.gestureListenersAttached))return;this.gestureListenersAttached=!0,this.gestureRoot=e;let t={passive:!0};e.addEventListener("pointerdown",this.handleShellPointerDown,t),e.addEventListener("pointermove",this.handleShellPointerMove,t),e.addEventListener("pointerup",this.handleShellPointerUp,t),e.addEventListener("pointercancel",this.handleShellPointerCancel,t),e.addEventListener("touchstart",this.handleShellTouchStart,t),e.addEventListener("touchmove",this.handleShellTouchMove,t),e.addEventListener("touchend",this.handleShellTouchEnd,t),e.addEventListener("touchcancel",this.handleShellTouchCancel,t)},this.teardownGestureListeners=()=>{let e=this.gestureRoot;e&&this.gestureListenersAttached&&(this.gestureListenersAttached=!1,e.removeEventListener("pointerdown",this.handleShellPointerDown),e.removeEventListener("pointermove",this.handleShellPointerMove),e.removeEventListener("pointerup",this.handleShellPointerUp),e.removeEventListener("pointercancel",this.handleShellPointerCancel),e.removeEventListener("touchstart",this.handleShellTouchStart),e.removeEventListener("touchmove",this.handleShellTouchMove),e.removeEventListener("touchend",this.handleShellTouchEnd),e.removeEventListener("touchcancel",this.handleShellTouchCancel),this.gestureRoot=null,this.gestureState.pointer=null,this.gestureState.overview=null)},this.handleShellPointerDown=e=>{if("touch"!==e.pointerType||!1===e.isPrimary)return;let t=e.target&&e.target.closest?e.target.closest(".opened-window"):null;t&&t.id&&(this.gestureState.pointer={pointerId:e.pointerId,windowId:t.id,startX:e.clientX,startY:e.clientY,lastX:e.clientX,lastY:e.clientY,startTime:"undefined"!=typeof performance?performance.now():Date.now()})},this.handleShellPointerMove=e=>{let t=this.gestureState.pointer;t&&t.pointerId===e.pointerId&&(t.lastX=e.clientX,t.lastY=e.clientY)},this.handleShellPointerUp=e=>{let t=this.gestureState.pointer;if(!t||t.pointerId!==e.pointerId||(this.gestureState.pointer=null,!t.windowId))return;let i=t.lastX-t.startX,n=t.lastY-t.startY,s=Math.abs(i),r=Math.abs(n),o=("undefined"!=typeof performance?performance.now():Date.now())-t.startTime;!(s<120||r>90||o>600||s/Math.max(o,1)<.35)&&this.dispatchWindowCommand(t.windowId,i>0?"ArrowRight":"ArrowLeft")&&this.focus(t.windowId)},this.handleShellPointerCancel=e=>{let t=this.gestureState.pointer;t&&t.pointerId===e.pointerId&&(this.gestureState.pointer=null)},this.handleShellTouchStart=e=>{if(e.touches&&e.touches.length>1&&(this.gestureState.pointer=null),!e.touches||3!==e.touches.length)return;let t=this.computeTouchCentroid(e.touches);t&&(this.gestureState.overview={startY:t.y,lastY:t.y,startTime:"undefined"!=typeof performance?performance.now():Date.now(),triggered:!1})},this.handleShellTouchMove=e=>{let t=this.gestureState.overview;if(!t)return;let i=this.computeTouchCentroid(e.touches);i&&(t.lastY=i.y)},this.handleShellTouchEnd=e=>{var t;let i=this.gestureState.overview;if(!i||e.touches&&e.touches.length>0)return;let n=i.startY-(null!=(t=i.lastY)?t:i.startY),s=("undefined"!=typeof performance?performance.now():Date.now())-i.startTime;(n>60||n>40&&s<400)&&!i.triggered&&(this.isOverlayOpen(ez)||this.openWindowSwitcher(),i.triggered=!0),this.gestureState.overview=null},this.handleShellTouchCancel=()=>{this.gestureState.overview=null},this.dispatchWindowCommand=(e,t)=>{if(!e)return!1;let i="undefined"!=typeof document?document.getElementById(e):null;if(!i)return!1;let n=new CustomEvent("super-arrow",{detail:t,bubbles:!0});return i.dispatchEvent(n),!0},this.getWindowStateForMenu=e=>{var t;if(!e||"undefined"==typeof document)return null;let i=document.getElementById(e);return i&&(null==(t=i.dataset)?void 0:t.windowState)||null},this.moveAppToWorkspace=(e,t)=>{var i;if(!e||"number"!=typeof t||t===this.state.activeWorkspace||t<0||t>=this.state.workspaces.length||this.isOverlayId(e)||!this.validAppIds.has(e)||(null==(i=this.state.closed_windows)?void 0:i[e])!==!1)return;let n=this.workspaceSnapshots[t]||this.createEmptyWorkspaceState(),s=this.state.window_positions||{},r=this.state.window_sizes||{},o=this.state.minimized_windows||{},a={...n,closed_windows:{...n.closed_windows,[e]:!1},minimized_windows:{...n.minimized_windows,[e]:!!o[e]},focused_windows:{...n.focused_windows,[e]:!1},window_positions:{...n.window_positions,...s[e]?{[e]:{...s[e]}}:{}},window_sizes:{...n.window_sizes,...r[e]?{[e]:{...r[e]}}:{}}};this.workspaceSnapshots[t]=a;let l=(this.workspaceStacks[this.state.activeWorkspace]||[]).filter(t=>t!==e),d=[e,...(this.workspaceStacks[t]||[]).filter(t=>t!==e)];this.workspaceStacks[this.state.activeWorkspace]=l,this.workspaceStacks[t]=d,this.setWorkspaceState(t=>{let i={...t.closed_windows,[e]:!0};return{closed_windows:i,minimized_windows:{...t.minimized_windows,[e]:!1},focused_windows:{...t.focused_windows,[e]:!1}}},()=>{this.broadcastWorkspaceState(),this.giveFocusToLastApp()})},this.updateWorkspaceSnapshots=e=>{let t=new Set(Object.keys(e.closed_windows||{}));this.workspaceSnapshots=this.workspaceSnapshots.map((i,n)=>{let s=i||this.createEmptyWorkspaceState();return n===this.state.activeWorkspace?this.cloneWorkspaceState(e):{focused_windows:this.mergeWorkspaceMaps(s.focused_windows,e.focused_windows,t),closed_windows:this.mergeWorkspaceMaps(s.closed_windows,e.closed_windows,t),minimized_windows:this.mergeWorkspaceMaps(s.minimized_windows,e.minimized_windows,t),window_positions:this.mergeWorkspaceMaps(s.window_positions,e.window_positions,t),window_sizes:this.mergeWorkspaceMaps(s.window_sizes,e.window_sizes,t)}})},this.getWorkspaceWindows=e=>{let t=this.workspaceSnapshots[e],i=e===this.state.activeWorkspace?this.state:t||this.createEmptyWorkspaceState(),n=i.closed_windows||{},s=i.minimized_windows||{},r=i.focused_windows||{},o=i.window_positions||{},a=i.window_sizes||{},l=Object.keys(n).filter(e=>!1===n[e]),d=(this.workspaceStacks[e]||[]).filter(e=>l.includes(e));return l.forEach(e=>{d.includes(e)||d.push(e)}),d.map(e=>{let t=this.getAppById(e);if(!t)return null;let i=o[e]||{},n=a[e]||{},l=n.width&&n.width>0?n.width:t.defaultWidth||800,d=n.height&&n.height>0?n.height:t.defaultHeight||600,c=t.icon?t.icon.replace(/^\.\//,"/"):"";return{id:e,title:t.title||t.name||e,icon:c,isMinimized:!!s[e],isFocused:!!r[e],x:i.x||0,y:i.y||0,w:l,h:d}}).filter(Boolean)},this.getWorkspaceSummaries=()=>this.state.workspaces.map(e=>{let t=Object.values((this.workspaceSnapshots[e.id]||this.createEmptyWorkspaceState()).closed_windows||{}).filter(e=>!1===e).length,i=this.getWorkspaceWindows(e.id);return{id:e.id,label:e.label,openWindows:t,windows:i}}),this.getPinnedAppSummaries=()=>{let e=this.getPinnedAppIds();if(!e.length)return[];let{closed_windows:t={},minimized_windows:i={},focused_windows:n={}}=this.state;return e.map(e=>{let s=this.getAppById(e);if(!s)return null;let r="string"==typeof s.icon?s.icon.replace("./","/"):"",o=!1===t[e];return{id:e,title:s.title,icon:r,isRunning:o,isFocused:!!n[e],isMinimized:!!i[e],mobilePinned:!!s.taskbarMobilePinned}}).filter(Boolean)},this.getRunningAppSummaries=()=>{let{closed_windows:e={},minimized_windows:t={},focused_windows:i={},overlayWindows:n={},appBadges:s={}}=this.state,r=[],o=new Map(f.default.map(e=>[e.id,e])),a=Object.keys(e).filter(t=>!1===e[t]);return this.getNormalizedTaskbarOrder(a,this.state.taskbarOrder||a).forEach(e=>{let n=o.get(e);if(!n)return;let a=s[e],l={id:e,title:n.title,icon:n.icon.replace("./","/"),isFocused:!!i[e],isMinimized:!!t[e]};a&&(l.badge={...a}),r.push(l)}),eE.forEach(o=>{let a=(null==n?void 0:n[o.id])||{};if(!0!==a.open&&!1!==e[o.id])return;let l="boolean"==typeof a.minimized?a.minimized:!!t[o.id],d="boolean"==typeof a.focused?a.focused:!!i[o.id],c=s[o.id],u={id:o.id,title:o.title,icon:o.icon,isFocused:d,isMinimized:l,isOverlay:!0};c&&(u.badge={...c}),r.push(u)}),r},this.setWorkspaceState=(e,t)=>{"function"==typeof e?this.setState(t=>{let i=e(t);return this.commitWorkspacePartial(i,t.activeWorkspace),i},t):(this.commitWorkspacePartial(e),this.setState(e,t))},this.setIconSizePreset=function(e){var i;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{bucketId:s,persist:r=!0,broadcast:o=!0}=n||{},a=s||t.state.iconSizeBucket||"gte-1024",l=e&&(null==(i=t.iconSizePresets)?void 0:i[e])?e:"medium",d=t.getIconSizePresetConfig(l);if(t.baseIconDimensions={...d.dimensions},t.baseIconGridSpacing={...d.spacing},t.baseDesktopPadding={...d.padding},r&&t.persistIconSizePreset(l,a),!t._isMounted){t.state={...t.state,iconSizePreset:l,iconSizeBucket:a};return}let c=()=>{t.applyIconLayoutFromSettings(t.props)&&t.realignIconPositions(),o&&t.broadcastIconSizePreset(l,a),t.broadcastWorkspaceState()};if(l===t.state.iconSizePreset&&a===t.state.iconSizeBucket)return void c();t.setState({iconSizePreset:l,iconSizeBucket:a},c)},this.loadDesktopIconPositions=()=>{if(!z.safeLocalStorage)return{};try{let e=z.safeLocalStorage.getItem("desktop_icon_positions");return e?JSON.parse(e):{}}catch(e){return{}}},this.persistIconPositions=()=>{if(!z.safeLocalStorage)return;let e=this.state.desktop_icon_positions||{};try{z.safeLocalStorage.setItem("desktop_icon_positions",JSON.stringify(e)),this.savedIconPositions={...e}}catch(e){}},this.persistFolderContents=e=>{var t;let i=null!=(t=null!=e?e:this.state.folder_contents)?t:{},n={};if(i&&"object"==typeof i&&Object.entries(i).forEach(e=>{let[t,i]=e;if(!t)return;if(!Array.isArray(i)){n[t]=[];return}let s=i.map(e=>eC(e)).filter(Boolean);n[t]=s}),z.safeLocalStorage)try{z.safeLocalStorage.setItem(eI,JSON.stringify(n||{}))}catch(e){}},this.loadWindowSizes=()=>eN(this.windowSizeStorageKey),this.persistWindowSizes=e=>{let t=eP();if(t)try{t.setItem(this.windowSizeStorageKey,JSON.stringify(e))}catch(e){}},this.ensureIconPositions=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Array.isArray(e)&&t.setState(i=>{let n=i.desktop_icon_positions||{},s=t.resolveIconLayout(e,n);return t.areIconLayoutsEqual(n,s)?null:{desktop_icon_positions:s}},()=>{t.persistIconPositions()})},this.getAllFolderItemIds=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.state.folder_contents,i=new Set;return e&&"object"==typeof e&&Object.values(e).forEach(e=>{Array.isArray(e)&&e.forEach(e=>{if(e){if("string"==typeof e)return void i.add(e);"object"==typeof e&&"string"==typeof e.id&&i.add(e.id)}})}),i},this.isFolderApp=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e&&!i)return!1;let n="string"==typeof e?e:(null==e?void 0:e.id)||i;if(!n)return!1;if(e&&"object"==typeof e&&e.isFolder)return!0;let s=t.state.folder_contents||{};return Object.prototype.hasOwnProperty.call(s,n)},this.ensureFolderEntry=e=>{e&&this.setState(t=>{let i=t.folder_contents||{};return Object.prototype.hasOwnProperty.call(i,e)?null:{folder_contents:{...i,[e]:[]}}},this.persistFolderContents)},this.getFolderDropTarget=(e,t)=>{if(!e||!Number.isFinite(e.clientX)||!Number.isFinite(e.clientY))return null;let i=this.getDesktopRect();if(!i)return null;let n=e.clientX-i.left,s=e.clientY-i.top;if(!Number.isFinite(n)||!Number.isFinite(s))return null;let r=this.state.desktop_apps||[];for(let e=0;e<r.length;e+=1){let i=r[e];if(!i||i===(null==t?void 0:t.id))continue;let o=this.getAppById(i);if(!this.isFolderApp(o,i))continue;let a=this.getIconBounds(i,e);if(!a)continue;let l=n>=a.left&&n<=a.left+a.width,d=s>=a.top&&s<=a.top+a.height;if(l&&d)return{type:"folder",id:i}}return null},this.moveIconIntoFolder=(e,t)=>{if(!e||!t)return;let i=this.getAppById(e);i&&this.setState(n=>{let s=Array.isArray(n.desktop_apps)?n.desktop_apps.filter(t=>t!==e):[],r={...n.desktop_icon_positions||{}};r[e]&&delete r[e];let o=n.folder_contents||{},a=Array.isArray(o[t])?o[t].slice():[];a.some(t=>!!t&&("string"==typeof t?t===e:t.id===e))||a.push({id:e,title:i.title||i.name||e,icon:i.icon});let l={...o,[t]:a},d=n.selectedIcons instanceof Set?new Set(n.selectedIcons):new Set;d.delete(e);let c=n.selectionAnchorId;if(d.size){if(c===e){let e=d.values().next().value;c=null!=e?e:null}}else c=null;return{desktop_apps:s,desktop_icon_positions:r,folder_contents:l,selectedIcons:d,selectionAnchorId:c,draggingIconId:null}},()=>{this.persistIconPositions(),this.persistFolderContents()})},this.getFolderContext=e=>{var t,i,n;if(!e)return null;let s=null==(t=this.state.folder_contents)?void 0:t[e];if(!Array.isArray(s)){let t=(null==(n=this.folderMetadata)?void 0:n.get(e))||null,i=this.getAppById(e);return{folderId:e,folderItems:[],folderTitle:(null==t?void 0:t.title)||(null==i?void 0:i.title)||e,folderDescription:null==t?void 0:t.description}}let r=s.map(e=>e?"string"==typeof e?{id:e,title:e}:{id:e.id,title:e.title||e.id,icon:e.icon}:null).filter(Boolean),o=(null==(i=this.folderMetadata)?void 0:i.get(e))||null,a=this.getAppById(e);return{folderId:e,folderItems:r,folderTitle:(null==o?void 0:o.title)||(null==a?void 0:a.title)||e,folderDescription:null==o?void 0:o.description}},this.getDesktopRect=()=>this.desktopRef&&this.desktopRef.current?this.desktopRef.current.getBoundingClientRect():null,this.getDesktopBounds=()=>{let e=this.getDesktopRect();return e?{width:e.width,height:e.height}:{width:window.innerWidth,height:window.innerHeight}},this.computeGridMetrics=()=>{let{width:e,height:t}=this.getDesktopBounds();return{iconsPerColumn:Math.max(1,Math.floor(Math.max(this.iconDimensions.height,t-(this.desktopPadding.top+this.desktopPadding.bottom))/this.iconGridSpacing.row)),offsetX:this.desktopPadding.left,offsetY:this.desktopPadding.top,columnSpacing:this.iconGridSpacing.column,rowSpacing:this.iconGridSpacing.row}},this.computeGridPosition=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,{iconsPerColumn:i,offsetX:n,offsetY:s,columnSpacing:r,rowSpacing:o}=t.computeGridMetrics(),a=Math.floor(e/i);return t.clampIconPosition(n+a*r,s+e%i*o)},this.normalizeBadgeTone=e=>"string"!=typeof e?"accent":eT[e.trim().toLowerCase()]||"accent",this.formatBadgeCount=(e,t)=>{let i=Number(e);if(!Number.isFinite(i))return null;let n=Math.max(0,Math.floor(i)),s=Number.isFinite(t)&&t>0?Math.floor(t):99;return{count:n,displayValue:n>s?"".concat(s,"+"):"".concat(n),max:s}},this.normalizeBadgeMetadata=e=>{var t,i,n,s,r,o,a,l,d,c,u;if(!e||"object"!=typeof e)return null;let h="string"==typeof e.type?e.type.trim().toLowerCase():null;h||(h=Number.isFinite(e.count)||Number.isFinite(e.value)||Number.isFinite(e.total)||Number.isFinite(e.notifications)?"count":Number.isFinite(e.progress)||Number.isFinite(e.current)||Number.isFinite(e.done)||Number.isFinite(e.completed)?"ring":"dot"),"progress"===h&&(h="ring");let p=this.normalizeBadgeTone(e.tone),m=!!e.persistOnFocus,f=void 0===e.pulse?void 0:!!e.pulse;if("count"===h){let r=null!=(s=null!=(n=null!=(i=null!=(t=e.count)?t:e.value)?i:e.total)?n:e.notifications)?s:e.number,o=this.formatBadgeCount(r,e.max);if(!o)return null;let{count:a,displayValue:l,max:d}=o,c="string"==typeof e.label&&e.label.trim()?e.label.trim():1===a?"1 notification":"".concat(l," notifications");return{type:"count",tone:p,count:a,displayValue:l,max:d,label:c,pulse:void 0!==f&&f,persistOnFocus:m}}if("ring"===h){let t=null!=(d=null!=(l=null!=(a=null!=(o=null!=(r=e.progress)?r:e.value)?o:e.current)?a:e.done)?l:e.completed)?d:0;if(!Number.isFinite(t))return null;let i=null!=(u=null!=(c=e.max)?c:e.total)?u:t>1?100:1,n=eO(Number(Number.isFinite(i)&&i>0?t/i:t>1?t/100:t),0,1),s="string"==typeof e.displayValue&&e.displayValue.trim()?e.displayValue.trim():"".concat(Math.round(100*n),"%"),h="string"==typeof e.label&&e.label.trim()?e.label.trim():"".concat(s," complete");return{type:"ring",tone:p,progress:n,displayValue:s,label:h,pulse:void 0===f?n<1:f,persistOnFocus:m}}return{type:"dot",tone:p,label:"string"==typeof e.label&&e.label.trim()?e.label.trim():"Attention needed",pulse:void 0===f||f,persistOnFocus:m}},this.areAppBadgesEqual=(e,t)=>{if(e===t)return!0;if(!e||!t||e.type!==t.type||e.tone!==t.tone||!!e.pulse!=!!t.pulse||!!e.persistOnFocus!=!!t.persistOnFocus||(e.displayValue||t.displayValue)&&e.displayValue!==t.displayValue||(e.label||t.label)&&e.label!==t.label||("number"==typeof e.count||"number"==typeof t.count)&&e.count!==t.count||("number"==typeof e.max||"number"==typeof t.max)&&e.max!==t.max)return!1;if(("number"==typeof e.progress||"number"==typeof t.progress)&&Math.abs(("number"==typeof e.progress?e.progress:0)-("number"==typeof t.progress?t.progress:0))>5e-4)return!1;return!0},this.clearAppBadge=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return;let n=!!i.force;t.setState(t=>{let i=t.appBadges||{},s=i[e];if(!s||!n&&s.persistOnFocus)return null;let r={...i};return delete r[e],{appBadges:r}})},this.handleAppBadgeEvent=e=>{let t=(null==e?void 0:e.detail)||{},i="string"==typeof t.appId?t.appId:"";if(!i||!this.validAppIds.has(i))return;if(!0===t.clear)return void this.clearAppBadge(i,{force:!0});let n=t.badge;if(void 0===n){let{appId:e,clear:i,...s}=t||{};n=s}let s=this.normalizeBadgeMetadata(n);if(!s)return void this.clearAppBadge(i,{force:!0});this.setState(e=>{let t=e.appBadges||{},n=t[i];return n&&this.areAppBadgesEqual(n,s)?null:{appBadges:{...t,[i]:s}}})},this.initializeDefaultFolders=e=>{let t={...this.state.folder_contents||{}},i=!1;if(g.DEFAULT_DESKTOP_FOLDERS.forEach(e=>{let n=e.id;if(!n)return;if(!Object.prototype.hasOwnProperty.call(t,n)){let s=Array.isArray(e.items)?e.items.map(e=>{let t=this.getAppById(e);return t?{id:t.id,title:t.title||t.id,icon:t.icon}:null}).filter(Boolean):[];t[n]=s,i=!0;return}let s=t[n];if(!Array.isArray(s)){t[n]=[],i=!0;return}let r=s.map(e=>eC(e)).filter(Boolean),o=r.length!==s.length,a=r.some((e,t)=>{let i=s[t];return!i||"string"==typeof i||i.id!==e.id||i.title!==e.title||i.icon!==e.icon});(o||a)&&(t[n]=r,i=!0)}),i)return void this.setState({folder_contents:t},()=>{this.persistFolderContents(t),"function"==typeof e&&e()});"function"==typeof e&&e()},this.resolveOverlayId=e=>{var t,i;if(!e)return null;if(null==(t=this.overlayRegistry)?void 0:t.has(e))return e;let n=null==e_?void 0:e_[e];return(null==n?void 0:n.id)&&(null==(i=this.overlayRegistry)?void 0:i.has(n.id))?n.id:null},this.isOverlayId=e=>!!this.resolveOverlayId(e),this.getOverlayMeta=e=>{var t;let i=this.resolveOverlayId(e);return i&&(null==(t=this.overlayRegistry)?void 0:t.get(i))||null},this.buildOverlayStateMap=(e,t,i)=>{var n;let s=this.resolveOverlayId(t)||t,r={...e&&e[s]||{},...i||{}},o=null==(n=Object.entries(e_).find(e=>{let[,t]=e;return t.id===s}))?void 0:n[0],a={...e,[s]:r};return o&&(a[o]=r),a},this.isOverlayOpen=e=>{var t,i;let n=this.resolveOverlayId(e);return!!n&&!!(null==(i=this.state.overlayWindows)||null==(t=i[n])?void 0:t.open)},this.isAnyOverlayActive=()=>{let e=this.state.overlayWindows||{};return eE.some(t=>{let{id:i}=t,n=e[i];return(null==n?void 0:n.open)&&!(null==n?void 0:n.minimized)})},this.getLauncherState=()=>{var e;return(null==(e=this.state.overlayWindows)?void 0:e[eM])||null},this.normalizePaletteIconPath=e=>{if(!e||"string"!=typeof e)return;if(/^(https?:|data:)/i.test(e))return e;let t=e.replace(/^\.\//,"").replace(/^\/+/,"");if(t)return t.startsWith("/")?t:"/".concat(t)},this.getCommandPaletteAppItems=()=>f.default.filter(e=>!e.disabled).map(e=>({id:e.id,title:e.title,icon:this.normalizePaletteIconPath(e.icon),subtitle:void 0,keywords:[e.id,e.title].filter(Boolean)})),this.getCommandPaletteRecentWindows=()=>{let e=this.getActiveStack(),t=new Set,i=this.state.overlayWindows||{},n=[];return e.forEach(e=>{if(!e||t.has(e))return;if(t.add(e),this.isOverlayId(e)){if(!(i[e]||{}).open)return;let t=this.getOverlayMeta(e);if(!t)return;n.push({id:e,title:t.title||e,icon:this.normalizePaletteIconPath(t.icon),subtitle:"System overlay",keywords:[e,t.title,"overlay"].filter(Boolean)});return}if(!1!==(this.state.closed_windows||{})[e])return;let s=this.getAppById(e);s&&n.push({id:e,title:s.title||e,icon:this.normalizePaletteIconPath(s.icon),subtitle:"Open window",keywords:[e,s.title,"window"].filter(Boolean)})}),n},this.getCommandPaletteSettingsActions=()=>{let e=[{id:"command-open-settings",title:"Open Settings",subtitle:"Launch the settings application",icon:this.normalizePaletteIconPath("/themes/Yaru/apps/gnome-control-center.svg"),keywords:["settings","preferences","control"],data:{action:"open-settings",target:"settings"}}];return[{preset:"small",title:"Use small desktop icons",keywords:["small","icons","desktop"]},{preset:"medium",title:"Use medium desktop icons",keywords:["medium","icons","desktop"]},{preset:"large",title:"Use large desktop icons",keywords:["large","icons","desktop"]}].forEach(t=>{let{preset:i,title:n,keywords:s}=t;this.state.iconSizePreset!==i&&e.push({id:"command-set-icon-size-".concat(i),title:n,subtitle:"Desktop setting",icon:this.normalizePaletteIconPath("/themes/Yaru/system/user-desktop.png"),keywords:["icon size",...s],data:{action:"set-icon-size",preset:i}})}),e},this.openCommandPalette=()=>{this.openOverlay(eD,{transitionState:"entered"},()=>{this.focus(eD)})},this.closeCommandPalette=()=>{this.closeOverlay(eD,void 0,()=>{let e=this.getActiveStack(),t=e.indexOf(eD);-1!==t&&e.splice(t,1),this.setState(e=>({focused_windows:{...e.focused_windows,[eD]:!1}}),()=>{this.giveFocusToLastApp()})})},this.toggleCommandPalette=()=>{this.isOverlayOpen(eD)?this.closeCommandPalette():this.openCommandPalette()},this.isCommandPaletteShortcut=e=>{if(!e||"object"!=typeof e||e.repeat)return!1;let t=e.key||"",i=e.code||"";return(" "===t||"Spacebar"===t||"Space"===t||"Space"===i)&&!e.altKey&&!e.shiftKey&&(this.commandPaletteUsesMeta?!!e.metaKey:!!e.ctrlKey)},this.handleCommandPaletteAction=e=>{var t,i,n;if(!e||"object"!=typeof e)return!1;let s=null==e||null==(t=e.data)?void 0:t.action;if("open-settings"===s)return this.openApp("settings"),!0;if("set-icon-size"===s){let t=null==e||null==(i=e.data)?void 0:i.preset;if(t&&(null==(n=this.iconSizePresets)?void 0:n[t]))return this.setIconSizePreset(t),!0}return!1},this.handleCommandPaletteSelect=e=>{if(e&&"object"==typeof e){if("action"===e.type){this.handleCommandPaletteAction(e)&&this.closeCommandPalette();return}e.id&&this.openApp(e.id),this.closeCommandPalette()}},this.syncOverlayWindowFlags=(e,t,i)=>{let n=this.resolveOverlayId(e)||e;if(!n){"function"==typeof i&&i();return}let{closed:s,minimized:r,focused:o}=t||{},a=!1;this.setState(e=>{let t={};if("boolean"==typeof s){let i=e.closed_windows||{};Object.prototype.hasOwnProperty.call(i,n)&&i[n]===s||(t.closed_windows={...i,[n]:s})}if("boolean"==typeof r){let i=e.minimized_windows||{};Object.prototype.hasOwnProperty.call(i,n)&&i[n]===r||(t.minimized_windows={...i,[n]:r})}if("boolean"==typeof o){let i=e.focused_windows||{};Object.prototype.hasOwnProperty.call(i,n)&&i[n]===o||(t.focused_windows={...i,[n]:o})}if(!Object.keys(t).length)return null;a=!0;let i={closed_windows:t.closed_windows||e.closed_windows,minimized_windows:t.minimized_windows||e.minimized_windows,focused_windows:t.focused_windows||e.focused_windows};return this.commitWorkspacePartial(i,e.activeWorkspace),t},()=>{"function"==typeof i&&i()}),a||"function"!=typeof i||i()},this.openOverlay=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,s=t.resolveOverlayId(e);s&&(t.recentlyClosedOverlays.delete(s),t.promoteWindowInStack(s),t.updateOverlayState(s,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="function"==typeof i?i({...e}):i,n={...e,open:!0,minimized:!1,focused:!0};if(s===eM){let i=e.transitionState;n.transitionState=(null==t?void 0:t.transitionState)||("entered"===i?"entered":"entering")}return t&&"object"==typeof t?{...n,...t}:n}),t.syncOverlayWindowFlags(s,{closed:!1,minimized:!1,focused:!0},()=>{t.focus(s),"function"==typeof n&&n()}))},this.toggleOverlayMinimize=e=>{var t;let i=this.resolveOverlayId(e);i&&((null==(t=this.state.minimized_windows)?void 0:t[i])?this.openOverlay(i,{transitionState:"entered"}):this.minimizeOverlay(i))},this.toggleOverlayMaximize=e=>{var t=this;let i=this.resolveOverlayId(e);i&&(this.updateOverlayState(i,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={...t.getOverlayDefaults(i),...e},s=!n.maximized;return{...n,open:!0,minimized:!1,maximized:s,focused:!0,transitionState:i===eM?n.transitionState||"entered":n.transitionState}}),this.syncOverlayWindowFlags(i,{closed:!1,minimized:!1,focused:!0}))},this.minimizeOverlay=e=>{var t;let i=this.resolveOverlayId(e);if(!i)return;let n=this.getOverlayDefaults(i),s=null==(t=Object.entries(e_).find(e=>{let[,t]=e;return t.id===i}))?void 0:t[0];this.setState(e=>{var t,r,o;let a=e.overlayWindows||{},l=a[i]?{...n,...a[i]}:{...n},d={...l,open:!0,minimized:!0,maximized:!1,focused:!1},c={...e.closed_windows||{},[i]:!1},u={...e.minimized_windows||{},[i]:!0},h={...e.focused_windows||{},[i]:!1},p=l.open===d.open&&l.minimized===d.minimized&&l.maximized===d.maximized&&l.focused===d.focused,m=(null==(t=e.closed_windows)?void 0:t[i])===c[i]&&(null==(r=e.minimized_windows)?void 0:r[i])===u[i]&&(null==(o=e.focused_windows)?void 0:o[i])===h[i];if(p&&m)return null;this.commitWorkspacePartial({closed_windows:c,minimized_windows:u,focused_windows:h},e.activeWorkspace);let f={...a,[i]:d};return s&&(f[s]=d),{overlayWindows:f,closed_windows:c,minimized_windows:u,focused_windows:h}},()=>{this.giveFocusToLastApp()})},this.restoreOverlay=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;t.openOverlay(e,i,n)},this.closeOverlay=function(e){var i;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0,r=t.resolveOverlayId(e);if(!r)return;t.recentlyClosedOverlays.add(r);let o=t.getActiveStack(),a=o.indexOf(r);-1!==a&&o.splice(a,1),(null==(i=t.windowPreviewCache)?void 0:i.has(r))&&t.windowPreviewCache.delete(r),t.updateOverlayState(r,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="function"==typeof n?n({...e}):n,i={...e,open:!1,minimized:!1,maximized:!1,focused:!1};return(r===eM&&(i.transitionState=t&&"object"==typeof t&&t.transitionState||"exiting"),t&&"object"==typeof t)?{...i,...t}:i}),t.syncOverlayWindowFlags(r,{closed:!0,minimized:!1,focused:!1},()=>{t.giveFocusToLastApp(),t.saveSession(),"function"==typeof s&&s()}),t.clearAppBadge(e,{force:!0})},this.getAppById=e=>{var t;if(!(null==(t=this.appMap)?void 0:t.has(e))){let t=f.default.find(t=>t.id===e);t&&(this.appMap.set(e,t),this.validAppIds.add(e))}return this.appMap.get(e)},this.buildWindowShelfEntry=e=>{let t=this.getAppById(e);if(!t)return null;let i=t.title||t.name||e;return{id:e,title:i,icon:"string"==typeof t.icon?t.icon:void 0}},this.getMinimizedWindowEntries=()=>{let e=this.state.closed_windows||{},t=this.state.minimized_windows||{},i=[];return Object.keys(t).forEach(n=>{if(!t[n]||!this.validAppIds.has(n))return;if(this.isOverlayId(n)){var s;let e=null==(s=this.state.overlayWindows)?void 0:s[n];if(!e||!1===e.open)return}else if(e[n])return;let r=this.buildWindowShelfEntry(n);r&&i.push(r)}),i},this.getClosedWindowOrderMap=()=>{let e=new Map;if(!z.safeLocalStorage)return e;try{let t=z.safeLocalStorage.getItem("window-trash");if(!t)return e;let i=JSON.parse(t);if(!Array.isArray(i))return e;i.forEach(t=>{if(t&&"string"==typeof t.id){let i=Number(t.closedAt);e.set(t.id,Number.isFinite(i)?i:0)}})}catch(e){}return e},this.getClosedWindowEntries=()=>{let e=this.state.closed_windows||{},t=this.getClosedWindowOrderMap(),i=[];return Object.keys(e).forEach(n=>{if(!e[n]||!this.validAppIds.has(n)||this.isOverlayId(n)&&!this.recentlyClosedOverlays.has(n))return;let s=this.buildWindowShelfEntry(n);if(s){let e=t.has(n)?t.get(n):0;i.push({...s,closedAt:e})}}),i.sort((e,t)=>(t.closedAt||0)-(e.closedAt||0)),i.map(e=>{let{id:t,title:i,icon:n}=e;return{id:t,title:i,icon:n}})},this.getDesktopAppIndex=e=>(this.state.desktop_apps||[]).indexOf(e),this.describeKeyboardIconPosition=e=>{if(!this.isValidIconPosition(e))return{column:null,row:null};let t=this.computeGridMetrics(),i=Math.max(t.columnSpacing||0,1),n=Math.max(t.rowSpacing||0,1);return{column:Math.max(1,Math.round((e.x-t.offsetX)/i)+1),row:Math.max(1,Math.round((e.y-t.offsetY)/n)+1)}},this.buildKeyboardMoveHint=(e,t,i)=>{var n;if(!e||(null==(n=this.state.disabled_apps)?void 0:n[e.id]))return;let s=e.title||e.name||"app";if(t){let e="";if(this.isValidIconPosition(i)){let{column:t,row:n}=this.describeKeyboardIconPosition(i);t&&n&&(e=" Current position column ".concat(t,", row ").concat(n,"."))}return"Move mode active for ".concat(s,". Use the arrow keys to reposition. Press Enter to place or Escape to cancel.").concat(e)}let r="";if(this.isValidIconPosition(i)){let{column:e,row:t}=this.describeKeyboardIconPosition(i);e&&t&&(r=" It is currently in column ".concat(e,", row ").concat(t,"."))}return"Press Enter to move ".concat(s," with the keyboard. Press Space to open it.").concat(r)},this.isValidIconPosition=e=>{if(!e)return!1;let{x:t,y:i}=e;return Number.isFinite(t)&&Number.isFinite(i)},this.getIconPositionKey=e=>this.isValidIconPosition(e)?"".concat(Math.round(e.x),":").concat(Math.round(e.y)):null,this.areIconLayoutsEqual=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.keys(e),s=Object.keys(i);return n.length===s.length&&n.every(n=>{let s=e[n],r=i[n];return!!t.isValidIconPosition(s)&&!!t.isValidIconPosition(r)&&s.x===r.x&&s.y===r.y})},this.areSetsEqual=(e,t)=>{if(e===t)return!0;let i=e instanceof Set?e:new Set(e||[]),n=t instanceof Set?t:new Set(t||[]);if(i.size!==n.size)return!1;for(let e of i)if(!n.has(e))return!1;return!0},this.areRectsEqual=(e,t)=>!e&&!t||!!e&&!!t&&e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height,this.rectsOverlap=(e,t)=>!!e&&!!t&&!(e.width<=0)&&!(e.height<=0)&&!(t.width<=0)&&!(t.height<=0)&&e.left<t.left+t.width&&e.left+e.width>t.left&&e.top<t.top+t.height&&e.top+e.height>t.top,this.getIconBounds=function(e,i){var n,s,r,o;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.state;if(!e)return null;let l=a.desktop_icon_positions||{},d=a.keyboardMoveState,c=d&&d.id===e&&d.position?d.position:l[e]||t.computeGridPosition(i);if(!t.isValidIconPosition(c))return null;let u=null!=(r=null==(n=t.iconDimensions)?void 0:n.width)?r:t.defaultIconDimensions.width,h=null!=(o=null==(s=t.iconDimensions)?void 0:s.height)?o:t.defaultIconDimensions.height;return{left:c.x,top:c.y,width:u,height:h}},this.calculateSelectionForState=function(e,i){var n;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!i)return null;let r=Array.isArray(e.desktop_apps)?e.desktop_apps:[],o=e.selectedIcons instanceof Set?e.selectedIcons:new Set,a=null!=(n=e.selectionAnchorId)?n:null,l=!!s.multi,d=!!s.range,c=a,u=null;if(l||d){if(d)if(r.length){let e=c;if(e&&r.includes(e)||(e=Array.from(o).find(e=>r.includes(e))||r[0]||i),r.includes(i)&&r.includes(e)){let t=r.indexOf(e),n=r.indexOf(i),[s,a]=t<=n?[t,n]:[n,t];u=l?new Set(o):new Set;for(let e=s;e<=a;e+=1)u.add(r[e]);c=e}else u=new Set(o)}else u=new Set(o);else if(l)if((u=new Set(o)).has(i)){if(u.delete(i),c===i){let e=u.values().next().value;c=null!=e?e:null}}else u.add(i),c=i}else u=new Set([i]),c=i;u||(u=new Set(o)),u.size||(c=null);let h=!t.areSetsEqual(o,u),p=c!==a&&(null!==c||null!==a);return{nextSelected:u,anchorId:c,changed:h,shouldUpdate:h||p}},this.applyKeyboardSelection=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.calculateSelectionForState(t.state,e,i);n&&n.shouldUpdate&&t.setState({selectedIcons:n.nextSelected,selectionAnchorId:n.nextSelected.size?n.anchorId:null})},this.buildMarqueeSelection=(e,t,i)=>{if(!t)return null;let n=Array.isArray(e.desktop_apps)?e.desktop_apps:[],s=(null==i?void 0:i.mode)==="add"?new Set((null==i?void 0:i.baseSelection)||[]):new Set;return n.length&&n.forEach((i,n)=>{let r=this.getIconBounds(i,n,e);r&&this.rectsOverlap(t,r)&&s.add(i)}),{nextSelected:s}},this.updateMarqueeSelection=(e,t)=>{this.setState(i=>{let n={};this.areRectsEqual(i.marqueeSelection,e)||(n.marqueeSelection=e);let s=this.buildMarqueeSelection(i,e,t);if(s){let e=i.selectedIcons instanceof Set?i.selectedIcons:new Set,o=s.nextSelected;if(this.areSetsEqual(e,o)||(n.selectedIcons=o),o&&o.size){let e=null==t?void 0:t.anchor,s=null;if(e&&o.has(e))s=e;else if(i.selectionAnchorId&&o.has(i.selectionAnchorId))s=i.selectionAnchorId;else{var r;s=null!=(r=o.values().next().value)?r:null}i.selectionAnchorId!==s&&(s||null!==i.selectionAnchorId)&&(n.selectionAnchorId=s)}else null!==i.selectionAnchorId&&(n.selectionAnchorId=null)}return Object.keys(n).length?n:null})},this.resolveIconLayout=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s={},r=new Set,o=(null==n?void 0:n.clampOnly)===!0,a=e=>{if(!t.isValidIconPosition(e))return null;let i=t.clampIconPosition(e.x,e.y),n=t.getIconPositionKey(i);return!n||r.has(n)?null:(r.add(n),i)},l=0;return e.forEach((e,n)=>{let d=[];if(i[e]&&d.push(i[e]),!o){var c;let i=null==(c=t.savedIconPositions)?void 0:c[e];i&&d.push(i)}let u=null;for(let e=0;e<d.length;e+=1){let t=a(d[e]);if(t){u=t;break}}u||(u=(e=>{let i=Math.max(e,l);for(;i<e+1e3;){let e=t.computeGridPosition(i),n=t.getIconPositionKey(e);if(n&&!r.has(n))return r.add(n),l=i+1,e;i+=1}let n=t.computeGridPosition(e),s=t.getIconPositionKey(n);return s&&!r.has(s)&&r.add(s),n})(n)),s[e]=u}),s},this.clampIconPosition=(e,t)=>{let{width:i,height:n}=this.getDesktopBounds(),s=this.desktopPadding.left,r=Math.max(s,i-this.iconDimensions.width-this.desktopPadding.right),o=this.desktopPadding.top,a=Math.max(o,n-this.iconDimensions.height-this.desktopPadding.bottom);return{x:Math.round(Math.min(Math.max(e,s),r)),y:Math.round(Math.min(Math.max(t,o),a))}},this.snapIconPosition=(e,t)=>{let i=this.computeGridMetrics(),n=(e,t,i)=>{if(!Number.isFinite(e)||!Number.isFinite(t)||!Number.isFinite(i)||i<=0)return e;let n=Math.round((e-t)/i)*i;return t+n};return{x:n(e,i.offsetX,i.columnSpacing),y:n(t,i.offsetY,i.rowSpacing)}},this.calculateIconPosition=function(e,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.iconDragState;if(!n)return{x:0,y:0};let s=t.getDesktopRect();if(!s){let s=t.snapIconPosition(e-n.offsetX,i-n.offsetY);return t.clampIconPosition(s.x,s.y)}let r=e-s.left-n.offsetX,o=i-s.top-n.offsetY,a=t.snapIconPosition(r,o);return t.clampIconPosition(a.x,a.y)},this.updateIconPosition=function(e,i,n){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=t.clampIconPosition(i,n);if(s)return void t.setState(i=>{let n=i.desktop_icon_positions||{},s=Array.isArray(i.desktop_apps)?i.desktop_apps:[],o=t.resolveIconLayout(s,{...n,[e]:r}),a=!t.areIconLayoutsEqual(n,o),l=a?o:n;return a||null!==i.draggingIconId?{desktop_icon_positions:l,draggingIconId:null}:null},()=>{t.persistIconPositions()});t.setState(t=>{let i=t.desktop_icon_positions||{},n=i[e];return n&&n.x===r.x&&n.y===r.y?null:{desktop_icon_positions:{...i,[e]:r},draggingIconId:t.draggingIconId}})},this.startKeyboardIconMove=e=>{var t;if(!this.validAppIds.has(e)||(null==(t=this.state.disabled_apps)?void 0:t[e]))return;let i=this.state.desktop_icon_positions||{},n=this.getDesktopAppIndex(e),s=n>=0?this.computeGridPosition(n):this.computeGridPosition(0),r=i[e]||s,o=this.clampIconPosition(r.x,r.y);this.setState({keyboardMoveState:{id:e,origin:o,position:o}},()=>{this.announceKeyboardMoveStart(e,o)})},this.moveIconWithKeyboard=(e,t,i)=>{let n=this.computeGridMetrics(),s=(t||0)*(n.columnSpacing||0),r=(i||0)*(n.rowSpacing||0);(0!==s||0!==r)&&this.setState(t=>{let i=t.keyboardMoveState;if(!i||i.id!==e||!this.isValidIconPosition(i.position))return null;let n=i.position,o=this.clampIconPosition(n.x+s,n.y+r);return o.x===n.x&&o.y===n.y?null:{keyboardMoveState:{...i,position:o}}},()=>{let t=this.state.keyboardMoveState;if(!t||t.id!==e||!this.isValidIconPosition(t.position))return;let{position:i}=t;this.updateIconPosition(e,i.x,i.y,!1),this.announceKeyboardPosition(e,i)})},this.completeKeyboardIconMove=()=>{let e=this.state.keyboardMoveState;if(!e)return;let{id:t,position:i}=e;this.setState({keyboardMoveState:null},()=>{this.isValidIconPosition(i)?(this.updateIconPosition(t,i.x,i.y,!0),this.announceKeyboardPlacement(t,i)):this.announceKeyboardPlacement(t,null)})},this.cancelKeyboardIconMove=()=>{let e=this.state.keyboardMoveState;if(!e)return;let{id:t,origin:i}=e;this.setState({keyboardMoveState:null},()=>{this.isValidIconPosition(i)&&this.updateIconPosition(t,i.x,i.y,!1),this.announceKeyboardCancel(t)})},this.handleIconKeyDown=(e,t)=>{var i;if(!t)return;let n=t.id;if(!n||(null==(i=this.state.disabled_apps)?void 0:i[n]))return;let s=this.state.keyboardMoveState,r=s&&s.id===n,o=e.key,a=e.ctrlKey||e.metaKey,l=e.shiftKey;if(r)switch(o){case"ArrowUp":e.preventDefault(),this.moveIconWithKeyboard(n,0,-1);return;case"ArrowDown":e.preventDefault(),this.moveIconWithKeyboard(n,0,1);return;case"ArrowLeft":e.preventDefault(),this.moveIconWithKeyboard(n,-1,0);return;case"ArrowRight":e.preventDefault(),this.moveIconWithKeyboard(n,1,0);return;case"Enter":e.preventDefault(),this.completeKeyboardIconMove();return;case"Escape":e.preventDefault(),this.cancelKeyboardIconMove();return;case" ":case"Spacebar":e.preventDefault();return;default:return}if("Enter"===o){e.preventDefault(),this.startKeyboardIconMove(n);return}(" "===o||"Spacebar"===o)&&(e.preventDefault(),a||l?this.applyKeyboardSelection(n,{multi:a,range:l}):this.openApp(n))},this.handleIconBlur=(e,t)=>{let i=this.state.keyboardMoveState;i&&i.id===t&&this.completeKeyboardIconMove()},this.announce=e=>{this.liveRegionTimeout&&(clearTimeout(this.liveRegionTimeout),this.liveRegionTimeout=null),this.setState({liveRegionMessage:""}),e&&(this.liveRegionTimeout=setTimeout(()=>{this.setState({liveRegionMessage:e}),this.liveRegionTimeout=null},75))},this.announceKeyboardMoveStart=(e,t)=>{let i=this.getAppById(e);if(!i)return;let n=i.title||i.name||"app",s="";if(this.isValidIconPosition(t)){let{column:e,row:i}=this.describeKeyboardIconPosition(t);e&&i&&(s=" Starting position column ".concat(e,", row ").concat(i,"."))}this.announce("Moving ".concat(n,". Use arrow keys to reposition. Press Enter to place or Escape to cancel.").concat(s))},this.announceKeyboardPosition=(e,t)=>{let i=this.getAppById(e);if(!i||!this.isValidIconPosition(t))return;let{column:n,row:s}=this.describeKeyboardIconPosition(t);if(!n||!s)return;let r=i.title||i.name||"app";this.announce("".concat(r," moved to column ").concat(n,", row ").concat(s,"."))},this.announceKeyboardPlacement=(e,t)=>{let i=this.getAppById(e);if(!i)return;let n=i.title||i.name||"app";if(this.isValidIconPosition(t)){let{column:e,row:i}=this.describeKeyboardIconPosition(t);if(e&&i)return void this.announce("".concat(n," placed at column ").concat(e,", row ").concat(i,"."))}this.announce("".concat(n," position unchanged."))},this.announceKeyboardCancel=e=>{let t=this.getAppById(e);if(!t)return;let i=t.title||t.name||"app";this.announce("Cancelled moving ".concat(i,"."))},this.handleIconPointerEnter=e=>{this.setState(t=>t.hoveredIconId===e?null:{hoveredIconId:e})},this.handleIconPointerLeave=e=>{this.setState(t=>t.hoveredIconId!==e?null:{hoveredIconId:null})},this.handleDesktopPointerDown=e=>{var t,i;if(0!==e.button||e.target!==e.currentTarget)return;e.stopPropagation();let n=e.currentTarget;null==(t=n.setPointerCapture)||t.call(n,e.pointerId);let s=Array.from(this.state.selectedIcons instanceof Set?this.state.selectedIcons:[]),r=null!=(i=this.state.selectionAnchorId)?i:null,o=e.metaKey||e.ctrlKey,a=e.shiftKey;this.desktopSelectionState={pointerId:e.pointerId,container:n,rect:n.getBoundingClientRect(),startClientX:e.clientX,startClientY:e.clientY,moved:!1,baseSelection:s,mode:o?"add":"replace",anchor:r},o||a||!(s.length>0)||this.setState({selectedIcons:new Set,selectionAnchorId:null}),this.state.keyboardMoveState&&this.setState({keyboardMoveState:null}),null!==this.state.hoveredIconId&&this.setState({hoveredIconId:null})},this.handleDesktopPointerMove=e=>{let t=this.desktopSelectionState;if(!t||e.pointerId!==t.pointerId)return;e.stopPropagation(),e.preventDefault();let{clientX:i,clientY:n}=e;this.desktopMoveRaf&&cancelAnimationFrame(this.desktopMoveRaf),this.desktopMoveRaf=requestAnimationFrame(()=>{if(!this.desktopSelectionState)return;let e=this.desktopSelectionState,t=i-e.startClientX,s=n-e.startClientY;if(!e.moved){if(4>Math.abs(t)&&4>Math.abs(s))return;e.moved=!0}let r=e.rect,o=e=>{let t=e-r.left;return Number.isFinite(t)?Math.min(Math.max(t,0),Math.max(r.width,0)):0},a=e=>{let t=e-r.top;return Number.isFinite(t)?Math.min(Math.max(t,0),Math.max(r.height,0)):0},l=o(e.startClientX),d=a(e.startClientY),c=o(i),u=a(n);this.updateMarqueeSelection({left:Math.min(l,c),top:Math.min(d,u),width:Math.abs(c-l),height:Math.abs(u-d)},e)})},this.handleDesktopPointerUp=e=>{var t,i;let n=this.desktopSelectionState;n&&e.pointerId===n.pointerId&&(e.stopPropagation(),this.desktopMoveRaf&&(cancelAnimationFrame(this.desktopMoveRaf),this.desktopMoveRaf=null),null==(i=n.container)||null==(t=i.releasePointerCapture)||t.call(i,n.pointerId),this.desktopSelectionState=null,this.setState(e=>e.marqueeSelection?{marqueeSelection:null}:null))},this.handleDesktopPointerCancel=e=>{var t,i,n;let s=this.desktopSelectionState;if(!s)return;null==e||null==(t=e.stopPropagation)||t.call(e),this.desktopMoveRaf&&(cancelAnimationFrame(this.desktopMoveRaf),this.desktopMoveRaf=null),null==(n=s.container)||null==(i=n.releasePointerCapture)||i.call(n,s.pointerId),this.desktopSelectionState=null;let r=new Set(s.baseSelection||[]);this.setState(e=>{var t;let i={};return e.marqueeSelection&&(i.marqueeSelection=null),i.selectedIcons=r,i.selectionAnchorId=r.size&&null!=(t=r.values().next().value)?t:null,Object.keys(i).length?i:null})},this.handleIconPointerDown=(e,t)=>{var i;if(0!==e.button)return;e.stopPropagation();let n=e.currentTarget,s=n.getBoundingClientRect(),r=e.clientX-s.left,o=e.clientY-s.top;null==(i=n.setPointerCapture)||i.call(n,e.pointerId),this.preventNextIconClick=!1;let a={multi:e.metaKey||e.ctrlKey,range:e.shiftKey},l=!1;this.setState(e=>{let i={draggingIconId:t};e.keyboardMoveState&&(i.keyboardMoveState=null);let n=this.calculateSelectionForState(e,t,a);return n&&(l=n.changed,n.shouldUpdate&&(i.selectedIcons=n.nextSelected,i.selectionAnchorId=n.nextSelected.size?n.anchorId:null)),i});let d=null,c=this.state.desktop_icon_positions||{};if(c[t])d={...c[t]};else if(1){let e=window.getComputedStyle(n);d={x:parseFloat(e.left)||0,y:parseFloat(e.top)||0}}this.iconDragState={id:t,pointerId:e.pointerId,offsetX:r,offsetY:o,startX:e.clientX,startY:e.clientY,moved:!1,container:n,startPosition:d,lastPosition:d,selectionChangedOnPointerDown:l,multiSelectIntent:a.multi||a.range},this.attachIconKeyboardListeners()},this.handleIconPointerMove=e=>{if(!this.iconDragState||e.pointerId!==this.iconDragState.pointerId)return;e.preventDefault();let{clientX:t,clientY:i}=e;this.iconMoveRaf&&cancelAnimationFrame(this.iconMoveRaf),this.iconMoveRaf=requestAnimationFrame(()=>{let e=this.iconDragState;if(!e)return;let n=t-e.startX,s=i-e.startY;if(!e.moved){if(4>Math.abs(n)&&4>Math.abs(s))return;e.moved=!0}let r=this.calculateIconPosition(t,i,e);e.lastPosition=r,this.updateIconPosition(e.id,r.x,r.y,!1)})},this.handleIconPointerUp=e=>{var t,i;if(!this.iconDragState||e.pointerId!==this.iconDragState.pointerId)return;e.stopPropagation(),this.iconMoveRaf&&(cancelAnimationFrame(this.iconMoveRaf),this.iconMoveRaf=null);let n=this.iconDragState,s=n.moved,r=!!n.selectionChangedOnPointerDown,o=!!n.multiSelectIntent;if(this.iconDragState=null,null==(i=n.container)||null==(t=i.releasePointerCapture)||t.call(i,e.pointerId),this.detachIconKeyboardListeners(),s){if(e.preventDefault(),this.preventNextIconClick=!0,this.getTaskbarDropTarget(e)){this.pinAppAtPosition(n.id,null,!0),n.startPosition&&this.updateIconPosition(n.id,n.startPosition.x,n.startPosition.y,!0),this.setState({draggingIconId:null});return}let t=this.getFolderDropTarget(e,n);if(t&&"folder"===t.type)this.moveIconIntoFolder(n.id,t.id);else{let t=this.resolveDropPosition(e,n);this.updateIconPosition(n.id,t.x,t.y,!0),this.setState({draggingIconId:null})}return}e.preventDefault();let a="touch"===e.pointerType||!r&&!o&&!(e.ctrlKey||e.metaKey||e.shiftKey);this.setState({draggingIconId:null},()=>{a&&this.openApp(n.id)})},this.handleIconPointerCancel=e=>{this.iconDragState&&e.pointerId===this.iconDragState.pointerId&&(e.preventDefault(),this.iconMoveRaf&&(cancelAnimationFrame(this.iconMoveRaf),this.iconMoveRaf=null),this.cancelIconDrag(!0))},this.handleIconClickCapture=e=>{this.preventNextIconClick&&(e.stopPropagation(),e.preventDefault(),this.preventNextIconClick=!1)},this.realignIconPositions=()=>{let e=this.state.desktop_apps||[];e.length&&this.setState(t=>{let i=t.desktop_icon_positions||{},n=this.resolveIconLayout(e,i,{clampOnly:!0});return this.areIconLayoutsEqual(i,n)?null:{desktop_icon_positions:n}},()=>{this.persistIconPositions()})},this.switchWorkspace=e=>{if(e===this.state.activeWorkspace||e<0||e>=this.state.workspaces.length)return;let t=this.workspaceSnapshots[e]||this.createEmptyWorkspaceState(),i=this.getWorkspaceTheme(e);this.closeOverlay("windowSwitcher"),this.setState({activeWorkspace:e,focused_windows:{...t.focused_windows},closed_windows:{...t.closed_windows},minimized_windows:{...t.minimized_windows},window_positions:{...t.window_positions},switcherWindows:[],currentTheme:i},()=>{this.broadcastWorkspaceState(),this.giveFocusToLastApp(),this.isOverlayOpen(ez)&&this.closeOverlay(ez)})},this.shiftWorkspace=e=>{let{activeWorkspace:t,workspaces:i}=this.state,n=i.length;this.switchWorkspace((t+e+n)%n)},this.getActiveStack=()=>{let{activeWorkspace:e}=this.state;return this.workspaceStacks[e]||(this.workspaceStacks[e]=[]),this.workspaceStacks[e]},this.promoteWindowInStack=e=>{if(!e)return;let t=this.getActiveStack(),i=t.indexOf(e);-1!==i&&t.splice(i,1),t.unshift(e)},this.handleExternalWorkspaceSelect=e=>{var t;let i=null==e||null==(t=e.detail)?void 0:t.workspaceId;"number"==typeof i&&this.switchWorkspace(i)},this.broadcastWorkspaceState=()=>{let e=this.getRunningAppSummaries(),t=e.map(e=>e.id);if(t.length){let e=this.getNormalizedTaskbarOrder(t,this.state.taskbarOrder||t),i=this.state.taskbarOrder||[];(e.length!==i.length||e.some((e,t)=>e!==i[t]))&&this.setTaskbarOrder(e)}let i={workspaces:this.getWorkspaceSummaries(),activeWorkspace:this.state.activeWorkspace,runningApps:e,pinnedApps:{kind:eb,version:1,items:ey(this.getPinnedAppSummaries())},iconSizePreset:this.state.iconSizePreset};window.dispatchEvent(new CustomEvent("workspace-state",{detail:i}))},this.getOverlayDefaults=e=>(this.resolveOverlayId(e)||e)===eM||"launcher"===e?{open:!1,minimized:!1,maximized:!1,transitionState:"exited"}:{open:!1,minimized:!1,maximized:!1},this.getOverlayState=e=>{var t;let i=this.resolveOverlayId(e)||e,n=(null==(t=this.state)?void 0:t.overlayWindows)||{},s=n[i]||n[e],r=this.getOverlayDefaults(i);return s?{...r,...s}:{...r}},this.updateOverlayState=(e,t,i)=>{var n;let s=this.resolveOverlayId(e)||e;if(!s)return;let r=null==(n=Object.entries(e_).find(e=>{let[,t]=e;return t.id===s}))?void 0:n[0];this.setState(e=>{let i=e.overlayWindows||{},n=i[s]?{...i[s]}:this.getOverlayDefaults(s),o="function"==typeof t?t({...n}):{...n,...t||{}};if(!o||"object"!=typeof o)return null;let a={...n,...o},l=new Set([...Object.keys(n),...Object.keys(a)]),d=!1;for(let e of l)if(n[e]!==a[e]){d=!0;break}if(!d)return null;let c={...i,[s]:a};return r&&(c[r]=a),{overlayWindows:c}},i)},this.hydrateFromStorage=()=>{let e=this.loadPinnedAppIds(),t=this.loadStoredIconPresetMap(),i=this.loadWindowSizes(),n=(()=>{if(!z.safeLocalStorage)return{};try{let e=z.safeLocalStorage.getItem(eI);if(!e)return{};let t=JSON.parse(e);if(!t||"object"!=typeof t)return{};let i={};return Object.entries(t).forEach(e=>{let[t,n]=e;if(!t||!Array.isArray(n))return;let s=n.map(e=>eC(e)).filter(Boolean);i[t]=s}),i}catch(e){return{}}})(),s=this.loadTaskbarOrder();this.iconSizePresetMap=t,this.setState({pinnedAppIds:e,window_sizes:i,folder_contents:n,taskbarOrder:s,mounted:!0},()=>{this.applyPinnedFlags(e),this.syncFavouriteAppsWithPinned(new Set(e)),this.broadcastWorkspaceState()})},this.handleExternalTaskbarCommand=e=>{let t=(null==e?void 0:e.detail)||{},i=t.action||"toggle";if("reorderPinned"===i){Array.isArray(t.order)&&this.setPinnedAppIds(t.order);return}let n=t.appId;if("pin"===i){if(n){let e="string"==typeof t.targetId?t.targetId:null,i=!!t.insertAfter;this.pinAppAtPosition(n,e,i)}return}if("new-window"===i){n&&this.openApp(n);return}if("unpin"===i){if(n){let e=this.getPinnedAppIds();if(e.includes(n)){let t=e.filter(e=>e!==n);this.setPinnedAppIds(t)}}return}if("reorder"===i){if(Array.isArray(t.order)){let e=this.getCurrentRunningAppIds(),i=this.getNormalizedTaskbarOrder(e,t.order);this.setTaskbarOrder(i)}return}if("moveWorkspace"===i){let e="number"==typeof t.workspaceId?t.workspaceId:null;null!==e&&this.moveAppToWorkspace(t.appId,e);return}if(n&&this.validAppIds.has(n)){if(this.isOverlayId(n)){switch(i){case"minimize":this.state.minimized_windows[n]||this.minimizeOverlay(n);break;case"maximize":case"restore":this.toggleOverlayMaximize(n);break;case"focus":case"open":this.openOverlay(n,{transitionState:"entered"});break;default:this.state.minimized_windows[n]?this.openOverlay(n,{transitionState:"entered"}):this.state.focused_windows[n]?this.minimizeOverlay(n):this.openOverlay(n,{transitionState:"entered"})}return}switch(i){case"minimize":this.state.minimized_windows[n]||this.hasMinimised(n);break;case"maximize":this.dispatchWindowCommand(n,"ArrowUp");break;case"restore":this.dispatchWindowCommand(n,"ArrowDown");break;case"focus":this.focus(n);break;case"open":this.openApp(n);break;default:this.state.minimized_windows[n]?this.openApp(n):this.state.focused_windows[n]?this.hasMinimised(n):this.openApp(n)}}},this.attachIconKeyboardListeners=()=>{this.iconKeyListenerAttached||"undefined"==typeof document||(document.addEventListener("keydown",this.handleIconKeyboardCancel,!0),this.iconKeyListenerAttached=!0)},this.detachIconKeyboardListeners=()=>{this.iconKeyListenerAttached&&"undefined"!=typeof document&&(document.removeEventListener("keydown",this.handleIconKeyboardCancel,!0),this.iconKeyListenerAttached=!1)},this.handleIconKeyboardCancel=e=>{this.iconDragState&&"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),this.cancelIconDrag(!0))},this.cancelIconDrag=function(){var e,i;let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=t.iconDragState;if(s){if(null==(i=s.container)||null==(e=i.releasePointerCapture)||e.call(i,s.pointerId),t.iconDragState=null,t.detachIconKeyboardListeners(),n&&s.startPosition){let e=t.clampIconPosition(s.startPosition.x,s.startPosition.y);t.setState(t=>{let i=t.desktop_icon_positions||{},n=i[s.id];return n&&n.x===e.x&&n.y===e.y&&null===t.draggingIconId?{draggingIconId:null}:{desktop_icon_positions:{...i,[s.id]:e},draggingIconId:null}})}else t.setState({draggingIconId:null});t.preventNextIconClick=!1}},this.resolveDropPosition=(e,t)=>{if(Number.isFinite(null==e?void 0:e.clientX)&&Number.isFinite(null==e?void 0:e.clientY))return this.calculateIconPosition(e.clientX,e.clientY,t);let i=(null==t?void 0:t.lastPosition)||(null==t?void 0:t.startPosition)||{x:0,y:0},n=this.snapIconPosition(i.x,i.y);return this.clampIconPosition(n.x,n.y)},this.getTaskbarDropTarget=e=>{if("undefined"==typeof document||!Number.isFinite(null==e?void 0:e.clientX)||!Number.isFinite(null==e?void 0:e.clientY))return null;let t=document.querySelector(".main-navbar-vp");if(!t||"function"!=typeof t.getBoundingClientRect)return null;let i=t.getBoundingClientRect(),{clientX:n,clientY:s}=e;return n>=i.left&&n<=i.right&&s>=i.top&&s<=i.bottom?i:null},this.checkForNewFolders=()=>{let e=null===z.safeLocalStorage||void 0===z.safeLocalStorage?void 0:z.safeLocalStorage.getItem("new_folders");if(!e){null===z.safeLocalStorage||void 0===z.safeLocalStorage||z.safeLocalStorage.setItem("new_folders",JSON.stringify([]));return}try{let t=JSON.parse(e),i=[];t.forEach(e=>{let t="string"==typeof(null==e?void 0:e.id)?e.id:"",n="string"==typeof(null==e?void 0:e.name)?e.name:t,s=t||(n?n.replace(/\s+/g,"-").toLowerCase():""),r=s?s.startsWith("new-folder-")?s:"new-folder-".concat(s):"";if(!r)return;let o="string"==typeof(null==e?void 0:e.name)?e.name:n||"New Folder";f.default.some(e=>e.id===r)||f.default.push({id:r,title:o,icon:"/themes/Yaru/system/folder.png",disabled:!1,favourite:!1,desktop_shortcut:!0,isFolder:!0,screen:()=>null}),i.push(r)}),i.forEach(e=>this.ensureFolderEntry(e)),i.length&&this.updateAppsData()}catch(e){null===z.safeLocalStorage||void 0===z.safeLocalStorage||z.safeLocalStorage.setItem("new_folders",JSON.stringify([]))}},this.setEventListeners=()=>{let e=document.getElementById("open-settings");if(!e)return void this.removeEventListeners();this.openSettingsClickHandler||(this.openSettingsClickHandler=()=>{this.openApp("settings")}),this.openSettingsTarget&&this.openSettingsTarget!==e&&this.openSettingsClickHandler&&(this.openSettingsTarget.removeEventListener("click",this.openSettingsClickHandler),this.openSettingsListenerAttached=!1),this.openSettingsTarget=e,!this.openSettingsListenerAttached&&this.openSettingsClickHandler&&(this.openSettingsTarget.addEventListener("click",this.openSettingsClickHandler),this.openSettingsListenerAttached=!0)},this.removeEventListeners=()=>{this.openSettingsTarget&&this.openSettingsClickHandler&&this.openSettingsTarget.removeEventListener("click",this.openSettingsClickHandler),this.openSettingsTarget=null,this.openSettingsListenerAttached=!1},this.setContextListeners=()=>{document.addEventListener("contextmenu",this.checkContextMenu),document.addEventListener("click",this.hideAllContextMenu),document.addEventListener("keydown",this.handleContextKey)},this.removeContextListeners=()=>{document.removeEventListener("contextmenu",this.checkContextMenu),document.removeEventListener("click",this.hideAllContextMenu),document.removeEventListener("keydown",this.handleContextKey)},this.handleGlobalShortcut=e=>{var t,i;if(e.altKey&&"Tab"===e.key)e.preventDefault(),this.isOverlayOpen(ez)||this.openWindowSwitcher();else if(e.ctrlKey&&e.shiftKey&&"v"===e.key.toLowerCase())e.preventDefault(),this.openApp("clipboard-manager");else if(e.altKey&&"Tab"===e.key)e.preventDefault(),this.cycleApps(e.shiftKey?-1:1);else if(e.altKey&&("`"===e.key||"~"===e.key))e.preventDefault(),this.cycleAppWindows(e.shiftKey?-1:1);else if(e.metaKey&&["m","f"].includes(e.key.toLowerCase())){e.preventDefault();let i=this.getFocusedWindowId();if(i){let n=new CustomEvent("super-action",{detail:"m"===e.key.toLowerCase()?"minimize":"toggle-maximize"});null==(t=document.getElementById(i))||t.dispatchEvent(n)}}else if(e.metaKey&&["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(e.key)){e.preventDefault();let t=this.getFocusedWindowId();if(t){let n=new CustomEvent("super-arrow",{detail:e.key});null==(i=document.getElementById(t))||i.dispatchEvent(n)}}else this.isCommandPaletteShortcut(e)?(e.preventDefault(),this.toggleCommandPalette()):"Meta"!==e.key||e.repeat||this.commandPaletteUsesMeta?e.ctrlKey&&"Escape"===e.key&&!e.repeat&&(e.preventDefault(),this.isOverlayOpen(eM)?this.closeAllAppsOverlay():this.openAllAppsOverlay("Ctrl+Escape")):("function"==typeof e.preventDefault&&e.preventDefault(),this.openAllAppsOverlay("Meta"))},this.handleGlobalShortcutKeyup=e=>{if(this.isOverlayOpen(eM)){if("Escape"===e.key||"Meta"===this.allAppsTriggerKey&&"Meta"===e.key){e.preventDefault(),this.closeAllAppsOverlay();return}"Ctrl+Escape"===this.allAppsTriggerKey&&"Control"===e.key&&(e.preventDefault(),this.closeAllAppsOverlay())}},this.focusAllAppsSearchInput=()=>{let e=()=>{var e;let t=null==(e=this.allAppsSearchRef)?void 0:e.current;if(t&&"function"==typeof t.focus){try{t.focus({preventScroll:!0})}catch(e){t.focus()}"function"==typeof t.select&&t.select()}};"function"==typeof window.requestAnimationFrame?window.requestAnimationFrame(e):e()},this.restoreFocusToPreviousElement=()=>{let e=this.previousFocusElement;if(this.previousFocusElement=null,this.allAppsTriggerKey=null,e&&"function"==typeof e.focus)try{e.focus()}catch(e){}},this.openAllAppsOverlay=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t.allAppsCloseTimeout&&(clearTimeout(t.allAppsCloseTimeout),t.allAppsCloseTimeout=null);let i=()=>{t.setState(e=>{var i;let n=null==(i=e.overlayWindows)?void 0:i[eM];return(null==n?void 0:n.open)?{overlayWindows:t.buildOverlayStateMap(e.overlayWindows,eM,{transitionState:"entered"})}:null}),t.allAppsEnterRaf=null},n=t.getLauncherState();if(null==n?void 0:n.open)t.setState(e=>({overlayWindows:t.buildOverlayStateMap(e.overlayWindows,eM,{transitionState:"entered"})}));else{if("undefined"!=typeof document){let e=document.activeElement;e&&e!==document.body?t.previousFocusElement=e:t.previousFocusElement=null}t.openOverlay(eM,{transitionState:"entering"}),"function"==typeof window.requestAnimationFrame?t.allAppsEnterRaf=window.requestAnimationFrame(i):i()}t.allAppsTriggerKey=e},this.closeAllAppsOverlay=()=>{if(!this.isOverlayOpen(eM)){this.allAppsTriggerKey=null;return}this.allAppsCloseTimeout&&(clearTimeout(this.allAppsCloseTimeout),this.allAppsCloseTimeout=null),this.closeOverlay(eM,{transitionState:"exiting"}),this.allAppsCloseTimeout=setTimeout(()=>{this.setState(e=>({overlayWindows:this.buildOverlayStateMap(e.overlayWindows,eM,{transitionState:"exited"})})),this.allAppsCloseTimeout=null},220),this.allAppsTriggerKey=null},this.activateAllAppsFocusTrap=()=>{this.allAppsFocusTrapHandler||"undefined"==typeof document||(this.allAppsFocusTrapHandler=e=>{var t;if("Tab"!==e.key||!this.isOverlayOpen(eM))return;let i=null==(t=this.allAppsOverlayRef)?void 0:t.current;if(!i)return;let n=Array.from(i.querySelectorAll('a[href],button:not([disabled]),textarea:not([disabled]),input:not([type="hidden"]):not([disabled]),select:not([disabled]),[tabindex]:not([tabindex="-1"])')).filter(e=>{if(!(e instanceof HTMLElement)||e.hasAttribute("disabled")||"true"===e.getAttribute("aria-hidden")||!i.contains(e))return!1;let t=e.getBoundingClientRect();return t.width>0&&t.height>0});if(!n.length)return void e.preventDefault();let s=n[0],r=n[n.length-1],o=document.activeElement instanceof HTMLElement?document.activeElement:null;if(e.shiftKey){o&&o!==s&&i.contains(o)||(e.preventDefault(),r.focus());return}o&&o!==r&&i.contains(o)||(e.preventDefault(),s.focus())},document.addEventListener("keydown",this.allAppsFocusTrapHandler,!0))},this.deactivateAllAppsFocusTrap=()=>{this.allAppsFocusTrapHandler&&"undefined"!=typeof document&&(document.removeEventListener("keydown",this.allAppsFocusTrapHandler,!0),this.allAppsFocusTrapHandler=null)},this.activateWindowFocusTrap=()=>{this.windowFocusTrapHandler||"undefined"==typeof document||(this.windowFocusTrapHandler=e=>{if("Tab"!==e.key||this.isAnyOverlayActive())return;let t=this.getFocusedWindowId();if(!t)return;let i=document.getElementById(t);if(!i)return;let n=Array.from(i.querySelectorAll('a[href],button:not([disabled]),textarea:not([disabled]),input:not([type="hidden"]):not([disabled]),select:not([disabled]),[tabindex]:not([tabindex="-1"])')).filter(e=>{if(!(e instanceof HTMLElement)||e.hasAttribute("disabled")||"true"===e.getAttribute("aria-hidden")||!i.contains(e))return!1;let t=e.getBoundingClientRect();return t.width>0&&t.height>0});if(!n.length)return void e.preventDefault();let s=n[0],r=n[n.length-1],o=document.activeElement instanceof HTMLElement?document.activeElement:null;if(e.shiftKey){o&&o!==s&&i.contains(o)||(e.preventDefault(),r.focus());return}o&&o!==r&&i.contains(o)||(e.preventDefault(),s.focus())},document.addEventListener("keydown",this.windowFocusTrapHandler,!0))},this.deactivateWindowFocusTrap=()=>{this.windowFocusTrapHandler&&"undefined"!=typeof document&&(document.removeEventListener("keydown",this.windowFocusTrapHandler,!0),this.windowFocusTrapHandler=null)},this.getFocusedWindowId=()=>{for(let e in this.state.focused_windows)if(this.state.focused_windows[e])return e;return null},this.cycleApps=e=>{let t=this.getActiveStack();if(!t.length)return;let i=this.getFocusedWindowId(),n=t.indexOf(i);-1===n&&(n=0);let s=(n+e+t.length)%t.length;for(let i=0;i<t.length;i++){let i=t[s];if(!this.state.minimized_windows[i]){this.focus(i);break}s=(s+e+t.length)%t.length}},this.cycleAppWindows=e=>{let t=this.getFocusedWindowId();if(!t)return;let i=t.split("#")[0],n=this.getActiveStack().filter(e=>e.startsWith(i));if(n.length<=1)return;let s=(n.indexOf(t)+e+n.length)%n.length;this.focus(n[s])},this.resolvePreviewIconUrl=e=>{if("string"!=typeof e||!e)return null;try{return new URL(e,window.location.href).toString()}catch(e){return null}},this.buildFallbackPreview=e=>{let t=this.getAppById(e)||{};return function(e){let t,i=ex(e.title||"Window"),n=e.subtitle?ex(e.subtitle):"",s=e.iconUrl?ex(e.iconUrl):"";return t='<?xml version="1.0" encoding="UTF-8"?>\n<svg xmlns="http://www.w3.org/2000/svg" width="320" height="180" viewBox="0 0 320 180">\n  <defs>\n    <linearGradient id="bg" x1="0" x2="1" y1="0" y2="1">\n      <stop offset="0" stop-color="#0f172a"/>\n      <stop offset="1" stop-color="#020617"/>\n    </linearGradient>\n    <linearGradient id="bar" x1="0" x2="1" y1="0" y2="0">\n      <stop offset="0" stop-color="#111827"/>\n      <stop offset="1" stop-color="#0b1220"/>\n    </linearGradient>\n    <linearGradient id="panel" x1="0" x2="0" y1="0" y2="1">\n      <stop offset="0" stop-color="rgba(255,255,255,0.10)"/>\n      <stop offset="1" stop-color="rgba(255,255,255,0.03)"/>\n    </linearGradient>\n  </defs>\n  <rect x="0" y="0" width="320" height="180" rx="12" fill="url(#bg)"/>\n  <rect x="10" y="10" width="300" height="28" rx="8" fill="url(#bar)" opacity="0.92"/>\n  <g opacity="0.9">\n    <circle cx="24" cy="24" r="5" fill="#ef4444"/>\n    <circle cx="40" cy="24" r="5" fill="#f59e0b"/>\n    <circle cx="56" cy="24" r="5" fill="#22c55e"/>\n  </g>\n  <rect x="14" y="50" width="292" height="116" rx="10" fill="rgba(2,6,23,0.28)" stroke="rgba(255,255,255,0.08)"/>\n  <rect x="28" y="66" width="264" height="84" rx="12" fill="url(#panel)" stroke="rgba(255,255,255,0.08)"/>\n  '.concat(s?'<image href="'.concat(s,'" x="44" y="92" width="36" height="36" />'):'<rect x="44" y="92" width="36" height="36" rx="10" fill="rgba(148,163,184,0.16)" stroke="rgba(148,163,184,0.22)" />','\n  <text x="92" y="112" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial" font-size="15" font-weight="750" fill="rgba(255,255,255,0.92)">\n    ').concat(i,"\n  </text>\n  ").concat(n?'<text x="92" y="132" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial" font-size="11.5" font-weight="600" fill="rgba(226,232,240,0.68)">\n    '.concat(n,"\n  </text>"):'<text x="92" y="132" font-family="ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial" font-size="11.5" font-weight="600" fill="rgba(226,232,240,0.62)">\n    Preview not available\n  </text>',"\n</svg>"),"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(t))}({title:t.title||t.name||e,iconUrl:this.resolvePreviewIconUrl(t.icon),subtitle:null})},this.captureWindowPreview=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal";if("undefined"==typeof document)return null;let i=document.getElementById(e);if(!i)return null;try{return await (0,ev.toPng)(i,{cacheBust:!0,pixelRatio:1,skipFonts:!0,style:{opacity:"1",visibility:"visible"},filter:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal",t=new Set(["IFRAME","OBJECT","EMBED"]),i=new Set([...t,"VIDEO","CANVAS"]);return n=>{if(!n||"object"!=typeof n)return!0;let s="string"==typeof n.tagName?n.tagName.toUpperCase():"";if(("aggressive"===e?i:t).has(s))return!1;if(("IMG"===s||"IMAGE"===s)&&"function"==typeof n.getAttribute){let e=n.getAttribute("src")||n.getAttribute("href");if("string"==typeof e&&e.length){var r,o;let t=e.trim();if(!/^data:|^blob:/i.test(t)&&(null==(r=window.location)?void 0:r.href))try{let e=new URL(t,window.location.href);if(!((null==(o=window.location)?void 0:o.origin)&&e.origin===window.location.origin))return!1}catch(e){}}}return("function"!=typeof n.getAttribute||"true"!==n.getAttribute("data-preview-exclude"))&&!0}}(t)})}catch(e){return null}},this.getWindowPreview=async e=>{var t;if(this.windowPreviewCache.has(e)){let t=this.windowPreviewCache.get(e);if("string"==typeof t&&t.length)return t;this.windowPreviewCache.delete(e)}let i=await this.captureWindowPreview(e,"normal");return i||(i=await this.captureWindowPreview(e,"aggressive")),"string"==typeof i&&i.startsWith("data:image/png")&&this.windowPreviewLastGoodCache.set(e,i),!i&&(null==(t=this.windowPreviewLastGoodCache)?void 0:t.has(e))&&(i=this.windowPreviewLastGoodCache.get(e)),i||(i=this.buildFallbackPreview(e)),this.windowPreviewCache.set(e,i),i},this.handleTaskbarPreviewRequest=e=>{var t;let i=(null==e?void 0:e.detail)||{},n=i.appId,s=i.requestId;n&&null!=s&&(i.bustCache&&(null==(t=this.windowPreviewCache)?void 0:t.has(n))&&this.windowPreviewCache.delete(n),Promise.resolve(this.getWindowPreview(n)).then(e=>{window.dispatchEvent(new CustomEvent("taskbar-preview-response",{detail:{appId:n,requestId:s,preview:e}}))}).catch(()=>{window.dispatchEvent(new CustomEvent("taskbar-preview-response",{detail:{appId:n,requestId:s,preview:null}}))}))},this.buildWindowSwitcherEntries=async e=>{let t=[];for(let i of e){let e=this.getAppById(i)||{},n=await this.getWindowPreview(i);t.push({id:i,title:e.title||e.name||i,icon:e.icon,preview:n})}return t},this.openWindowSwitcher=()=>{let e=this.getActiveStack().filter(e=>!1===this.state.closed_windows[e]&&!this.state.minimized_windows[e]);if(!e.length)return;this.windowSwitcherReturnFocusId=this.getFocusedWindowId();let t=++this.windowSwitcherRequestId;this.openOverlay(ez),Promise.resolve(this.buildWindowSwitcherEntries(e)).then(e=>{if(this.windowSwitcherRequestId===t){if(!e.length){this.setState({switcherWindows:[]}),this.closeOverlay(ez);return}this.setState({switcherWindows:e})}}).catch(()=>{this.windowSwitcherRequestId===t&&(this.setState({switcherWindows:[]}),this.closeOverlay(ez))})},this.closeWindowSwitcher=()=>{if(this.setState({switcherWindows:[]}),this.closeOverlay(ez),this.windowSwitcherReturnFocusId){let e=this.windowSwitcherReturnFocusId;this.windowSwitcherReturnFocusId=null,!1!==this.state.closed_windows[e]||this.state.minimized_windows[e]||this.focus(e)}},this.selectWindow=e=>{this.setState({switcherWindows:[]},()=>{this.windowSwitcherReturnFocusId=null,this.closeOverlay(ez),this.openApp(e)})},this.checkContextMenu=e=>{e.preventDefault(),this.hideAllContextMenu();let t=e.target.closest("[data-context]"),i=t?t.dataset.context:null,n=t?t.dataset.appId:null;switch(i){case"desktop-area":(0,ew.logEvent)({category:"Context Menu",action:"Opened Desktop Context Menu"}),this.showContextMenu(e,"desktop");break;case"app":(0,ew.logEvent)({category:"Context Menu",action:"Opened App Context Menu"}),this.setState({context_app:n},()=>this.showContextMenu(e,"app"));break;case"taskbar":(0,ew.logEvent)({category:"Context Menu",action:"Opened Taskbar Context Menu"}),this.setState({context_app:n},()=>this.showContextMenu(e,"taskbar"));break;default:(0,ew.logEvent)({category:"Context Menu",action:"Opened Default Context Menu"}),this.showContextMenu(e,"default")}},this.handleContextKey=e=>{if(!(e.shiftKey&&"F10"===e.key))return;e.preventDefault(),this.hideAllContextMenu();let t=e.target.closest("[data-context]"),i=t?t.dataset.context:null,n=t?t.dataset.appId:null,s=t?t.getBoundingClientRect():{left:0,top:0,height:0},r={pageX:s.left,pageY:s.top+s.height};switch(i){case"desktop-area":(0,ew.logEvent)({category:"Context Menu",action:"Opened Desktop Context Menu"}),this.showContextMenu(r,"desktop");break;case"app":(0,ew.logEvent)({category:"Context Menu",action:"Opened App Context Menu"}),this.setState({context_app:n},()=>this.showContextMenu(r,"app"));break;case"taskbar":(0,ew.logEvent)({category:"Context Menu",action:"Opened Taskbar Context Menu"}),this.setState({context_app:n},()=>this.showContextMenu(r,"taskbar"));break;default:(0,ew.logEvent)({category:"Context Menu",action:"Opened Default Context Menu"}),this.showContextMenu(r,"default")}},this.showContextMenu=(e,t)=>{let{posx:i,posy:n}=this.getMenuPosition(e),s=document.getElementById("".concat(t,"-menu")),r=s.offsetWidth,o=s.offsetHeight;i+r>window.innerWidth&&(i-=r),n+o>window.innerHeight&&(n-=o),i=i.toString()+"px",n=n.toString()+"px",s.style.left=i,s.style.top=n,this.setState({context_menus:{...this.state.context_menus,[t]:!0}})},this.hideAllContextMenu=()=>{let e={...this.state.context_menus};Object.keys(e).forEach(t=>{e[t]=!1}),this.setState({context_menus:e,context_app:null})},this.getMenuPosition=e=>{var t=0,i=0;return e||(e=window.event),e.pageX||e.pageY?(t=e.pageX,i=e.pageY):(e.clientX||e.clientY)&&(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),{posx:t,posy:i}},this.fetchAppsData=e=>{this.refreshAppRegistry();let t=this.getPinnedAppIds(),i=new Set(this.setPinnedAppIds(t,{persist:!0,broadcast:!1,force:!0,syncFavourite:!1})),n={...eF(!1),...this.state.focused_windows||{}},s={...eF(!0),...this.state.closed_windows||{}},r={...eF(!1),...this.state.minimized_windows||{}},o={...n},a={...s},l={},d={},c={...r},u=[],h=this.getAllFolderItemIds();f.default.forEach(e=>{let t=s[e.id],p=n[e.id],m=r[e.id];o[e.id]="boolean"==typeof p&&p,a[e.id]="boolean"!=typeof t||t,c[e.id]="boolean"==typeof m&&m,l[e.id]=e.disabled,d[e.id]=i.has(e.id),e.desktop_shortcut&&!h.has(e.id)&&u.push(e.id)});let p={focused_windows:o,closed_windows:a,minimized_windows:c,window_positions:this.state.window_positions||{},window_sizes:this.state.window_sizes||{}};this.updateWorkspaceSnapshots(p),this.workspaceStacks=Array.from({length:this.workspaceCount},()=>[]),this.setWorkspaceState({...p,disabled_apps:l,favourite_apps:d,desktop_apps:u},()=>{this.ensureIconPositions(u),"function"==typeof e&&e(),this.broadcastWorkspaceState()}),this.initFavourite={...d}},this.updateAppsData=()=>{this.refreshAppRegistry();let e=this.getPinnedAppIds(),t=new Set(this.setPinnedAppIds(e,{persist:!0,broadcast:!1,force:!0,syncFavourite:!1})),i={...eF(!1),...this.state.focused_windows||{}},n={...eF(!0),...this.state.closed_windows||{}},s={...eF(!1),...this.state.minimized_windows||{}},r={...i},o={...n},a={},l={...s},d={},c=[],u=this.getAllFolderItemIds();f.default.forEach(e=>{let h=i[e.id],p=s[e.id],m=n[e.id];r[e.id]="boolean"==typeof h&&h,l[e.id]="boolean"==typeof p&&p,d[e.id]=e.disabled,o[e.id]="boolean"!=typeof m||m,a[e.id]=t.has(e.id),e.desktop_shortcut&&!u.has(e.id)&&c.push(e.id)});let h={focused_windows:r,closed_windows:o,minimized_windows:l,window_positions:this.state.window_positions||{},window_sizes:this.state.window_sizes||{}};this.updateWorkspaceSnapshots(h),this.setWorkspaceState({...h,disabled_apps:d,favourite_apps:a,desktop_apps:c},()=>{this.ensureIconPositions(c),this.broadcastWorkspaceState()}),this.initFavourite={...a}},this.hasVisibleWindows=()=>{let e=this.state.closed_windows||{},t=this.state.minimized_windows||{};return Object.keys(e).some(i=>this.validAppIds.has(i)&&!1===e[i]&&!t[i])},this.renderDesktopApps=()=>{let{desktop_apps:e,desktop_icon_positions:t={},draggingIconId:i,keyboardMoveState:s}=this.state;if(!e||0===e.length)return null;let r=this.hasVisibleWindows()&&!i,o=this.state.selectedIcons instanceof Set?this.state.selectedIcons:new Set,a=this.state.hoveredIconId,l=this.state.marqueeSelection,d=e.map((e,r)=>{var l;let d=this.getAppById(e);if(!d)return null;let c=!1!==d.prefetchOnHover,u={name:d.title,id:d.id,icon:d.icon,openApp:this.openApp,disabled:this.state.disabled_apps[d.id],prefetch:c?null==(l=d.screen)?void 0:l.prefetch:void 0,style:this.desktopIconVariables,accentVariables:this.desktopAccentVariables},h=s&&s.id===e&&s.position?s.position:t[e]||this.computeGridPosition(r),p=!!(s&&s.id===e),m=i===e||p,f=o.has(e),g=a===e,w=this.buildKeyboardMoveHint(d,p,h),v={position:"absolute",left:"".concat(h.x,"px"),top:"".concat(h.y,"px"),touchAction:"none",cursor:m?"grabbing":"pointer",zIndex:m?60:15};return(0,n.jsx)("div",{style:v,onPointerDown:e=>this.handleIconPointerDown(e,d.id),onPointerMove:this.handleIconPointerMove,onPointerUp:this.handleIconPointerUp,onPointerCancel:this.handleIconPointerCancel,onClickCapture:this.handleIconClickCapture,onPointerEnter:()=>this.handleIconPointerEnter(d.id),onPointerLeave:()=>this.handleIconPointerLeave(d.id),children:(0,n.jsx)(I,{...u,draggable:!1,isBeingDragged:m,onKeyDown:e=>this.handleIconKeyDown(e,d),onBlur:e=>this.handleIconBlur(e,d.id),assistiveHint:w,isSelected:f,isHovered:g})},d.id)}).filter(Boolean);return d.length?(0,n.jsxs)("div",{className:"absolute inset-0","aria-hidden":r?"true":"false",style:{pointerEvents:"auto",zIndex:r?5:15},onPointerDown:this.handleDesktopPointerDown,onPointerMove:this.handleDesktopPointerMove,onPointerUp:this.handleDesktopPointerUp,onPointerCancel:this.handleDesktopPointerCancel,children:[d,l?(0,n.jsx)("div",{className:"absolute pointer-events-none rounded-sm border border-sky-300/80 bg-sky-400/10 shadow-[0_0_0_1px_rgba(56,189,248,0.35)]",style:{left:"".concat(l.left,"px"),top:"".concat(l.top,"px"),width:"".concat(l.width,"px"),height:"".concat(l.height,"px")}}):null]}):null},this.renderWindows=()=>{let{closed_windows:e={},minimized_windows:t={},focused_windows:i={}}=this.state,s=(0,v.measureWindowTopOffset)(),r=this.getActiveStack(),o=[],a=new Set;if(r.slice().reverse().forEach(t=>{!1!==e[t]||a.has(t)||(o.push(t),a.add(t))}),f.default.forEach(t=>{!1!==e[t.id]||a.has(t.id)||(o.push(t.id),a.add(t.id))}),!o.length)return null;let l=new Map(f.default.map(e=>[e.id,e])),d=this.props.snapGrid||[8,8];return o.map((e,r)=>{var o,a;let c=l.get(e);if(!c)return null;let u=this.state.window_positions[e],h=(null==(o=this.state.window_sizes)?void 0:o[e])||(null==(a=this.loadWindowSizes())?void 0:a[e]),p=h&&"number"==typeof h.width?h.width:c.defaultWidth,m=h&&"number"==typeof h.height?h.height:c.defaultHeight,f={title:c.title,id:c.id,screen:c.screen,addFolder:this.addToDesktop,closed:this.closeApp,openApp:this.openApp,focus:this.focus,isFocused:i[e],hasMinimised:this.hasMinimised,minimized:t[e],resizable:c.resizable,allowMaximize:c.allowMaximize,defaultWidth:p,defaultHeight:m,responsiveWidth:c.responsiveWidth,responsiveHeight:c.responsiveHeight,initialX:u?u.x:void 0,initialY:u?(0,v.clampWindowTopPosition)(u.y,s):s,onPositionChange:this.updateWindowPosition,onSizeChange:this.updateWindowSize,snapEnabled:this.props.snapEnabled,snapGrid:d,context:this.state.window_context[e]};return(0,n.jsx)(A,{...f},e)}).filter(Boolean)},this.renderOverlayWindows=()=>{let e=[],t=this.state.overlayWindows||{},i=t[eM];if(i){let t=i.transitionState||(i.open?"entered":"exited"),s=i.open||["entering","exiting"].includes(t),r=i.open&&!i.minimized,o=i.maximized?"max-w-6xl lg:max-w-7xl xl:max-w-[90vw] h-[calc(100vh-5rem)]":"max-w-6xl";s&&e.push((0,n.jsx)(M,{id:eM,title:"All Applications",open:s,minimized:!!(i.minimized||!i.open),maximized:!!i.maximized,overlayRef:this.allAppsOverlayRef,overlayClassName:"z-[600] overflow-y-auto bg-slate-950/70 backdrop-blur-xl transition-opacity duration-200 ease-out ".concat(r?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"),frameClassName:"w-full transform transition-all duration-200 ease-out focus:outline-none ".concat(r?"scale-100 opacity-100 translate-y-0":"scale-95 opacity-0 -translate-y-2"," ").concat(o),bodyClassName:"bg-transparent p-0",ariaLabelledBy:"all-apps-overlay-title",onMinimize:()=>this.toggleOverlayMinimize(eM),onMaximize:()=>this.toggleOverlayMaximize(eM),onClose:this.closeAllAppsOverlay,children:(0,n.jsx)(H,{apps:f.default,games:f.games,recentApps:this.getActiveStack(),openApp:this.openApp,searchInputRef:this.allAppsSearchRef,headingId:"all-apps-overlay-title"})},eM))}let s=t[eL];if(s){let t=s.open&&!s.minimized;(s.open||s.minimized)&&e.push((0,n.jsx)(M,{id:eL,title:"Add to Desktop",open:!!s.open,minimized:!!s.minimized,maximized:!!s.maximized,overlayClassName:"z-[550] bg-slate-950/70 backdrop-blur-xl transition-opacity duration-200 ease-out ".concat(t?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"),frameClassName:"w-full max-w-4xl transform transition-all duration-200 ease-out ".concat(t?"scale-100 opacity-100 translate-y-0":"scale-95 opacity-0 -translate-y-2"),bodyClassName:"bg-transparent p-0",allowMaximize:!1,onMinimize:()=>this.toggleOverlayMinimize(eL),onClose:()=>this.closeOverlay(eL),children:(0,n.jsx)(V,{apps:f.default,games:f.games,onSelect:this.addShortcutToDesktop,onClose:()=>this.closeOverlay(eL)})},eL))}let r=t[ez];if(r){let t=r.open&&!r.minimized;(r.open||r.minimized)&&e.push((0,n.jsx)(M,{id:ez,title:"Window Switcher",open:!!r.open,minimized:!!(r.minimized||!r.open),maximized:!!r.maximized,overlayClassName:"z-[520] bg-slate-950/65 backdrop-blur-xl transition-opacity duration-150 ease-out ".concat(t?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"),frameClassName:"w-full max-w-5xl transform transition-all duration-150 ease-out ".concat(t?"scale-100 opacity-100 translate-y-0":"scale-95 opacity-0 -translate-y-2"),bodyClassName:"bg-transparent p-0",allowMaximize:!1,onMinimize:()=>this.toggleOverlayMinimize(ez),onClose:this.closeWindowSwitcher,children:(0,n.jsx)(G,{windows:this.state.switcherWindows,onSelect:this.selectWindow,onClose:this.closeWindowSwitcher})},ez))}let o=t[eD];if(o&&(o.open||o.minimized)){let t=o.open&&!o.minimized;e.push((0,n.jsx)(M,{id:eD,title:"Command Palette",open:!!o.open,minimized:!!o.minimized,maximized:!!o.maximized,onMinimize:()=>this.toggleOverlayMinimize(eD),onClose:this.closeCommandPalette,allowMaximize:!1,overlayClassName:"bg-slate-950/70 backdrop-blur-xl transition-opacity duration-200 ease-out",frameClassName:"w-full max-w-3xl",bodyClassName:"bg-transparent p-0",children:(0,n.jsx)($,{open:t,apps:this.getCommandPaletteAppItems(),recentWindows:this.getCommandPaletteRecentWindows(),settingsActions:this.getCommandPaletteSettingsActions(),onSelect:this.handleCommandPaletteSelect,onClose:this.closeCommandPalette})},eD))}return e},this.updateWindowPosition=(e,t,i)=>{let[n,s]=this.getSnapGrid(),r=(e,t)=>this.props.snapEnabled&&"number"==typeof t&&Number.isFinite(t)&&!(t<=0)?Math.round(e/t)*t:e,o=(0,v.measureWindowTopOffset)(),a=r(t,n),l=(0,v.clampWindowTopPosition)(r(i,s),o);this.setWorkspaceState(t=>({window_positions:{...t.window_positions,[e]:{x:a,y:l}}}),()=>{this.persistWindowSizes(this.state.window_sizes||{}),this.saveSession()})},this.updateWindowSize=(e,t,i)=>{if(!e)return;let n=Number(t),s=Number(i);if(!Number.isFinite(n)||!Number.isFinite(s))return;let r=Math.max(0,Math.round(n)),o=Math.max(0,Math.round(s));this.setWorkspaceState(t=>{let i={...t.window_sizes||{}};return i[e]={width:r,height:o},{window_sizes:i}},()=>{this.persistWindowSizes(this.state.window_sizes||{})})},this.getSnapGrid=()=>this.props.snapGrid||[8,8],this.saveSession=()=>{if(!this.props.setSession)return;let e=Object.keys(this.state.closed_windows).filter(e=>!1===this.state.closed_windows[e]&&!this.isOverlayId(e)),t=(0,v.measureWindowTopOffset)(),i=e.map(e=>{let i=this.state.window_positions[e]||{};return{id:e,x:"number"==typeof i.x?i.x:60,y:(0,v.clampWindowTopPosition)(i.y,t)}}),n={...this.props.session,windows:i};"dock"in n&&delete n.dock,this.props.setSession(n)},this.hasMinimised=e=>{if(this.isOverlayId(e))return void this.minimizeOverlay(e);this.setState(t=>{let i={...t.minimized_windows,[e]:!0},n={...t.focused_windows,[e]:!1};return this.commitWorkspacePartial({minimized_windows:i,focused_windows:n},t.activeWorkspace),{minimized_windows:i,focused_windows:n}},()=>{this.giveFocusToLastApp()})},this.giveFocusToLastApp=()=>{if(!this.checkAllMinimised()){let e=this.getActiveStack();for(let t=0;t<e.length;t++)if(!this.state.minimized_windows[e[t]]){this.focus(e[t]);break}}},this.toggleMinimizedShelf=()=>{this.setState(e=>({minimizedShelfOpen:!e.minimizedShelfOpen}))},this.toggleClosedShelf=()=>{this.setState(e=>({closedShelfOpen:!e.closedShelfOpen}))},this.handleMinimizedWindowActivate=e=>{e&&(this.isOverlayId(e)?this.openOverlay(e,{transitionState:"entered"}):this.openApp(e),this.setState({minimizedShelfOpen:!1}))},this.handleClosedWindowActivate=e=>{e&&(this.isOverlayId(e)?this.openOverlay(e,{transitionState:"entered"}):this.openApp(e),this.setState({closedShelfOpen:!1}))},this.dismissClosedWindowEntry=e=>{e&&this.setState(t=>{let i=t.closed_windows||{};if(!Object.prototype.hasOwnProperty.call(i,e))return null;let n={...i};return delete n[e],this.commitWorkspacePartial({closed_windows:n},t.activeWorkspace),{closed_windows:n}},()=>{this.isOverlayId(e)&&this.recentlyClosedOverlays.delete(e),this.saveSession()})},this.checkAllMinimised=()=>{let e=!0;for(let t in this.state.minimized_windows)this.state.closed_windows[t]||(e&=this.state.minimized_windows[t]);return e},this.handleOpenAppEvent=e=>{let t=e.detail;if(t){if("string"==typeof t)return void this.openApp(t);if("object"==typeof t&&t.id){let{id:e,...i}=t;this.openApp(e,i)}}},this.openApp=(e,t)=>{if(!this.validAppIds.has(e))return void console.warn("Attempted to open unknown app: ".concat(e));if(this.isOverlayId(e))return void this.openOverlay(e);let i=t&&"object"==typeof t?{...t,...t.path&&!t.initialPath?{initialPath:t.path}:{}}:void 0,n=this.isFolderApp(e)?this.getFolderContext(e):null,s=n||i?{...n||{},...i||{}}:void 0,r=s?{...this.state.window_context,[e]:s}:this.state.window_context;if((0,ew.logEvent)({category:"Open App",action:"Opened ".concat(e," window")}),!this.state.disabled_apps[e]){if(!this.isOverlayId(e)&&this.isOverlayOpen(eM)&&this.closeAllAppsOverlay(),!1===this.state.closed_windows[e]){if(this.state.minimized_windows[e]){this.focus(e);var o=document.querySelector("#"+e);o.style.transform="translate(".concat(o.style.getPropertyValue("--window-transform-x"),",").concat(o.style.getPropertyValue("--window-transform-y"),") scale(1)");let t=this.state.minimized_windows;t[e]=!1,this.setWorkspaceState({minimized_windows:t},this.saveSession)}let t=()=>{if(this.state.minimized_windows[e]){this.focus(e);var t=document.querySelector("#"+e);t.style.transform="translate(".concat(t.style.getPropertyValue("--window-transform-x"),",").concat(t.style.getPropertyValue("--window-transform-y"),") scale(1)");let i=this.state.minimized_windows;i[e]=!1,this.setState({minimized_windows:i},this.saveSession)}else this.focus(e),this.saveSession()};s?this.setState({window_context:r},t):t();return}{let t=[];try{t=JSON.parse((null===z.safeLocalStorage||void 0===z.safeLocalStorage?void 0:z.safeLocalStorage.getItem("frequentApps"))||"[]")}catch(e){t=[]}var a=t.find(t=>t.id===e);a?t.forEach(e=>{e.id===a.id&&(e.frequency+=1)}):t.push({id:e,frequency:1}),t.sort((e,t)=>e.frequency<t.frequency?1:e.frequency>t.frequency?-1:0),null===z.safeLocalStorage||void 0===z.safeLocalStorage||z.safeLocalStorage.setItem("frequentApps",JSON.stringify(t)),(0,D.addRecentApp)(e),this.closeAllAppsOverlay(),setTimeout(()=>{let t={...this.state.closed_windows,[e]:!1},i={...this.state.favourite_apps,[e]:!0},n={...this.state.minimized_windows,[e]:!1};this.setWorkspaceState({closed_windows:t,minimized_windows:n},()=>{let r={closed_windows:t,favourite_apps:i,minimized_windows:n};s&&(r.window_context={...this.state.window_context,[e]:s}),this.setState(r,()=>{this.focus(e),this.saveSession()})})},200)}}},this.closeApp=async e=>{var t,i;if(this.isOverlayId(e))return void this.closeOverlay(e);let n=await this.captureWindowPreview(e,"normal");n||(n=await this.captureWindowPreview(e,"aggressive")),!n&&(null==(t=this.windowPreviewLastGoodCache)?void 0:t.has(e))&&(n=this.windowPreviewLastGoodCache.get(e)),n||(n=this.buildFallbackPreview(e));let s=f.default.find(t=>t.id===e)||{},r=24*parseInt((null===z.safeLocalStorage||void 0===z.safeLocalStorage?void 0:z.safeLocalStorage.getItem("trash-purge-days"))||"30",10)*36e5,o=Date.now(),a=[];try{a=JSON.parse((null===z.safeLocalStorage||void 0===z.safeLocalStorage?void 0:z.safeLocalStorage.getItem("window-trash"))||"[]")}catch(e){a=[]}(a=a.filter(e=>o-e.closedAt<=r)).push({id:e,title:s.title||e,icon:s.icon,image:n,closedAt:o}),null===z.safeLocalStorage||void 0===z.safeLocalStorage||z.safeLocalStorage.setItem("window-trash",JSON.stringify(a)),this.updateTrashIcon();let l=this.getActiveStack(),d=l.indexOf(e);-1!==d&&l.splice(d,1),(null==(i=this.windowPreviewCache)?void 0:i.has(e))&&this.windowPreviewCache.delete(e),this.giveFocusToLastApp(),await new Promise(t=>{this.setWorkspaceState(t=>{var i;let n={closed_windows:{...t.closed_windows,[e]:!0},minimized_windows:{...t.minimized_windows,[e]:!1}};return(null==(i=t.focused_windows)?void 0:i[e])&&(n.focused_windows={...t.focused_windows,[e]:!1}),n},()=>{this.setState(t=>{var i;let n={...t.closed_windows,[e]:!0},s={...t.favourite_apps};!1===this.initFavourite[e]&&(s[e]=!1);let r={...t.minimized_windows,[e]:!1},o={...t.window_context};delete o[e];let a={closed_windows:n,favourite_apps:s,minimized_windows:r,window_context:o};return(null==(i=t.focused_windows)?void 0:i[e])&&(a.focused_windows={...t.focused_windows,[e]:!1}),a},()=>{this.saveSession(),t()})})}),this.clearAppBadge(e,{force:!0})},this.pinAppAtPosition=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e||!t.getAppById(e))return;let s=t.getPinnedAppIds(),r=s.includes(e)?s:[...s,e],o=t.insertPinnedAppId(r,e,i,n);t.setPinnedAppIds(o)},this.pinApp=e=>{e&&(this.pinAppAtPosition(e,null,!0),this.hideAllContextMenu())},this.unpinApp=e=>{if(!e)return;let t=this.getPinnedAppIds();if(!t.includes(e))return void this.hideAllContextMenu();let i=t.filter(t=>t!==e);this.setPinnedAppIds(i),this.hideAllContextMenu()},this.focus=e=>{this.promoteWindowInStack(e),this.setState(t=>{let i={...t.focused_windows};Object.keys(i).forEach(t=>{i[t]=t===e}),Object.prototype.hasOwnProperty.call(i,e)||(i[e]=!0);let n=t.overlayWindows;return n&&(n=Object.keys(n).reduce((t,i)=>{let s=n[i];return t[i]={...s,focused:i===e,minimized:i!==e&&s.minimized},t},{})),this.commitWorkspacePartial({focused_windows:i},t.activeWorkspace),{focused_windows:i,overlayWindows:n}},()=>{this.clearAppBadge(e)})},this.addNewFolder=()=>{this.setState({showNameBar:!0})},this.openShortcutSelector=()=>{this.openOverlay(eL)},this.addShortcutToDesktop=e=>{let t=f.default.findIndex(t=>t.id===e);if(-1===t)return;f.default[t].desktop_shortcut=!0;let i=[];try{i=JSON.parse((null===z.safeLocalStorage||void 0===z.safeLocalStorage?void 0:z.safeLocalStorage.getItem("app_shortcuts"))||"[]")}catch(e){i=[]}i.includes(e)||(i.push(e),null===z.safeLocalStorage||void 0===z.safeLocalStorage||z.safeLocalStorage.setItem("app_shortcuts",JSON.stringify(i))),this.closeOverlay(eL),this.updateAppsData()},this.checkForAppShortcuts=()=>{let e=null===z.safeLocalStorage||void 0===z.safeLocalStorage?void 0:z.safeLocalStorage.getItem("app_shortcuts");if(e){try{JSON.parse(e).forEach(e=>{let t=f.default.findIndex(t=>t.id===e);-1!==t&&(f.default[t].desktop_shortcut=!0)})}catch(e){null===z.safeLocalStorage||void 0===z.safeLocalStorage||z.safeLocalStorage.setItem("app_shortcuts",JSON.stringify([]))}this.updateAppsData()}else null===z.safeLocalStorage||void 0===z.safeLocalStorage||z.safeLocalStorage.setItem("app_shortcuts",JSON.stringify([]))},this.updateTrashIcon=()=>{let e=[];try{e=JSON.parse((null===z.safeLocalStorage||void 0===z.safeLocalStorage?void 0:z.safeLocalStorage.getItem("window-trash"))||"[]")}catch(t){e=[]}let t=f.default.findIndex(e=>"trash"===e.id);if(-1!==t){let i=e.length?"/themes/Yaru/status/user-trash-full-symbolic.svg":"/themes/Yaru/status/user-trash-symbolic.svg";f.default[t].icon!==i&&(f.default[t].icon=i,this.forceUpdate())}},this.addToDesktop=e=>{let t=(e=e.trim()).replace(/\s+/g,"-").toLowerCase(),i="new-folder-".concat(t);f.default.push({id:i,title:e,icon:"/themes/Yaru/system/folder.png",disabled:!1,favourite:!1,desktop_shortcut:!0,isFolder:!0,screen:f.displayDesktopFolder}),this.ensureFolderEntry(i);let n=[];try{n=JSON.parse((null===z.safeLocalStorage||void 0===z.safeLocalStorage?void 0:z.safeLocalStorage.getItem("new_folders"))||"[]")}catch(e){n=[]}n.push({id:i,name:e}),null===z.safeLocalStorage||void 0===z.safeLocalStorage||z.safeLocalStorage.setItem("new_folders",JSON.stringify(n)),this.setState({showNameBar:!1},this.updateAppsData)},this.showAllApps=()=>{this.isOverlayOpen(eM)?this.closeAllAppsOverlay():this.openAllAppsOverlay()},this.renderNameBar=()=>{let e=e=>{var t;e.preventDefault();let i=this.folderNameInputRef.current,n=null!=(t=null==i?void 0:i.value)?t:"";if(!n.trim()){null==i||i.focus();return}this.addToDesktop(n)},t=()=>{this.setState({showNameBar:!1})};return(0,n.jsx)("div",{className:"absolute rounded-md top-1/2 left-1/2 text-center text-white font-light text-sm bg-ub-cool-grey transform -translate-y-1/2 -translate-x-1/2 sm:w-96 w-3/4 z-50",children:(0,n.jsxs)("form",{onSubmit:e,className:"flex flex-col",children:[(0,n.jsxs)("div",{className:"w-full flex flex-col justify-around items-start pl-6 pb-8 pt-6",children:[(0,n.jsx)("label",{htmlFor:"folder-name-input",children:"New folder name"}),(0,n.jsx)("input",{className:"outline-none mt-5 px-1 w-10/12 context-menu-bg border-2 border-blue-700 rounded py-0.5",id:"folder-name-input",type:"text",autoComplete:"off",spellCheck:"false",autoFocus:!0,"aria-label":"Folder name",ref:this.folderNameInputRef})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("button",{type:"submit","aria-label":"Create folder",className:"w-1/2 px-4 py-2 border border-gray-900 border-opacity-50 border-r-0 hover:bg-ub-warm-grey hover:bg-opacity-10 hover:border-opacity-50",children:"Create"}),(0,n.jsx)("button",{type:"button",onClick:t,"aria-label":"Cancel folder creation",className:"w-1/2 px-4 py-2 border border-gray-900 border-opacity-50 hover:bg-ub-warm-grey hover:bg-opacity-10 hover:border-opacity-50",children:"Cancel"})]})]})})},this._isMounted=!1,this.workspaceCount=4,this.workspaceStacks=Array.from({length:this.workspaceCount},()=>[]),this.workspaceKeys=new Set(["focused_windows","closed_windows","minimized_windows","window_positions","window_sizes"]),this.windowSizeStorageKey="desktop_window_sizes",this.defaultThemeConfig={id:"default",accent:e.desktopTheme&&e.desktopTheme.accent||"#1793d1",wallpaperUrl:e.desktopTheme&&e.desktopTheme.wallpaperUrl,fallbackWallpaperUrl:e.desktopTheme&&e.desktopTheme.fallbackWallpaperUrl||"/wallpapers/wall-2.webp",wallpaperName:e.desktopTheme&&e.desktopTheme.wallpaperName||"wall-2",overlay:e.desktopTheme?e.desktopTheme.overlay:void 0,useKaliWallpaper:!!(e.desktopTheme&&e.desktopTheme.useKaliWallpaper)};let i=this.normalizeTheme(e.desktopTheme);this.workspaceThemes=Array.from({length:this.workspaceCount},()=>({...i})),this.initFavourite={},this.allWindowClosed=!1,this.iconSizePresetStorageKey="desktop_icon_size_presets",this.iconSizePresetLegacyKey="desktop_icon_size_preset",this.iconSizePresetBuckets=[{id:"lt-640",label:"mobile screens (tiny)",min:0,max:640},{id:"lt-1024",label:"screens below 1024px",min:640,max:1024},{id:"gte-1024",label:"screens 1024px and above",min:1024,max:1/0}],this.iconSizePresets={small:{dimensions:{width:84,height:76},spacing:{row:100,column:116},padding:{top:eS.DESKTOP_TOP_PADDING,right:20,bottom:112,left:20}},medium:{dimensions:{width:96,height:88},spacing:{row:112,column:128},padding:{top:eS.DESKTOP_TOP_PADDING,right:24,bottom:120,left:24}},large:{dimensions:{width:112,height:104},spacing:{row:132,column:148},padding:{top:eS.DESKTOP_TOP_PADDING+8,right:28,bottom:136,left:28}},tiny:{dimensions:{width:72,height:68},spacing:{row:88,column:88},padding:{top:32,right:12,bottom:96,left:12}}},this.taskbarOrderKeyBase="taskbar-order",this.pinnedStorageKey="pinnedApps",this.hasStoredPinnedAppIds=!1;let s=this.normalizePinnedAppIds(f.default.filter(e=>e.favourite).map(e=>e.id));this.applyPinnedFlags(s),this.iconSizePresetMap={};let r="medium",o=this.getIconSizePresetConfig(r);this.baseIconDimensions={...o.dimensions},this.baseIconGridSpacing={...o.spacing},this.baseDesktopPadding={...o.padding},this.iconDimensions={...this.baseIconDimensions},this.iconGridSpacing={...this.baseIconGridSpacing},this.desktopPadding={...this.baseDesktopPadding},this.latestViewportWidth=0,this.viewportResizeObserver=null;let l=eF(!0),d=eF(!1),c=eF(!1),u={},h={},p={};f.default.forEach(e=>{u[e.id]=!1,h[e.id]="about"!==e.id,p[e.id]=!1});let m={};this.state={focused_windows:{...c,...u},closed_windows:{...l,...h},disabled_apps:{},favourite_apps:{},pinnedAppIds:s,minimized_windows:{...d,...p},window_positions:{},window_sizes:m,desktop_apps:[],desktop_icon_positions:{},folder_contents:{},window_context:{},context_menus:{desktop:!1,default:!1,app:!1,taskbar:!1},context_app:null,showNameBar:!1,switcherWindows:[],activeWorkspace:0,workspaces:Array.from({length:this.workspaceCount},(e,t)=>({id:t,label:"Workspace ".concat(t+1)})),draggingIconId:null,keyboardMoveState:null,liveRegionMessage:"",selectedIcons:new Set,selectionAnchorId:null,marqueeSelection:null,hoveredIconId:null,currentTheme:i,iconSizeBucket:"gte-1024",iconSizePreset:r,overlayWindows:(()=>{let e={};return eE.forEach(t=>{let{id:i}=t;e[i]={open:!1,minimized:!1,maximized:!1,focused:!1},i===eM&&(e[i].transitionState="exited")}),Object.entries(e_).forEach(t=>{let[i,n]=t;e[n.id]&&(e[i]=e[n.id])}),e})(),minimizedShelfOpen:!1,closedShelfOpen:!1,appBadges:{},taskbarOrder:[],mounted:!1};let w={};if(f.default.forEach(e=>{w[e.id]=!0}),this.workspaceSnapshots=Array.from({length:this.workspaceCount},(e,t)=>0===t?{focused_windows:{},closed_windows:{},minimized_windows:{},window_positions:{},window_sizes:{...m}}:{focused_windows:{...c,...u},closed_windows:{...l,...w},minimized_windows:{...d,...p},window_positions:{},window_sizes:{...m}}),this.desktopRef=a.createRef(),this.folderNameInputRef=a.createRef(),this.allAppsSearchRef=a.createRef(),this.allAppsOverlayRef=a.createRef(),this.windowSwitcherContentRef=a.createRef(),this.iconDragState=null,this.preventNextIconClick=!1,this.savedIconPositions={},this.gestureState={pointer:null,overview:null},this.currentPointerIsCoarse=!1,this.desktopIconVariables={},this.desktopAccentVariables={"--desktop-icon-selection-bg":"rgba(56, 189, 248, 0.2)","--desktop-icon-selection-border":"rgba(165, 243, 252, 0.9)","--desktop-icon-selection-glow":"0 0 0 1px rgba(56,189,248,0.7), 0 6px 24px rgba(8,47,73,0.55)","--desktop-icon-hover-bg":"rgba(56, 189, 248, 0.12)","--desktop-icon-hover-border":"rgba(165, 243, 252, 0.35)"},this.applyIconLayoutFromSettings(e),this.validAppIds=new Set,this.appMap=new Map,this.overlayRegistry=new Map(eE.map(e=>[e.id,e])),this.folderMetadata=new Map(g.DEFAULT_DESKTOP_FOLDERS.map(e=>[e.id,e])),this.windowPreviewCache=new Map,this.windowPreviewLastGoodCache=new Map,this.windowSwitcherRequestId=0,this.refreshAppRegistry(),this.hasStoredPinnedAppIds||this.persistPinnedAppIds(s),this.openSettingsTarget=null,this.openSettingsClickHandler=null,this.openSettingsListenerAttached=!1,this.liveRegionTimeout=null,this.previousFocusElement=null,this.recentlyClosedOverlays=new Set,this.allAppsTriggerKey=null,this.allAppsCloseTimeout=null,this.allAppsEnterRaf=null,this.allAppsFocusTrapHandler=null,this.windowFocusTrapHandler=null,this.windowSwitcherReturnFocusId=null,this.desktopSelectionState=null,this.commandPaletteUsesMeta=!1,"undefined"!=typeof navigator){let e=navigator.platform||"",t=navigator.userAgent||"";this.commandPaletteUsesMeta=/Mac|iPhone|iPad|iPod/i.test(e||t)}}}eR.defaultProps={snapGrid:[8,8]};let eW=a.forwardRef((e,t)=>{let[i]=(0,ej.useSnapSetting)(),[s]=(0,ej.useSnapGridSetting)(),{density:r,fontScale:o,largeHitAreas:l,desktopTheme:d}=(0,c.useSettings)(),u=a.useMemo(()=>Array.isArray(s)?["number"==typeof s[0]&&Number.isFinite(s[0])&&s[0]>0?s[0]:8,"number"==typeof s[1]&&Number.isFinite(s[1])&&s[1]>0?s[1]:8]:[8,8],[s]);return(0,n.jsx)(eR,{ref:t,...e,snapEnabled:i,snapGrid:u,density:r,fontScale:o,largeHitAreas:l,desktopTheme:d})});eW.displayName="DesktopWithSnap";var eB=i(40382);let eK=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],eU=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],eq=e=>{let t=new Date(e);return t.setHours(0,0,0,0),t},eH=(e,t)=>eq(e).getTime()===eq(t).getTime(),eV=(e,t)=>{let i=new Date(e);return i.setDate(i.getDate()+t),i},eY=(e,t)=>{let i=new Date(e);return i.setMonth(i.getMonth()+t),i},eG=(e,t)=>{let i=new Date(e);return i.setFullYear(i.getFullYear()+t),i},eX=e=>{let t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),i=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-i);let n=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.floor((t.getTime()-n.getTime())/864e5/7)+1},eJ=e=>{let{onlyDay:t=!1,onlyTime:s=!1,showCalendar:r=!1,hour12:o=!0,variant:l="default",isOpen:d,onToggle:c}=e,[u,h]=(0,a.useState)(null),[p,m]=(0,a.useState)(!1),f="boolean"==typeof d,g=f?d:p,w=(0,a.useCallback)(e=>{f?("function"==typeof e?e(g):e)!==g&&c&&c():m(e)},[f,g,c]),[v,x]=(0,a.useState)(()=>new Date),[b,y]=(0,a.useState)(()=>new Date),k=(()=>{let[e,t]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{if(!window.matchMedia)return;let e=window.matchMedia("(prefers-reduced-motion: reduce)"),i=()=>t(e.matches);return i(),e.addEventListener?e.addEventListener("change",i):e.addListener(i),()=>{e.removeEventListener?e.removeEventListener("change",i):e.removeListener(i)}},[]),e})(),S=(0,a.useRef)(null),j=(0,a.useRef)(null),A=(0,a.useRef)(null),I=(0,a.useRef)(!1),C=(0,a.useId)(),P="".concat(C,"-popover"),[N,_]=(0,a.useState)(!1),[E,M]=(0,a.useState)({});(0,a.useEffect)(()=>{let e,t,n=()=>h(new Date);return n(),"function"==typeof Worker?((e=new Worker(i.tu(new URL(i.p+i.u(239),i.b)))).onmessage=n,e.postMessage({action:"start",interval:1e4})):t=setInterval(n,1e4),()=>{e&&(e.postMessage({action:"stop"}),e.terminate()),t&&clearInterval(t)}},[]),(0,a.useEffect)(()=>{g&&u&&(x(new Date(u.getFullYear(),u.getMonth(),1)),y(u))},[g,u]),(0,a.useEffect)(()=>{if(!g)return;let e=e=>{var t,i;(null==(t=j.current)||!t.contains(e.target))&&(null!=(i=S.current)&&i.contains(e.target)||w(!1))},t=e=>{"Escape"===e.key&&(w(!1),S.current&&S.current.focus({preventScroll:k}))};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e),document.removeEventListener("keydown",t)}},[g,k]),(0,a.useEffect)(()=>{g&&A.current&&A.current.focus({preventScroll:k})},[g,v,b,k]),(0,a.useEffect)(()=>{I.current&&!g&&S.current&&S.current.focus({preventScroll:k}),I.current=g},[g,k]),(0,a.useEffect)(()=>{_(!0)},[]),(0,a.useEffect)(()=>{if(!g)return void M({});let e=()=>{let e=S.current,t=j.current;if(!e||!t)return;let i=e.getBoundingClientRect(),n=t.getBoundingClientRect(),s=window.innerWidth,r=window.innerHeight,o=i.bottom+12,a=i.right-n.width;if(a<12&&(a=12),a+n.width>s-12&&(a=Math.max(12,s-12-n.width)),o+n.height>r-12){let e=i.top-12-n.height;o=e>=12?e:Math.max(12,r-12-n.height)}M({position:"fixed",top:o,left:a,zIndex:60})},t=window.requestAnimationFrame(e);return window.addEventListener("resize",e),window.addEventListener("scroll",e,!0),()=>{window.cancelAnimationFrame(t),window.removeEventListener("resize",e),window.removeEventListener("scroll",e,!0)}},[g,v,b]);let L=(0,a.useMemo)(()=>new Intl.DateTimeFormat(void 0,{month:"long",year:"numeric"}),[]),z=(0,a.useMemo)(()=>L.format(v),[L,v]),D=(0,a.useMemo)(()=>g?(e=>{let t=new Date(e.getFullYear(),e.getMonth(),1),i=t.getDay(),n=eV(t,-i),s=new Date(e.getFullYear(),e.getMonth()+1,0),r=[],o=n;for(;;){let t=[];for(let i=0;i<7;i++){let n=eV(o,i);t.push({date:n,inCurrentMonth:n.getMonth()===e.getMonth()})}if(r.push({weekNumber:eX(t[3].date),days:t}),(o=eV(o,7))>s||r.length>=6)break}return r})(v):[],[g,v]),T=(0,a.useMemo)(()=>new Intl.DateTimeFormat(void 0,{weekday:"long",month:"long",day:"numeric"}),[]),O=(0,a.useMemo)(()=>new Intl.DateTimeFormat(void 0,{hour:"2-digit",minute:"2-digit",hour12:o}),[o]),F=(0,a.useMemo)(()=>new Intl.DateTimeFormat(void 0,{hour:"2-digit",minute:"2-digit",hour12:o}),[o]),R=(0,a.useCallback)(()=>{w(e=>!e)},[]),W=(0,a.useCallback)(()=>{w(!1)},[]),B=(0,a.useCallback)(e=>{x(t=>new Date(t.getFullYear(),t.getMonth()+e,1))},[]),K=(0,a.useCallback)(()=>{if(!u)return;let e=new Date(u);x(new Date(e.getFullYear(),e.getMonth(),1)),y(e)},[u]),U=(0,a.useCallback)((e,t)=>{let i=null;switch(e.key){case"ArrowRight":i=eV(t,1);break;case"ArrowLeft":i=eV(t,-1);break;case"ArrowDown":i=eV(t,7);break;case"ArrowUp":i=eV(t,-7);break;case"Home":i=eV(t,-t.getDay());break;case"End":i=eV(t,6-t.getDay());break;case"PageUp":i=e.shiftKey?eG(t,-1):eY(t,-1);break;case"PageDown":i=e.shiftKey?eG(t,1):eY(t,1);break;case"Enter":case" ":case"Spacebar":e.preventDefault(),w(!1),S.current&&S.current.focus({preventScroll:k});return;default:return}i&&(e.preventDefault(),y(i),(i.getMonth()!==v.getMonth()||i.getFullYear()!==v.getFullYear())&&x(new Date(i.getFullYear(),i.getMonth(),1)))},[k,v]),q=(0,a.useCallback)(()=>{w(!1)},[]),H=(0,a.useMemo)(()=>(e=>{let{currentTime:t,onlyDay:i,onlyTime:n,timeFormatter:s}=e;if(!t)return"";let r=eU[t.getDay()],o=eK[t.getMonth()],a=t.getDate(),l=s.format(t);if(n)return l;let d="".concat(r," ").concat(o," ").concat(a);return i?d:"".concat(d," ").concat(l)})({currentTime:u,onlyDay:t,onlyTime:s,timeFormatter:F}),[u,t,s,F]),V=(0,a.useMemo)(()=>u?T.format(u):"",[u,T]),Y=(0,a.useMemo)(()=>u?O.format(u):"",[u,O]),G=g?{...E,visibility:"number"==typeof E.top?"visible":"hidden"}:E,X=(0,n.jsxs)("div",{ref:j,id:P,role:"dialog","aria-modal":"false","aria-label":"Calendar",className:"fixed z-50 w-[24rem] max-w-[95vw] origin-top-right overflow-hidden rounded-3xl border border-white/10 bg-gradient-to-b from-slate-900/95 via-slate-950/90 to-slate-950/95 p-4 text-sm text-white shadow-2xl ring-1 ring-cyan-300/20 backdrop-blur-2xl animate-in fade-in zoom-in-95 duration-200",style:G,children:[(0,n.jsxs)("div",{className:"mb-4 flex items-center justify-between rounded-2xl border border-white/5 bg-white/5 px-3 py-2 shadow-inner",children:[(0,n.jsxs)("div",{className:"flex flex-col","aria-live":"polite",id:C,children:[(0,n.jsx)("span",{className:"text-[0.65rem] uppercase tracking-[0.22em] text-cyan-200/70",children:V}),(0,n.jsx)("span",{className:"text-base font-semibold tracking-tight text-white",children:z}),(0,n.jsx)("span",{className:"text-xs font-medium tracking-tight text-white/60",children:Y})]}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("button",{type:"button",onClick:()=>B(-1),className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-white/10 bg-slate-900/60 text-lg text-white/80 transition-colors hover:border-white/30 hover:bg-slate-800 hover:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-300","aria-label":"Previous month",children:"‹"}),(0,n.jsx)("button",{type:"button",onClick:()=>B(1),className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-white/10 bg-slate-900/60 text-lg text-white/80 transition-colors hover:border-white/30 hover:bg-slate-800 hover:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-300","aria-label":"Next month",children:"›"})]})]}),(0,n.jsxs)("table",{role:"grid","aria-labelledby":C,className:"w-full border-collapse text-center",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{role:"row",children:[(0,n.jsx)("th",{scope:"col",className:"w-12 pb-2 text-[0.6rem] font-semibold uppercase tracking-[0.35em] text-white/30","aria-label":"Week",children:"Wk"}),eU.map(e=>(0,n.jsx)("th",{scope:"col",className:"pb-2 text-[0.6rem] font-semibold uppercase tracking-[0.35em] text-white/60",children:e},e))]})}),(0,n.jsx)("tbody",{children:D.map(e=>(0,n.jsxs)("tr",{role:"row",children:[(0,n.jsx)("th",{scope:"row",className:"py-1 text-[0.65rem] font-semibold text-white/35","aria-label":"Week ".concat(e.weekNumber),children:e.weekNumber}),e.days.map(e=>{let{date:t,inCurrentMonth:i}=e,s=u&&eH(t,u),r=eH(t,b);return(0,n.jsx)("td",{role:"gridcell","aria-selected":r,className:"p-1",children:(0,n.jsx)("button",{type:"button",onClick:q,onKeyDown:e=>U(e,t),className:"flex h-9 w-9 items-center justify-center rounded-2xl text-sm font-medium transition duration-150 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-300 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-950 ".concat(i?"text-white":"text-white/35"," ").concat(s?"bg-gradient-to-br from-cyan-400 via-sky-500 to-blue-600 text-slate-950 shadow-lg ring-1 ring-white/60":r?"bg-white/20 text-white shadow-inner":"hover:bg-white/10"),tabIndex:r?0:-1,ref:r?A:null,children:t.getDate()})},t.toISOString())})]},"week-".concat(e.days[0].date.toISOString())))})]}),(0,n.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,n.jsx)("button",{type:"button",onClick:K,className:"rounded-full bg-gradient-to-r from-cyan-400 via-sky-500 to-blue-600 px-4 py-1.5 text-[0.65rem] font-semibold uppercase tracking-[0.3em] text-slate-950 shadow focus:outline-none focus-visible:ring-2 focus-visible:ring-white/80",children:"Today"}),(0,n.jsx)("button",{type:"button",onClick:W,className:"rounded-full border border-white/20 px-3 py-1.5 text-[0.65rem] font-medium uppercase tracking-[0.3em] text-white/70 transition hover:border-white/40 hover:bg-white/10 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-300",children:"Close"})]})]});if(!u)return(0,n.jsx)("span",{suppressHydrationWarning:!0});if(!(r||!t&&!s))return(0,n.jsx)("span",{suppressHydrationWarning:!0,children:H});let J="minimal"===l;return(0,n.jsxs)("div",{className:"relative inline-flex items-center ".concat(J?"justify-end":""),suppressHydrationWarning:!0,children:[(0,n.jsxs)("button",{type:"button",ref:S,onClick:R,className:J?"group flex items-center gap-1 rounded px-0 py-0 text-right text-sm font-semibold text-white/80 transition-colors duration-150 hover:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-300/80 focus-visible:ring-offset-0":"group flex items-center gap-1 rounded-full border border-white/10 bg-white/5 px-3 py-1.5 text-left text-sm font-medium text-white shadow-sm transition-colors duration-200 hover:border-white/20 hover:bg-white/15 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-300/80 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900","aria-haspopup":"dialog","aria-expanded":g,"aria-controls":P,children:[(0,n.jsx)("span",{className:J?"font-mono text-sm md:text-base tracking-tight":"truncate text-xs md:text-sm tracking-tight","aria-live":"polite",children:H}),r&&!J?(0,n.jsx)("span",{"aria-hidden":!0,className:"inline-flex h-4 w-4 items-center justify-center rounded-full bg-cyan-500/80 text-[0.6rem] font-semibold text-slate-950 shadow ring-1 ring-white/40 transition-transform duration-200 group-hover:scale-105",children:"☰"}):null]}),g?N&&"undefined"!=typeof document?(0,eB.createPortal)(X,document.body):X:null]})};var eZ=i(56187);let e$=["Enter"," ","Spacebar","Escape"];function eQ(e){let{bgImageName:t,useKaliWallpaper:i}=(0,c.useSettings)(),s=t||e.bgImgName||"wall-2",r=i||"kali-gradient"===s,o=(0,a.useRef)(null),l=(0,a.useRef)(null),d=(0,a.useCallback)(()=>{let e=l.current||o.current;e&&"function"==typeof e.focus&&e.focus({preventScroll:!0})},[]);(0,a.useEffect)(()=>{if(!e.isLocked)return;let t=()=>{window.removeEventListener("click",i),window.removeEventListener("keydown",n)},i=()=>{var i;t(),null==(i=e.unLockScreen)||i.call(e)},n=t=>{if(e.isLocked){if("Tab"===t.key){t.preventDefault(),d();return}!["Shift","Control","Alt","Meta"].includes(t.key)&&e$.includes(t.key)&&(t.preventDefault(),i())}};return d(),window.addEventListener("click",i,{once:!0}),window.addEventListener("keydown",n),()=>{t()}},[d,e.isLocked,e.unLockScreen]);let u=(0,a.useMemo)(()=>{let t=e.isLocked?"blur-sm":"blur-none",i="absolute top-0 left-0 h-full w-full transform z-20 transition duration-500 motion-reduce:duration-0 motion-reduce:transition-none ".concat(t);return r?(0,n.jsx)(eZ.default,{className:i}):(0,n.jsx)("img",{src:"/wallpapers/".concat(s,".webp"),alt:"",className:"".concat(i," object-cover")})},[s,e.isLocked,r]);return(0,n.jsxs)("div",{id:"ubuntu-lock-screen",ref:o,style:{zIndex:"100",contentVisibility:"auto"},"aria-hidden":!e.isLocked,role:e.isLocked?"dialog":void 0,"aria-modal":!!e.isLocked||void 0,tabIndex:-1,className:(e.isLocked?" visible translate-y-0 ":" invisible -translate-y-full ")+" absolute outline-none bg-black bg-opacity-90 transform duration-500 motion-reduce:duration-0 motion-reduce:transition-none select-none top-0 right-0 overflow-hidden m-0 p-0 h-screen w-screen",children:[u,(0,n.jsxs)("div",{className:"w-full h-full z-50 overflow-hidden relative flex flex-col justify-center items-center text-white",children:[(0,n.jsx)("button",{type:"button",ref:l,className:"sr-only",onClick:e.unLockScreen,children:"Unlock screen"}),(0,n.jsx)("span",{className:"sr-only",children:"Press Enter, Space, or Escape to unlock."}),(0,n.jsx)("div",{className:" text-7xl",children:(0,n.jsx)(eJ,{onlyTime:!0})}),(0,n.jsx)("div",{className:"mt-4 text-xl font-medium",children:(0,n.jsx)(eJ,{onlyDay:!0})}),(0,n.jsx)("div",{className:" mt-16 text-base",children:"Click or press Enter, Space, or Escape to unlock"})]})]})}let e0={muted:"/themes/Yaru/status/audio-volume-muted-symbolic.svg",low:"/themes/Yaru/status/audio-volume-low-symbolic.svg",medium:"/themes/Yaru/status/audio-volume-medium-symbolic.svg",high:"/themes/Yaru/status/audio-volume-high-symbolic.svg"},e1=e=>"number"==typeof e&&Number.isFinite(e)&&e>=0&&e<=1,e2=e=>"".concat(Math.round(100*e),"%"),e5=e=>{let{className:t="",isOpen:i,onToggle:s}=e,[r,o]=(0,ej.default)("system-volume",()=>.7,e1),[l,c]=(0,ej.default)("system-volume-muted",!1,e=>"boolean"==typeof e),[u,h]=(0,a.useState)(!1),p="boolean"==typeof i,m=p?i:u,f=(0,a.useCallback)(e=>{p?("function"==typeof e?e(m):e)!==m&&s&&s():h(e)},[p,m,s]),g=(0,a.useRef)(null),w=(0,a.useRef)(null),v=(0,a.useMemo)(()=>l||r<=.001?"muted":r<=.33?"low":r<=.66?"medium":"high",[r,l]),x=(0,a.useCallback)(e=>{o(t=>Number(Math.min(1,Math.max(0,"function"==typeof e?e(t):e)).toFixed(2)))},[o]),b=e=>{e.preventDefault(),e.stopPropagation();let t=e.deltaY>0?-1:1,i=(e.shiftKey?.02:.05)*t;x(e=>e+i)};(0,a.useEffect)(()=>{if(!m)return;let e=e=>{g.current&&(g.current.contains(e.target)||f(!1))},t=e=>{"Escape"===e.key&&f(!1)};return document.addEventListener("pointerdown",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("pointerdown",e),document.removeEventListener("keydown",t)}},[m]),(0,a.useEffect)(()=>{if(m){var e;null==(e=w.current)||e.focus({preventScroll:!0})}},[m]);let y=l?0:r;return(0,n.jsxs)("div",{ref:g,className:"relative flex items-center ".concat(t).trim(),onWheel:b,children:[(0,n.jsx)("button",{type:"button",className:"flex h-full w-full items-center justify-center rounded-full focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-400","aria-label":"Volume ".concat(l?"muted":e2(r)),"aria-haspopup":"true","aria-expanded":m,title:"Volume ".concat(l?"muted":e2(r)),onClick:e=>{e.stopPropagation(),f(e=>!e)},onPointerDown:e=>e.stopPropagation(),children:(0,n.jsx)(d(),{width:16,height:16,src:e0[v],alt:"".concat(v," volume"),className:"status-symbol h-4 w-4",draggable:!1,sizes:"16px"})}),m&&(0,n.jsxs)("div",{className:"absolute top-full mt-2 right-0 z-[300] w-44 origin-top-right rounded-xl border border-white/10 bg-slate-950/95 p-3 text-xs text-white shadow-[0_16px_32px_-8px_rgba(0,0,0,0.5)] backdrop-blur-xl animate-in fade-in slide-in-from-top-2 duration-200",onClick:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),onWheel:b,children:[(0,n.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-[10px] font-semibold uppercase tracking-wider text-slate-400",children:"Volume"}),(0,n.jsx)("span",{className:"text-sm font-medium tabular-nums",children:l?"Muted":e2(r)})]}),(0,n.jsxs)("div",{className:"relative mb-3 h-1.5 w-full overflow-hidden rounded-full bg-slate-800",children:[(0,n.jsx)("div",{className:"absolute inset-y-0 left-0 rounded-full transition-all duration-100 ".concat(l?"bg-slate-600":"bg-cyan-400"),style:{width:"".concat(100*y,"%")}}),(0,n.jsx)("input",{ref:w,type:"range",min:0,max:100,step:1,value:Math.round(100*y),onChange:e=>{e.stopPropagation(),x(Number(e.target.value)/100)},className:"absolute inset-0 h-full w-full cursor-pointer opacity-0","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":Math.round(100*y),"aria-label":"Volume level",disabled:l})]}),(0,n.jsxs)("button",{type:"button",onClick:()=>{c(e=>!e)},className:"flex w-full items-center justify-center gap-2 rounded-lg py-2 text-xs font-medium transition-all ".concat(l?"bg-cyan-500/20 text-cyan-300":"bg-white/[0.06] text-slate-300 hover:bg-white/[0.1]"),children:[(0,n.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:l?(0,n.jsx)("path",{d:"M11 5L6 9H2v6h4l5 4V5zM23 9l-6 6M17 9l6 6"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}),(0,n.jsx)("path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07"})]})}),l?"Unmute":"Mute"]})]})]})},e3=e=>Math.min(1,Math.max(0,e)),e4=(e,t)=>t?"#34d399":e<=.15?"#f87171":e<=.4?"#facc15":"#a3e635",e9=e=>{let{level:t,charging:i}=e,s=e3(t),r=Math.max(0,12*s),o=e4(s,i);return(0,n.jsxs)("svg",{className:"status-symbol h-4 w-4",width:16,height:16,viewBox:"0 0 20 12",role:"img","aria-hidden":"true",children:[(0,n.jsx)("rect",{x:"1",y:"1",width:"16",height:"10",rx:"2",ry:"2",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.85"}),(0,n.jsx)("rect",{x:"17",y:"4",width:"2.5",height:"4",rx:"1.2",fill:"currentColor",opacity:"0.85"}),(0,n.jsx)("rect",{x:"2.5",y:"2.5",width:r,height:"7",rx:"1.5",fill:o,style:{transition:"width 150ms ease"}}),i&&(0,n.jsx)("path",{d:"M10 2.8 7.2 7.6h2.1L8.7 10l3-4.8H9.8L10 2.8Z",fill:"#0ea5e9",stroke:"#0ea5e9",strokeWidth:"0.4",opacity:"0.95"})]})},e6=()=>(0,n.jsxs)("svg",{className:"status-symbol h-4 w-4",width:16,height:16,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",role:"img","aria-hidden":"true",children:[(0,n.jsx)("path",{d:"M12 2v4"}),(0,n.jsx)("path",{d:"M12 18v4"}),(0,n.jsx)("path",{d:"M8.5 2H8a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-.5"}),(0,n.jsx)("path",{d:"M6 12h12"})]}),e8=e=>{if(!Number.isFinite(e)||0===e)return null;let t=Math.floor(e/3600),i=Math.floor(e%3600/60);return t>0?"".concat(t,"h ").concat(i,"m"):"".concat(i,"m")},e7=e=>{let{className:t="",isOpen:i,onToggle:s}=e,[r,o]=(0,a.useState)(!1),l="boolean"==typeof i,d=l?i:r,c=(0,a.useCallback)(e=>{l?("function"==typeof e?e(d):e)!==d&&s&&s():o(e)},[l,d,s]),u=(0,a.useRef)(null),[h,p]=(0,a.useState)(1),[m,f]=(0,a.useState)(!0),[g,w]=(0,a.useState)(0),[v,x]=(0,a.useState)(1/0),[b,y]=(0,a.useState)(!1),[k,S]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e,t=()=>{p(e.level),f(e.charging),w(e.chargingTime),x(e.dischargingTime),y(!0),S(!0)};return"undefined"!=typeof navigator&&navigator.getBattery?navigator.getBattery().then(i=>{e=i,t(),i.addEventListener("levelchange",t),i.addEventListener("chargingchange",t),i.addEventListener("chargingtimechange",t),i.addEventListener("dischargingtimechange",t)}).catch(()=>{y(!1),S(!0)}):(y(!1),S(!0)),()=>{e&&(e.removeEventListener("levelchange",t),e.removeEventListener("chargingchange",t),e.removeEventListener("chargingtimechange",t),e.removeEventListener("dischargingtimechange",t))}},[]),(0,a.useEffect)(()=>{if(!d)return;let e=e=>{u.current&&(u.current.contains(e.target)||c(!1))},t=e=>{"Escape"===e.key&&c(!1)};return document.addEventListener("pointerdown",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("pointerdown",e),document.removeEventListener("keydown",t)}},[d]);let j=(0,a.useMemo)(()=>"".concat(Math.round(100*e3(h)),"%"),[h]),A=!k||!b||m&&h>=.99,I=k?"".concat(j," • ").concat(m?"Charging":"On battery"):"Power Status",C=(0,a.useMemo)(()=>{if(m){if(h>=1)return"Fully charged";let e=e8(g);return e?"".concat(e," until full"):"Charging"}let e=e8(v);return e?"".concat(e," remaining"):"On Battery"},[m,h,g,v]);return(0,n.jsxs)("div",{ref:u,className:"relative flex items-center ".concat(t).trim(),children:[(0,n.jsx)("button",{type:"button",className:"flex h-full w-full items-center justify-center rounded-full focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-400","aria-label":I,"aria-haspopup":"true","aria-expanded":d,title:I,onClick:e=>{e.stopPropagation(),c(e=>!e)},onPointerDown:e=>e.stopPropagation(),children:(0,n.jsx)("span",{className:"relative inline-flex items-center justify-center text-slate-200",children:A?(0,n.jsx)(e6,{}):(0,n.jsx)(e9,{level:h,charging:m})})}),d&&(0,n.jsxs)("div",{className:"absolute top-full mt-2 right-0 z-[300] w-52 origin-top-right rounded-xl border border-white/10 bg-slate-950/95 p-3 text-xs text-white shadow-[0_16px_32px_-8px_rgba(0,0,0,0.5)] backdrop-blur-xl animate-in fade-in slide-in-from-top-2 duration-200",role:"menu","aria-label":"Battery menu",onClick:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-[10px] font-semibold uppercase tracking-wider text-slate-400",children:"Power"}),(0,n.jsxs)("div",{className:"flex items-center gap-1.5",children:[m&&(0,n.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"#34d399",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),(0,n.jsx)("span",{className:"text-sm font-medium tabular-nums",children:b?j:"AC"})]})]}),b&&(0,n.jsx)("div",{className:"relative mb-3 h-2 w-full overflow-hidden rounded-full bg-slate-800",children:(0,n.jsx)("div",{className:"absolute inset-y-0 left-0 rounded-full transition-all duration-200",style:{width:"".concat(100*h,"%"),backgroundColor:e4(h,m)}})}),(0,n.jsx)("div",{className:"text-center text-[10px] text-slate-400 mb-1",children:b?C:"Plugged in • No battery detected"}),(0,n.jsxs)("div",{className:"mt-3 flex flex-col gap-1 border-t border-white/5 pt-2 text-[10px] text-slate-500",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"Status"}),(0,n.jsx)("span",{className:"text-slate-300",children:m?"Plugged In":"Discharging"})]}),b&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"Health"}),(0,n.jsx)("span",{className:"text-slate-300",children:"Good"})]})]})]})]})};var te=i(21746),tt=i.n(te),ti=i(4454),tn=i(43239);let ts=e=>{let{icon:t,label:i,onClick:s,active:r}=e;return(0,n.jsxs)("button",{onClick:s,className:"group flex flex-col items-center gap-2 rounded-xl p-3 transition-all duration-200 border ".concat(r?"bg-cyan-500/20 text-cyan-300 border-cyan-500/30 shadow-[0_0_12px_-4px_rgba(34,211,238,0.4)]":"bg-white/5 text-slate-300 border-white/5 hover:bg-white/10 hover:border-white/10 hover:text-white"),children:[(0,n.jsx)("span",{className:"h-6 w-6 transition-transform group-hover:scale-110 duration-200 ".concat(r?"animate-pulse":""),children:t}),(0,n.jsx)("span",{className:"text-[10px] font-bold tracking-tight",children:i})]})},tr=()=>(0,n.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),(0,n.jsx)("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),(0,n.jsx)("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),(0,n.jsx)("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),(0,n.jsx)("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2"}),(0,n.jsx)("path",{d:"M12 12h.01"})]}),to=()=>(0,n.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M2 16.1A5 5 0 0 1 5.9 20"}),(0,n.jsx)("path",{d:"M2 12.05A9 9 0 0 1 9.95 20"}),(0,n.jsx)("path",{d:"M2 8V6a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-6"}),(0,n.jsx)("line",{x1:"2",y1:"20",x2:"2.01",y2:"20"})]}),ta=()=>(0,n.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"}),(0,n.jsx)("circle",{cx:"12",cy:"12",r:"3",fill:"currentColor",stroke:"none"})]}),tl=()=>(0,n.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"18",cy:"5",r:"3"}),(0,n.jsx)("circle",{cx:"6",cy:"12",r:"3"}),(0,n.jsx)("circle",{cx:"18",cy:"19",r:"3"}),(0,n.jsx)("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),(0,n.jsx)("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),td=()=>(0,n.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}),(0,n.jsx)("path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07"}),(0,n.jsx)("path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14"})]}),tc=()=>(0,n.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}),(0,n.jsx)("line",{x1:"23",y1:"9",x2:"17",y2:"15"}),(0,n.jsx)("line",{x1:"17",y1:"9",x2:"23",y2:"15"})]}),tu=()=>(0,n.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"5"}),(0,n.jsx)("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),th=()=>(0,n.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),tp=()=>(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,n.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),tm=()=>(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.72v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),(0,n.jsx)("circle",{cx:"12",cy:"12",r:"3"})]}),tf=e=>{let{className:t="",isOpen:i,onToggle:s}=e,[r,o]=(0,a.useState)(!1),l="boolean"==typeof i,d=l?i:r,u=(0,a.useCallback)(e=>{l?("function"==typeof e?e(d):e)!==d&&s&&s():o(e)},[l,d,s]),h=(0,a.useRef)(null),{theme:p,setTheme:m}=(0,ti.useTheme)(),{fontScale:f,setFontScale:g,volume:w,setVolume:v}=(0,c.useSettings)(),x=(0,tn.isDarkTheme)(p),[b,y]=(0,a.useState)(!1);(0,a.useEffect)(()=>{y(!0)},[]);let[k,S]=(0,a.useState)(null),j=(0,a.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";S({message:e,type:t}),setTimeout(()=>S(null),3e3)},[]),[A,I]=(0,a.useState)(!1),C=(0,a.useRef)(null),P=(0,a.useRef)(null),[N,_]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(!d){I(!1),_(null);return}let e=e=>{h.current&&(h.current.contains(e.target)||u(!1))},t=e=>{"Escape"===e.key&&u(!1)};return document.addEventListener("pointerdown",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("pointerdown",e),document.removeEventListener("keydown",t)}},[d]);let E=(0,a.useCallback)(async()=>{if("undefined"==typeof navigator||!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return void j("Camera not supported","error");I(!0),_(null);try{let e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});C.current&&(C.current.srcObject=e,C.current.play(),requestAnimationFrame(L))}catch(e){console.error("Camera access denied",e),I(!1),j("Camera access denied","error")}},[j]),M=(0,a.useCallback)(()=>{I(!1),C.current&&C.current.srcObject&&(C.current.srcObject.getTracks().forEach(e=>e.stop()),C.current.srcObject=null)},[]),L=()=>{if(C.current&&P.current&&A){if(C.current.readyState===C.current.HAVE_ENOUGH_DATA){let e=C.current,t=P.current,i=t.getContext("2d");if(!i)return;t.height=e.videoHeight,t.width=e.videoWidth,i.drawImage(e,0,0,t.width,t.height);let n=i.getImageData(0,0,t.width,t.height),s=tt()(n.data,n.width,n.height,{inversionAttempts:"dontInvert"});s&&(_(s.data),M(),s.data.startsWith("http")&&j("URL Detected","success"))}A&&requestAnimationFrame(L)}};(0,a.useEffect)(()=>{A||M()},[A,M]);let z=async()=>{let e={title:document.title,url:window.location.href};if(navigator.share&&navigator.canShare&&navigator.canShare(e))try{await navigator.share(e)}catch(e){console.error(e)}else try{await navigator.clipboard.writeText(window.location.href),j("Link copied to clipboard","success")}catch(e){j("Failed to copy link","error")}};return b?(0,n.jsxs)("div",{ref:h,className:"relative flex items-center ".concat(t).trim(),children:[(0,n.jsx)("button",{type:"button",className:"flex h-full w-full items-center justify-center rounded-full focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-400",onClick:e=>{e.stopPropagation(),u(e=>!e)},"aria-label":"Control Center","aria-expanded":d,title:"Control Center",onPointerDown:e=>e.stopPropagation(),children:(0,n.jsx)("div",{className:"status-symbol h-4 w-4 relative flex items-center justify-center transition-transform group-hover:scale-105 text-white/90",children:(0,n.jsx)(tm,{})})}),d&&(0,n.jsxs)("div",{className:"absolute top-full right-0 z-[300] mt-3 w-80 max-w-[calc(100vw-2rem)] origin-top-right rounded-2xl border border-white/10 bg-slate-950/95 p-4 text-white shadow-[0_24px_48px_-12px_rgba(0,0,0,0.7)] backdrop-blur-xl animate-in fade-in zoom-in-95 duration-200",onClick:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,n.jsx)("h3",{className:"text-sm font-bold uppercase tracking-wider text-white",children:"Control Center"}),(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsx)("button",{onClick:()=>m(x?"default":"dark"),className:"rounded-full bg-white/5 p-2 hover:bg-white/10 transition-colors",title:"Toggle Theme",children:x?(0,n.jsx)(th,{}):(0,n.jsx)(tu,{})})})]}),A?(0,n.jsxs)("div",{className:"mb-4 relative rounded-xl overflow-hidden aspect-video bg-black max-h-[40vh]",children:[(0,n.jsx)("video",{ref:C,className:"w-full h-full object-cover",muted:!0,playsInline:!0}),(0,n.jsx)("canvas",{ref:P,className:"hidden"}),(0,n.jsx)("button",{onClick:M,className:"absolute top-2 right-2 bg-black/50 p-2 rounded-full text-white hover:bg-black/70 transition-colors",children:(0,n.jsx)(tp,{})}),(0,n.jsx)("div",{className:"absolute bottom-4 left-0 right-0 text-center text-xs text-white/80 bg-black/40 py-1",children:"Scanning..."})]}):N?(0,n.jsxs)("div",{className:"mb-4 p-3 rounded-xl bg-white/10 break-all",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsx)("div",{className:"text-[10px] text-slate-400 uppercase font-bold",children:"Scan Result"}),(0,n.jsx)("button",{onClick:()=>_(null),className:"p-1 rounded hover:bg-white/10 text-slate-400 hover:text-white",children:(0,n.jsx)(tp,{})})]}),(0,n.jsx)("div",{className:"text-sm mb-3 font-mono bg-black/20 p-2 rounded border border-white/5 selection:bg-cyan-500/30 selection:text-cyan-100",children:N}),(0,n.jsxs)("div",{className:"flex gap-2",children:[N.startsWith("http")&&(0,n.jsx)("a",{href:N,target:"_blank",rel:"noopener noreferrer",className:"flex-1 text-center px-3 py-2 rounded-lg bg-cyan-500/20 text-cyan-300 text-xs font-bold hover:bg-cyan-500/30 transition-colors border border-cyan-500/30",children:"Open Link"}),(0,n.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(N),j("Copied","success")},className:"flex-1 px-3 py-2 rounded-lg bg-white/10 text-white text-xs font-bold hover:bg-white/20 transition-colors border border-white/10",children:"Copy"})]})]}):null,k&&(0,n.jsx)("div",{className:"absolute top-20 left-1/2 -translate-x-1/2 z-[400] w-max max-w-[90%] pointer-events-none",children:(0,n.jsxs)("div",{className:"px-4 py-2 rounded-xl shadow-xl border backdrop-blur-md text-xs font-bold animate-in fade-in slide-in-from-top-2 flex items-center gap-2 ".concat("error"===k.type?"bg-red-500/90 border-red-400/50 text-white shadow-red-900/20":"success"===k.type?"bg-emerald-500/90 border-emerald-400/50 text-white shadow-emerald-900/20":"bg-slate-800/90 border-white/10 text-white shadow-black/40"),children:["success"===k.type&&(0,n.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-white animate-pulse"}),k.message]})}),(0,n.jsxs)("div",{className:"grid grid-cols-4 gap-3 mb-4",children:[(0,n.jsx)(ts,{icon:(0,n.jsx)(tr,{}),label:"Scan QR",onClick:E,active:A}),(0,n.jsx)(ts,{icon:(0,n.jsx)(to,{}),label:"Cast",onClick:()=>{j("Searching for devices...","info")}}),(0,n.jsx)(ts,{icon:(0,n.jsx)(ta,{}),label:"Record",onClick:()=>{u(!1),window.dispatchEvent(new CustomEvent("open-app",{detail:"screen-recorder"}))}}),(0,n.jsx)(ts,{icon:(0,n.jsx)(tl,{}),label:"Share",onClick:z})]}),(0,n.jsxs)("div",{className:"mb-3 p-3 rounded-xl bg-white/5 border border-white/5",children:[(0,n.jsxs)("div",{className:"flex justify-between text-xs mb-2 font-medium",children:[(0,n.jsx)("span",{className:"text-slate-300",children:"Text Size"}),(0,n.jsxs)("span",{className:"text-cyan-300",children:[Math.round(100*f),"%"]})]}),(0,n.jsxs)("div",{className:"relative h-2 w-full overflow-hidden rounded-full bg-slate-800/80 ring-1 ring-white/10",children:[(0,n.jsx)("div",{className:"absolute inset-y-0 left-0 bg-cyan-500 rounded-full transition-all duration-100",style:{width:"".concat(Math.min(100,Math.max(0,(f-.5)*100)),"%")}}),(0,n.jsx)("input",{type:"range",min:"0.5",max:"1.5",step:"0.1",value:f,onChange:e=>g(parseFloat(e.target.value)),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer","aria-label":"Text Size"})]}),(0,n.jsxs)("div",{className:"flex justify-between text-[10px] text-slate-500 mt-1 font-medium",children:[(0,n.jsx)("span",{children:"A"}),(0,n.jsx)("span",{children:"A"})]})]}),(0,n.jsxs)("div",{className:"mb-2 p-3 rounded-xl bg-white/5 border border-white/5 flex gap-3 items-center",children:[(0,n.jsx)("button",{className:"p-1.5 rounded-lg hover:bg-white/10 text-slate-400 hover:text-white transition-colors",onClick:()=>v(100*(0===w)),children:0===w?(0,n.jsx)(tc,{}):(0,n.jsx)(td,{})}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex justify-between text-xs mb-2 font-medium",children:[(0,n.jsx)("span",{className:"text-slate-300",children:"Volume"}),(0,n.jsxs)("span",{className:"text-cyan-300",children:[Math.round(w),"%"]})]}),(0,n.jsxs)("div",{className:"relative h-2 w-full overflow-hidden rounded-full bg-slate-800/80 ring-1 ring-white/10",children:[(0,n.jsx)("div",{className:"absolute inset-y-0 left-0 bg-cyan-500 rounded-full transition-all duration-100",style:{width:"".concat(w,"%")}}),(0,n.jsx)("input",{type:"range",min:"0",max:"100",step:"1",value:w,onChange:e=>v(parseFloat(e.target.value)),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer","aria-label":"Volume"})]})]})]})]})]}):null};function tg(e){let{className:t="",activeDropdown:i,onDropdownToggle:s}=e,[r,o]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=async()=>{var e;if(null==(e=window)?void 0:e.location)try{let e=new URL("/favicon.ico",window.location.href).toString();await fetch(e,{method:"HEAD",cache:"no-store"}),o(!0)}catch(e){o(!1)}},t=()=>{let t=navigator.onLine;o(t),t&&e()};return t(),window.addEventListener("online",t),window.addEventListener("offline",t),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",t)}},[]);let l=["status-cluster flex items-center gap-0.5 text-[0.75rem] font-medium text-white/80",t].filter(Boolean).join(" "),d="flex items-center justify-center h-8 w-8 rounded-full bg-white/[0.06] hover:bg-white/[0.12] active:bg-white/[0.18] transition-all duration-150 backdrop-blur-sm border border-white/[0.06] hover:border-white/[0.12]";return(0,n.jsxs)("div",{className:l,role:"status","aria-live":"polite",children:[(0,n.jsx)(tf,{className:d,isOpen:"control-center"===i,onToggle:()=>s&&s("control-center")}),(0,n.jsx)(e5,{className:d,isOpen:"volume"===i,onToggle:()=>s&&s("volume")}),(0,n.jsx)(e7,{className:d,isOpen:"battery"===i,onToggle:()=>s&&s("battery")})]})}let tw="whisker-menu-category",tv=[{id:"all",label:"All Applications",icon:"/themes/Yaru/system/view-app-grid-symbolic.svg",type:"all"},{id:"favorites",label:"Favorites",icon:"/themes/Yaru/status/projects.svg",type:"favorites"},{id:"recent",label:"Recent",icon:"/themes/Yaru/status/process-working-symbolic.svg",type:"recent"},{id:"information-gathering",label:"Information Gathering",icon:"/themes/Yaru/apps/radar-symbolic.svg",type:"ids",appIds:["nmap-nse","reconng","kismet","wireshark"]},{id:"vulnerability-analysis",label:"Vulnerability Analysis",icon:"/themes/Yaru/apps/nessus.svg",type:"ids",appIds:["nessus","openvas","nikto"]},{id:"web-app-analysis",label:"Web App Analysis",icon:"/themes/Yaru/apps/http.svg",type:"ids",appIds:["http","beef","metasploit"]},{id:"password-attacks",label:"Password Attacks",icon:"/themes/Yaru/apps/john.svg",type:"ids",appIds:["john","hashcat","hydra"]},{id:"wireless-attacks",label:"Wireless Attacks",icon:"/themes/Yaru/status/network-wireless-signal-good-symbolic.svg",type:"ids",appIds:["kismet","reaver","wireshark"]},{id:"exploitation-tools",label:"Exploitation Tools",icon:"/themes/Yaru/apps/metasploit.svg",type:"ids",appIds:["metasploit","security-tools","beef"]},{id:"sniffing-spoofing",label:"Sniffing & Spoofing",icon:"/themes/Yaru/apps/ettercap.svg",type:"ids",appIds:["dsniff","ettercap","wireshark"]},{id:"post-exploitation",label:"Post Exploitation",icon:"/themes/Yaru/apps/msf-post.svg",type:"ids",appIds:["msf-post","mimikatz","volatility"]},{id:"forensics-reporting",label:"Forensics & Reporting",icon:"/themes/Yaru/apps/autopsy.svg",type:"ids",appIds:["autopsy","evidence-vault","project-gallery"]}],tx=e=>{let{isOpen:t,onToggle:i}=e,[s,r]=(0,a.useState)(!1),o="boolean"==typeof t,l=o?t:s,c=(0,a.useCallback)(e=>{o?("function"==typeof e?e(l):e)!==l&&i&&i():r(e)},[o,l,i]),[u,h]=(0,a.useState)(!1),[p,m]=(0,a.useState)({}),g=(0,a.useRef)(null),[w,v]=(0,a.useState)("all"),[x,b]=(0,a.useState)(!0),[y,k]=(0,a.useState)(""),[S,j]=(0,a.useState)([]),[A,I]=(0,a.useState)(0),[C,P]=(0,a.useState)(0),N=(0,a.useRef)(null),_=(0,a.useRef)(null),E=(0,a.useRef)(null),M=(0,a.useRef)([]),L=(0,a.useRef)(null),T=(0,a.useRef)(null),O=(0,a.useRef)(null),F=f.default,R=(0,a.useMemo)(()=>F.filter(e=>e.favourite),[F]);(0,a.useEffect)(()=>{let e=window.matchMedia("(min-width: 640px)"),t=e=>{b(e.matches)};return(b(e.matches),"function"==typeof e.addEventListener)?(e.addEventListener("change",t),()=>{e.removeEventListener("change",t)}):(e.addListener(t),()=>{e.removeListener(t)})},[]),(0,a.useEffect)(()=>{j((0,D.readRecentAppIds)())},[]),(0,a.useEffect)(()=>{l&&j((0,D.readRecentAppIds)())},[l]),(0,a.useLayoutEffect)(()=>{if(!l)return;let e=()=>{let e=L.current;if(!e)return;let t=_.current,i=document.activeElement;if((!(t&&i instanceof HTMLElement&&t.contains(i))||i===e)&&(e.focus(),"function"==typeof e.setSelectionRange)){let t=e.value.length;e.setSelectionRange(t,t)}};return O.current=window.requestAnimationFrame(()=>{e(),T.current=window.setTimeout(e,120)}),()=>{null!==O.current&&(window.cancelAnimationFrame(O.current),O.current=null),null!==T.current&&(window.clearTimeout(T.current),T.current=null)}},[l]),es(_,l,{restoreFocusRef:N});let W=(0,a.useMemo)(()=>{let e=new Map(F.map(e=>[e.id,e]));return S.map(t=>e.get(t)).filter(e=>!!e)},[F,S]),B=(0,a.useMemo)(()=>{let e=new Map(F.map(e=>[e.id,e]));return tv.map(t=>{let i=[];switch(t.type){case"all":default:i=F;break;case"favorites":i=R;break;case"recent":i=W;break;case"ids":i=t.appIds.map(t=>e.get(t)).filter(e=>!!e)}return{...t,apps:i}})},[F,R,W]),K=(0,a.useMemo)(()=>{let e=B.find(e=>e.id===w);return null!=e?e:B[0]},[w,B]),U=(0,a.useMemo)(()=>{let e=(null==K?void 0:K.apps)?[...K.apps]:[];if(y){let t=y.toLowerCase();return e.filter(e=>e.title.toLowerCase().includes(t)).sort((e,t)=>e.title.localeCompare(t.title))}return e.sort((e,t)=>e.title.localeCompare(t.title))},[K,y]);(0,a.useEffect)(()=>{let e=null===z.safeLocalStorage||void 0===z.safeLocalStorage?void 0:z.safeLocalStorage.getItem(tw);e&&tv.some(t=>t.id===e)&&v(e)},[]),(0,a.useEffect)(()=>{null===z.safeLocalStorage||void 0===z.safeLocalStorage||z.safeLocalStorage.setItem(tw,K.id)},[K.id]),(0,a.useEffect)(()=>{u&&I(0)},[u,w,y]),(0,a.useEffect)(()=>{if(!u)return;let e=B.findIndex(e=>e.id===K.id);P(-1===e?0:e)},[u,K.id,B]);let q=(0,a.useCallback)(e=>{window.dispatchEvent(new CustomEvent("open-app",{detail:e})),c(!1)},[c]);(0,a.useEffect)(()=>!l&&u?(g.current=setTimeout(()=>{h(!1)},180),()=>{g.current&&clearTimeout(g.current)}):(l&&g.current&&(clearTimeout(g.current),g.current=null),()=>{g.current&&(clearTimeout(g.current),g.current=null)}),[l,u]);let H=(0,a.useCallback)(()=>{h(!0),requestAnimationFrame(()=>c(!0))},[c]),V=(0,a.useCallback)(()=>{c(!1)},[c]),Y=(0,a.useCallback)(()=>{l||u?V():H()},[V,l,u,H]);(0,a.useEffect)(()=>{let e=e=>{var t;let i="Meta"===e.key&&!e.ctrlKey&&!e.shiftKey&&!e.altKey,n="F1"===e.key&&e.altKey&&!e.metaKey&&!e.ctrlKey&&!e.shiftKey;if(i||n){e.preventDefault(),Y();return}if(!u)return;let s=e.target instanceof Node?e.target:null;if(!(s&&(null==(t=E.current)?void 0:t.contains(s)))){if("Escape"===e.key)V();else if("ArrowDown"===e.key)e.preventDefault(),I(e=>Math.min(e+1,U.length-1));else if("ArrowUp"===e.key)e.preventDefault(),I(e=>Math.max(e-1,0));else if("Enter"===e.key){e.preventDefault();let t=U[A];t&&q(t.id)}}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[U,A,V,u,q,Y]),(0,a.useEffect)(()=>{let e=e=>{var t,i;if(!u)return;let n=e.target instanceof Node?e.target:null;n&&((null==(t=_.current)?void 0:t.contains(n))||(null==(i=N.current)?void 0:i.contains(n))||V())};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[V,u]),(0,a.useEffect)(()=>()=>{g.current&&clearTimeout(g.current)},[]),(0,a.useEffect)(()=>{if(!u)return void m({});let e=()=>{let e=N.current;if(!e||window.innerWidth>=640)return void m({});let t=e.getBoundingClientRect(),i=Math.min(window.innerWidth-24,680),n=getComputedStyle(document.documentElement),s=e=>{let t=parseFloat(e);return Number.isFinite(t)?t:0},r=s(n.getPropertyValue("--safe-area-left")),o=s(n.getPropertyValue("--safe-area-right")),a=Math.min(i,Math.max(window.innerWidth-r-o,0)),l=Math.max(r,window.innerWidth-o-a),d=Math.min(Math.max(t.left+t.width/2-a/2,r),l);m({width:"".concat(a,"px"),left:"".concat(d,"px"),top:"".concat(t.bottom+12,"px")})};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[u]);let G=e=>{P(t=>{let i=(t+e+B.length)%B.length,n=B[i];return n&&(v(n.id),(e=>{let t=M.current[e];t&&(t.focus({preventScroll:!0}),requestAnimationFrame(()=>{t.scrollIntoView({behavior:"smooth",block:x?"nearest":"center",inline:"center"})}))})(i)),i})};return(0,n.jsxs)("div",{className:"relative inline-flex",children:[(0,n.jsxs)("button",{ref:N,type:"button",onClick:Y,"aria-keyshortcuts":"Meta Alt+F1","aria-label":"Applications menu",className:"group relative flex h-8 items-center justify-center gap-2 rounded-lg px-2.5 outline-none transition-all duration-200 ease-out hover:bg-white/8 focus-visible:ring-2 focus-visible:ring-cyan-400/60 focus-visible:ring-offset-1 focus-visible:ring-offset-slate-950 sm:px-3",tabIndex:l?-1:0,children:[(0,n.jsx)("span",{className:"relative flex h-5 w-5 items-center justify-center",children:(0,n.jsx)("svg",{"aria-hidden":"true",viewBox:"0 0 100 100",className:"h-4.5 w-4.5 text-white/90 transition-all duration-200 group-hover:text-cyan-400 group-hover:drop-shadow-[0_0_8px_rgba(34,211,238,0.6)]",fill:"currentColor",focusable:"false",children:(0,n.jsx)("path",{d:"M 22.060547 19.480469 C 18.150547 19.480469 13.970625 19.650234 9.640625 19.990234 C 8.570625 20.070234 7.7607813 20.990547 7.8007812 22.060547 C 7.8407813 23.130547 8.7207813 23.980469 9.8007812 23.980469 C 23.710781 24.000469 36.469141 25.689922 44.619141 28.419922 C 42.129141 28.209922 39.610547 28.089844 37.060547 28.089844 C 18.060547 28.089844 3.8009375 33.910391 3.2109375 34.150391 C 2.2409375 34.560391 1.7503125 35.630859 2.0703125 36.630859 C 2.3503125 37.460859 3.1307031 38 3.9707031 38 C 4.1307031 38 4.2909375 37.979453 4.4609375 37.939453 C 4.6109375 37.899453 20.480938 34 36.460938 34 C 38.520938 34 40.500859 34.069453 42.380859 34.189453 C 24.690859 37.009453 11.460313 46.990469 10.820312 47.480469 C 9.9803125 48.130469 9.7908594 49.309453 10.380859 50.189453 C 10.770859 50.759453 11.399063 51.070312 12.039062 51.070312 C 12.389062 51.070312 12.740547 50.979062 13.060547 50.789062 C 13.250547 50.679063 31.949531 39.689453 50.769531 39.689453 C 51.289531 39.689453 51.800547 39.690937 52.310547 39.710938 L 52.369141 39.710938 C 49.879141 41.790937 46.609375 45.790547 46.859375 52.310547 C 47.179375 60.540547 53.159453 65.49 58.939453 66.75 C 61.319453 67.27 63.350547 67.39 65.310547 67.5 C 68.920547 67.72 72.050156 67.899375 76.910156 70.609375 C 82.340156 73.629375 86.450625 81.589141 87.390625 90.869141 C 87.490625 91.879141 88.339375 92.659922 89.359375 92.669922 L 89.380859 92.669922 C 90.390859 92.669922 91.239141 91.919922 91.369141 90.919922 C 91.429141 90.429922 92.430937 81.599687 86.960938 72.929688 C 89.010937 74.779687 90.759844 77.349141 91.339844 80.869141 C 91.499844 81.829141 92.340547 82.539063 93.310547 82.539062 L 93.339844 82.539062 C 94.329844 82.519063 95.160781 81.790547 95.300781 80.810547 C 95.330781 80.560547 96.069531 74.619219 91.019531 69.199219 C 85.779531 63.569219 76.979609 60.720703 64.849609 60.720703 C 61.169609 60.720703 58.320156 59.710938 56.410156 57.710938 C 54.310156 55.520938 53.660234 52.440703 53.740234 50.470703 C 53.870234 47.320703 56.390312 43.640625 63.070312 43.640625 C 66.720313 43.640625 73.270156 46.709141 76.410156 48.369141 C 76.610156 49.469141 77.069141 50.729141 78.119141 51.369141 C 78.399141 51.549141 78.709609 51.679844 79.099609 51.839844 C 80.239609 52.329844 82.150156 53.140156 84.410156 55.660156 C 84.800156 56.090156 85.350391 56.320313 85.900391 56.320312 C 86.280391 56.320312 86.66 56.210234 87 55.990234 L 90.009766 54.009766 C 90.689766 53.559766 91.030859 52.750938 90.880859 51.960938 C 90.720859 51.170938 90.110313 50.540859 89.320312 50.380859 C 88.280312 50.160859 86.969766 49.650234 86.259766 49.240234 C 86.229766 48.780234 86.089062 48.309375 85.789062 47.859375 C 85.649062 47.649375 85.480781 47.450703 85.300781 47.220703 C 84.910781 46.760703 84.389453 46.129922 83.939453 45.169922 C 83.779453 44.839922 83.380781 44.220078 82.550781 43.830078 C 82.780781 43.630078 82.979609 43.389609 83.099609 43.099609 C 83.409609 42.349609 83.240156 41.489922 82.660156 40.919922 C 74.000156 32.299922 66.640078 30.499687 66.330078 30.429688 C 66.180078 30.389688 66.029141 30.369141 65.869141 30.369141 C 65.049141 30.369141 64.3 30.879688 64 31.679688 C 63.65 32.619687 64.059219 33.680391 64.949219 34.150391 C 64.999219 34.170391 67.709297 35.589375 70.779297 37.609375 L 70.720703 37.609375 C 70.260703 37.639375 69.839531 37.840859 69.519531 38.130859 C 68.549531 37.750859 67.309219 37.339375 65.949219 37.109375 C 64.739219 36.899375 63.459844 36.869609 62.339844 36.849609 C 61.359844 36.829609 59.870234 36.790312 59.490234 36.570312 C 59.360234 36.460313 59.189766 36.329453 59.009766 36.189453 C 58.039766 35.469453 56.569297 34.380938 56.029297 27.710938 C 55.989297 27.170938 55.719063 26.660313 55.289062 26.320312 C 54.949062 26.040312 46.530547 19.480469 22.060547 19.480469 z M 22.060547 21.480469 C 46.110547 21.480469 54.039063 27.880859 54.039062 27.880859 C 54.719062 36.340859 56.98 37.080859 58.25 38.130859 C 59.51 39.190859 62.869375 38.610078 65.609375 39.080078 C 68.349375 39.550078 70.550781 40.820312 70.550781 40.820312 L 70.869141 39.609375 C 71.749141 41.679375 73.869141 42.390625 73.869141 42.390625 L 73.869141 40.759766 C 74.659141 42.659766 76.869141 43.970703 76.869141 43.970703 L 76.869141 42.410156 C 76.869141 42.410156 77.609844 43.539844 78.339844 44.339844 C 79.079844 45.149844 79.859375 45.599609 79.859375 45.599609 C 79.859375 45.599609 80.350859 45.480469 80.880859 45.480469 C 81.380859 45.480469 81.920859 45.589531 82.130859 46.019531 C 82.890859 47.649531 83.810859 48.500703 84.130859 48.970703 C 84.440859 49.440703 84.130859 50 84.130859 50 C 84.650859 50.98 87.390156 52.019844 88.910156 52.339844 L 85.900391 54.320312 C 82.680391 50.740313 79.939922 50.149922 79.169922 49.669922 C 78.389922 49.189922 78.269531 47.109375 78.269531 47.109375 C 78.269531 47.109375 68.530313 41.640625 63.070312 41.640625 C 55.020313 41.640625 51.900234 46.460625 51.740234 50.390625 C 51.580234 54.310625 53.729609 62.720703 64.849609 62.720703 C 77.659609 62.720703 85.320547 66.020547 89.560547 70.560547 C 94.020547 75.350547 93.320313 80.539063 93.320312 80.539062 C 91.370312 68.809062 78.119141 66.429687 78.119141 66.429688 C 91.209141 75.999687 89.380859 90.669922 89.380859 90.669922 C 88.490859 81.849922 84.570859 72.589375 77.880859 68.859375 C 69.920859 64.419375 65.939375 66.230781 59.359375 64.800781 C 54.589375 63.760781 49.149375 59.720234 48.859375 52.240234 C 48.509375 43.230234 55.910156 39.720703 55.910156 39.720703 L 52.519531 30.029297 C 45.979531 25.119297 28.700781 22.000469 9.8007812 21.980469 C 14.290781 21.640469 18.370547 21.480469 22.060547 21.480469 z M 37.060547 30.089844 C 41.400547 30.089844 45.969922 30.399922 50.669922 31.169922 C 50.669922 31.179922 50.679453 31.179453 50.689453 31.189453 L 51.210938 33.359375 C 46.560937 32.379375 41.500937 32 36.460938 32 C 20.030938 32 3.9707031 36 3.9707031 36 C 3.9707031 36 18.240547 30.089844 37.060547 30.089844 z M 65.900391 32.380859 C 66.380391 32.500859 73.19 34.319844 81.25 42.339844 L 79.560547 42.339844 C 75.620547 37.509844 66.470391 32.680859 65.900391 32.380859 z M 51.460938 35.449219 L 51.539062 35.449219 L 52.380859 37.710938 C 51.840859 37.690938 51.309531 37.689453 50.769531 37.689453 C 31.459531 37.689453 12.640781 48.720547 12.050781 49.060547 C 12.600781 48.650547 30.140938 35.449219 51.460938 35.449219 z M 81.912109 47.929688 C 81.912109 47.929688 81.822109 48.49825 81.912109 48.65625 C 82.084109 48.96025 83.111328 49.376953 83.111328 49.376953 L 81.912109 47.929688 z"})})}),(0,n.jsx)("span",{className:"hidden text-[13px] font-semibold tracking-wide text-white/90 transition-colors duration-200 group-hover:text-white sm:block",children:"Applications"}),(0,n.jsx)("span",{className:"pointer-events-none absolute inset-x-1 -bottom-0.5 h-0.5 scale-x-0 rounded-full bg-gradient-to-r from-cyan-400/0 via-cyan-400/70 to-cyan-400/0 opacity-0 transition-all duration-300 group-hover:scale-x-100 group-hover:opacity-100","aria-hidden":"true"})]}),u&&(0,n.jsxs)("div",{ref:_,"data-testid":"whisker-menu-dropdown",className:"fixed z-[260] flex h-[500px] max-h-[85vh] w-[min(94vw,720px)] flex-row overflow-hidden rounded-2xl border border-white/[0.08] bg-[#0a1018] text-white shadow-[0_32px_96px_-12px_rgba(0,0,0,0.7),0_0_0_1px_rgba(255,255,255,0.05),inset_0_1px_0_rgba(255,255,255,0.05)] backdrop-blur-2xl transition-all ease-out sm:absolute sm:top-full sm:left-0 sm:mt-2 sm:max-h-[520px] ".concat(l?"opacity-100 translate-y-0 scale-100":"pointer-events-none opacity-0 -translate-y-4 scale-[0.96]"),style:{...p,transitionDuration:"".concat(180,"ms")},tabIndex:-1,onBlur:e=>{e.currentTarget.contains(e.relatedTarget)||V()},children:[(0,n.jsxs)("div",{className:"order-2 flex flex-1 flex-col bg-transparent",children:[(0,n.jsxs)("div",{className:"border-b border-white/[0.06] px-4 py-4 sm:px-5",children:[(0,n.jsxs)("div",{className:"group/search relative mb-4",children:[(0,n.jsx)("span",{className:"pointer-events-none absolute left-3.5 top-1/2 -translate-y-1/2 text-white/40 transition-colors duration-200 group-focus-within/search:text-cyan-400",children:(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,n.jsx)("circle",{cx:"11",cy:"11",r:"7"}),(0,n.jsx)("line",{x1:"20",y1:"20",x2:"16.65",y2:"16.65"})]})}),(0,n.jsx)("input",{ref:L,className:"h-11 w-full rounded-xl border border-white/[0.08] bg-white/[0.03] pl-11 pr-4 text-[14px] text-gray-100 placeholder:text-white/30 shadow-none transition-all duration-200 hover:border-white/[0.12] hover:bg-white/[0.05] focus:border-cyan-400/50 focus:bg-white/[0.06] focus:shadow-[0_0_0_4px_rgba(34,211,238,0.1)] focus:outline-none",type:"search",inputMode:"search",enterKeyHint:"search",placeholder:"Search applications...","aria-label":"Search applications",autoFocus:l,value:y,onChange:e=>k(e.target.value)})]}),(0,n.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:R.slice(0,6).map(e=>(0,n.jsx)("button",{type:"button",onClick:()=>q(e.id),className:"group/fav relative flex h-10 w-10 items-center justify-center rounded-xl bg-white/[0.04] text-white ring-1 ring-white/[0.06] transition-all duration-200 hover:-translate-y-0.5 hover:bg-white/[0.08] hover:ring-white/[0.1] hover:shadow-[0_8px_20px_-8px_rgba(0,0,0,0.4)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400/60","aria-label":"Open ".concat(e.title),children:(0,n.jsx)(d(),{src:e.icon,alt:"",width:22,height:22,className:"h-[22px] w-[22px] transition-transform duration-200 group-hover/fav:scale-110",sizes:"22px"})},e.id))})]}),(0,n.jsx)("div",{className:"flex-1 overflow-y-auto px-3 py-2 sm:px-3",children:0===U.length?(0,n.jsxs)("div",{className:"flex h-full flex-col items-center justify-center gap-3 py-8 text-sm text-white/40",children:[(0,n.jsx)("span",{className:"flex h-11 w-11 items-center justify-center rounded-full bg-white/[0.04] text-cyan-400/50",children:(0,n.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,n.jsx)("circle",{cx:"11",cy:"11",r:"7"}),(0,n.jsx)("line",{x1:"20",y1:"20",x2:"16.65",y2:"16.65"})]})}),(0,n.jsx)("p",{className:"text-[13px]",children:"No applications found"})]}):(0,n.jsx)("ul",{className:"space-y-1","data-testid":"whisker-menu-app-list",children:U.map((e,t)=>(0,n.jsx)("li",{children:(0,n.jsxs)("button",{type:"button",className:"group/app flex w-full min-h-[56px] items-center justify-between gap-3 rounded-xl px-3 py-2.5 text-left transition-all duration-150 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400/60 ".concat(t===A?"bg-gradient-to-r from-cyan-500/[0.15] to-cyan-500/[0.05] text-white shadow-[inset_0_0_0_1px_rgba(165,243,252,0.15)]":"text-white/80 hover:bg-white/[0.04] hover:text-white"," ").concat(e.disabled?"cursor-not-allowed opacity-50":""),"aria-label":e.title,disabled:e.disabled,onClick:()=>{e.disabled||q(e.id)},onMouseEnter:()=>I(t),children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"flex h-[42px] w-[42px] items-center justify-center rounded-xl bg-white/[0.05] ring-1 ring-white/[0.06] transition-all duration-200 group-hover/app:bg-white/[0.08] group-hover/app:shadow-[0_4px_12px_-4px_rgba(0,0,0,0.3)]",children:(0,n.jsx)(d(),{src:e.icon,alt:"",width:26,height:26,className:"h-[26px] w-[26px] transition-transform duration-200 group-hover/app:scale-110",sizes:"26px"})}),(0,n.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,n.jsx)("p",{className:"text-[13px] font-medium leading-tight",children:e.title}),(0,n.jsx)("p",{className:"text-[10px] font-medium uppercase tracking-[0.15em] text-cyan-400/60",children:"Application"})]})]}),(0,n.jsx)("svg",{className:"h-3.5 w-3.5 flex-shrink-0 text-white/30 transition-all duration-200 group-hover/app:translate-x-0.5 group-hover/app:text-cyan-400/70",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,n.jsx)("polyline",{points:"9 18 15 12 9 6"})})]})},e.id))})})]}),(0,n.jsxs)("div",{className:"order-1 flex w-[68px] flex-col border-r border-white/[0.06] bg-[#05080c] sm:w-[220px]",children:[(0,n.jsx)("div",{className:"hidden sm:flex items-center gap-2 px-4 py-4 text-[11px] font-bold uppercase tracking-[0.15em] text-white/30",children:"Categories"}),(0,n.jsx)("div",{ref:E,className:"flex flex-1 flex-col gap-1 overflow-y-auto px-2 py-2 sm:px-3",role:"listbox","aria-label":"Application categories","aria-orientation":"vertical",tabIndex:0,onKeyDown:e=>{if("ArrowDown"===e.key)e.preventDefault(),G(1);else if("ArrowUp"===e.key)e.preventDefault(),G(-1);else if("Enter"===e.key){e.preventDefault();let t=B[C];t&&v(t.id)}},children:B.map((e,t)=>(0,n.jsxs)("button",{ref:e=>{M.current[t]=e},type:"button",className:"group/cat relative flex min-h-[44px] w-full items-center gap-3 rounded-lg px-2 py-2 transition-all duration-150 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400/60 ".concat(w===e.id?"bg-gradient-to-r from-cyan-500/[0.15] to-cyan-500/[0.05] text-white shadow-[inset_0_0_0_1px_rgba(34,211,238,0.2)]":"text-white/60 hover:bg-white/[0.04] hover:text-white/90"," justify-center sm:justify-start"),role:"option","aria-selected":w===e.id,onClick:()=>{v(e.id),P(t)},children:[(0,n.jsx)("span",{className:"relative flex h-6 w-6 items-center justify-center transition-all duration-200 ".concat(w===e.id?"":"group-hover/cat:scale-110"),children:(0,n.jsx)(d(),{src:e.icon,alt:"",width:20,height:20,className:"h-5 w-5 transition-all duration-200 ".concat(w===e.id?"opacity-100 drop-shadow-[0_0_6px_rgba(34,211,238,0.5)]":"opacity-70 group-hover/cat:opacity-100"),sizes:"20px"})}),(0,n.jsx)("span",{className:"truncate text-[13px] font-medium hidden sm:block ".concat(w===e.id?"text-white":"text-white/80"),children:e.label}),w===e.id&&(0,n.jsx)("span",{className:"absolute inset-y-2 right-0 hidden w-0.5 rounded-l-full bg-cyan-400 shadow-[0_0_8px_rgba(34,211,238,0.8)] sm:block","aria-hidden":"true"}),w===e.id&&(0,n.jsx)("span",{className:"absolute inset-x-2 bottom-0 block h-0.5 rounded-t-full bg-cyan-400 shadow-[0_0_8px_rgba(34,211,238,0.8)] sm:hidden","aria-hidden":"true"})]},e.id))}),(0,n.jsx)("div",{className:"mt-auto border-t border-white/[0.06] px-2 py-3 sm:px-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-center gap-3 sm:justify-start",children:[(0,n.jsxs)("span",{className:"relative flex h-8 w-8 items-center justify-center rounded-full bg-gradient-to-br from-cyan-500/20 to-cyan-600/10 text-[12px] font-bold uppercase text-cyan-400 ring-1 ring-white/10",children:["k",(0,n.jsx)("span",{className:"absolute bottom-0 right-0 h-2.5 w-2.5 rounded-full border-2 border-[#080d14] bg-green-500"})]}),(0,n.jsxs)("div",{className:"hidden flex-col sm:flex",children:[(0,n.jsx)("p",{className:"text-[13px] font-medium text-white/90",children:"kali"}),(0,n.jsx)("p",{className:"text-[10px] font-medium uppercase tracking-[0.1em] text-white/40",children:"Session"})]})]})})]})]})]})},tb=e=>{let{className:t}=e,i=function(){let[e,t]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{if("function"!=typeof window.matchMedia)return;let e=window.matchMedia("(prefers-reduced-motion: reduce)"),i=()=>{t(e.matches)};return(i(),"function"==typeof e.addEventListener)?(e.addEventListener("change",i),()=>{e.removeEventListener("change",i)}):(e.addListener(i),()=>{e.removeListener(i)})},[]),e}(),[s,r]=(0,a.useState)(()=>Array.from({length:32},(e,t)=>.32+t%3*.04)),o=(0,a.useRef)(null),l=(0,a.useRef)(null),d=(0,a.useRef)("undefined"!=typeof performance?performance.now():0);(0,a.useEffect)(()=>{if(i){r(e=>e.map(()=>.28)),null!==o.current&&window.clearTimeout(o.current),null!==l.current&&cancelAnimationFrame(l.current);return}let e=!1,t=t=>{if(e)return;let i=t-d.current;d.current=t,r(e=>{let t=e.slice(-31);return t.push(Math.max(.12,Math.min(1,.28+.6*Math.min(1,Math.abs(i-1e3)/1e3)+.18*Math.random()))),t}),n()},n=()=>{o.current=window.setTimeout(()=>{l.current=requestAnimationFrame(t)},1e3)};return l.current=requestAnimationFrame(t),()=>{e=!0,null!==o.current&&window.clearTimeout(o.current),null!==l.current&&cancelAnimationFrame(l.current)}},[i]);let c=(0,a.useMemo)(()=>{if(0===s.length)return"";let e=s.slice(-32),t=e.length>1?80/(e.length-1):80;return e.map((e,i)=>{let n=Math.max(0,Math.min(1,e)),s=Number((i*t).toFixed(2)),r=Number(((1-n)*18).toFixed(2));return"".concat(0===i?"M":"L").concat(s," ").concat(r)}).join(" ")},[s]);return(0,n.jsx)("div",{className:"hidden items-center pr-2 text-ubt-grey/70 sm:flex md:pr-3 lg:pr-4"+(t?" ".concat(t):""),"aria-hidden":"true","data-reduced-motion":i?"true":"false",children:(0,n.jsxs)("svg",{width:80,height:18,viewBox:"0 0 ".concat(80," ").concat(18),className:"opacity-90",role:"presentation",focusable:"false",children:[(0,n.jsx)("defs",{children:(0,n.jsxs)("linearGradient",{id:"kaliSpark",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[(0,n.jsx)("stop",{offset:"0%",stopColor:"#61a3ff",stopOpacity:"0.9"}),(0,n.jsx)("stop",{offset:"100%",stopColor:"#1f4aa8",stopOpacity:"0.25"})]})}),(0,n.jsx)("path",{d:c,fill:"none",stroke:"url(#kaliSpark)",strokeWidth:1.6,strokeLinecap:"round",shapeRendering:"geometricPrecision"})]})})},ty=e=>{let{workspace:t,active:i}=e;return(0,n.jsxs)("div",{className:"relative w-full aspect-video rounded border overflow-hidden transition-all duration-200 ".concat(i?"bg-slate-800/80 border-cyan-500/50 shadow-[0_0_15px_-3px_rgba(6,182,212,0.3)]":"bg-slate-900/60 border-white/10 group-hover:border-white/20"),children:[(0,n.jsx)("div",{className:"absolute inset-0 opacity-20 bg-gradient-to-br from-indigo-500/10 via-purple-500/10 to-pink-500/10"}),(t.windows||[]).map(e=>{let t=e.w&&e.w>0?e.w:800,i=e.h&&e.h>0?e.h:600,s=Math.max(0,Math.min(95,(e.x||0)/19.2)),r=Math.max(0,Math.min(95,(e.y||0)/10.8)),o=Math.max(15,Math.min(100,t/19.2)),a=Math.max(15,Math.min(100,i/10.8));return(0,n.jsxs)("div",{className:"absolute rounded-[2px] shadow-sm overflow-hidden border flex flex-col ".concat(e.isFocused?"bg-slate-200 border-slate-400 z-10 shadow-md":"bg-slate-700 border-slate-600/50 z-0 opacity-90"),style:{left:"".concat(s,"%"),top:"".concat(r,"%"),width:"".concat(o,"%"),height:"".concat(a,"%")},children:[(0,n.jsx)("div",{className:"h-[12%] min-h-[4px] w-full ".concat(e.isFocused?"bg-slate-300":"bg-slate-800")}),(0,n.jsx)("div",{className:"flex-1 relative w-full ".concat(e.isFocused?"bg-white":"bg-slate-800"),children:e.icon&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center opacity-50 p-0.5",children:(0,n.jsx)("img",{src:e.icon,alt:"",className:"max-w-full max-h-full object-contain",onError:e=>{e.currentTarget.style.display="none"}})})})]},e.id)}),(0,n.jsxs)("div",{className:"absolute bottom-1 right-1 px-1.5 py-0.5 rounded bg-black/40 text-[9px] font-medium text-white/50 backdrop-blur-sm",children:[t.openWindows," apps"]})]})};function tk(e){var t;let{workspaces:i,activeWorkspace:s,onSelect:r}=e,[o,l]=(0,a.useState)(!1),[d,c]=(0,a.useState)(null),u=(0,a.useRef)(null);return((0,a.useEffect)(()=>{let e=e=>{u.current&&!u.current.contains(e.target)&&l(!1)};return o&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[o]),0===i.length)?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("nav",{"aria-label":"Workspace switcher",role:"tablist",className:"hidden items-center gap-0.5 overflow-visible rounded-lg border border-white/10 bg-slate-950/70 px-1 py-0.5 shadow-[0_4px_24px_-8px_rgba(0,0,0,0.5)] backdrop-blur-xl sm:flex relative",onMouseLeave:()=>c(null),children:i.map((e,t)=>{let i=e.id===s;return(0,n.jsxs)("div",{className:"relative group",children:[(0,n.jsxs)("button",{type:"button",role:"tab",tabIndex:i?0:-1,"aria-selected":i,"aria-label":function(e){let t=e.openWindows;return"".concat(e.label).concat(0===t?"":1===t?", 1 window":", ".concat(t," windows"))}(e),onClick:()=>r(e.id),onMouseEnter:()=>c(t),className:"flex h-7 min-w-[2rem] items-center justify-center gap-1.5 rounded-md px-2.5 text-[11px] font-semibold tracking-wide transition-all duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400/70 focus-visible:ring-offset-1 focus-visible:ring-offset-slate-950 ".concat(i?"bg-gradient-to-b from-cyan-500/25 to-cyan-600/15 text-white shadow-[inset_0_1px_0_rgba(255,255,255,0.1),0_1px_2px_rgba(0,0,0,0.2)]":"text-white/60 hover:bg-white/[0.08] hover:text-white/90"),children:[(0,n.jsx)("span",{className:"relative z-10",children:t+1}),(0,n.jsx)("span",{"aria-hidden":"true",className:"pointer-events-none absolute inset-x-1 bottom-0.5 h-[2px] rounded-full bg-cyan-400 transition-all duration-200 ".concat(i?"scale-x-100 opacity-100":"scale-x-0 opacity-0")}),e.openWindows>0&&(0,n.jsx)("span",{className:"relative z-10 flex h-4 min-w-[1rem] items-center justify-center rounded px-1 text-[9px] font-bold transition-all ".concat(i?"bg-cyan-400/20 text-cyan-300":"bg-white/10 text-white/50 group-hover:bg-white/15 group-hover:text-white/70"),children:e.openWindows})]}),d===t&&(0,n.jsx)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-3 w-48 z-50 pointer-events-none animate-in fade-in zoom-in-95 duration-200",role:"tooltip",children:(0,n.jsxs)("div",{className:"p-1.5 rounded-lg border border-white/10 bg-slate-900/90 shadow-xl backdrop-blur-md",children:[(0,n.jsx)(ty,{workspace:e,active:i}),(0,n.jsx)("div",{className:"mt-1.5 px-1 text-center text-[10px] text-white/60 font-medium truncate",children:e.label})]})})]},e.id)})}),(0,n.jsxs)("div",{className:"relative sm:hidden",ref:u,children:[(0,n.jsx)("button",{onClick:()=>l(!o),"aria-expanded":o,"aria-haspopup":"grid","aria-label":"Workspace ".concat(s+1),className:"flex h-8 w-8 items-center justify-center rounded-full border text-xs font-bold text-white shadow-md backdrop-blur-xl transition-all duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400 ".concat(o?"border-cyan-500/50 bg-cyan-500/20 ring-2 ring-cyan-500/30":"border-white/15 bg-slate-950/70 hover:border-white/25 hover:bg-white/10"),children:(0,n.jsxs)("span",{className:"relative",children:[s+1,((null==(t=i[s])?void 0:t.openWindows)||0)>0&&(0,n.jsx)("span",{className:"absolute -right-1 -top-1 h-2 w-2 rounded-full bg-cyan-400 shadow-[0_0_6px_rgba(34,211,238,0.6)]"})]})}),o&&(0,n.jsx)("div",{role:"dialog","aria-label":"Select workspace",className:"absolute left-0 z-50 mt-2 w-72 origin-top-left animate-in fade-in zoom-in-95 slide-in-from-top-2 duration-200",children:(0,n.jsxs)("div",{className:"overflow-hidden rounded-xl border border-white/10 bg-slate-900/95 shadow-2xl shadow-black/50 backdrop-blur-2xl p-3",children:[(0,n.jsx)("div",{className:"grid grid-cols-2 gap-3",children:i.map(e=>{var t;let i=e.id===s;return(0,n.jsxs)("button",{onClick:()=>{r(e.id),l(!1)},className:"group flex flex-col gap-2 rounded-lg p-1.5 transition-all text-left focus:outline-none focus:ring-2 focus:ring-cyan-500/50 ".concat(i?"bg-white/5 ring-1 ring-white/10":"hover:bg-white/5"),children:[(0,n.jsx)(ty,{workspace:e,active:i}),(0,n.jsxs)("div",{className:"flex items-center justify-between px-1 w-full",children:[(0,n.jsx)("span",{className:"text-[11px] font-semibold ".concat(i?"text-cyan-300":"text-white/70"),children:e.label||(t=e.id,"Desktop ".concat(t+1))}),i&&(0,n.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-cyan-400 shadow-[0_0_4px_rgba(34,211,238,0.8)]"})]})]},e.id)})}),(0,n.jsx)("div",{className:"mt-3 pt-2 border-t border-white/5 text-center text-[10px] text-white/30",children:"Tap to switch workspaces"})]})})]})]})}let tS=a.forwardRef((e,t)=>{let{title:i,image:s,status:r="loading",updating:o=!1,position:a={top:0,left:0},visible:l=!1,onMouseEnter:d,onMouseLeave:c,onFocus:u,onBlur:h,onKeyDown:p}=e;if(!l)return null;let m=Number.isFinite(a.top)?Math.round(a.top):0,f=Number.isFinite(a.left)?Math.round(a.left):0,g=i?"".concat(i," preview"):"Window preview",w=i?"".concat(i," window preview"):"Window preview";return(0,n.jsx)("div",{ref:t,role:"dialog","aria-label":g,"aria-modal":"false",tabIndex:0,className:"fixed z-[275] max-w-[18rem] outline-none",style:{top:"".concat(m,"px"),left:"".concat(f,"px"),transform:"translateX(-50%)"},onMouseEnter:d,onMouseLeave:c,onFocus:u,onBlur:h,onKeyDown:p,children:(0,n.jsx)("div",{className:"rounded-lg border border-white/10 bg-slate-900/95 p-3 text-white shadow-2xl shadow-black/60 backdrop-blur-md",children:(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[i&&(0,n.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-white/80",children:i}),(0,n.jsxs)("div",{className:"relative overflow-hidden rounded-md border border-white/10 bg-black/50",role:"document","aria-label":w,children:[s?(0,n.jsx)("img",{src:s,alt:w,className:"max-h-48 w-64 object-contain"}):null,"loading"===r&&!s&&(0,n.jsx)("div",{className:"flex h-32 w-64 items-center justify-center",children:(0,n.jsx)("span",{className:"text-[0.65rem] uppercase tracking-widest text-white/60",children:"Loading preview…"})}),!!o&&s&&(0,n.jsx)("div",{className:"absolute inset-x-0 bottom-0 flex items-center justify-end bg-black/35 px-2 py-1",children:(0,n.jsx)("span",{className:"text-[0.6rem] uppercase tracking-widest text-white/70",children:"Updating…"})}),"empty"===r&&(0,n.jsx)("div",{className:"flex h-32 w-64 items-center justify-center",children:(0,n.jsx)("span",{className:"text-[0.65rem] uppercase tracking-widest text-white/60",children:"Preview unavailable"})})]})]})})})});tS.displayName="TaskbarPreviewFlyout";let tj=Object.freeze({accent:{bg:"#3b82f6",fg:"#020817",glow:"rgba(59,130,246,0.45)",track:"rgba(8,15,26,0.82)"},info:{bg:"#38bdf8",fg:"#04121f",glow:"rgba(56,189,248,0.45)",track:"rgba(8,15,26,0.82)"},success:{bg:"#22c55e",fg:"#032014",glow:"rgba(34,197,94,0.48)",track:"rgba(8,15,26,0.82)"},warning:{bg:"#fbbf24",fg:"#111827",glow:"rgba(251,191,36,0.45)",track:"rgba(8,15,26,0.82)"},danger:{bg:"#f97316",fg:"#ffffff",glow:"rgba(249,115,22,0.52)",track:"rgba(8,15,26,0.82)"},neutral:{bg:"#94a3b8",fg:"#0f172a",glow:"rgba(148,163,184,0.4)",track:"rgba(8,15,26,0.82)"}}),tA=function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!Array.isArray(e)||0===e.length||!t||t===i)return null;let s=[...e],r=s.findIndex(e=>e.id===t);if(-1===r)return null;let[o]=s.splice(r,1),a=i?s.findIndex(e=>e.id===i):-1,l=n?s.length:0,d=Math.min(Math.max(-1===a?l:n?a+1:a,0),s.length);return s.splice(d,0,o),e.length===s.length&&e.every((e,t)=>e.id===s[t].id)?null:s},tI=a.forwardRef((e,t)=>{let{apps:i,renderItem:s,onDragOver:r,onDrop:o,onDragLeave:a,dropIndicator:l}=e;return(null==i?void 0:i.length)?(0,n.jsxs)("ul",{ref:t,className:"relative flex shrink min-w-0 max-w-full items-center gap-1 overflow-x-auto rounded-lg border border-white/[0.06] bg-slate-950/60 px-1.5 py-1 backdrop-blur-sm scrollbar-hide",role:"list","aria-label":"Open applications",onDragOver:r,onDrop:o,onDragLeave:a,children:[(null==l?void 0:l.section)==="running"?(0,n.jsx)("span",{"aria-hidden":"true",className:"taskbar-drop-indicator",style:{left:"".concat(l.left,"px")}}):null,i.map(e=>s(e))]}):null});tI.displayName="RunningAppsList";let tC=a.forwardRef((e,t)=>{let{apps:i,renderItem:s,onDragOver:r,onDrop:o,onDragLeave:a,dropIndicator:l}=e,d=Array.isArray(i)&&i.length>0;return(0,n.jsxs)("ul",{ref:t,className:"relative flex shrink min-w-0 min-h-[2.25rem] max-w-full items-center gap-1 overflow-x-auto rounded-lg border border-white/[0.06] bg-slate-950/60 px-1.5 py-1 backdrop-blur-sm scrollbar-hide",role:"list","aria-label":"Pinned applications",onDragOver:r,onDrop:o,onDragLeave:a,children:[(null==l?void 0:l.section)==="pinned"?(0,n.jsx)("span",{"aria-hidden":"true",className:"taskbar-drop-indicator",style:{left:"".concat(l.left,"px")}}):null,d?i.map(e=>s(e)):(0,n.jsx)("li",{className:"pointer-events-none select-none px-2 text-xs text-white/40",children:"Drag apps here to pin"})]})});tC.displayName="PinnedAppsList";let tP=e=>{let{children:t,statusCardOpen:i,onStatusToggle:s,onStatusKeyDown:r,activeDropdown:o,onDropdownToggle:a}=e;return(0,n.jsxs)("div",{className:"flex items-center gap-1 md:gap-3 text-xs md:text-sm",children:[(0,n.jsx)("div",{className:"hidden md:block",children:(0,n.jsx)(tb,{})}),(0,n.jsx)("div",{id:"status-bar",className:"flex items-center gap-2 rounded px-2 py-1",children:(0,n.jsx)(tg,{activeDropdown:o,onDropdownToggle:a})}),(0,n.jsx)(eJ,{onlyTime:!0,showCalendar:!0,hour12:!1,variant:"minimal",isOpen:"clock"===o,onToggle:()=>a("clock")}),t]})},tN=(e,t)=>{if(e===t)return!0;if(!e||!t||e.type!==t.type||(e.displayValue||t.displayValue)&&e.displayValue!==t.displayValue||("number"==typeof e.count||"number"==typeof t.count)&&e.count!==t.count||("number"==typeof e.max||"number"==typeof t.max)&&e.max!==t.max)return!1;if(("number"==typeof e.progress||"number"==typeof t.progress)&&Math.abs(("number"==typeof e.progress?e.progress:0)-("number"==typeof t.progress?t.progress:0))>5e-4)return!1;return(!e.label&&!t.label||e.label===t.label)&&(!e.tone&&!t.tone||e.tone===t.tone)&&!!e.pulse==!!t.pulse&&!!e.persistOnFocus==!!t.persistOnFocus},t_=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e.length!==t.length)return!1;for(let i=0;i<e.length;i+=1){let n=e[i],s=t[i];if(!s||n.id!==s.id||n.title!==s.title||n.icon!==s.icon||n.isFocused!==s.isFocused||n.isMinimized!==s.isMinimized||!tN(n.badge,s.badge))return!1}return!0},tE=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e.length!==t.length)return!1;for(let i=0;i<e.length;i+=1){let n=e[i],s=t[i];if(!s||n.id!==s.id||n.title!==s.title||n.icon!==s.icon||n.isRunning!==s.isRunning||n.isFocused!==s.isFocused||n.isMinimized!==s.isMinimized||!!n.mobilePinned!=!!s.mobilePinned)return!1}return!0};class tM extends a.PureComponent{componentDidMount(){window.addEventListener("workspace-state",this.handleWorkspaceStateUpdate),window.addEventListener("taskbar-preview-response",this.handlePreviewResponse),window.dispatchEvent(new CustomEvent("workspace-request")),window.addEventListener("resize",this.handleWindowResize),window.addEventListener("orientationchange",this.handleWindowResize),this.initializeResizeObserver(),this.scheduleDesktopOffsetUpdate(),"undefined"!=typeof document&&document.addEventListener("keydown",this.handleDocumentKeyDown)}componentWillUnmount(){window.removeEventListener("workspace-state",this.handleWorkspaceStateUpdate),window.removeEventListener("taskbar-preview-response",this.handlePreviewResponse),window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener("orientationchange",this.handleWindowResize),"undefined"!=typeof document&&document.removeEventListener("keydown",this.handleDocumentKeyDown),this.clearPreviewHideTimeout(),this.stopPreviewAutoRefresh(),this.teardownResizeObserver(),this.resetDesktopOffset()}componentDidUpdate(){this.initializeResizeObserver(),this.scheduleDesktopOffsetUpdate()}render(){let{workspaces:e,activeWorkspace:t,preview:i}=this.state,s=this.renderPinnedApps(),r=this.renderRunningApps();return(0,n.jsxs)("div",{ref:this.navbarRef,className:"main-navbar-vp fixed inset-x-0 top-0 z-[260] flex w-full items-center justify-between border-b border-white/[0.04] bg-slate-950/75 text-ubt-grey shadow-[0_1px_3px_rgba(0,0,0,0.3)] backdrop-blur-xl",role:"navigation","aria-label":"Desktop taskbar",style:{minHeight:"calc(".concat(eS.NAVBAR_HEIGHT,"px + var(--safe-area-top, 0px))"),paddingTop:"calc(var(--safe-area-top, 0px) + 0.25rem)",paddingBottom:"0.25rem",paddingLeft:"calc(0.5rem + var(--safe-area-left, 0px))",paddingRight:"calc(0.5rem + var(--safe-area-right, 0px))"},children:[(0,n.jsxs)("div",{className:"flex-none flex items-center gap-1.5 text-xs md:text-sm",children:[(0,n.jsx)(tx,{isOpen:"start-menu"===this.state.activeDropdown,onToggle:()=>this.handleDropdownToggle("start-menu")}),e.length>0&&(0,n.jsx)("div",{className:"hidden md:block",children:(0,n.jsx)(tk,{workspaces:e,activeWorkspace:t,onSelect:this.handleWorkspaceSelect})})]}),(0,n.jsxs)("div",{className:"flex flex-1 min-w-0 items-center gap-1.5 overflow-hidden",children:[s,r]}),(0,n.jsx)("div",{className:"flex-none pl-2",children:(0,n.jsx)(tP,{statusCardOpen:this.state.status_card,onStatusToggle:this.handleStatusToggle,onStatusKeyDown:this.handleStatusKeyDown,activeDropdown:this.state.activeDropdown,onDropdownToggle:this.handleDropdownToggle})}),(0,n.jsx)(tS,{ref:this.previewFlyoutRef,visible:!!i,title:null==i?void 0:i.appTitle,image:null==i?void 0:i.image,status:null==i?void 0:i.status,updating:null==i?void 0:i.updating,position:null==i?void 0:i.position,onMouseEnter:this.handlePreviewMouseEnter,onMouseLeave:this.handlePreviewMouseLeave,onFocus:this.handlePreviewFocus,onBlur:this.handlePreviewBlur,onKeyDown:this.handlePreviewKeyDown})]})}constructor(){var e;super(),e=this,this.isAppRunning=e=>{var t;let i=null==e?void 0:e.id;return!!i&&("boolean"==typeof(null==e?void 0:e.isRunning)?e.isRunning:((null==(t=this.state)?void 0:t.runningApps)||[]).some(e=>(null==e?void 0:e.id)===i))},this.initializeResizeObserver=()=>{var e;let t=window.ResizeObserver;if("function"!=typeof t)return;let i=null==(e=this.navbarRef)?void 0:e.current;i&&(this.resizeObserver||(this.resizeObserver=new t(()=>{this.scheduleDesktopOffsetUpdate()})),this.observedNavbarElement&&this.observedNavbarElement!==i&&"function"==typeof this.resizeObserver.unobserve&&this.resizeObserver.unobserve(this.observedNavbarElement),"function"==typeof this.resizeObserver.observe&&(this.resizeObserver.observe(i),this.observedNavbarElement=i))},this.teardownResizeObserver=()=>{this.resizeObserver&&"function"==typeof this.resizeObserver.disconnect&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.observedNavbarElement=null,this.pendingOffsetUpdate&&"function"==typeof window.cancelAnimationFrame&&window.cancelAnimationFrame(this.pendingOffsetUpdate),this.pendingOffsetUpdate=null},this.handleWindowResize=()=>{this.scheduleDesktopOffsetUpdate()},this.scheduleDesktopOffsetUpdate=()=>{null!==this.pendingOffsetUpdate&&"function"==typeof window.cancelAnimationFrame&&(window.cancelAnimationFrame(this.pendingOffsetUpdate),this.pendingOffsetUpdate=null),"function"==typeof window.requestAnimationFrame?this.pendingOffsetUpdate=window.requestAnimationFrame(()=>{this.pendingOffsetUpdate=null,this.updateDesktopOffset()}):this.updateDesktopOffset()},this.resetDesktopOffset=()=>{var e,t,i,n;"undefined"!=typeof document&&(null==(e=document.documentElement)?void 0:e.style)&&document.documentElement.style.removeProperty("--desktop-navbar-height"),(null==(n=this.navbarRef)||null==(i=n.current)||null==(t=i.parentElement)?void 0:t.style)&&this.navbarRef.current.parentElement.style.removeProperty("--desktop-navbar-height"),this.lastNavbarHeight=null},this.updateDesktopOffset=()=>{var e,t;let i=null==(e=this.navbarRef)?void 0:e.current;if(!i||"function"!=typeof i.getBoundingClientRect)return;let n=i.getBoundingClientRect();if(!n)return;let s=n.height;if(!Number.isFinite(s)||s<=0)return;let r=Math.round(1e3*s)/1e3;if(null!==this.lastNavbarHeight&&.5>Math.abs(this.lastNavbarHeight-r))return;this.lastNavbarHeight=r;let o="".concat(r,"px");i.parentElement&&i.parentElement.style&&"function"==typeof i.parentElement.style.setProperty&&i.parentElement.style.setProperty("--desktop-navbar-height",o),"undefined"!=typeof document&&(null==(t=document.documentElement)?void 0:t.style)&&"function"==typeof document.documentElement.style.setProperty&&document.documentElement.style.setProperty("--desktop-navbar-height",o)},this.escapeAttributeValue=e=>"string"!=typeof e?"":"undefined"!=typeof CSS&&"function"==typeof CSS.escape?CSS.escape(e):e.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),this.getTaskbarButtonElement=e=>{var t;if(!e||!(null==(t=this.runningListRef)?void 0:t.current))return null;let i=this.escapeAttributeValue(e);return this.runningListRef.current.querySelector('button[data-app-id="'.concat(i,'"]'))},this.computePreviewPosition=e=>{if(!e)return{top:0,left:0};let t=window.innerWidth||0,i=e.left+e.width/2,n=i;if(t){let e=148,s=t-140-8;148<=s&&(n=Math.min(Math.max(i,e),s))}return{top:e.bottom+8,left:n}},this.dispatchPreviewRequest=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];window.dispatchEvent(new CustomEvent("taskbar-preview-request",{detail:{appId:e,requestId:t,bustCache:i}}))},this.clearPreviewHideTimeout=()=>{this.previewHideTimeout&&(clearTimeout(this.previewHideTimeout),this.previewHideTimeout=null)},this.setPreviewLifecycleState=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.previewLifecycle||{},s={...n,...i,state:t||n.state};(n.state!==s.state||n.appId!==s.appId||n.trigger!==s.trigger)&&(e.previewLifecycle=s)},this.requestPreviewOpen=function(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t&&i&&(e.setPreviewLifecycleState("visible",{appId:t.id,trigger:n.trigger||"hover"}),e.clearPreviewHideTimeout(),e.openPreviewForApp(t,i,n))},this.requestPreviewHide=function(){var t;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"blur";(null==(t=e.previewLifecycle)?void 0:t.state)!=="hidden"&&(e.setPreviewLifecycleState("pendingHide",{trigger:i}),e.schedulePreviewHide())},this.schedulePreviewHide=()=>{this.clearPreviewHideTimeout(),this.previewHideTimeout=setTimeout(()=>{this.hidePreview()},120)},this.hidePreview=()=>{this.clearPreviewHideTimeout(),this.setPreviewLifecycleState("hidden",{appId:null,trigger:null}),this.previewFocusPending=!1,this.stopPreviewAutoRefresh(),this.clearPreviewUpdatingTimeout(),this.setState(e=>e.preview?{preview:null}:null)},this.clearPreviewUpdatingTimeout=()=>{this.previewUpdatingTimeout&&(clearTimeout(this.previewUpdatingTimeout),this.previewUpdatingTimeout=null)},this.setPreviewUpdating=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{minDurationMs:n=900,requestId:s,appId:r}=i||{};if(e.clearPreviewUpdatingTimeout(),t){e.previewUpdatingMinUntil=Date.now()+(Number.isFinite(n)?n:900),e.setState(e=>{let t=e.preview;return!t||r&&t.appId!==r||null!=s&&t.requestId!==s||!0===t.updating?null:{preview:{...t,updating:!0}}});return}let o=Math.max(0,(e.previewUpdatingMinUntil||0)-Date.now());if(o>0){var a,l;let t=r||(null==(a=e.state.preview)?void 0:a.appId),i=null!=s?s:null==(l=e.state.preview)?void 0:l.requestId;e.previewUpdatingTimeout=setTimeout(()=>{e.previewUpdatingTimeout=null,e.setState(e=>{let n=e.preview;return!n||t&&n.appId!==t||null!=i&&n.requestId!==i||!0!==n.updating?null:{preview:{...n,updating:!1}}})},o)}else e.setState(e=>{let t=e.preview;return!t||r&&t.appId!==r||null!=s&&t.requestId!==s||!0!==t.updating?null:{preview:{...t,updating:!1}}})},this.startPreviewAutoRefresh=()=>{this.previewRefreshInterval||(this.previewRefreshInterval=window.setInterval(()=>{let e=this.state.preview;if(!e||!e.appId||this.previewRefreshInFlight)return;this.previewRefreshInFlight=!0;let t=++this.previewRequestSequence;this.previewUpdatingMinUntil=Date.now()+900,this.setState(i=>{let n=i.preview;return n&&n.appId===e.appId?{preview:{...n,requestId:t,updating:!0}}:null},()=>{this.dispatchPreviewRequest(e.appId,t,!0)})},5e3))},this.stopPreviewAutoRefresh=()=>{this.previewRefreshInterval&&(clearInterval(this.previewRefreshInterval),this.previewRefreshInterval=null,this.previewRefreshInFlight=!1,this.previewUpdatingMinUntil=0)},this.handlePreviewResponse=e=>{let{appId:t,requestId:i,preview:n}=(null==e?void 0:e.detail)||{};t&&null!=i&&this.setState(e=>{let s=e.preview;return s&&s.appId===t&&s.requestId===i?{preview:{...s,image:n||null,status:n?"ready":"empty"}}:(this.previewFocusPending=!1,this.previewRefreshInFlight=!1,null)},()=>{var e;this.previewRefreshInFlight=!1,(null==(e=this.state.preview)?void 0:e.updating)&&this.setPreviewUpdating(!1,{appId:t,requestId:i}),this.state.preview&&this.startPreviewAutoRefresh(),this.previewFocusPending&&this.previewFlyoutRef.current&&this.previewFlyoutRef.current.focus(),this.previewFocusPending=!1})},this.handleDocumentKeyDown=e=>{if("Escape"!==e.key)return;let{preview:t}=this.state;if(!t)return;let i=null==e?void 0:e.target,n=i&&"object"==typeof i&&"nodeType"in i,s=this.previewFlyoutRef.current,r=this.getTaskbarButtonElement(t.appId);if(n){let t="function"==typeof(null==r?void 0:r.contains)&&r.contains(i);((null==s?void 0:s.contains(i))||t)&&e.preventDefault()}this.hidePreview()},this.openPreviewForApp=function(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t||!i||"function"!=typeof i.getBoundingClientRect||!e.isAppRunning(t))return;let s=i.getBoundingClientRect(),r=e.computePreviewPosition(s),o=e.state.preview,a=o&&o.appId===t.id,l=a?o.status:"loading",d=a?o.image:null,c=a?o.requestId:null,u=!1;a?n.forceRefresh?u=!0:d||"loading"===l||(u=!0):u=!0,u&&(c=++e.previewRequestSequence,l="loading",d=null),e.previewFocusPending=!!n.shouldFocus,e.clearPreviewHideTimeout(),e.setState({preview:{appId:t.id,appTitle:t.title,position:r,status:l||"loading",image:d||null,requestId:c,updating:!1}},()=>{u?e.dispatchPreviewRequest(t.id,c,!!n.forceRefresh):(e.previewFocusPending&&e.previewFlyoutRef.current&&(e.previewFlyoutRef.current.focus(),e.previewFocusPending=!1),e.startPreviewAutoRefresh())})},this.handlePreviewMouseEnter=()=>{var e;(null==(e=this.state.preview)?void 0:e.appId)&&this.setPreviewLifecycleState("visible",{appId:this.state.preview.appId,trigger:"flyout-hover"}),this.clearPreviewHideTimeout()},this.handlePreviewMouseLeave=e=>{var t,i;let n=null==e?void 0:e.relatedTarget,s=null==(t=this.state.preview)?void 0:t.appId,r=this.getTaskbarButtonElement(s),o="function"==typeof(null==n?void 0:n.getAttribute)&&"taskbar"===n.getAttribute("data-context");n&&n instanceof Node&&((null==(i=this.previewFlyoutRef.current)?void 0:i.contains(n))||(null==r?void 0:r.contains(n))||o)||this.requestPreviewHide("flyout-leave")},this.handlePreviewFocus=()=>{var e;(null==(e=this.state.preview)?void 0:e.appId)&&this.setPreviewLifecycleState("visible",{appId:this.state.preview.appId,trigger:"flyout-focus"}),this.clearPreviewHideTimeout()},this.handlePreviewBlur=e=>{let t=null==e?void 0:e.relatedTarget;if(t&&t instanceof Node){var i,n;if(null==(i=this.previewFlyoutRef.current)?void 0:i.contains(t))return;let e=null==(n=this.state.preview)?void 0:n.appId;if(this.getTaskbarButtonElement(e)===t)return}this.requestPreviewHide("flyout-blur")},this.handlePreviewKeyDown=e=>{"Escape"===e.key&&(e.stopPropagation(),e.preventDefault(),this.hidePreview())},this.handleRunningAppsChange=e=>{let{preview:t}=this.state;if(!t)return;let i=e.find(e=>e.id===t.appId);if(!i)return void this.hidePreview();let n=this.getTaskbarButtonElement(t.appId);if(!n)return void this.hidePreview();this.requestPreviewOpen(i,n,{forceRefresh:!0,trigger:"refresh"})},this.handleAppButtonMouseEnter=(e,t)=>{this.isAppRunning(t)&&this.requestPreviewOpen(t,e.currentTarget,{trigger:"hover"})},this.handleAppButtonMouseLeave=e=>{var t;let i=null==e?void 0:e.relatedTarget,n="function"==typeof(null==i?void 0:i.getAttribute)&&"taskbar"===i.getAttribute("data-context"),s=i instanceof Node;i&&(s&&(null==(t=this.previewFlyoutRef.current)?void 0:t.contains(i))||n)||this.requestPreviewHide("hover-out")},this.handleAppButtonFocus=(e,t)=>{this.isAppRunning(t)&&this.requestPreviewOpen(t,e.currentTarget,{trigger:"focus"})},this.handleAppButtonBlur=e=>{var t;let i=null==e?void 0:e.relatedTarget;i&&i instanceof Node&&(null==(t=this.previewFlyoutRef.current)?void 0:t.contains(i))||this.requestPreviewHide("blur")},this.handleWorkspaceStateUpdate=e=>{let t=(null==e?void 0:e.detail)||{},{workspaces:i,activeWorkspace:n}=t,s=Array.isArray(i)?i:[],r="number"==typeof n?n:0,o=Array.isArray(t.runningApps)?t.runningApps:[],a=ek(t.pinnedApps),l=!1;this.setState(e=>{let t=!((e,t)=>{if(e.length!==t.length)return!1;for(let i=0;i<e.length;i+=1)if(e[i]!==t[i])return!1;return!0})(s,e.workspaces),i=e.activeWorkspace!==r;l=!t_(o,e.runningApps);let n=!tE(a,e.pinnedApps);return t||i||l||n?{workspaces:t?s:e.workspaces,activeWorkspace:r,runningApps:l?o:e.runningApps,pinnedApps:n?a:e.pinnedApps}:null},()=>{l&&this.handleRunningAppsChange(o)})},this.dispatchTaskbarCommand=e=>{window.dispatchEvent(new CustomEvent("taskbar-command",{detail:e}))},this.handleAppButtonClick=e=>{this.hidePreview();let t={appId:e.id,action:"toggle"};this.dispatchTaskbarCommand(t)},this.handleAppButtonKeyDown=(e,t)=>{if("ArrowDown"===e.key){if(!this.isAppRunning(t))return;e.preventDefault(),this.requestPreviewOpen(t,e.currentTarget,{forceRefresh:!0,shouldFocus:!0,trigger:"keyboard"});return}if("Escape"===e.key&&this.state.preview){e.preventDefault(),this.hidePreview();return}("Enter"===e.key||" "===e.key)&&(e.preventDefault(),this.handleAppButtonClick(t))},this.renderRunningApps=()=>{let{runningApps:e,pinnedApps:t}=this.state;if(!e.length)return null;let i=new Set((t||[]).map(e=>e.id)),s=e.filter(e=>!i.has(e.id));return s.length?(0,n.jsx)(tI,{ref:this.runningListRef,apps:s,renderItem:this.renderRunningAppItem,onDragOver:this.handleTaskbarDragOver,onDrop:this.handleTaskbarDrop,onDragLeave:this.handleListDragLeave,dropIndicator:this.state.dropIndicator}):null},this.renderRunningAppItem=e=>(0,n.jsx)("li",{className:"flex",draggable:!0,"data-app-id":e.id,role:"listitem",onDragStart:t=>this.handleAppDragStart(t,e),onDragOver:this.handleAppDragOver,onDrop:t=>this.handleAppDrop(t,e.id),onDragEnd:this.handleAppDragEnd,children:this.renderTaskbarButton(e,"running")},e.id),this.renderPinnedApps=()=>{let{pinnedApps:e=[]}=this.state,t=window.innerWidth<768,i=e.some(e=>e.mobilePinned),s=t&&i?e.filter(e=>e.mobilePinned):e;return(0,n.jsx)(tC,{ref:this.pinnedListRef,apps:s,renderItem:this.renderPinnedAppItem,onDragOver:this.handlePinnedDragOver,onDrop:this.handlePinnedContainerDrop,onDragLeave:this.handleListDragLeave,dropIndicator:this.state.dropIndicator})},this.renderPinnedAppItem=e=>(0,n.jsx)("li",{className:"flex",draggable:!0,"data-app-id":e.id,role:"listitem",onDragStart:t=>this.handlePinnedDragStart(t,e),onDragOver:this.handlePinnedDragOver,onDrop:t=>this.handlePinnedDrop(t,e.id),onDragEnd:this.handlePinnedDragEnd,children:this.renderTaskbarButton(e,"pinned")},e.id),this.renderAppBadge=e=>{if(!e||"object"!=typeof e)return null;let t=(e=>"string"!=typeof e?tj.accent:tj[e.trim().toLowerCase()]||tj.accent)(e.tone),i={"--taskbar-badge-bg":t.bg,"--taskbar-badge-fg":t.fg,"--taskbar-badge-glow":t.glow,"--taskbar-badge-track":t.track},s=!!e.pulse,r=["taskbar-badge"];s&&r.push("taskbar-badge--pulse");let o="string"==typeof e.label&&e.label.trim()?e.label.trim():void 0;if("count"===e.type){r.push("taskbar-badge--count");let t="string"==typeof e.displayValue&&e.displayValue.trim()?e.displayValue.trim():"number"==typeof e.count?String(e.count):"";if(!t)return null;let s=o||(()=>{let e=Number(t.replace(/\D+/g,""));return Number.isFinite(e)?1===e?"1 notification":"".concat(t," notifications"):"".concat(t," updates")})();return(0,n.jsx)("span",{className:r.join(" "),style:i,role:"status","aria-label":s,title:s,children:(0,n.jsx)("span",{"aria-hidden":"true",children:t})})}if("ring"===e.type){r.push("taskbar-badge--ring");let t="number"==typeof e.progress?Math.max(0,Math.min(1,e.progress)):0;i["--taskbar-badge-progress"]="".concat(Math.round(360*t),"deg");let s="string"==typeof e.displayValue&&e.displayValue.trim()?e.displayValue.trim():"".concat(Math.round(100*t),"%"),a=o||"".concat(s," complete");return(0,n.jsx)("span",{className:r.join(" "),style:i,role:"status","aria-label":a,title:a,children:(0,n.jsx)("span",{className:"taskbar-badge__value","aria-hidden":"true",children:s})})}r.push("taskbar-badge--dot");let a=o||"Attention needed";return(0,n.jsx)("span",{className:r.join(" "),style:i,role:"status","aria-label":a,title:a})},this.renderTaskbarButton=(e,t)=>{let i=!!e.isMinimized,s="running"===t||!!e.isRunning,r="running"===t?!i:s&&!i,o=!!(e.isFocused&&r),a=e&&"object"==typeof e.badge?e.badge:null,l=this.renderAppBadge(a),c=(null==a?void 0:a.label)?"".concat(e.title," — ").concat(a.label):e.title;return(0,n.jsxs)("button",{type:"button","aria-label":c,title:c,"aria-pressed":r,"data-context":"taskbar","data-app-id":e.id,"data-active":r?"true":"false",onClick:()=>this.handleAppButtonClick(e),onKeyDown:t=>this.handleAppButtonKeyDown(t,e),onMouseEnter:t=>this.handleAppButtonMouseEnter(t,e),onMouseLeave:this.handleAppButtonMouseLeave,onFocus:t=>this.handleAppButtonFocus(t,e),onBlur:this.handleAppButtonBlur,className:"group/btn relative flex items-center gap-1.5 rounded-md px-1.5 py-1 text-xs transition-all duration-150 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400/60 ".concat(o?"bg-white/[0.12]":"bg-transparent hover:bg-white/[0.06]"," text-white/80 hover:text-white"),children:[(0,n.jsxs)("span",{className:"relative inline-flex items-center justify-center",children:[(0,n.jsx)(d(),{src:e.icon,alt:"",width:24,height:24,className:"h-5 w-5 transition-transform duration-150 group-hover/btn:scale-105"}),l,r&&(0,n.jsx)("span",{"aria-hidden":"true","data-testid":"running-indicator",className:"absolute -bottom-0.5 left-1/2 h-[3px] w-[3px] -translate-x-1/2 rounded-full bg-cyan-400"})]}),(0,n.jsx)("span",{className:"hidden whitespace-nowrap text-[11px] font-medium text-white/80 group-hover/btn:text-white lg:inline",children:e.title})]})},this.setDropIndicator=e=>{this.setState(t=>{let i=t.dropIndicator;return e||i?e&&i?i.section===e.section&&i.left===e.left?null:{dropIndicator:e}:{dropIndicator:e||null}:null})},this.clearDropIndicator=()=>{this.setDropIndicator(null)},this.shouldShowDropIndicator=(e,t)=>!!e&&!!(null==t?void 0:t.id)&&("running"===e?"running"===t.section:"pinned"===e&&("pinned"===t.section||"running"===t.section||"launcher"===t.section||"desktop"===t.section||!t.section)),this.resolveDropIndicatorLeft=(e,t,i)=>{if(!e||"function"!=typeof e.getBoundingClientRect)return 0;let n=e.getBoundingClientRect(),s=null;if(t&&"function"==typeof t.getBoundingClientRect&&t!==e){let e=t.getBoundingClientRect();s=i?e.right:e.left}else{let t=e.querySelectorAll("[data-app-id]");if(t.length){let e=(i?t[t.length-1]:t[0]).getBoundingClientRect();s=i?e.right:e.left}else s=n.left+8}return null===s&&(s=n.left),Math.max(0,Math.min(s-n.left+e.scrollLeft,e.scrollWidth))},this.updateDropIndicator=function(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{targetElement:s,insertAfter:r}=n||{},o="pinned"===i?e.pinnedListRef:e.runningListRef,a=null==o?void 0:o.current;if(!a)return;let l=e.getDragSource(t);if(!e.shouldShowDropIndicator(i,l))return void e.clearDropIndicator();let d=e.resolveDropIndicatorLeft(a,s||a,r);e.setDropIndicator({section:i,left:d})},this.handleAutoScroll=(e,t)=>{if(!t||"function"!=typeof t.getBoundingClientRect)return;let i=t.getBoundingClientRect(),n=e.clientX-i.left,s=i.right-e.clientX;n<32?t.scrollLeft=Math.max(0,t.scrollLeft-12):s<32&&(t.scrollLeft=Math.min(t.scrollWidth,t.scrollLeft+12))},this.handleListDragLeave=e=>{var t,i;let n=null==e?void 0:e.relatedTarget;n&&(null==(i=e.currentTarget)||null==(t=i.contains)?void 0:t.call(i,n))||this.clearDropIndicator()},this.handleTaskbarDragOver=e=>{var t,i;e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move");let n=null==(t=this.runningListRef)?void 0:t.current,s=null==n||null==(i=n.getBoundingClientRect)?void 0:i.call(n),r=!s||e.clientX-s.left>s.width/2;this.updateDropIndicator(e,"running",{targetElement:n,insertAfter:r}),this.handleAutoScroll(e,n)},this.handleTaskbarDrop=e=>{e.preventDefault();let t=this.getDragSource(e);if(this.clearDropIndicator(),t.id){if("pinned"===t.section)return void this.dispatchTaskbarCommand({action:"unpin",appId:t.id});if("running"===t.section)return void this.reorderRunningApps(t.id,null,!0);this.pinAppFromDrag(t.id,null,!0)}},this.handleAppDragStart=(e,t)=>{this.draggingAppId=t.id,this.draggingSection="running",e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("application/x-taskbar-app-id",t.id),e.dataTransfer.setData("application/x-taskbar-section","running"),e.dataTransfer.setData("application/x-taskbar-app-id-legacy","running|".concat(t.id)))},this.handleAppDragOver=e=>{var t,i,n;e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move");let s=null==(i=e.currentTarget)||null==(t=i.getBoundingClientRect)?void 0:t.call(i),r=!!s&&e.clientX-s.left>s.width/2;this.updateDropIndicator(e,"running",{targetElement:e.currentTarget,insertAfter:r}),this.handleAutoScroll(e,null==(n=this.runningListRef)?void 0:n.current)},this.handleAppDrop=(e,t)=>{var i,n;e.preventDefault();let s=this.getDragSource(e);if(this.clearDropIndicator(),!s.id)return;if("pinned"===s.section)return void this.dispatchTaskbarCommand({action:"unpin",appId:s.id});let r=null==(n=e.currentTarget)||null==(i=n.getBoundingClientRect)?void 0:i.call(n),o=!!r&&e.clientX-r.left>r.width/2;if("running"===s.section)return void this.reorderRunningApps(s.id,t,o);this.pinAppFromDrag(s.id,null,!0)},this.handleAppDragEnd=()=>{this.draggingAppId=null,this.draggingSection=null,this.clearDropIndicator()},this.handlePinnedDragStart=(e,t)=>{this.draggingAppId=t.id,this.draggingSection="pinned",e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("application/x-taskbar-app-id",t.id),e.dataTransfer.setData("application/x-taskbar-section","pinned"),e.dataTransfer.setData("application/x-taskbar-app-id-legacy","pinned|".concat(t.id)))},this.handlePinnedDragOver=e=>{var t,i,n,s,r;e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move");let o=null==(i=e.currentTarget)||null==(t=i.getBoundingClientRect)?void 0:t.call(i),a=!!o&&e.clientX-o.left>o.width/2,l=null==(n=this.pinnedListRef)?void 0:n.current,d=(null==(r=e.currentTarget)||null==(s=r.dataset)?void 0:s.appId)?e.currentTarget:l;this.updateDropIndicator(e,"pinned",{targetElement:d,insertAfter:a}),this.handleAutoScroll(e,l)},this.handlePinnedDrop=(e,t)=>{var i,n;e.preventDefault();let s=this.getDragSource(e);if(this.clearDropIndicator(),!s.id)return;let r=null==(n=e.currentTarget)||null==(i=n.getBoundingClientRect)?void 0:i.call(n),o=!!r&&e.clientX-r.left>r.width/2;return"running"===s.section?void this.pinAppFromDrag(s.id,t,o):"pinned"===s.section?void this.reorderPinnedApps(s.id,t,o):void this.pinAppFromDrag(s.id,t,o)},this.handlePinnedContainerDrop=e=>{e.preventDefault();let t=this.getDragSource(e);if(this.clearDropIndicator(),t.id){if("running"===t.section)return void this.pinAppFromDrag(t.id,null,!0);if("pinned"===t.section)return void this.reorderPinnedApps(t.id,null,!0);this.pinAppFromDrag(t.id,null,!0)}},this.handlePinnedDragEnd=()=>{this.draggingAppId=null,this.draggingSection=null,this.clearDropIndicator()},this.getDragSource=e=>{let t=e.dataTransfer;if(t){let e=t.getData("application/x-taskbar-app-id"),i=t.getData("application/x-taskbar-section"),n=t.getData("text/plain"),s=t.getData("application/x-taskbar-app-id-legacy");if(e){if(i)return{id:e,section:i};if(e.includes("|")){let[t,i]=e.split("|");return{id:i,section:t}}if(s){let[t,i]=s.split("|");return{id:i||e,section:t||"running"}}return{id:e,section:"running"}}if(n)return{id:n,section:i||"launcher"}}return this.draggingAppId?{id:this.draggingAppId,section:this.draggingSection||"running"}:{id:null,section:null}},this.pinAppFromDrag=function(t,i){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s={action:"pin",appId:t};i&&(s.targetId=i),n&&(s.insertAfter=!0),e.dispatchTaskbarCommand(s)},this.reorderPinnedApps=function(t,i){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&(e.pendingPinnedReorder=null,e.setState(s=>{let r=tA(s.pinnedApps,t,i,n);return r?(e.pendingPinnedReorder=r.map(e=>e.id),{pinnedApps:r}):null},()=>{e.pendingPinnedReorder&&(e.dispatchTaskbarCommand({action:"reorderPinned",order:e.pendingPinnedReorder}),e.pendingPinnedReorder=null)}))},this.reorderRunningApps=function(t,i){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&(e.pendingReorder=null,e.setState(s=>{let r=tA(s.runningApps,t,i,n);return r?(e.pendingReorder=r.map(e=>e.id),{runningApps:r}):null},()=>{e.pendingReorder&&(e.dispatchTaskbarCommand({action:"reorder",order:e.pendingReorder}),e.pendingReorder=null)}))},this.handleWorkspaceSelect=e=>{"number"==typeof e&&(this.setState({activeWorkspace:e}),window.dispatchEvent(new CustomEvent("workspace-select",{detail:{workspaceId:e}})))},this.handleStatusToggle=()=>{this.setState(e=>({status_card:!e.status_card}))},this.handleStatusKeyDown=e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),this.handleStatusToggle())},this.handleDropdownToggle=e=>{this.setState(t=>({activeDropdown:t.activeDropdown===e?null:e}))},this.state={status_card:!1,applicationsMenuOpen:!1,placesMenuOpen:!1,workspaces:[],activeWorkspace:0,runningApps:[],preview:null,pinnedApps:[],activeDropdown:null,dropIndicator:null},this.runningListRef=a.createRef(),this.pinnedListRef=a.createRef(),this.draggingAppId=null,this.pendingReorder=null,this.previewFlyoutRef=a.createRef(),this.previewHideTimeout=null,this.previewRequestSequence=0,this.previewFocusPending=!1,this.previewRefreshInterval=null,this.previewRefreshInFlight=!1,this.previewUpdatingTimeout=null,this.previewUpdatingMinUntil=0,this.pendingPinnedReorder=null,this.draggingSection=null,this.navbarRef=a.createRef(),this.resizeObserver=null,this.observedNavbarElement=null,this.pendingOffsetUpdate=null,this.lastNavbarHeight=null,this.previewLifecycle={state:"hidden",appId:null,trigger:null}}}var tL=i(49096),tz=i.n(tL),tD=i(76098);let tT=a.forwardRef((e,t)=>{let{className:i,children:s,...r}=e;return(0,n.jsx)(S,{children:(0,n.jsx)(tD.SnapOverlayProvider,{children:(0,n.jsxs)("div",{ref:t,...r,className:"jsx-25a5deb5bf81231e "+(r&&null!=r.className&&r.className||(0,ec.default)("desktop-shell isolate relative h-screen w-full overflow-hidden bg-transparent text-white antialiased",i)||""),children:[s,(0,n.jsx)(tz(),{id:"25a5deb5bf81231e",children:":root{--safe-area-top:env(safe-area-inset-top, 0px);--safe-area-right:env(safe-area-inset-right, 0px);--safe-area-bottom:env(safe-area-inset-bottom, 0px);--safe-area-left:env(safe-area-inset-left, 0px)}.desktop-shell.jsx-25a5deb5bf81231e{--shell-taskbar-height:2.5rem;--shell-taskbar-padding-x:0.75rem;--shell-taskbar-gap:0.5rem;--shell-taskbar-font-size:0.875rem;--shell-taskbar-icon:1.5rem;--shell-hit-target:2.5rem;--desktop-icon-width:6rem;--desktop-icon-height:5.5rem;--desktop-icon-padding:0.25rem;--desktop-icon-gap:0.375rem;--desktop-icon-image:2.5rem;--desktop-icon-font-size:0.75rem;touch-action:manipulation;font-size:clamp(.95rem,.9rem + .2vw,1rem);height:100vh}@supports(height:100svh){.desktop-shell.jsx-25a5deb5bf81231e{height:100svh}}@supports(height:100dvh){.desktop-shell.jsx-25a5deb5bf81231e{height:100dvh}}@media(min-width:640px){.desktop-shell.jsx-25a5deb5bf81231e{--shell-taskbar-height:2.75rem;--shell-taskbar-padding-x:0.875rem;--shell-taskbar-gap:0.6rem;--desktop-icon-width:6.25rem;--desktop-icon-height:5.75rem}}@media(min-width:768px){.desktop-shell.jsx-25a5deb5bf81231e{--shell-taskbar-height:3rem;--shell-taskbar-padding-x:1rem;--shell-taskbar-gap:0.75rem;--shell-taskbar-font-size:0.925rem;--desktop-icon-width:6.5rem;--desktop-icon-height:6rem;--desktop-icon-image:2.75rem;--desktop-icon-font-size:0.8rem}}@media(min-width:1024px){.desktop-shell.jsx-25a5deb5bf81231e{--shell-taskbar-height:3.25rem;--shell-taskbar-font-size:0.95rem;--desktop-icon-width:6.75rem;--desktop-icon-height:6.25rem}}@media(min-width:1280px){.desktop-shell.jsx-25a5deb5bf81231e{--shell-taskbar-height:3.5rem;--shell-taskbar-font-size:1rem;--desktop-icon-width:7rem;--desktop-icon-height:6.5rem;--desktop-icon-image:3rem;--desktop-icon-font-size:0.85rem}}@media(pointer:coarse){.desktop-shell.jsx-25a5deb5bf81231e{--shell-taskbar-height:3.5rem;--shell-taskbar-padding-x:1.1rem;--shell-taskbar-gap:0.85rem;--shell-taskbar-font-size:1rem;--shell-taskbar-icon:2rem;--shell-hit-target:3.5rem;--desktop-icon-width:7.25rem;--desktop-icon-height:6.75rem;--desktop-icon-image:3rem;--desktop-icon-padding:0.45rem;--desktop-icon-gap:0.5rem;--desktop-icon-font-size:0.85rem}}@media(pointer:coarse)and (min-width:768px){.desktop-shell.jsx-25a5deb5bf81231e{--shell-taskbar-height:3.75rem;--shell-taskbar-padding-x:1.25rem;--shell-hit-target:3.75rem;--desktop-icon-width:7.5rem;--desktop-icon-height:7rem;--desktop-icon-image:3.25rem;--desktop-icon-font-size:0.9rem}}"})]})})})});tT.displayName="DesktopLayout";var tO=i(65624);let tF=()=>{let{pushNotification:e}=(()=>{let e=(0,a.useContext)(tO.NotificationsContext);if(!e)throw Error("useNotifications must be used within NotificationCenter");return e})();return(0,a.useEffect)(()=>{let t=t=>{t.detail&&e(t.detail)};window.addEventListener("system-notification",t);let i=setTimeout(()=>{e({appId:"system",title:"Welcome to Kali Linux Portfolio",body:"Explore the applications, try the terminal, and check out the new features!",priority:"normal"})},1500);return()=>{window.removeEventListener("system-notification",t),clearTimeout(i)}},[e]),null};class tR extends a.Component{componentDidMount(){this.getLocalData()}componentWillUnmount(){this.detachBootScreenLoadHandler()}render(){return(0,n.jsx)(tT,{id:"monitor-screen",children:(0,n.jsxs)(tO.default,{children:[(0,n.jsx)(tF,{}),(0,n.jsx)(eQ,{isLocked:this.state.screen_locked,bgImgName:this.state.bg_image_name,unLockScreen:this.unLockScreen}),(0,n.jsx)(h,{visible:this.state.booting_screen,isShutDown:this.state.shutDownScreen,turnOn:this.turnOn,disableMessageSequence:"undefined"!=typeof jest}),(0,n.jsx)(tM,{lockScreen:this.lockScreen,shutDown:this.shutDown}),(0,n.jsx)(eW,{bg_image_name:this.state.bg_image_name,changeBackgroundImage:this.changeBackgroundImage})]})})}constructor(){super(),this.detachBootScreenLoadHandler=()=>{if(this.bootScreenLoadHandler){let e=this.bootScreenLoadTarget||window,t=this.bootScreenLoadEvent||"load";e.removeEventListener(t,this.bootScreenLoadHandler),this.bootScreenLoadHandler=null,this.bootScreenLoadEvent=null,this.bootScreenLoadTarget=null}this.bootSequenceTimeoutId&&(window.clearTimeout(this.bootSequenceTimeoutId),this.bootSequenceTimeoutId=null)},this.hideBootScreen=()=>{this.setState({booting_screen:!1})},this.waitForBootSequence=()=>{if("undefined"==typeof document)return;let e="undefined"!=typeof jest,t=350*!e,i="undefined"!=typeof performance&&"function"==typeof performance.now?performance.now():null,n=()=>{this.hideBootScreen(),this.detachBootScreenLoadHandler()},s=()=>{if(!1===this.state.booting_screen)return;if(e)return void n();let s=()=>{if(e)return void n();("function"==typeof window.requestAnimationFrame?window.requestAnimationFrame.bind(window):e=>window.setTimeout(e,0))(n)};if(e)return void n();if(null!==i){let n=Math.max(t-(performance.now()-i),0);if(n>0&&!e)return void window.setTimeout(s,n)}else if(t>0&&!e)return void window.setTimeout(s,t);s()};this.detachBootScreenLoadHandler();let r=()=>{this.bootSequenceTimeoutId&&(window.clearTimeout(this.bootSequenceTimeoutId),this.bootSequenceTimeoutId=null),s()};if("complete"===document.readyState)return void s();this.bootScreenLoadHandler=()=>{r()},this.bootScreenLoadEvent="load",this.bootScreenLoadTarget=window,window.addEventListener("load",this.bootScreenLoadHandler,{once:!0}),this.bootSequenceTimeoutId=window.setTimeout(()=>{s()},1200*!e)},this.getLocalData=()=>{let e=null===z.safeLocalStorage||void 0===z.safeLocalStorage?void 0:z.safeLocalStorage.getItem("bg-image");null!=e&&this.setState({bg_image_name:e}),null!=(null===z.safeLocalStorage||void 0===z.safeLocalStorage?void 0:z.safeLocalStorage.getItem("booting_screen"))?this.setState({booting_screen:!1}):(null===z.safeLocalStorage||void 0===z.safeLocalStorage||z.safeLocalStorage.setItem("booting_screen",!1),this.waitForBootSequence());let t=null===z.safeLocalStorage||void 0===z.safeLocalStorage?void 0:z.safeLocalStorage.getItem("shut-down");if(null!=t&&"true"===t)this.shutDown();else{let e=null===z.safeLocalStorage||void 0===z.safeLocalStorage?void 0:z.safeLocalStorage.getItem("screen-locked");null!=e&&this.setState({screen_locked:"true"===e})}},this.lockScreen=()=>{(0,ew.logPageView)("/lock-screen","Lock Screen"),(0,ew.logEvent)({category:"Screen Change",action:"Set Screen to Locked"});let e=document.getElementById("status-bar");null==e||e.blur();let t=()=>{this.setState({screen_locked:!0})};"undefined"!=typeof jest?t():setTimeout(t,100),null===z.safeLocalStorage||void 0===z.safeLocalStorage||z.safeLocalStorage.setItem("screen-locked",!0)},this.unLockScreen=()=>{(0,ew.logPageView)("/desktop","Custom Title"),window.removeEventListener("click",this.unLockScreen),window.removeEventListener("keypress",this.unLockScreen),this.setState({screen_locked:!1}),null===z.safeLocalStorage||void 0===z.safeLocalStorage||z.safeLocalStorage.setItem("screen-locked",!1)},this.changeBackgroundImage=e=>{this.setState({bg_image_name:e}),null===z.safeLocalStorage||void 0===z.safeLocalStorage||z.safeLocalStorage.setItem("bg-image",e)},this.shutDown=()=>{(0,ew.logPageView)("/switch-off","Custom Title"),(0,ew.logEvent)({category:"Screen Change",action:"Switched off the Ubuntu"});let e=document.getElementById("status-bar");null==e||e.blur(),this.setState({shutDownScreen:!0}),null===z.safeLocalStorage||void 0===z.safeLocalStorage||z.safeLocalStorage.setItem("shut-down",!0)},this.turnOn=()=>{(0,ew.logPageView)("/desktop","Custom Title"),this.setState({shutDownScreen:!1,booting_screen:!0},this.waitForBootSequence),null===z.safeLocalStorage||void 0===z.safeLocalStorage||z.safeLocalStorage.setItem("shut-down",!1)},this.state={screen_locked:!1,bg_image_name:"wall-2",booting_screen:!0,shutDownScreen:!1},this.bootScreenLoadHandler=null,this.bootScreenLoadEvent=null,this.bootScreenLoadTarget=null,this.bootSequenceTimeoutId=null}}let tW=()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{href:"#window-area",className:"sr-only focus:not-sr-only",children:"Skip to content"}),(0,n.jsx)(s.default,{}),(0,n.jsx)(tR,{}),(0,n.jsx)(o,{})]})},49096:(e,t,i)=>{"use strict";e.exports=i(37603).style},65006:(e,t,i)=>{"use strict";i.d(t,{default:()=>o});var n=i(37876);i(14232);var s=i(77328),r=i.n(s);function o(){let e=function(){if("undefined"!=typeof document)return document.documentElement.dataset.cspNonce}();return(0,n.jsxs)(r(),{children:[(0,n.jsx)("title",{children:"Alex Unnippillil's Portfolio "}),(0,n.jsx)("meta",{charSet:"utf-8"}),(0,n.jsx)("meta",{name:"title",content:"Alex Patel Portfolio - Computer Engineering Student"}),(0,n.jsx)("meta",{name:"description",content:"Alex Unnippillil Personal Portfolio Website"}),(0,n.jsx)("meta",{name:"author",content:"Alex Unnippillil"}),(0,n.jsx)("meta",{name:"keywords",content:"Alex Unnippillil, Unnippillil's portfolio, linux, kali portfolio, alex unnippillil portfolio, alex computer, alex unnippillil, alex linux, alex unnippillil kali portfolio"}),(0,n.jsx)("meta",{name:"robots",content:"index, follow"}),(0,n.jsx)("meta",{httpEquiv:"Content-Type",content:"text/html; charset=utf-8"}),(0,n.jsx)("meta",{name:"language",content:"English"}),(0,n.jsx)("meta",{name:"category",content:"16"}),(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,n.jsx)("meta",{name:"theme-color",content:"#0f1317"}),(0,n.jsx)("meta",{name:"image",content:"images/logos/fevicon.png"}),(0,n.jsx)("meta",{itemProp:"name",content:"Alex Unnippillil Portfolio "}),(0,n.jsx)("meta",{itemProp:"description",content:"Alex Unnippillil Personal Portfolio Website"}),(0,n.jsx)("meta",{itemProp:"image",content:"images/logos/fevicon.png"}),(0,n.jsx)("meta",{name:"twitter:card",content:"summary"}),(0,n.jsx)("meta",{name:"twitter:title",content:"Alex Unnippillil Personal Portfolio Website"}),(0,n.jsx)("meta",{name:"twitter:description",content:"Alex Unnippillil Personal Portfolio Website"}),(0,n.jsx)("meta",{name:"twitter:site",content:"alexunnippillil"}),(0,n.jsx)("meta",{name:"twitter:creator",content:"unnippillil"}),(0,n.jsx)("meta",{name:"twitter:image:src",content:"images/logos/logo_1024.png"}),(0,n.jsx)("meta",{name:"og:title",content:"Alex Unnippillil Personal Portfolio Website "}),(0,n.jsx)("meta",{name:"og:description",content:"Alex Unnippillil Personal Portfolio Website. ."}),(0,n.jsx)("meta",{name:"og:image",content:"https://unnippillil.com/images/logos/logo_1200.png"}),(0,n.jsx)("meta",{name:"og:url",content:"https://unnippillil.com/"}),(0,n.jsx)("meta",{name:"og:site_name",content:"Alex Unnippillil Personal Portfolio"}),(0,n.jsx)("meta",{name:"og:locale",content:"en_CA"}),(0,n.jsx)("meta",{name:"og:type",content:"website"}),(0,n.jsx)("link",{rel:"canonical",href:"https://unnippillil.com/"}),(0,n.jsx)("link",{rel:"icon",href:"images/logos/fevicon.svg"}),(0,n.jsx)("link",{rel:"apple-touch-icon",href:"images/logos/logo.png"}),(0,n.jsx)("script",{type:"application/ld+json",nonce:e,dangerouslySetInnerHTML:{__html:JSON.stringify({"@context":"https://schema.org","@type":"Person",name:"Alex Unnippillil",url:"https://unnippillil.com/"})}})]})}},69241:(e,t,i)=>{"use strict";i.d(t,{default:()=>n});let n=function(){for(var e,t,i=0,n="",s=arguments.length;i<s;i++)(e=arguments[i])&&(t=function e(t){var i,n,s="";if("string"==typeof t||"number"==typeof t)s+=t;else if("object"==typeof t)if(Array.isArray(t)){var r=t.length;for(i=0;i<r;i++)t[i]&&(n=e(t[i]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}(e))&&(n&&(n+=" "),n+=t);return n}},72552:()=>{}},e=>{e.O(0,[8067,4587,3115,186,9534,1885,236,58,636,6593,8792],()=>e(e.s=16760)),_N_E=e.O()}]);