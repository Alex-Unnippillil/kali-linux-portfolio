(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4344],{5999:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var l=t(37876),r=t(14232),a=t(8606);let i={Critical:"#991b1b",High:"#b45309",Medium:"#a16207",Low:"#1e40af"},o=2*Math.PI*60,n=()=>{let[e,s]=(0,r.useState)(null),[t,n]=(0,r.useState)("All"),[c,d]=(0,r.useState)("All"),[m,p]=(0,r.useState)("All"),[h,x]=(0,r.useState)(a),u=(0,r.useMemo)(()=>Array.from(new Set(h.map(e=>e.host))).sort(),[h]),v=(0,r.useMemo)(()=>Array.from(new Set(h.map(e=>e.pluginFamily))).sort(),[h]),y=(0,r.useMemo)(()=>h.reduce((e,s)=>(e[s.severity]=(e[s.severity]||0)+1,e),{}),[h]),b=(0,r.useMemo)(()=>h.filter(e=>("All"===t||e.severity===t)&&("All"===c||e.host===c)&&("All"===m||e.pluginFamily===m)),[h,t,c,m]),j=async e=>{var s;let t=null==(s=e.target.files)?void 0:s[0];if(t){if("sample-report.json"!==t.name)return void alert("Only sample-report.json is supported in this demo.");try{let e=await t.text(),s=JSON.parse(e);x(s),n("All"),d("All"),p("All")}catch(e){alert("Invalid JSON file.")}}},g=(0,r.useMemo)(()=>{let e=h.length,s=0;return Object.entries(y).map(t=>{let[r,a]=t,n=a/e*o,c=(0,l.jsx)("circle",{r:60,cx:80,cy:80,fill:"transparent",stroke:i[r],strokeWidth:"30",strokeDasharray:"".concat(n," ").concat(o-n),strokeDashoffset:-s,transform:"rotate(-90 ".concat(80," ").concat(80,")")},r);return s+=n,c})},[y,h.length]);return(0,l.jsxs)("div",{className:"p-4 bg-gray-900 text-white min-h-screen",children:[(0,l.jsx)("h1",{className:"text-2xl mb-4",children:"Sample Nessus Report"}),(0,l.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 mb-4",children:["Critical","High","Medium","Low"].map(e=>(0,l.jsxs)("div",{className:"bg-gray-800 p-2 rounded flex items-center justify-between",children:[(0,l.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs text-white",style:{backgroundColor:i[e]},children:e}),(0,l.jsx)("span",{className:"font-mono",children:y[e]||0})]},e))}),(0,l.jsxs)("div",{className:"flex items-center space-x-2 mb-4 flex-wrap",children:[(0,l.jsx)("label",{htmlFor:"report-file",className:"text-sm",children:"Import report"}),(0,l.jsx)("input",{id:"report-file",type:"file",accept:".json",className:"text-black p-1 rounded",onChange:j}),(0,l.jsx)("label",{htmlFor:"severity-filter",className:"text-sm",children:"Filter severity"}),(0,l.jsx)("select",{id:"severity-filter",className:"text-black p-1 rounded",value:t,onChange:e=>n(e.target.value),children:["All","Critical","High","Medium","Low"].map(e=>(0,l.jsx)("option",{value:e,children:e},e))}),(0,l.jsx)("label",{htmlFor:"host-filter",className:"text-sm",children:"Filter host"}),(0,l.jsx)("select",{id:"host-filter",className:"text-black p-1 rounded",value:c,onChange:e=>d(e.target.value),children:["All",...u].map(e=>(0,l.jsx)("option",{value:e,children:e},e))}),(0,l.jsx)("label",{htmlFor:"family-filter",className:"text-sm",children:"Filter family"}),(0,l.jsx)("select",{id:"family-filter",className:"text-black p-1 rounded",value:m,onChange:e=>p(e.target.value),children:["All",...v].map(e=>(0,l.jsx)("option",{value:e,children:e},e))}),(0,l.jsx)("button",{type:"button",onClick:()=>{let e=new Blob([[["ID","Finding","CVSS","Severity","Host","Plugin Family","Description"],...b.map(e=>[e.id,e.name,e.cvss,e.severity,e.host,e.pluginFamily,e.description])].map(e=>e.map(e=>'"'.concat(String(e).replace(/"/g,'""'),'"')).join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.setAttribute("download","nessus_report.csv"),document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(s)},className:"p-2 bg-blue-600 rounded","aria-label":"Export CSV",children:(0,l.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",width:24,height:24,children:[(0,l.jsx)("path",{d:"M12 3v12m0 0l4-4m-4 4-4-4"}),(0,l.jsx)("path",{d:"M4.5 15.75v3.75A2.25 2.25 0 006.75 21h10.5A2.25 2.25 0 0019.5 19.5v-3.75"})]})})]}),(0,l.jsx)("p",{className:"text-xs text-gray-400 mb-2",children:"Only the bundled sample-report.json is supported. Files are processed locally and never uploaded."}),(0,l.jsx)("svg",{width:160,height:160,"aria-label":"CVSS severity distribution",className:"mx-auto mb-4",children:g}),(0,l.jsxs)("table",{className:"w-full mb-4 text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"text-left border-b border-gray-700 h-9",children:[(0,l.jsx)("th",{className:"px-2",scope:"col",children:"ID"}),(0,l.jsx)("th",{className:"px-2",scope:"col",children:"Finding"}),(0,l.jsx)("th",{className:"px-2",scope:"col",children:"CVSS"}),(0,l.jsx)("th",{className:"px-2",scope:"col",children:"Severity"}),(0,l.jsx)("th",{className:"px-2",scope:"col",children:"Host"}),(0,l.jsx)("th",{className:"px-2",scope:"col",children:"Plugin Family"})]})}),(0,l.jsx)("tbody",{children:b.map(e=>(0,l.jsxs)("tr",{className:"border-b border-gray-800 cursor-pointer hover:bg-gray-800 border-l-4",style:{borderLeftColor:i[e.severity]},onClick:()=>s(e),children:[(0,l.jsx)("td",{className:"px-2",children:e.id}),(0,l.jsx)("td",{className:"px-2",children:e.name}),(0,l.jsx)("td",{className:"px-2",children:e.cvss}),(0,l.jsx)("td",{className:"px-2",children:(0,l.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs text-white",style:{backgroundColor:i[e.severity]},children:e.severity})}),(0,l.jsx)("td",{className:"px-2",children:e.host}),(0,l.jsx)("td",{className:"px-2",children:e.pluginFamily})]},e.id))})]}),e&&(0,l.jsxs)("div",{role:"dialog",className:"fixed top-0 right-0 h-full w-80 bg-gray-800 p-4 overflow-auto shadow-lg",children:[(0,l.jsx)("button",{type:"button",onClick:()=>s(null),className:"mb-2 text-sm bg-red-600 px-2 py-1 rounded",children:"Close"}),(0,l.jsx)("h2",{className:"text-xl mb-2",children:e.name}),(0,l.jsxs)("p",{className:"text-sm mb-2",children:["CVSS ",e.cvss," (",e.severity,")"]}),(0,l.jsx)("p",{className:"mb-4 text-sm whitespace-pre-wrap",children:e.description}),(0,l.jsx)("p",{className:"text-xs text-gray-400",children:"Disclaimer: This sample report is for demonstration purposes only."})]})]})}},8606:e=>{"use strict";e.exports=JSON.parse('[{"id":"1","name":"OpenSSL Heartbeat Information Disclosure","cvss":5,"severity":"Medium","host":"server1.example.com","pluginFamily":"SSL","description":"OpenSSL 1.0.1 Heartbeat extension allows remote attackers to obtain sensitive information."},{"id":"2","name":"Apache HTTP Server Privilege Escalation","cvss":7.5,"severity":"High","host":"server1.example.com","pluginFamily":"Web Servers","description":"Apache may allow local users to escalate privileges."},{"id":"3","name":"Weak SSH Cipher","cvss":9.8,"severity":"Critical","host":"server2.example.com","pluginFamily":"SSH","description":"The SSH server is configured to allow weak ciphers."},{"id":"4","name":"Outdated Software","cvss":2.5,"severity":"Low","host":"server3.example.com","pluginFamily":"General","description":"Installed software is outdated."}]')},13820:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/nessus-report",function(){return t(5999)}])}},e=>{e.O(0,[636,6593,8792],()=>e(e.s=13820)),_N_E=e.O()}]);