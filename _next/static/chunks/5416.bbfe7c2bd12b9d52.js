"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5416],{95416:(e,t,a)=>{a.r(t),a.d(t,{default:()=>d});var s=a(37876),r=a(14232),i=a(52798);let l=JSON.parse('{"artifacts":[{"name":"resume.docx","type":"Document","description":"Resume found on user\'s desktop","size":12345,"plugin":"metadata","timestamp":"2023-08-01T10:00:00Z"},{"name":"photo.jpg","type":"Image","description":"Photo from mobile device","size":23456,"plugin":"hash","timestamp":"2023-08-01T12:30:00Z"},{"name":"system.log","type":"Log","description":"System log entry","size":34567,"plugin":"metadata","timestamp":"2023-08-01T14:45:00Z"},{"name":"run.exe","type":"File","description":"Executable recovered from temp folder","size":45678,"plugin":"hash","timestamp":"2023-08-01T16:15:00Z"},{"name":"HKCU\\\\Software\\\\Example","type":"Registry","description":"Registry key with suspicious value","size":0,"plugin":"regParser","timestamp":"2023-08-01T18:20:00Z"}]}'),n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},o=function(){let[e,t]=(0,r.useState)([]),a=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=n(t);return 0===e.length||e.forEach(e=>{let t=RegExp("(".concat(e.replace(/[.*+?^${}()|[\\]\\]/g,"\\$&"),")"),"gi");a=a.replace(t,"<mark>$1</mark>")}),a},i=l.artifacts.filter(t=>{let a="".concat(t.name," ").concat(t.description," ").concat("user"in t?t.user:"").toLowerCase();return e.some(e=>a.includes(e.toLowerCase()))});return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{children:(0,s.jsx)("input",{type:"file",accept:".txt",onChange:e=>{var a;let s=null==(a=e.target.files)?void 0:a[0];if(!s)return;let r=new FileReader;r.onload=e=>{var a;t(((null==(a=e.target)?void 0:a.result)||"").split(/\r?\n/).map(e=>e.trim()).filter(Boolean))},r.readAsText(s)},className:"rounded border border-kali-border/60 bg-kali-dark p-2 text-kali-text focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus/80"})}),e.length>0&&(0,s.jsxs)("div",{className:"text-sm",children:["Loaded ",e.length," keywords"]}),(0,s.jsx)("div",{className:"grid gap-2 md:grid-cols-2",children:i.map((e,t)=>(0,s.jsxs)("div",{className:"rounded border border-kali-border/60 bg-kali-dark/80 p-2 text-sm text-kali-text",children:[(0,s.jsx)("div",{className:"font-bold",dangerouslySetInnerHTML:{__html:a(e.name)}}),(0,s.jsx)("div",{className:"text-kali-text/60",children:e.type}),"user"in e&&(0,s.jsx)("div",{className:"text-xs",dangerouslySetInnerHTML:{__html:"User: ".concat(a(e.user))}}),(0,s.jsx)("div",{className:"text-xs",dangerouslySetInnerHTML:{__html:a(e.description)}})]},"".concat(e.name,"-").concat(t)))})]})},d=()=>{let[e,t]=(0,r.useState)("autopsy"),a=(0,r.useRef)([]),l=(0,r.useMemo)(()=>[{id:"autopsy",label:"Autopsy",description:"Explore simulated forensic timelines and artifacts.",callout:"Autopsy mode lets you review forensic evidence, timelines, and case notes in a guided walkthrough."},{id:"keywords",label:"Keyword Tester",description:"Check how indicators of compromise trigger the parser.",callout:"Keyword Tester mode helps you experiment with keyword parsing to understand how search rules flag findings."}],[]);(0,r.useEffect)(()=>{let e=new URLSearchParams(window.location.hash.replace(/^#/,"")).get("view");("keywords"===e||"autopsy"===e)&&t(e)},[]),(0,r.useEffect)(()=>{let t=new URLSearchParams(window.location.hash.replace(/^#/,""));t.set("view",e);let a=t.toString();window.location.hash=a?"#".concat(a):""},[e]);let n=(0,r.useMemo)(()=>{var t;return null!=(t=l.find(t=>t.id===e))?t:l[0]},[l,e]),d=e=>{var s;let r=l[e];r&&(t(r.id),null==(s=a.current[e])||s.focus())};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex flex-wrap gap-3",role:"tablist","aria-label":"Autopsy simulator modes",children:l.map((r,i)=>{let n=e===r.id;return(0,s.jsxs)("button",{ref:e=>{a.current[i]=e},type:"button",role:"tab",id:"tab-".concat(r.id),"aria-selected":n,"aria-controls":"panel-".concat(r.id),tabIndex:n?0:-1,onClick:()=>t(r.id),onKeyDown:e=>((e,t)=>{switch(e.key){case"ArrowRight":e.preventDefault(),d((t+1)%l.length);break;case"ArrowLeft":e.preventDefault(),d((t-1+l.length)%l.length);break;case"Home":e.preventDefault(),d(0);break;case"End":e.preventDefault(),d(l.length-1)}})(e,i),className:"flex min-w-[12rem] flex-1 flex-col gap-1 rounded-md border px-4 py-3 text-left shadow-sm transition focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus focus-visible:ring-offset-2 focus-visible:ring-offset-kali-dark ".concat(n?"border-kali-accent bg-kali-surface text-kali-text shadow-md":"border-transparent bg-kali-dark/60 text-kali-text/75 hover:bg-kali-dark/80"),children:[(0,s.jsx)("span",{className:"text-sm font-semibold uppercase tracking-wide",children:r.label}),(0,s.jsx)("span",{className:"text-sm leading-snug text-kali-text/80",children:r.description})]},r.id)})}),(0,s.jsxs)("div",{id:"mode-description",role:"note","aria-live":"polite",className:"space-y-1 rounded-lg border border-kali-accent/50 bg-kali-surface/80 p-4 text-sm text-kali-text/80 shadow-inner",children:[(0,s.jsxs)("p",{className:"text-base font-semibold text-kali-text",children:[n.label," mode"]}),(0,s.jsx)("p",{className:"leading-relaxed",children:n.callout})]}),(0,s.jsx)("div",{className:"space-y-4",children:l.map(t=>{let a=e===t.id;return(0,s.jsxs)("div",{role:"tabpanel",id:"panel-".concat(t.id),"aria-labelledby":"tab-".concat(t.id),"aria-describedby":"mode-description",hidden:!a,className:"min-h-[22rem] rounded-lg border border-kali-accent/40 bg-kali-surface/90 p-4 shadow-sm transition-all duration-200 ".concat(a?"opacity-100":"opacity-0"),children:["autopsy"===e&&"autopsy"===t.id&&(0,s.jsx)(i.default,{}),"keywords"===e&&"keywords"===t.id&&(0,s.jsx)(o,{})]},t.id)})})]})}}}]);