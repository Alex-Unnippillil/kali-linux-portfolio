"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6345],{16345:(e,t,a)=>{a.r(t),a.d(t,{default:()=>x,displayReconNG:()=>y});var n=a(37876),l=a(14232),s=a(18847),r=a.n(s),i=a(95220);let c=JSON.parse('{"executive":{"name":"Executive Summary","template":"Executive Summary\\n\\nFindings:\\n{{#findings}}- {{title}} ({{severity}})\\n{{/findings}}"},"detailed":{"name":"Detailed Report","template":"Detailed Report\\n\\n{{#findings}}{{index}}. {{title}}\\nSeverity: {{severity}}\\n{{description}}\\n\\n{{/findings}}"}}'),o=[{title:"Open Port 80",description:"HTTP service detected on port 80",severity:"Low"},{title:"Deprecated TLS Version",description:"Server supports TLS 1.0",severity:"Medium"},{title:"SQL Injection",description:"User parameter vulnerable to injection",severity:"High"}];function d(){let[e,t]=(0,l.useState)(c),a=Object.keys(e),[s,r]=(0,i.default)("reconng-report-template",a[0]),d=a.includes(s)?s:a[0],p=(0,l.useMemo)(()=>{let t;return t=e[d].template,t.replace(/{{#findings}}([\s\S]*?){{\/findings}}/,(e,t)=>o.map((e,a)=>t.replace(/{{index}}/g,String(a+1)).replace(/{{title}}/g,e.title).replace(/{{severity}}/g,e.severity).replace(/{{description}}/g,e.description)).join(""))},[d,e]),[u,h]=(0,l.useState)(!1),g=JSON.stringify(e,null,2);return(0,n.jsxs)("div",{className:"flex flex-col h-full",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)("label",{htmlFor:"template",children:"Template"}),(0,n.jsx)("select",{id:"template",value:d,onChange:e=>r(e.target.value),className:"bg-gray-800 px-2 py-1",children:Object.entries(e).map(e=>{let[t,a]=e;return(0,n.jsx)("option",{value:t,children:a.name},t)})}),(0,n.jsx)("button",{type:"button",onClick:()=>{let e=new Blob([p],{type:"text/plain"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="".concat(d,"-report.txt"),a.click(),URL.revokeObjectURL(t)},className:"bg-blue-600 hover:bg-blue-500 px-2 py-1 rounded",children:"Export"}),(0,n.jsx)("button",{type:"button",onClick:()=>h(!0),className:"bg-gray-600 hover:bg-gray-500 px-2 py-1 rounded",children:"Import/Share"})]}),(0,n.jsx)("pre",{className:"flex-1 bg-black p-2 overflow-auto whitespace-pre-wrap text-sm",children:p}),u&&(0,n.jsxs)("dialog",{open:!0,className:"p-4 bg-gray-800 text-white rounded max-w-md",children:[(0,n.jsx)("p",{className:"mb-2",children:"Import templates (JSON)"}),(0,n.jsx)("input",{type:"file",accept:"application/json",onChange:e=>{var a;let n=null==(a=e.target.files)?void 0:a[0];if(!n)return;let l=new FileReader;l.onload=()=>{try{let e=JSON.parse(l.result);t(e);let a=Object.keys(e)[0];a&&r(a)}catch(e){}},l.readAsText(n)}}),(0,n.jsx)("p",{className:"mt-4 mb-2",children:"Share templates"}),(0,n.jsx)("textarea",{readOnly:!0,value:g,className:"w-full h-40 p-1 text-black"}),(0,n.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,n.jsx)("button",{type:"button",onClick:()=>{try{navigator.clipboard.writeText(g)}catch(e){}},className:"bg-blue-600 hover:bg-blue-500 px-2 py-1 rounded",children:"Copy"}),(0,n.jsx)("button",{type:"button",onClick:()=>h(!1),className:"bg-gray-600 hover:bg-gray-500 px-2 py-1 rounded",children:"Close"})]})]})]})}var p=a(74273);let u=r()(async()=>{let e=(await a.e(9364).then(a.bind(a,58564))).default,t=(await a.e(125).then(a.t.bind(a,60125,23))).default;return e.use(t),(await Promise.all([a.e(9364),a.e(2458)]).then(a.bind(a,52458))).default},{loadableGenerated:{webpack:()=>[52458]},ssr:!1}),h={"DNS Enumeration":{input:"domain",demo:e=>({output:"DNS records for ".concat(e,"\nA	93.184.216.34"),nodes:[{data:{id:"domains",label:"Domains"}},{data:{id:"ips",label:"IPs"}},{data:{id:"entities",label:"Entities"}},{data:{id:e,label:e,parent:"domains",type:"domain"}},{data:{id:"93.184.216.34",label:"93.184.216.34",parent:"ips",type:"ip"}},{data:{id:"John Doe",label:"John Doe",parent:"entities",type:"entity"}}],edges:[{data:{id:"e1",source:e,target:"93.184.216.34"}},{data:{id:"e2",source:"93.184.216.34",target:"John Doe"}}]}),fetchUrl:e=>"https://dns.google/resolve?name=".concat(encodeURIComponent(e))},"WHOIS Lookup":{input:"domain",demo:e=>({output:"WHOIS data for ".concat(e,"\nRegistrant: Example Corp"),nodes:[{data:{id:"domains",label:"Domains"}},{data:{id:"entities",label:"Entities"}},{data:{id:e,label:e,parent:"domains",type:"domain"}},{data:{id:"Example Corp",label:"Example Corp",parent:"entities",type:"entity"}}],edges:[{data:{id:"e1",source:e,target:"Example Corp"}}]}),fetchUrl:e=>"https://api.allorigins.win/raw?url=".concat(encodeURIComponent("https://api.hackertarget.com/whois/?q=".concat(e)))},"Reverse IP Lookup":{input:"ip",demo:e=>({output:"Domains hosted on ".concat(e,"\nexample.com"),nodes:[{data:{id:"domains",label:"Domains"}},{data:{id:"ips",label:"IPs"}},{data:{id:"entities",label:"Entities"}},{data:{id:"example.com",label:"example.com",parent:"domains",type:"domain"}},{data:{id:e,label:e,parent:"ips",type:"ip"}},{data:{id:"John Doe",label:"John Doe",parent:"entities",type:"entity"}}],edges:[{data:{id:"e1",source:"example.com",target:e}},{data:{id:"e2",source:e,target:"John Doe"}}]}),fetchUrl:e=>"https://api.allorigins.win/raw?url=".concat(encodeURIComponent("https://api.hackertarget.com/reverseiplookup/?q=".concat(e)))}},g=Object.keys(h),m=e=>({name:"Workspace ".concat(e+1),graph:[],entities:{domain:new Set,ip:new Set,entity:new Set}}),b=()=>{let{allowNetwork:e}=(0,p.useSettings)(),[t,a]=(0,l.useState)(g[0]),[s,r]=(0,l.useState)(""),[c,o]=(0,l.useState)(""),[b,x]=(0,l.useState)(!1),[y,f]=(0,l.useState)("run"),[j,v]=(0,l.useState)([]),[w,N]=(0,i.default)("reconng-script-tags",{}),[k,S]=(0,l.useState)({}),[C,E]=(0,i.default)("reconng-api-keys",{}),[R,O]=(0,l.useState)({}),[L,U]=(0,l.useState)([m(0)]),[D,I]=(0,l.useState)(0),[A,J]=(0,l.useState)(""),[P,T]=(0,l.useState)(0),[M,F]=(0,l.useState)(!1),[H,W]=(0,l.useState)(null),q=(0,l.useRef)(null),B=L[D];(0,l.useEffect)(()=>{if(e)return;let t=window.fetch.bind(window);return window.fetch=(e,a)=>{let n="string"==typeof e?e:e.url;return!/^https?:/i.test(n)||n.startsWith(window.location.origin)||n.startsWith("/")?t(e,a):Promise.reject(Error("Outbound requests blocked"))},()=>{window.fetch=t}},[e]),(0,l.useEffect)(()=>{fetch("/reconng-marketplace.json").then(e=>e.json()).then(e=>v(e.modules||[])).catch(()=>{})},[]),(0,l.useEffect)(()=>{"builder"!==y||H||fetch("/reconng-chain.json").then(e=>e.json()).then(e=>W(e)).catch(()=>{})},[y,H]),(0,l.useEffect)(()=>{{let e=window.matchMedia("(prefers-reduced-motion: reduce)");F(e.matches);let t=e=>F(e.matches);return e.addEventListener("change",t),()=>e.removeEventListener("change",t)}},[]),(0,l.useEffect)(()=>{q.current&&requestAnimationFrame(()=>{var e;q.current.layout({name:"cose-bilkent",animate:!M}).run();let t=q.current.nodes().filter(e=>!e.isParent());t.unselect(),null==(e=t[0])||e.select()});let e=B.graph.filter(e=>{var t;return!(null==(t=e.data)?void 0:t.source)}).length,t=B.graph.filter(e=>{var t;return null==(t=e.data)?void 0:t.source}).length;J("Graph updated with ".concat(e," nodes and ").concat(t," edges.")),T(0)},[B.graph,M]);let G=(0,l.useMemo)(()=>[...g,...j],[j]),K=(0,l.useMemo)(()=>[{selector:"node",style:{"background-color":"#888",color:"#fff",label:"data(label)"}},{selector:'node[type="domain"]',style:{"background-color":"#1f77b4",shape:"round-rectangle"}},{selector:'node[type="ip"]',style:{"background-color":"#ff7f0e",shape:"rectangle"}},{selector:'node[type="entity"]',style:{"background-color":"#006400",shape:"diamond"}},{selector:"edge",style:{width:2,"line-color":"#ccc","target-arrow-color":"#ccc","target-arrow-shape":"triangle","curve-style":"bezier"}},{selector:"$node > node",style:{padding:"10px","background-opacity":.1,"border-color":"#555"}}],[]),_=e=>{U(t=>{let a=[...t];return a[D]=e(a[D]),a})},z=e=>{_(t=>{let a={domain:new Set(t.entities.domain),ip:new Set(t.entities.ip),entity:new Set(t.entities.entity)};return e.forEach(e=>{e.data.type&&e.data.label&&a[e.data.type].add(e.data.label)}),{...t,entities:a}})},V=async(e,t)=>{let a=h[e],n=a.demo(t),l=n.output;if(b&&a.fetchUrl)try{let e=await fetch(a.fetchUrl(t));l=await e.text()}catch(e){l="".concat(n.output,"\n\n(Live fetch failed; showing demo data)")}return{text:l,nodes:n.nodes,edges:n.edges}},Q=async()=>{if(!s)return;let e=await V(t,s);o(e.text),z(e.nodes),_(t=>({...t,graph:[...e.nodes,...e.edges]}))},$=async()=>{if(!H||!s)return;o("Running module chain...");let e=((e,t)=>{let a=new Map(e.map(e=>[e.data.id,e])),n=new Map,l=new Map;e.forEach(e=>{n.set(e.data.id,[]),l.set(e.data.id,0)}),t.forEach(e=>{n.get(e.data.source).push(e.data.target),l.set(e.data.target,l.get(e.data.target)+1)});let s=[];l.forEach((e,t)=>{0===e&&s.push(t)});let r=[];for(;s.length;){let e=s.shift();r.push(a.get(e)),n.get(e).forEach(e=>{l.set(e,l.get(e)-1),0===l.get(e)&&s.push(e)})}return r})(H.chain.nodes,H.chain.edges),t={domain:new Set([s]),ip:new Set([s]),entity:new Set},a=[],n=[],l=[];for(let s of e){let e=s.data.label,r=h[e];if(!r)continue;let i=t[r.input].values().next().value;if(!i)continue;let c=await V(e,i);l.push(c.text),a=a.concat(c.nodes),n=n.concat(c.edges),c.nodes.forEach(e=>{e.data.type&&e.data.label&&t[e.data.type].add(e.data.label)})}a.length&&(z(a),_(e=>({...e,graph:[...a,...n]}))),o(l.join("\n\n")),f("run")};return(0,n.jsxs)("div",{className:"flex flex-col h-full w-full bg-gray-900 text-white p-4",children:[(0,n.jsxs)("div",{className:"flex gap-2 mb-2",children:[L.map((e,t)=>(0,n.jsx)("button",{type:"button",onClick:()=>I(t),className:"px-2 py-1 ".concat(t===D?"bg-blue-600":"bg-gray-800"),children:e.name},e.name)),(0,n.jsx)("button",{type:"button",onClick:()=>{U(e=>[...e,m(e.length)]),I(L.length)},className:"px-2 py-1 bg-green-700",children:"+"})]}),(0,n.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,n.jsx)("button",{type:"button",onClick:()=>f("run"),className:"px-2 py-1 ".concat("run"===y?"bg-blue-600":"bg-gray-800"),children:"Run"}),(0,n.jsx)("button",{type:"button",onClick:()=>f("builder"),className:"px-2 py-1 ".concat("builder"===y?"bg-blue-600":"bg-gray-800"),children:"Builder"}),(0,n.jsx)("button",{type:"button",onClick:()=>f("reports"),className:"px-2 py-1 ".concat("reports"===y?"bg-blue-600":"bg-gray-800"),children:"Reports"}),(0,n.jsx)("button",{type:"button",onClick:()=>f("settings"),className:"px-2 py-1 ".concat("settings"===y?"bg-blue-600":"bg-gray-800"),children:"Settings"}),(0,n.jsx)("button",{type:"button",onClick:()=>f("marketplace"),className:"px-2 py-1 ".concat("marketplace"===y?"bg-blue-600":"bg-gray-800"),children:"Marketplace"})]}),"run"===y&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,n.jsx)("select",{value:t,onChange:e=>a(e.target.value),className:"bg-gray-800 px-2 py-1",children:G.map(e=>(0,n.jsx)("option",{value:e,children:e},e))}),(0,n.jsx)("input",{type:"text",value:s,onChange:e=>r(e.target.value),placeholder:"Target",className:"flex-1 bg-gray-800 px-2 py-1"}),(0,n.jsxs)("label",{className:"flex items-center gap-1 text-xs",children:[(0,n.jsx)("input",{type:"checkbox",checked:b,onChange:e=>x(e.target.checked)}),"Live fetch"]}),(0,n.jsx)("button",{type:"button",onClick:Q,className:"bg-blue-600 hover:bg-blue-500 px-3 py-1 rounded",children:"Run"})]}),(0,n.jsx)("pre",{className:"flex-1 bg-black p-2 overflow-auto whitespace-pre-wrap mb-2",children:c}),B.graph.length>0&&(0,n.jsx)("div",{className:"bg-black p-2 mb-2",style:{height:"300px"},tabIndex:0,onKeyDown:e=>{if(!q.current)return;let t=q.current.nodes().filter(e=>!e.isParent());if(0===t.length)return;let a=P;if(["ArrowRight","ArrowDown","Tab"].includes(e.key))e.preventDefault(),a=(P+1)%t.length;else{if(!["ArrowLeft","ArrowUp"].includes(e.key))return;e.preventDefault(),a=(P-1+t.length)%t.length}t.unselect();let n=t[a];n.select(),T(a),J("Selected node ".concat(n.data("label")))},role:"application","aria-label":"Graph visualization",children:(0,n.jsx)(u,{elements:B.graph,stylesheet:K,style:{width:"100%",height:"100%"},cy:e=>{q.current=e}})}),Object.entries(B.entities).map(e=>{let[t,a]=e;return(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsx)("h3",{className:"font-bold ".concat("ip"===t?"uppercase":"capitalize"),children:t}),(0,n.jsx)("table",{className:"w-full text-sm",children:(0,n.jsx)("tbody",{children:Array.from(a).map(e=>(0,n.jsx)("tr",{children:(0,n.jsx)("td",{children:e})},e))})})]},t)}),B.graph.length>0&&(0,n.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,n.jsx)("button",{type:"button",onClick:()=>{let e="type,label\n";Object.entries(B.entities).forEach(t=>{let[a,n]=t;Array.from(n).forEach(t=>{e+="".concat(a,",").concat(t,"\n")})});let t=new Blob([e],{type:"text/csv"}),a=URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download="reconng-entities.csv",n.click(),URL.revokeObjectURL(a)},className:"bg-gray-800 px-2 py-1",children:"Export CSV"}),(0,n.jsx)("button",{type:"button",onClick:()=>{let e={};Object.entries(B.entities).forEach(t=>{let[a,n]=t;e[a]=Array.from(n)});let t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download="reconng-entities.json",n.click(),URL.revokeObjectURL(a)},className:"bg-gray-800 px-2 py-1",children:"Export JSON"})]}),(0,n.jsx)("div",{role:"status","aria-live":"polite",className:"sr-only",children:A})]}),"builder"===y&&H&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{type:"button",onClick:$,className:"mb-2 bg-blue-600 hover:bg-blue-500 px-3 py-1 rounded",children:"Run Chain"}),(0,n.jsx)("div",{className:"bg-black p-2",style:{height:"300px"},children:(0,n.jsx)(u,{elements:[...H.chain.nodes,...H.chain.edges],stylesheet:K,style:{width:"100%",height:"100%"}})})]}),"reports"===y&&(0,n.jsx)(d,{}),"settings"===y&&(0,n.jsx)("div",{className:"flex-1 overflow-auto",children:G.map(e=>(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsx)("label",{className:"block mb-1",children:"".concat(e," API Key")}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("input",{type:R[e]?"text":"password",value:C[e]||"",onChange:t=>E({...C,[e]:t.target.value}),className:"flex-1 bg-gray-800 px-2 py-1",placeholder:"".concat(e," API Key")}),(0,n.jsx)("button",{type:"button",onClick:()=>O({...R,[e]:!R[e]}),className:"ml-2 px-2 py-1 bg-gray-700",children:R[e]?"Hide":"Show"})]})]},e))}),"marketplace"===y&&(0,n.jsx)("ul",{className:"list-disc pl-5",children:j.map(e=>(0,n.jsxs)("li",{className:"mb-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{children:e}),(0,n.jsx)("input",{type:"text",value:k[e]||"",onChange:t=>S({...k,[e]:t.target.value}),onKeyDown:t=>{if("Enter"===t.key&&k[e]){let t=k[e].trim();t&&N({...w,[e]:[...w[e]||[],t]}),S({...k,[e]:""})}},placeholder:"Tag ".concat(e),className:"bg-gray-800 px-1 py-0.5 text-xs","aria-label":"Tag ".concat(e)})]}),(w[e]||[]).length>0&&(0,n.jsx)("div",{className:"mt-1 flex gap-1 flex-wrap",children:w[e].map(e=>(0,n.jsx)("span",{className:"bg-gray-700 px-1 text-xs",children:e},e))})]},e))})]})},x=b,y=()=>(0,n.jsx)(b,{})}}]);