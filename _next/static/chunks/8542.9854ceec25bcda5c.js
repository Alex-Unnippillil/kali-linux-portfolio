"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8542],{50360:(e,t,a)=>{a.d(t,{copyToClipboard:()=>s,default:()=>r});let s=async e=>{try{var t,a;if(null==(a=navigator)||null==(t=a.clipboard)?void 0:t.writeText)await navigator.clipboard.writeText(e);else{let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),document.body.removeChild(t)}return!0}catch(e){return!1}},r=s},62933:(e,t,a)=>{a.d(t,{contactSchema:()=>r});var s=a(51802);let r=s.object({name:s.string().trim().min(1).max(100).transform(e=>e.replace(/\s+/g," ")),email:s.string().trim().email(),message:s.string().trim().min(1).max(1e3).transform(e=>e.replace(/\s+/g," ")),honeypot:s.string().max(0),csrfToken:s.string().min(1),recaptchaToken:s.string().min(1)})},68542:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j,processContactForm:()=>h});var s=a(37876),r=a(14232),n=a(75758),l=a(50360),i=a(72468),c=a(62933);let o=e=>{let{attachments:t,setAttachments:a,onError:n}=e,l=(0,r.useRef)(null);return(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsx)("label",{htmlFor:"contact-attachments",className:"sr-only",id:"contact-attachments-label",children:"Attach files"}),(0,s.jsx)("input",{ref:l,id:"contact-attachments",type:"file",multiple:!0,onChange:e=>{let s=e.target.files;if(!s)return;let r=t.reduce((e,t)=>e+t.size,0),i=[];for(let e of Array.from(s)){if(e.size>5242880){null==n||n("Attachment '".concat(e.name,"' exceeds the ").concat(5,"MB limit."));continue}if(r+e.size>0x1400000){null==n||n("Total attachment size exceeds limit.");break}i.push(e),r+=e.size}i.length&&a([...t,...i]),l.current&&(l.current.value="")},className:"text-sm","aria-labelledby":"contact-attachments-label"})]})},u=e=>{let{attachments:t,onRemove:a}=e,[n,l]=(0,r.useState)(0),[i,c]=(0,r.useState)([]);if((0,r.useEffect)(()=>{let e=t.map(e=>URL.createObjectURL(e));return c(e),()=>{e.forEach(e=>URL.revokeObjectURL(e))}},[t]),(0,r.useEffect)(()=>{n>=t.length&&l(t.length-1)},[t,n]),!t.length)return null;let o=t[n],u=i[n],d=o.type.startsWith("image/");return(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsxs)("div",{className:"relative",children:[d?(0,s.jsx)("img",{src:u,alt:o.name,className:"max-h-48 object-contain"}):(0,s.jsx)("div",{className:"p-3 bg-gray-800 rounded",children:o.name}),(0,s.jsx)("button",{type:"button",onClick:()=>a(n),className:"absolute top-1 right-1 bg-red-600 text-white px-2 py-1 rounded",children:"Remove"})]}),t.length>1&&(0,s.jsxs)("div",{className:"flex items-center justify-between mt-3",children:[(0,s.jsx)("button",{type:"button",onClick:()=>l((n-1+t.length)%t.length),className:"px-2 py-1 bg-gray-700 rounded",children:"Prev"}),(0,s.jsxs)("span",{className:"text-sm",children:[n+1," / ",t.length]}),(0,s.jsx)("button",{type:"button",onClick:()=>l((n+1)%t.length),className:"px-2 py-1 bg-gray-700 rounded",children:"Next"})]})]})};var d=a(99742);let m=e=>e.replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[e]),p={rate_limit:"Too many requests. Please try again later.",invalid_input:"Please check your input and try again.",invalid_csrf:"Security token mismatch. Refresh and retry.",invalid_recaptcha:"Captcha verification failed. Please try again.",recaptcha_disabled:"Captcha service is not configured. Please use the options above."},h=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fetch;try{let a=c.contactSchema.parse(e),s=await t("/api/contact",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":a.csrfToken},body:JSON.stringify({name:m(a.name),email:a.email,message:m(a.message),honeypot:a.honeypot,recaptchaToken:a.recaptchaToken})});if(!s.ok){let e=await s.json().catch(()=>({}));return{success:!1,error:p[e.code]||"Submission failed",code:e.code}}return{success:!0}}catch(e){return{success:!1,error:"Submission failed"}}},g="contact-draft.json",f="alex.unnippillil@hotmail.com",x="true"===d.env.NEXT_PUBLIC_DEMO_MODE,b=async e=>{try{var t,a;let s=await (null==(a=navigator.storage)||null==(t=a.getDirectory)?void 0:t.call(a));if(!s)return;let r=await s.getFileHandle(g,{create:!0}),n=await r.createWritable();await n.write(JSON.stringify(e)),await n.close()}catch(e){}},y=async()=>{try{var e,t;let a=await (null==(t=navigator.storage)||null==(e=t.getDirectory)?void 0:e.call(t));if(!a)return null;let s=await a.getFileHandle(g),r=await s.getFile(),n=await r.text();return JSON.parse(n)}catch(e){return null}},v=async()=>{try{var e,t;let a=await (null==(t=navigator.storage)||null==(e=t.getDirectory)?void 0:e.call(t));if(!a)return;await a.removeEntry(g)}catch(e){}},w=async e=>{if(!e.length)return;let t=new FormData;e.forEach(e=>t.append("files",e));try{await fetch("/api/contact/attachments",{method:"POST",body:t})}catch(e){}},j=()=>{let[e,t]=(0,r.useState)(""),[a,m]=(0,r.useState)(""),[p,g]=(0,r.useState)(""),[j,N]=(0,r.useState)(""),[C,S]=(0,r.useState)([]),[T,k]=(0,r.useState)(""),[E,_]=(0,r.useState)(null),[P,F]=(0,r.useState)(!1),[R,O]=(0,r.useState)(""),[U,A]=(0,r.useState)(!1),[L,M]=(0,r.useState)(""),[D,I]=(0,r.useState)("");(0,r.useEffect)(()=>{(async()=>{let e=await y();e&&(t(e.name||""),m(e.email||""),g(e.message||""))})(),(async()=>{try{let e=await fetch("/api/contact",{credentials:"same-origin"});if(e.ok){let t=await e.json();if(null==t?void 0:t.csrfToken)return void O(t.csrfToken)}}catch(e){}A(!0),k("Form unavailable in this static preview. Use the options above.")})();let e=d.env.NEXT_PUBLIC_RECAPTCHA_SITE_KEY||"";x||e&&window.grecaptcha||A(!0)},[]),(0,r.useEffect)(()=>{b({name:e,email:a,message:p})},[e,a,p]);let z=async s=>{if(s.preventDefault(),P)return;F(!0),k(""),_(null),M(""),I("");let r=c.contactSchema.shape.email.safeParse(a),n=c.contactSchema.shape.message.safeParse(p),l=!1;if(r.success||(M("Invalid email"),l=!0),n.success||(I("1-1000 chars"),l=!0),l){_({type:"error",message:"Failed to send"}),F(!1);return}if(C.reduce((e,t)=>e+t.size,0)>0x1400000){k("Attachments exceed the ".concat(20,"MB total limit.")),_({type:"error",message:"Failed to send"}),F(!1);return}let i="",o=d.env.NEXT_PUBLIC_RECAPTCHA_SITE_KEY||"",u=U;if(x?(i="demo",u=!1):!u&&o&&window.grecaptcha&&(i=await (e=>new Promise(t=>{let a=window.grecaptcha;if(!a||!e)return t("");a.ready(()=>{a.execute(e,{action:"submit"}).then(e=>t(e)).catch(()=>t(""))})}))(o))||(u=!0),u){A(!0),k("Email service unavailable. Use the options above."),_({type:"error",message:"Failed to send"}),F(!1);return}let f=await h({name:e,email:a,message:p,honeypot:j,csrfToken:R,recaptchaToken:i});if(f.success)_({type:"success",message:"Message sent"}),t(""),m(""),g(""),N(""),await w(C),S([]),v();else{var b;let e=f.error||"Submission failed";k(e),_({type:"error",message:e}),("server_not_configured"===f.code||(null==(b=f.error)?void 0:b.toLowerCase().includes("captcha"))||"Submission failed"===f.error)&&A(!0)}F(!1)};return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-900 text-white p-6",children:[(0,s.jsx)("h1",{className:"mb-6 text-2xl",children:"Contact"}),E&&(0,s.jsx)("div",{className:"mb-6 rounded p-3 text-sm ".concat("success"===E.type?"bg-green-600":"bg-red-600"),children:E.message}),U&&(0,s.jsxs)("p",{className:"mb-6 text-sm",children:["Service unavailable in this mode. You can"," ",(0,s.jsx)("button",{type:"button",onClick:()=>(0,l.copyToClipboard)(f),className:"underline mr-2",children:"Copy address"}),(0,s.jsx)("button",{type:"button",onClick:()=>(0,l.copyToClipboard)(p),className:"underline mr-2",children:"Copy message"}),(0,s.jsx)("button",{type:"button",onClick:()=>(0,i.openMailto)(f,"",p),className:"underline",children:"Open email app"})]}),(0,s.jsxs)("form",{onSubmit:z,className:"space-y-6 max-w-md",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{id:"contact-name",className:"peer w-full rounded border border-gray-700 bg-gray-800 px-3 py-3 text-white focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500",value:e,onChange:e=>t(e.target.value),required:!0,placeholder:" "}),(0,s.jsx)("label",{htmlFor:"contact-name",className:"absolute left-3 -top-2 bg-gray-800 px-1 text-xs text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-2 peer-focus:text-xs peer-focus:text-blue-400",children:"Name"})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{id:"contact-email",type:"email",className:"peer w-full rounded border border-gray-700 bg-gray-800 px-3 py-3 text-white focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500",value:a,onChange:e=>m(e.target.value),required:!0,"aria-invalid":!!L,"aria-describedby":L?"contact-email-error":void 0,placeholder:" "}),(0,s.jsx)("label",{htmlFor:"contact-email",className:"absolute left-3 -top-2 bg-gray-800 px-1 text-xs text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-2 peer-focus:text-xs peer-focus:text-blue-400",children:"Email"}),L&&(0,s.jsx)(n.default,{id:"contact-email-error",className:"mt-3",children:L})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("textarea",{id:"contact-message",className:"peer w-full rounded border border-gray-700 bg-gray-800 px-3 py-3 text-white focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500",rows:4,value:p,onChange:e=>g(e.target.value),required:!0,"aria-invalid":!!D,"aria-describedby":D?"contact-message-error":void 0,placeholder:" "}),(0,s.jsx)("label",{htmlFor:"contact-message",className:"absolute left-3 -top-2 bg-gray-800 px-1 text-xs text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-2 peer-focus:text-xs peer-focus:text-blue-400",children:"Message"}),D&&(0,s.jsx)(n.default,{id:"contact-message-error",className:"mt-3",children:D})]}),(0,s.jsx)(o,{attachments:C,setAttachments:S,onError:k}),(0,s.jsx)(u,{attachments:C,onRemove:e=>S(t=>t.filter((t,a)=>a!==e))}),(0,s.jsx)("input",{type:"text",value:j,onChange:e=>N(e.target.value),className:"hidden",tabIndex:-1,autoComplete:"off"}),T&&(0,s.jsx)(n.default,{className:"mt-3",children:T}),(0,s.jsx)("button",{type:"submit",disabled:P,className:"flex items-center justify-center rounded bg-blue-600 px-4 py-2 disabled:opacity-50",children:P?(0,s.jsx)("div",{className:"h-5 w-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):"Send"})]})]})}},72468:(e,t,a)=>{a.d(t,{openMailto:()=>s});let s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=new URLSearchParams;t&&s.set("subject",t),a&&s.set("body",a);let r=s.toString(),n="mailto:".concat(e).concat(r?"?".concat(r):"");window.location.href=n}},75758:(e,t,a)=>{a.d(t,{default:()=>r});var s=a(37876);a(14232);let r=e=>{let{id:t,className:a="",role:r="status",ariaLive:n,children:l}=e;return(0,s.jsx)("p",{id:t,role:r,"aria-live":null!=n?n:"alert"===r?"assertive":"polite",className:"text-red-600 text-sm mt-2 ".concat(a).trim(),children:l})}}}]);