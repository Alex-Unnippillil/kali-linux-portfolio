"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6891],{16924:(e,t,r)=>{r.d(t,{default:()=>a});var n=r(14232);function a(e,t){let r=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let n=r.current;if(!n)return;let a=n.getContext("2d");if(!a)return;let l=()=>{let r=(()=>{let e=n.parentElement;if(!e)return null;let{clientWidth:t,clientHeight:r}=e;if(t>0&&r>0)return e;let a=e.closest("[data-game-viewport]");if(a)return a;let l=e.closest(".windowMainScreen");return null!=l?l:e})();if(!r)return;let{clientWidth:l,clientHeight:s}=r;if(l<=0||s<=0)return;let i=Math.min(l/e,s/t),c=e*i,o=t*i,u=window.devicePixelRatio||1;n.style.width="".concat(c,"px"),n.style.height="".concat(o,"px"),n.width=Math.floor(c*u),n.height=Math.floor(o*u),a.setTransform(u*i,0,0,u*i,0,0)};l();let s=n.parentElement,i=null==s?void 0:s.closest("[data-game-viewport]"),c=null==s?void 0:s.closest(".windowMainScreen"),o="undefined"!=typeof ResizeObserver?new ResizeObserver(l):null;return s&&o&&o.observe(s),i&&o&&i!==s&&o.observe(i),c&&o&&c!==s&&o.observe(c),window.addEventListener("resize",l),()=>{window.removeEventListener("resize",l),null==o||o.disconnect()}},[e,t]),r}},35539:(e,t,r)=>{r.d(t,{default:()=>a});var n=r(14232);function a(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=(0,n.useRef)(e);r.current=e,(0,n.useEffect)(()=>{let e;if(!t)return;let n=performance.now(),a=t=>{let l=(t-n)/1e3;n=t,r.current(l),e=requestAnimationFrame(a)};return e=requestAnimationFrame(a),()=>cancelAnimationFrame(e)},[t])}},36891:(e,t,r)=>{r.r(t),r.d(t,{CURVE_PRESETS:()=>h,canUseTilt:()=>g,default:()=>b,detectCollision:()=>m,updateScore:()=>v});var n=r(37876),a=r(14232),l=r(16924),s=r(95220),i=r(99372),c=r(48581),o=r(70994),u=r(35539),d=r(30684);let f=[100,120,140],p={easy:{speedMul:.9,accelMul:.85,spawnMul:.9},normal:{speedMul:1,accelMul:1,spawnMul:1},hard:{speedMul:1.15,accelMul:1.15,spawnMul:1.15}},h={linear:e=>e,"ease-in":e=>e*e,"ease-out":e=>Math.sqrt(e),"ease-in-out":e=>e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2},m=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:460,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:22,a=r-n;return t.some(t=>{if(t.lane!==e)return!1;let l=t.y,s=t.y+n;return l<=r&&s>=a})},v=(e,t,r)=>e+t*r,g=async()=>{let e=window.DeviceOrientationEvent||globalThis.DeviceOrientationEvent;if(!e)return!1;if("function"==typeof e.requestPermission)try{let t=await e.requestPermission();return"granted"===t}catch(e){return!1}return!0},y=(e,t,r)=>Math.max(t,Math.min(r,e)),b=()=>{let e=(0,l.default)(300,500),{danger:t,gameOver:r}=(0,i.default)(),b=(0,a.useRef)(null),x=(0,a.useRef)(0),[w,j]=(0,s.default)("lane-runner:control","keys"),[M,R]=(0,s.default)("lane-runner:curve","linear"),[N,k]=(0,s.default)("lane-runner:difficulty","normal"),[S,E]=(0,s.default)("lane-runner:sensitivity",1),[C,L]=(0,s.default)("lane_runner_high",0),O=p[N]||p.normal,[P,A]=(0,a.useState)(!1),[T,D]=(0,a.useState)(!1),[F,G]=(0,a.useState)(!1),[I,U]=(0,a.useState)(0),[q,B]=(0,a.useState)({score:0,speed:f[1],lives:3}),_=(0,a.useRef)(0),[J]=(0,d.default)("lane-runner",{left:"ArrowLeft",right:"ArrowRight",pause:" ",restart:"r"}),z=(0,a.useRef)(null),H=(0,a.useRef)(1),V=(0,a.useRef)([]),W=(0,a.useRef)([]),X=(0,a.useRef)([...f]),Y=(0,a.useRef)(0),K=(0,a.useRef)(0),Q=(0,a.useRef)(0),Z=(0,a.useRef)(null),$=(0,a.useRef)(0),ee=(0,a.useRef)(0),et=(0,a.useRef)(0),er=(0,a.useRef)(3),en=(0,a.useRef)(0),ea=(0,a.useRef)(0),el=(0,a.useRef)(0),es=(0,a.useRef)(0),ei=(0,a.useRef)(0),ec=(0,a.useRef)(null),eo=(0,a.useCallback)(()=>{H.current=1,V.current=[],W.current=[],X.current=f.map(e=>e*O.speedMul),Y.current=0,K.current=0,Q.current=0,Z.current=null,$.current=0,ee.current=0,et.current=0,er.current=3,en.current=0,ea.current=0,el.current=0,B({score:0,speed:X.current[1],lives:3}),D(!1),A(!1)},[O.speedMul]);(0,a.useEffect)(()=>{eo()},[N]),(0,a.useEffect)(()=>{let t=e.current;if(!t)return;let r=t.getContext("2d");r&&(r.imageSmoothingEnabled=!1,t.style.imageRendering="pixelated",z.current=r)},[e]);let eu=(0,a.useMemo)(()=>{let e=window.DeviceOrientationEvent||globalThis.DeviceOrientationEvent;return e?{supported:!0,needsPermission:"function"==typeof e.requestPermission}:{supported:!1,needsPermission:!1}},[]);(0,a.useEffect)(()=>{if("tilt"!==w)return void G(!1);eu.supported&&!eu.needsPermission&&G(!0)},[w,eu.supported,eu.needsPermission]);let ed=(0,a.useCallback)(async()=>{let e=await g();G(e),e||j("keys")},[j]),ef=(0,a.useCallback)(()=>{U(x.current),ei.current=0},[]);(0,a.useEffect)(()=>{if("keys"!==w)return;let e=e=>{if(P||T)return;let t=e.key;t===J.left&&(H.current=Math.max(0,H.current-1)),t===J.right&&(H.current=Math.min(2,H.current+1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[w,J.left,J.right,P,T]),(0,a.useEffect)(()=>{let t=e.current;if(!t||"touch"!==w&&"keys"!==w)return;let r=e=>{P||T||(e.preventDefault(),t.setPointerCapture&&t.setPointerCapture(e.pointerId),ec.current={x:e.clientX,y:e.clientY,t:performance.now()})},n=e=>{if(P||T)return;e.preventDefault();let t=ec.current;if(ec.current=null,!t)return;let r=e.clientX-t.x,n=e.clientY-t.y,a=Math.abs(r),l=Math.abs(n);a<24||a<l||(r<0&&(H.current=Math.max(0,H.current-1)),r>0&&(H.current=Math.min(2,H.current+1)))};return t.style.touchAction="none",t.style.userSelect="none",t.addEventListener("pointerdown",r,{passive:!1}),t.addEventListener("pointerup",n,{passive:!1}),t.addEventListener("pointercancel",n,{passive:!1}),()=>{t.removeEventListener("pointerdown",r),t.removeEventListener("pointerup",n),t.removeEventListener("pointercancel",n)}},[e,w,P,T]),(0,a.useEffect)(()=>{if("tilt"!==w||!F)return;let e=e=>{let t="number"==typeof e.gamma?e.gamma:0;x.current=t,es.current=(t-I)*S};return window.addEventListener("deviceorientation",e),()=>window.removeEventListener("deviceorientation",e)},[w,F,I,S]);let ep=(0,a.useCallback)(()=>{let e=z.current;if(!e)return;let t=H.current,r=V.current,n=X.current,a=en.current,l=ea.current,s=el.current;e.clearRect(0,0,300,500),e.fillStyle="#070a10",e.fillRect(0,0,300,500),e.fillStyle="#0b0f18",e.fillRect(0,0,300,500),e.strokeStyle="rgba(255,255,255,0.22)",e.lineWidth=1,e.strokeRect(.5,.5,299,499),e.save(),e.strokeStyle="rgba(255,255,255,0.25)",e.setLineDash([10,10]),e.lineDashOffset=-(s%20);for(let t=1;t<3;t+=1)e.beginPath(),e.moveTo(100*t,0),e.lineTo(100*t,500),e.stroke();for(let t of(e.restore(),r)){let r=100*t.lane+10,n=80;e.save(),e.fillStyle="#ef4444",e.shadowColor="rgba(239,68,68,0.6)",e.shadowBlur=8,e.fillRect(r,t.y,n,22),e.restore()}for(let t of W.current){let r=100*t.lane+14,n=72;e.save(),e.fillStyle="#22c55e",e.shadowColor="rgba(34,197,94,0.6)",e.shadowBlur=8,e.fillRect(r,t.y,n,16),e.restore()}a>0&&Math.floor(12*a)%2==0||(e.save(),e.fillStyle="#22d3ee",e.shadowColor="rgba(34,211,238,0.65)",e.shadowBlur=10,e.fillRect(100*t+10,438,80,22),e.restore()),l>0&&(e.save(),e.globalAlpha=y(l,0,1),e.fillStyle="rgba(255,255,255,0.15)",e.fillRect(0,0,300,500),e.restore()),e.fillStyle="rgba(255,255,255,0.7)",e.font='11px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace';for(let t=0;t<3;t+=1){let r=100*t+6;e.fillText("".concat(Math.round(n[t])),r,14)}T&&(e.save(),e.fillStyle="rgba(0,0,0,0.55)",e.fillRect(0,0,300,500),e.fillStyle="#fff",e.font="20px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial",e.fillText("Game Over",95,240),e.font="12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial",e.fillText("Press R to restart",95,264),e.restore())},[T]),eh=(0,a.useCallback)((e,t)=>{let r=[];for(let n=0;n<3;n+=1)e.some(e=>e.lane===n&&e.y<t)||r.push(n);return r},[]),em=(0,a.useCallback)((e,t)=>{let r=eh(e,t),n=r.length?r:[0,1,2],a=Z.current,l=Y.current-$.current,s=n.length>1&&null!==a&&l<1.4?n.filter(e=>e!==a):n;return s[Math.floor(Math.random()*s.length)]},[eh]);(0,u.default)(e=>{if(T)return;let n=y(e,0,.05);Y.current+=n,K.current+=n;let a=Math.min(Y.current/60,1),l=(h[M]||h.linear)(a),s=10*O.accelMul*(1+l),i=X.current;for(let e=0;e<i.length;e+=1)i[e]+=n*s;el.current+=n*i[H.current]*.45;let c=V.current;for(let e of c)e.y+=i[e.lane]*n;V.current=c.filter(e=>e.y<522);let o=W.current;for(let e of o)e.y+=i[e.lane]*n;W.current=o.filter(e=>e.y<516);let u=Math.max(.35,1.05/O.spawnMul-.55*l);if(Q.current=Math.max(0,Q.current-n),K.current>=u&&Q.current<=0){let e=em(V.current,57.2);V.current.push({lane:e,y:-22}),Z.current=e,$.current=Y.current,K.current=0}if(ee.current+=n,ee.current>=12&&er.current<5){let e=em(V.current,48.400000000000006);W.current.push({lane:e,y:-16}),ee.current=0}if("tilt"===w&&F){let e=es.current,t=ei.current;e>12&&t<=12&&(H.current=Math.min(2,H.current+1)),e<-12&&t>=-12&&(H.current=Math.max(0,H.current-1)),ei.current=e}if(en.current=Math.max(0,en.current-n),ea.current=Math.max(0,ea.current-3*n),en.current<=0&&m(H.current,V.current,460,22))if(er.current-=1,en.current=1.1,ea.current=1,t(),er.current>0)V.current=[],W.current=[],K.current=0,Q.current=.6,H.current=1;else{D(!0),A(!1),r();let e=Math.floor(et.current);e>C&&L(e)}if(W.current.length){let e=[];for(let t of W.current){if(t.lane!==H.current)continue;let r=t.y,n=t.y+16;r<=460&&n>=438&&e.push(t)}e.length&&(W.current=W.current.filter(t=>!e.includes(t)),er.current=Math.min(5,er.current+e.length))}et.current=v(et.current,i[H.current],n);let d=performance.now();d-_.current>120&&(_.current=d,B({score:Math.floor(et.current),speed:i[H.current],lives:Math.max(0,er.current)})),ep()},!P&&!T),(0,a.useEffect)(()=>{ep()},[ep]);let ev=(0,a.useCallback)(()=>{let e=new Blob([(0,c.exportGameSettings)("lane-runner")],{type:"application/json"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="lane-runner-settings.json",r.click(),URL.revokeObjectURL(t)},[]),eg=(0,a.useCallback)(async e=>{let t=await e.text();(0,c.importGameSettings)("lane-runner",t);try{let e=JSON.parse(t);"number"==typeof e.sensitivity&&E(y(e.sensitivity,.5,2)),"string"==typeof e.curve&&h[e.curve]&&R(e.curve),"string"==typeof e.control&&j(e.control),"string"==typeof e.difficulty&&k(e.difficulty)}catch(e){}},[E,R,j,k]),ey=(0,n.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("div",{className:"font-semibold",children:"Controls"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{htmlFor:"lr-control",className:"min-w-24 opacity-80",children:"Mode"}),(0,n.jsxs)("select",{id:"lr-control",value:w,onChange:e=>{let t=e.target.value;j(t),"tilt"!==t&&G(!1)},className:"rounded bg-black/40 border border-white/10 px-2 py-1",children:[(0,n.jsx)("option",{value:"keys",children:"Keyboard + Swipe"}),(0,n.jsx)("option",{value:"touch",children:"Touch Buttons"}),(0,n.jsx)("option",{value:"tilt",disabled:!eu.supported,children:"Tilt"})]})]}),"tilt"===w&&!eu.supported&&(0,n.jsx)("div",{className:"text-xs opacity-75",children:"Tilt is not supported on this device."}),"tilt"===w&&eu.supported&&(0,n.jsxs)("div",{className:"space-y-2 mt-2",children:[eu.needsPermission&&!F&&(0,n.jsx)("button",{onClick:ed,className:"px-2 py-1 rounded bg-gray-700 hover:bg-gray-600",children:"Enable tilt"}),(!eu.needsPermission||F)&&(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:ef,className:"px-2 py-1 rounded bg-gray-700 hover:bg-gray-600",children:"Calibrate"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{htmlFor:"lane-runner-sensitivity",className:"opacity-80",children:"Sensitivity"}),(0,n.jsx)("input",{id:"lane-runner-sensitivity",type:"range",min:"0.5",max:"2",step:"0.1",value:S,onChange:e=>E(parseFloat(e.target.value)),"aria-label":"Tilt sensitivity"}),(0,n.jsx)("span",{className:"tabular-nums w-10 text-right",children:S.toFixed(1)})]})]}),eu.needsPermission&&!1===F&&(0,n.jsx)("div",{className:"text-xs opacity-75",children:'Some browsers require permission. Tap "Enable tilt" first.'})]})]}),"touch"===w&&(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("div",{className:"font-semibold",children:"Touch buttons"}),(0,n.jsx)("div",{className:"text-xs opacity-75",children:"Use the on-screen buttons, or swipe left and right on the canvas."})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"font-semibold",children:"Difficulty"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{htmlFor:"lr-difficulty",className:"min-w-24 opacity-80",children:"Preset"}),(0,n.jsxs)("select",{id:"lr-difficulty",value:N,onChange:e=>k(e.target.value),className:"rounded bg-black/40 border border-white/10 px-2 py-1",children:[(0,n.jsx)("option",{value:"easy",children:"Easy"}),(0,n.jsx)("option",{value:"normal",children:"Normal"}),(0,n.jsx)("option",{value:"hard",children:"Hard"})]})]}),(0,n.jsxs)("div",{className:"text-xs opacity-75",children:["Extra life pickups appear periodically and cap at ",5," lives."]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"font-semibold",children:"Ramp curve"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{htmlFor:"lr-curve",className:"min-w-24 opacity-80",children:"Curve"}),(0,n.jsx)("select",{id:"lr-curve",value:M,onChange:e=>R(e.target.value),className:"rounded bg-black/40 border border-white/10 px-2 py-1",children:Object.keys(h).map(e=>(0,n.jsx)("option",{value:e,children:e},e))})]}),(0,n.jsx)("div",{className:"text-xs opacity-75",children:"This controls how quickly speed and spawn rate ramp during the first minute."})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"font-semibold",children:"Export / import settings"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:ev,className:"px-2 py-1 rounded bg-gray-700 hover:bg-gray-600",children:"Export"}),(0,n.jsx)("button",{onClick:()=>{var e;return null==(e=b.current)?void 0:e.click()},className:"px-2 py-1 rounded bg-gray-700 hover:bg-gray-600",children:"Import"}),(0,n.jsx)("input",{type:"file",accept:"application/json",ref:b,className:"hidden","aria-label":"Import lane runner save",onChange:e=>{let t=e.target.files&&e.target.files[0];t&&eg(t),e.target.value=""}})]})]})]}),eb=(0,a.useMemo)(()=>{let e=Math.round(q.speed);return"Speed ".concat(e)},[q.speed]),ex=(0,a.useMemo)(()=>Array.from(new Set([J.pause,"space"])).filter(Boolean),[J.pause]),ew=(0,a.useMemo)(()=>Array.from(new Set([J.restart,"r"])).filter(Boolean),[J.restart]);return(0,n.jsx)(o.default,{gameId:"lane-runner",title:"Lane Runner",onPauseChange:e=>{A(e),ep()},pauseHotkeys:ex,restartHotkeys:ew,score:q.score,highScore:C,lives:q.lives,stage:eb,hint:"Arrow keys or swipe to change lanes",badge:N,gameOver:T,onRestart:eo,settingsPanel:ey,children:(0,n.jsxs)("div",{className:"relative h-full w-full flex items-center justify-center bg-black",children:[(0,n.jsx)("canvas",{ref:e,className:"w-full h-full touch-none","aria-label":"Lane Runner game canvas"}),"touch"===w&&(0,n.jsx)("div",{className:"absolute bottom-3 left-0 right-0 flex items-center justify-center gap-3 pointer-events-none",children:(0,n.jsxs)("div",{className:"flex gap-3 pointer-events-auto",children:[(0,n.jsx)("button",{type:"button","aria-label":"Move left",className:"px-4 py-3 rounded bg-white/10 hover:bg-white/15 border border-white/15",onPointerDown:e=>{e.preventDefault(),H.current=Math.max(0,H.current-1)},children:"◀"}),(0,n.jsx)("button",{type:"button","aria-label":"Move right",className:"px-4 py-3 rounded bg-white/10 hover:bg-white/15 border border-white/15",onPointerDown:e=>{e.preventDefault(),H.current=Math.min(2,H.current+1)},children:"▶"})]})})]})})}},48581:(e,t,r)=>{function n(e){let t={};for(let r=0;r<window.localStorage.length;r+=1){let n=window.localStorage.key(r);if(n&&n.startsWith("".concat(e,":")))try{let r=window.localStorage.getItem(n);t[n.slice(e.length+1)]=r?JSON.parse(r):null}catch(e){}}return JSON.stringify(t)}function a(e,t){let r;try{r=JSON.parse(t)}catch(e){return}Object.entries(r).forEach(t=>{let[r,n]=t;try{window.localStorage.setItem("".concat(e,":").concat(r),JSON.stringify(n))}catch(e){}})}r.d(t,{exportGameSettings:()=>n,importGameSettings:()=>a})},85687:(e,t,r)=>{r.d(t,{patterns:()=>l,supportsVibration:()=>n,vibrate:()=>a});let n=()=>"undefined"!=typeof navigator&&"function"==typeof navigator.vibrate,a=e=>{if("false"===window.localStorage.getItem("haptics"))return;let t=Array.isArray(e)?e.reduce((e,t)=>e+(t>0?t:0),0):e;try{n()&&navigator.vibrate(e);if("undefined"!=typeof navigator&&"getGamepads"in navigator&&Array.from(navigator.getGamepads?navigator.getGamepads():[]).some(e=>e&&e.vibrationActuator&&"function"==typeof e.vibrationActuator.playEffect))try{for(let e of navigator.getGamepads())e&&e.vibrationActuator&&e.vibrationActuator.playEffect("dual-rumble",{duration:t,strongMagnitude:1,weakMagnitude:1})}catch(e){}}catch(e){}},l={score:[20],danger:[40,80,40],gameOver:[100,30,100]}},99372:(e,t,r)=>{r.d(t,{default:()=>s});var n=r(14232),a=r(74273),l=r(85687);function s(){let{haptics:e,setHaptics:t}=(0,a.useSettings)(),r=(0,n.useCallback)(t=>{e&&(0,l.supportsVibration)()&&(0,l.vibrate)(t)},[e]),s=(0,n.useCallback)(()=>r(l.patterns.score),[r]),i=(0,n.useCallback)(()=>r(l.patterns.danger),[r]),c=(0,n.useCallback)(()=>r(l.patterns.gameOver),[r]),o=(0,n.useCallback)(()=>t(!e),[t,e]);return{enabled:e,toggle:o,vibrate:r,score:s,danger:i,gameOver:c}}}}]);