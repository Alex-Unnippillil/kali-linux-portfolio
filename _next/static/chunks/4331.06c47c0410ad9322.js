"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4331],{64331:(e,t,l)=>{l.r(t),l.d(t,{default:()=>g});var s=l(37876),a=l(14232);let o=JSON.parse('[{"path":"post/multi/recon/local_exploit_suggester","description":"Examines the target system to suggest potential local privilege escalation exploits.","options":[{"name":"SESSION","label":"Session ID","value":"1"}],"sampleOutput":"# Running local_exploit_suggester\\n[*] Checking target...\\n[+] Found 0-day privilege escalation path"},{"path":"post/windows/manage/enable_rdp","description":"Enables Remote Desktop Protocol on the target Windows system.","options":[{"name":"SESSION","label":"Session ID","value":"1"}],"sampleOutput":"# Running enable_rdp\\n[*] RDP is already enabled\\n[+] Operation completed successfully"},{"path":"post/linux/gather/enum_network","description":"Collects network interface and routing information from a Linux host.","options":[{"name":"SESSION","label":"Session ID","value":"1"}],"sampleOutput":"# Running enum_network\\n[*] Gathering network info\\n[+] Interface eth0 192.168.0.5"}]'),r=JSON.parse('{"label":"Post Exploitation","children":[{"label":"Gather System Info","children":[{"label":"enum_network"},{"label":"local_exploit_suggester"}]},{"label":"Escalate Privileges","children":[{"label":"kernel exploits"},{"label":"service misconfig"}]},{"label":"Establish Persistence","children":[{"label":"enable_rdp"}]}]}'),n=JSON.parse('[{"id":1,"issue":"Weak SSH password policy","remediation":"Enforce strong SSH passwords and lockout policy","severity":"High"},{"id":2,"issue":"Anonymous FTP enabled","remediation":"Disable anonymous FTP or restrict permissions","severity":"Medium"},{"id":3,"issue":"Outdated Apache version","remediation":"Update Apache to the latest version","severity":"Low"}]'),i=()=>{let[e,t]=(0,a.useState)({key:"issue",direction:"asc"}),l=(0,a.useMemo)(()=>[...n].sort((t,l)=>{let s=t[e.key],a=l[e.key];return"number"==typeof s&&"number"==typeof a?"asc"===e.direction?s-a:a-s:"asc"===e.direction?String(s).localeCompare(String(a)):String(a).localeCompare(String(s))}),[n,e]),o=e=>{t(t=>t.key===e?{key:e,direction:"asc"===t.direction?"desc":"asc"}:{key:e,direction:"asc"})},r=t=>e.key!==t?null:"asc"===e.direction?"▲":"▼";return(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Remediation Tips"}),(0,s.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsxs)("th",{className:"cursor-pointer",onClick:()=>o("issue"),children:["Issue ",r("issue")]}),(0,s.jsxs)("th",{className:"cursor-pointer",onClick:()=>o("remediation"),children:["Remediation ",r("remediation")]}),(0,s.jsxs)("th",{className:"cursor-pointer",onClick:()=>o("severity"),children:["Severity ",r("severity")]})]})}),(0,s.jsx)("tbody",{children:l.map(e=>(0,s.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,s.jsx)("td",{className:"py-1 pr-2",children:e.issue}),(0,s.jsx)("td",{className:"py-1 pr-2 text-yellow-300",children:e.remediation}),(0,s.jsx)("td",{className:"py-1 pr-2",children:e.severity})]},e.id))})]})]})},c=e=>{let{title:t,output:l}=e;return(0,s.jsxs)("div",{className:"mb-2 rounded border border-[color:var(--kali-panel-border)] bg-[color:color-mix(in_srgb,var(--kali-panel)_92%,transparent)] p-3 shadow-[0_0_0_1px_rgba(15,148,210,0.08)]",children:[(0,s.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,s.jsx)("h4",{className:"font-semibold",children:t}),(0,s.jsx)("button",{onClick:()=>navigator.clipboard.writeText(l),className:"rounded px-2 py-1 text-xs font-medium text-[color:var(--color-dark)] transition hover:opacity-90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--kali-control)]",style:{background:"var(--kali-control)"},children:"Copy"})]}),(0,s.jsx)("pre",{className:"whitespace-pre-wrap rounded border border-[color:var(--kali-panel-border)] bg-[color:var(--kali-panel-highlight)] p-3 text-[color:var(--color-text)]",children:l})]})};var d=l(95220);let m={pending:"border border-[color:color-mix(in_srgb,var(--color-severity-medium)_32%,transparent)] bg-[color:color-mix(in_srgb,var(--color-severity-medium)_18%,transparent)] text-[color:var(--color-severity-medium)]",running:"border border-[color:color-mix(in_srgb,var(--color-severity-high)_32%,transparent)] bg-[color:color-mix(in_srgb,var(--color-severity-high)_18%,transparent)] text-[color:var(--color-severity-high)]",done:"border border-[color:color-mix(in_srgb,var(--color-severity-low)_32%,transparent)] bg-[color:color-mix(in_srgb,var(--color-severity-low)_18%,transparent)] text-[color:var(--color-severity-low)]"},u={pending:"text-[color:var(--color-severity-medium)]",running:"text-[color:var(--color-severity-high)]",done:"text-[color:var(--color-severity-low)]"},p={pending:"Pending",running:"Running",done:"Done"},h=e=>{let{data:t,onSelect:l}=e;return(0,s.jsx)("ul",{className:"pl-4",children:Object.entries(t).map(e=>{let[t,a]=e;return(0,s.jsx)(x,{name:t,node:a,onSelect:l},t)})})},x=e=>{let{name:t,node:l,onSelect:a}=e;return l.module?(0,s.jsx)("li",{children:(0,s.jsx)("button",{className:"text-left hover:underline",onClick:()=>a(l.module),children:t})}):(0,s.jsx)("li",{children:(0,s.jsxs)("details",{children:[(0,s.jsx)("summary",{className:"cursor-pointer",children:t}),(0,s.jsx)(h,{data:l.children,onSelect:a})]})})},b=e=>{let{node:t}=e;return(0,s.jsx)("ul",{className:"pl-4",children:(0,s.jsxs)("li",{children:[t.label,t.children&&t.children.length>0&&(0,s.jsx)("div",{children:t.children.map(e=>(0,s.jsx)(b,{node:e},e.label))})]})})},v=()=>{let[e,t]=(0,a.useState)(""),[l,o]=(0,a.useState)(null),[r,n]=(0,a.useState)(""),[i,c]=(0,a.useState)([]);return(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Evidence Vault"}),(0,s.jsx)("label",{htmlFor:"metasploit-evidence-note",className:"sr-only",id:"metasploit-evidence-note-label",children:"Note"}),(0,s.jsx)("textarea",{id:"metasploit-evidence-note",className:"w-full p-2 mb-2 text-black",placeholder:"Note",value:e,onChange:e=>t(e.target.value),"aria-labelledby":"metasploit-evidence-note-label"}),(0,s.jsx)("label",{htmlFor:"metasploit-evidence-file",className:"sr-only",id:"metasploit-evidence-file-label",children:"Attachment"}),(0,s.jsx)("input",{id:"metasploit-evidence-file",type:"file",className:"mb-2",onChange:e=>{var t;return o((null==(t=e.target.files)?void 0:t[0])||null)},"aria-labelledby":"metasploit-evidence-file-label"}),(0,s.jsx)("label",{htmlFor:"metasploit-evidence-tags",className:"sr-only",id:"metasploit-evidence-tags-label",children:"Tags"}),(0,s.jsx)("input",{id:"metasploit-evidence-tags",className:"w-full p-2 mb-2 text-black",placeholder:"Tags (comma separated)",value:r,onChange:e=>n(e.target.value),"aria-labelledby":"metasploit-evidence-tags-label"}),(0,s.jsx)("button",{onClick:()=>{if(!e&&!l)return;let s={id:Date.now(),note:e,fileName:null==l?void 0:l.name,tags:r.split(",").map(e=>e.trim()).filter(Boolean)};c(e=>[...e,s]),t(""),o(null),n("")},className:"rounded px-3 py-1 text-sm font-medium text-[color:var(--color-dark)] transition hover:opacity-90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--kali-control)]",style:{background:"var(--kali-control)"},children:"Add"}),(0,s.jsx)("ul",{className:"mt-4 list-disc pl-6",children:i.map(e=>(0,s.jsxs)("li",{className:"mb-2",children:[e.fileName&&(0,s.jsx)("span",{className:"font-mono mr-2",children:e.fileName}),e.note,e.tags.length>0&&(0,s.jsxs)("span",{className:"ml-2 text-sm text-gray-400",children:["[",e.tags.join(", "),"]"]})]},e.id))})]})},g=()=>{var e,t;let[l,n]=(0,a.useState)(null),[x,g]=(0,a.useState)({}),[f,j]=(0,a.useState)([{label:"Gather System Info",done:!1},{label:"Escalate Privileges",done:!1},{label:"Establish Persistence",done:!1},{label:"Cleanup Traces",done:!1}]),[y,N]=(0,a.useState)("Hash Dump"),[k,S]=(0,a.useState)({"Hash Dump":[],Persistence:[],Enumeration:[]}),[w,_]=(0,a.useState)([]),[C,E]=(0,a.useState)([]),[R,P]=(0,a.useState)(""),[T,D]=(0,d.default)("msf-post-sets",[]),[O,I]=(0,a.useState)(null),[q,F]=(0,a.useState)(!1),M=(0,a.useMemo)(()=>(e=>{let t={};return e.forEach(e=>{let l=e.path.split("/").slice(1),s=t;l.forEach((t,a)=>{s[t]=s[t]||{},a===l.length-1?s[t].module=e:(s[t].children=s[t].children||{},s=s[t].children)})}),t})(o),[]),Q=(0,a.useCallback)(()=>{j(e=>e.map(e=>({...e,done:!1}))),f.forEach((e,t)=>{setTimeout(()=>{j(e=>e.map((e,l)=>l===t?{...e,done:!0}:e))},(t+1)*500)})},[f]),A=(0,a.useCallback)((e,t)=>{E(l=>l.map(l=>l.module.path===e?{...l,status:t}:l))},[]),H=e=>{let t={title:e.path,output:e.sampleOutput};S(e=>({...e,[y]:[...e[y],t]})),n(e),Q()},W=(null==l||null==(e=l.options)?void 0:e.filter(e=>!(x[e.name]&&x[e.name].trim())))||[],G=W.length>0;return(0,s.jsxs)("div",{className:"min-h-screen bg-[var(--kali-panel)] p-4 text-[color:var(--color-text)]",children:[(0,s.jsx)("h1",{className:"text-xl mb-4",children:"Metasploit Post Modules"}),(0,s.jsxs)("div",{className:"mb-4 rounded border border-gray-700 bg-gray-800 p-3","data-testid":"queue-summary-card",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Execution Queue"}),q&&(0,s.jsx)("span",{className:"text-xs uppercase ".concat(u.running),children:"Processing"})]}),0===C.length?(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-300",children:"No modules queued."}):(0,s.jsx)("ul",{className:"mt-2 space-y-2",children:C.map(e=>(0,s.jsxs)("li",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"pr-2",children:e.module.path}),(0,s.jsx)("span",{className:"rounded-full px-2 py-0.5 text-xs uppercase tracking-wide ".concat(m[e.status]),children:p[e.status]})]},e.module.path))})]}),O&&(0,s.jsx)("div",{className:"mb-4 rounded border border-[color:color-mix(in_srgb,var(--color-info)_32%,transparent)] bg-[color:color-mix(in_srgb,var(--color-info)_14%,transparent)] p-3 text-sm text-[color:var(--color-info)]",role:"status",children:O}),(0,s.jsx)("div",{className:"flex space-x-4 mb-4",children:["Hash Dump","Persistence","Enumeration"].map(e=>(0,s.jsxs)("button",{onClick:()=>N(e),className:"px-3 py-1 rounded ".concat(y===e?"bg-gray-800":"bg-gray-700"),children:[e,(0,s.jsx)("span",{className:"ml-2 rounded px-2 py-0.5 text-xs ".concat(k[e].length?"bg-[color:color-mix(in_srgb,var(--color-severity-low)_22%,transparent)] text-[color:var(--color-severity-low)]":"bg-[color:color-mix(in_srgb,var(--color-severity-medium)_22%,transparent)] text-[color:var(--color-severity-medium)]"),children:k[e].length?"done":"pending"})]},e))}),(0,s.jsxs)("div",{className:"mb-4",children:[k[y].map((e,t)=>(0,s.jsx)(c,{title:e.title,output:e.output},t)),(0,s.jsx)("button",{onClick:()=>{let e=[...k["Hash Dump"],...k.Persistence,...k.Enumeration];if(0===e.length)return void I("No results to save. Run a module before generating a report.");I("Saving consolidated report results..."),_(t=>[...t,...e]),I("Report saved. Scroll down to review the compiled findings.")},className:"mt-2 rounded px-3 py-1 text-sm font-medium text-[color:var(--color-dark)] transition hover:opacity-90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--kali-control)]",style:{background:"var(--kali-control)"},children:"Save report"})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"w-1/3 overflow-auto border-r border-gray-700 pr-2",children:(0,s.jsx)(h,{data:M,onSelect:e=>{var t;n(e);let l={};null==(t=e.options)||t.forEach(e=>l[e.name]=e.value||""),g(l),j(e=>e.map(e=>({...e,done:!1})))}})}),(0,s.jsxs)("div",{className:"w-2/3 pl-4",children:[l?(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"font-semibold mb-2",children:l.path}),(0,s.jsx)("p",{className:"mb-2 text-sm text-gray-300",children:l.description}),l.options&&l.options.length>0?(0,s.jsx)("p",{className:"mb-3 text-xs text-gray-400",children:"Provide values for all required options before running. Defaults are pre-filled when available."}):(0,s.jsx)("p",{className:"mb-3 text-xs text-gray-400",children:"This module has no required options."}),null==(t=l.options)?void 0:t.map(e=>{let t="metasploit-post-option-".concat(e.name),l="".concat(t,"-label");return(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsx)("label",{className:"block",htmlFor:t,id:l,children:e.label}),(0,s.jsx)("input",{id:t,type:"text",className:"w-full p-1 bg-gray-800 rounded mt-1",value:x[e.name]||"",onChange:t=>{var l,s;return l=e.name,s=t.target.value,void g(e=>({...e,[l]:s}))},"aria-labelledby":l})]},e.name)}),G&&(0,s.jsxs)("p",{className:"text-xs text-amber-300",children:["Missing options: ",W.map(e=>e.label).join(", ")]}),(0,s.jsx)("button",{onClick:()=>{var e;if(!l)return void I("Select a module to run from the catalog tree.");let t=(null==(e=l.options)?void 0:e.filter(e=>!(x[e.name]&&x[e.name].trim())))||[];if(t.length>0){let e=t.map(e=>e.label).join(", ");I("Set the required option values before running: ".concat(e,"."));return}I("Running ".concat(l.path,"...")),H(l),A(l.path,"done"),I("Completed ".concat(l.path,". Review the output in the ").concat(y," tab."))},className:"mt-2 px-3 py-1 rounded ".concat(G?"bg-green-600/40 cursor-not-allowed":"bg-green-600"),disabled:G,children:"Run"}),(0,s.jsx)("button",{onClick:()=>{l&&E(e=>e.find(e=>e.module.path===l.path)?(I("This module is already queued."),e):(I("Queued ".concat(l.path,".")),[...e,{module:l,status:"pending"}]))},className:"mt-2 ml-2 px-3 py-1 bg-purple-600 rounded",children:"Add to Queue"})]}):(0,s.jsx)("p",{className:"text-gray-400",children:"Select a module to view details."}),C.length>0&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Queued Modules"}),(0,s.jsx)("ul",{className:"list-disc pl-6",children:C.map(e=>(0,s.jsxs)("li",{children:[e.module.path,(0,s.jsxs)("span",{className:"ml-2 text-xs ".concat(u[e.status]),children:["(",p[e.status],")"]})]},e.module.path))}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,s.jsx)("button",{onClick:()=>{if(0===C.length)return void I("Queue is empty. Add modules to the queue before running.");if(q)return void I("Queue is already running. Please wait for it to finish.");let e=[...C];F(!0),I("Running queue with ".concat(e.length," module").concat(e.length>1?"s":"","...")),e.forEach((t,l)=>{let s=1200*l;setTimeout(()=>{A(t.module.path,"running"),I("Running ".concat(t.module.path," (").concat(l+1,"/").concat(e.length,")..."))},s),setTimeout(()=>{H(t.module),A(t.module.path,"done"),l===e.length-1&&(I("Queue completed. Review the results below."),F(!1),setTimeout(()=>E([]),800))},s+600)})},className:"px-3 py-1 rounded ".concat(q?"bg-green-600/40 cursor-not-allowed":"bg-green-600"),disabled:q,children:"Run Queue"}),(0,s.jsx)("label",{htmlFor:"metasploit-post-set-name",className:"sr-only",id:"metasploit-post-set-name-label",children:"Set name"}),(0,s.jsx)("input",{id:"metasploit-post-set-name",className:"p-1 text-black",placeholder:"Set name",value:R,onChange:e=>P(e.target.value),"aria-labelledby":"metasploit-post-set-name-label"}),(0,s.jsx)("button",{onClick:()=>{if(!R||0===C.length)return;let e={name:R,modules:C.map(e=>e.module.path)};D(t=>[...t,e]),E([]),P("")},className:"rounded px-3 py-1 text-sm font-medium text-[color:var(--color-dark)] transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--kali-control)] ".concat(0!==C.length&&R.trim()?"hover:opacity-90":"cursor-not-allowed opacity-70"),style:{background:0!==C.length&&R.trim()?"var(--kali-control)":"color-mix(in srgb, var(--kali-control) 35%, transparent)"},disabled:0===C.length||!R.trim(),children:"Save Set"})]})]}),T.length>0&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Saved Sets"}),T.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,s.jsx)("span",{className:"flex-1",children:e.name}),(0,s.jsx)("button",{onClick:()=>{var t;return t=e.modules,void o.filter(e=>t.includes(e.path)).forEach((e,t)=>{setTimeout(()=>H(e),1e3*t)})},className:"px-2 py-0.5 bg-green-600 rounded",children:"Run"}),(0,s.jsx)("button",{onClick:()=>{D(e=>e.filter((e,l)=>l!==t))},className:"px-2 py-0.5 bg-red-600 rounded",children:"Delete"})]},t))]}),(0,s.jsx)("svg",{width:"220",height:80*f.length,className:"mt-4",children:f.map((e,t)=>(0,s.jsxs)("g",{transform:"translate(20, ".concat(70*t+20,")"),children:[(0,s.jsx)("circle",{cx:"0",cy:"0",r:"20",fill:e.done?"var(--color-severity-low)":"color-mix(in srgb, var(--color-text) 28%, transparent)"}),e.done&&(0,s.jsx)("path",{d:"M-8 0 l4 4 l8 -8",stroke:"#fff",strokeWidth:"2",fill:"none"}),(0,s.jsx)("text",{x:"40",y:"5",fill:e.done?"var(--color-severity-low)":"color-mix(in srgb, var(--color-text) 65%, transparent)",fontSize:"14",children:e.label}),t<f.length-1&&(0,s.jsx)("line",{x1:"0",y1:"20",x2:"0",y2:"70",stroke:"color-mix(in srgb, var(--color-text) 28%, transparent)",strokeWidth:"2"})]},e.label))}),(0,s.jsxs)("div",{className:"mt-8",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Privilege Escalation Tree"}),(0,s.jsx)(b,{node:r})]}),(0,s.jsx)(i,{}),(0,s.jsx)(v,{})]})]}),w.length>0&&(0,s.jsxs)("div",{className:"mt-8",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Saved Report"}),w.map((e,t)=>(0,s.jsx)(c,{title:e.title,output:e.output},t))]})]})}}}]);