"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2798],{2157:(e,t,a)=>{a.d(t,{default:()=>n});var l=a(37876),i=a(14232),r=a(13729);let n=e=>{let{dense:t=!1}=e,[a,n]=(0,i.useState)([]);(0,i.useEffect)(()=>{n((0,r.getSimulationLog)());let e=()=>n((0,r.getSimulationLog)());return window.addEventListener("simulation-log-updated",e),()=>window.removeEventListener("simulation-log-updated",e)},[]);let s=(0,i.useMemo)(()=>a.reduce((e,t)=>(e[t.tool]=(e[t.tool]||0)+1,e),{}),[a]);return(0,l.jsxs)("div",{className:"mt-4 rounded-md border border-[color:var(--kali-border)] bg-[color:color-mix(in_srgb,var(--kali-panel)_90%,var(--kali-overlay)_10%)] ".concat(t?"p-2 text-xs":"p-3 text-sm"),children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,l.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,l.jsx)("p",{className:"font-semibold text-[color:var(--color-text)]",children:"Export simulation report"}),(0,l.jsx)("p",{className:"text-[color:var(--color-muted)]",children:a.length?"".concat(a.length," entries captured across tools."):"Logs remain local until you export them."})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsx)("button",{type:"button",onClick:()=>{let e=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),l=document.createElement("a");l.href=t,l.download="simulation-report.json",l.click(),URL.revokeObjectURL(t)},className:"rounded border border-kali-border/70 bg-[color:var(--kali-panel)] px-3 py-1 font-semibold text-[color:var(--color-text)] shadow-sm transition hover:border-kali-accent/60 hover:text-kali-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus",children:"Download JSON"}),(0,l.jsx)("button",{type:"button",onClick:()=>{let e=a.map(e=>"<tr><td>".concat(e.tool,"</td><td>").concat((e=>{let t=new Date(e);return Number.isNaN(t.getTime())?e:t.toISOString().replace("T"," ").replace("Z"," UTC")})(e.timestamp),"</td><td>").concat(e.title,"</td><td>").concat(e.summary,"</td></tr>")).join(""),t=window.open("","_blank","width=900,height=700");t&&(t.document.write("<!doctype html><html><head><title>Simulation Report</title><style>body{font-family:Inter,system-ui,sans-serif;background:#111;color:#eee;padding:16px;}table{width:100%;border-collapse:collapse;}th,td{border:1px solid #333;padding:6px;font-size:13px;}</style></head><body><h1>Simulation Report (Deterministic)</h1><p>Save or print this page as a PDF to attach to demos.</p><table><thead><tr><th>Tool</th><th>Timestamp</th><th>Title</th><th>Summary</th></tr></thead><tbody>".concat(e||'<tr><td colspan="4">No entries recorded yet.</td></tr>',"</tbody></table></body></html>")),t.document.close(),t.focus(),t.print())},className:"rounded border border-kali-accent/70 bg-kali-accent/20 px-3 py-1 font-semibold text-white shadow-sm transition hover:bg-kali-accent/30 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus",children:"Print/PDF"}),(0,l.jsx)("button",{type:"button",onClick:()=>{(0,r.clearSimulationLog)(),n([])},className:"rounded border border-kali-border/70 bg-[color:var(--kali-panel)] px-3 py-1 font-semibold text-[color:var(--color-text)] shadow-sm transition hover:border-red-400 hover:text-red-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus",children:"Clear"})]})]}),!t&&a.length>0&&(0,l.jsx)("div",{className:"mt-3 grid grid-cols-2 gap-2 text-xs text-[color:var(--color-muted)] sm:grid-cols-3 md:grid-cols-4",children:Object.entries(s).map(e=>{let[t,a]=e;return(0,l.jsxs)("div",{className:"rounded bg-[color:color-mix(in_srgb,var(--kali-overlay)_65%,transparent)] px-2 py-1",children:[(0,l.jsx)("span",{className:"font-semibold text-[color:var(--color-text)]",children:t}),": ",a," entr",1===a?"y":"ies"]},t)})})]})}},13729:(e,t,a)=>{a.d(t,{clearSimulationLog:()=>o,getSimulationLog:()=>s,recordSimulation:()=>n});let l="simulation-report-log",i=Date.parse("2024-01-01T00:00:00Z"),r=()=>{try{let e=window.localStorage.getItem(l);if(!e)return[];let t=JSON.parse(e);return Array.isArray(t)?t:[]}catch(e){return[]}},n=e=>{let t=r(),a=new Date(i+6e4*t.length).toISOString(),n={...e,timestamp:a};var s=[...t,n];try{window.localStorage.setItem(l,JSON.stringify(s.slice(-50))),window.dispatchEvent(new Event("simulation-log-updated"))}catch(e){}return n},s=()=>r(),o=()=>{try{window.localStorage.removeItem(l),window.dispatchEvent(new Event("simulation-log-updated"))}catch(e){}}},42979:(e,t,a)=>{a.d(t,{default:()=>i});var l=a(37876);a(14232);let i=e=>{let{toolName:t,message:a="Deterministic demo output. No live hosts, credentials, or network calls.",className:i=""}=e;return(0,l.jsxs)("div",{className:"mb-3 flex items-start gap-3 rounded-md border border-[color:color-mix(in_srgb,var(--color-accent)_55%,transparent)] bg-[color:color-mix(in_srgb,var(--kali-panel)_88%,var(--kali-overlay)_12%)] px-3 py-2 text-sm text-[color:var(--color-text)] shadow-[0_8px_24px_rgba(0,0,0,0.28)] ".concat(i),role:"status","aria-live":"polite",children:[(0,l.jsx)("span",{"aria-hidden":!0,className:"mt-0.5 inline-flex h-7 w-7 items-center justify-center rounded-full bg-[color:color-mix(in_srgb,var(--color-accent)_30%,transparent)] text-base font-bold text-kali-accent shadow-[0_0_0_1px_color-mix(in_srgb,var(--color-accent)_75%,transparent)]",children:"SIM"}),(0,l.jsxs)("div",{className:"leading-snug",children:[(0,l.jsxs)("p",{className:"font-semibold uppercase tracking-wide text-[color:var(--color-muted)]",children:[t," Simulation"]}),(0,l.jsx)("p",{className:"text-[color:var(--color-text)]",children:a})]})]})}},50360:(e,t,a)=>{a.d(t,{copyToClipboard:()=>l,default:()=>i});let l=async e=>{try{var t,a;if(null==(a=navigator)||null==(t=a.clipboard)?void 0:t.writeText)await navigator.clipboard.writeText(e);else{let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),document.body.removeChild(t)}return!0}catch(e){return!1}},i=l},52798:(e,t,a)=>{a.r(t),a.d(t,{default:()=>v,displayAutopsy:()=>k});var l=a(37876),i=a(14232),r=a(42979),n=a(2157),s=a(13729);let o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},c={Document:"\uD83D\uDCC4",Image:"\uD83D\uDDBC️",Log:"\uD83D\uDCDC",File:"\uD83D\uDCC1",Registry:"\uD83D\uDDC3️"},d=function(e){let{keyword:t,setKeyword:a,artifacts:i,onSelect:r}=e,n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=o(e);if(!t)return a;let l=RegExp("(".concat(t.replace(/[.*+?^${}()|[\\]\\]/g,"\\$&"),")"),"gi");return a.replace(l,"<mark>$1</mark>")};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)("input",{type:"text",value:t,onChange:e=>a(e.target.value),placeholder:"Keyword search",className:"flex-grow rounded border border-kali-border/60 bg-kali-dark px-2 py-1 text-kali-text focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus/80"}),(0,l.jsx)("button",{onClick:()=>{let e=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="autopsy-hits.json",a.click(),URL.revokeObjectURL(t)},className:"rounded border border-kali-accent/80 bg-kali-accent px-2 py-1 text-sm font-semibold text-kali-text transition hover:bg-kali-accent/90 focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus",children:"Export Hits"})]}),(0,l.jsx)("div",{className:"grid gap-2 md:grid-cols-2",children:i.map((e,t)=>(0,l.jsxs)("button",{type:"button",onClick:()=>r(e),className:"flex flex-col gap-1 rounded border border-kali-border/60 bg-kali-dark/80 p-2 text-left text-sm text-kali-text transition hover:border-kali-accent/70 focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus/80",children:[(0,l.jsxs)("div",{className:"flex items-center font-bold",children:[(0,l.jsx)("span",{className:"mr-1","aria-hidden":"true",children:c[e.type]||"\uD83D\uDCC1"}),(0,l.jsx)("span",{dangerouslySetInnerHTML:{__html:n(e.name)}})]}),(0,l.jsx)("div",{className:"text-kali-text/60",children:e.type}),(0,l.jsx)("div",{className:"text-xs",children:new Date(e.timestamp).toLocaleString()}),e.user&&(0,l.jsx)("div",{className:"text-xs",dangerouslySetInnerHTML:{__html:"User: ".concat(n(e.user))}}),(0,l.jsx)("div",{className:"text-xs",dangerouslySetInnerHTML:{__html:n(e.description)}})]},"".concat(e.name,"-").concat(t)))})]})},u=JSON.parse('[{"name":"resume.docx","type":"Document","description":"Resume found on user\'s desktop","size":12345,"plugin":"metadata","timestamp":"2023-08-01T10:00:00Z","user":"alice"},{"name":"photo.jpg","type":"Image","description":"Photo from mobile device","size":23456,"plugin":"hash","timestamp":"2023-08-01T12:30:00Z","user":"bob"},{"name":"system.log","type":"Log","description":"System log entry","size":34567,"plugin":"metadata","timestamp":"2023-08-01T14:45:00Z","user":"alice"},{"name":"run.exe","type":"File","description":"Executable recovered from temp folder","size":45678,"plugin":"hash","timestamp":"2023-08-01T16:15:00Z","user":"bob"},{"name":"HKCU\\\\\\\\Software\\\\\\\\Example","type":"Registry","description":"Registry key with suspicious value","size":0,"plugin":"regParser","timestamp":"2023-08-01T18:20:00Z","user":"system"}]');var m=a(50360);let p=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),x=e=>{let{caseName:t="case",artifacts:a}=e,r=(0,i.useMemo)(()=>{let e=a.map(e=>"<tr><td>".concat(p(e.name),"</td><td>").concat(p(e.type),"</td><td>").concat(p(e.description),"</td><td>").concat(e.size,"</td><td>").concat(p(e.plugin),"</td><td>").concat(p(e.timestamp),"</td></tr>")).join("");return'<!DOCTYPE html><html><head><meta charset="utf-8"/><title>'.concat(p(t)," Report</title></head><body><h1>").concat(p(t),'</h1><table border="1"><tr><th>Name</th><th>Type</th><th>Description</th><th>Size</th><th>Plugin</th><th>Timestamp</th></tr>').concat(e,"</table></body></html>")},[a,t]);return(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{onClick:()=>{(0,m.default)(r)},className:"rounded border border-kali-border/60 bg-kali-muted px-3 py-1 text-sm text-kali-text shadow-sm transition hover:bg-kali-muted/80 focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus/80",children:"Copy HTML Report"}),(0,l.jsx)("button",{onClick:()=>{let e=new Blob([r],{type:"text/html"}),a=URL.createObjectURL(e),l=document.createElement("a");l.href=a,l.download="".concat(t||"case","-report.html"),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)},className:"rounded border border-kali-accent/80 bg-kali-accent px-3 py-1 text-sm font-semibold text-kali-text shadow-sm transition hover:bg-kali-accent/90 focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus",children:"Download HTML Report"})]})},f=JSON.parse('{"timeline":[{"timestamp":"2023-08-01T10:00:00Z","event":"resume.docx created on desktop","thumbnail":"/themes/Yaru/apps/gedit.png"},{"timestamp":"2023-08-01T12:30:00Z","event":"photo.jpg taken on phone","thumbnail":"/themes/Yaru/apps/autopsy.svg"},{"timestamp":"2023-08-01T14:45:00Z","event":"system.log updated","thumbnail":"/themes/Yaru/apps/autopsy.svg"},{"timestamp":"2023-08-01T16:15:00Z","event":"run.exe executed","thumbnail":"/themes/Yaru/apps/autopsy.svg"},{"timestamp":"2023-08-01T18:20:00Z","event":"Registry key modified","thumbnail":"/themes/Yaru/apps/autopsy.svg"}]}'),h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")};function g(e){let{events:t,onSelect:r}=e,n=(0,i.useRef)(null),s=(0,i.useRef)(null),o=(0,i.useRef)(null),c=(0,i.useRef)(null),d=(0,i.useRef)([]),[u,m]=(0,i.useState)([]),p=1/1440,[x,f]=(0,i.useState)(1/60),[h,g]=(0,i.useState)(""),[b,v]=(0,i.useState)(0),[k,y]=(0,i.useState)(null),j=(0,i.useMemo)(()=>{let e=[],t=new Set;return u.forEach((a,l)=>{let i=new Date(a.timestamp).toISOString().split("T")[0];t.has(i)||(t.add(i),e.push({day:i,idx:l}))}),e},[u]);(0,i.useEffect)(()=>{if("function"==typeof Worker)return c.current=new Worker(a.tu(new URL(a.p+a.u(6015),a.b))),c.current.onmessage=e=>m(e.data),()=>{var e;return null==(e=c.current)?void 0:e.terminate()}},[]),(0,i.useEffect)(()=>{c.current&&c.current.postMessage({events:t})},[t]),(0,i.useEffect)(()=>{v(0)},[u]),(0,i.useEffect)(()=>{let e,t=1/x;if(t>=1440){let a=t/1440;e="".concat(a.toFixed(0)," day").concat(a>1?"s":""," per pixel")}else if(t>=60){let a=t/60;e="".concat(a.toFixed(0)," hour").concat(a>1?"s":""," per pixel")}else if(t>=1)e="".concat(t.toFixed(0)," minute").concat(t>1?"s":""," per pixel");else{let a=60*t;e="".concat(a.toFixed(0)," second").concat(a>1?"s":""," per pixel")}g("Timeline scale: ".concat(e))},[x]),(0,i.useEffect)(()=>{let e=n.current;if(!e)return;let t=e=>{e.preventDefault();let t=e.deltaY<0?2:.5;f(e=>Math.min(60,Math.max(p,e*t)))};return e.addEventListener("wheel",t,{passive:!1}),()=>e.removeEventListener("wheel",t)},[60,p]);let w=(0,i.useCallback)(()=>{let e=n.current;if(!e||0===u.length)return;let t=e.getContext("2d"),a=u.map(e=>new Date(e.timestamp).getTime()),l=Math.min(...a),i=Math.max(...a),r=Math.max(((i-l)/6e4||1)*x,600);e.width=r,e.height=80;let c=e.height,m=window.matchMedia("(prefers-reduced-motion: reduce)").matches,p=()=>{let e=t.createLinearGradient(0,0,r,0);e.addColorStop(0,"#1f1f1f"),e.addColorStop(1,"#2a2a2a"),t.fillStyle=e,t.fillRect(0,0,r,c),t.strokeStyle="#ffffff",t.beginPath(),t.moveTo(0,c/2),t.lineTo(r,c/2),t.stroke(),t.fillStyle="#ffffff",t.font="10px sans-serif";let a=1/x*80,n=[1,5,15,30,60,120,240,720,1440].find(e=>e>=a)||1440,m=6e4*n,p=Math.ceil(l/m)*m;for(let e=p;e<=i;e+=m){let a,i=(e-l)/6e4*x;t.fillRect(i,c/2+10,1,10);let r=new Date(e);a=n>=1440?r.toLocaleDateString():n>=60?r.toLocaleTimeString([],{hour:"2-digit"}):r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),t.fillText(a,i+2,c/2+25)}t.fillStyle="#ffa500",d.current=[],u.forEach(e=>{let a=(new Date(e.timestamp).getTime()-l)/6e4*x;t.fillRect(a,c/2-10,2,20),d.current.push({x:a,event:e})});let f=s.current,h=o.current;if(f){let e=f.getContext("2d"),t=h?h.clientWidth:600;f.width=t,f.height=20;let a=e.createLinearGradient(0,0,t,0);a.addColorStop(0,"#1f1f1f"),a.addColorStop(1,"#2a2a2a"),e.fillStyle=a,e.fillRect(0,0,t,20),e.fillStyle="#ffa500";let n=i-l||1;if(u.forEach(a=>{let i=(new Date(a.timestamp).getTime()-l)/n*t;e.fillRect(i,5,1,10)}),h){let a=h.scrollLeft/r,l=(h.scrollLeft+h.clientWidth)/r,i=a*t,n=Math.max((l-a)*t,10);e.strokeStyle="#ffffff",e.strokeRect(i,0,n,20)}}};m?p():requestAnimationFrame(p)},[u,x]);return(0,i.useEffect)(()=>{let e=n.current;if(!e)return;let t=t=>{let a=e.getBoundingClientRect(),l=t.clientX-a.left,i=d.current.find(e=>5>Math.abs(e.x-l));i&&r&&r(i.event)};return e.addEventListener("click",t),()=>e.removeEventListener("click",t)},[r]),(0,i.useEffect)(()=>{w()},[w]),(0,i.useEffect)(()=>{let e=o.current;if(!e)return;let t=()=>w();return e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)},[w]),(0,i.useEffect)(()=>{let e=s.current,t=o.current;if(!e||!t)return;let a=a=>{let l=e.getBoundingClientRect(),i=(a.clientX-l.left)/e.width*n.current.width-t.clientWidth/2;t.scrollLeft=Math.max(0,i),w()};return e.addEventListener("click",a),()=>e.removeEventListener("click",a)},[w]),(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("div",{"aria-live":"polite",className:"sr-only",children:h}),(0,l.jsxs)("div",{className:"mb-1 flex space-x-2",children:[(0,l.jsx)("button",{onClick:()=>f(e=>Math.min(2*e,60)),className:"rounded border border-kali-accent/80 bg-kali-accent px-2 py-1 text-sm font-semibold text-kali-text transition hover:bg-kali-accent/90 focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus","aria-label":"Zoom in",children:"+"}),(0,l.jsx)("button",{onClick:()=>f(e=>Math.max(e/2,p)),className:"rounded border border-kali-accent/80 bg-kali-accent px-2 py-1 text-sm font-semibold text-kali-text transition hover:bg-kali-accent/90 focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus","aria-label":"Zoom out",children:"-"})]}),u.length>0&&(0,l.jsxs)("div",{className:"relative mb-2",children:[(0,l.jsx)("input",{type:"range",min:0,max:u.length-1,value:b,onChange:e=>{let t=Number(e.target.value);v(t),r&&u[t]&&r(u[t])},onMouseMove:e=>{let t=e.target.getBoundingClientRect();y(Math.round((e.clientX-t.left)/t.width*(u.length-1)))},onMouseLeave:()=>y(null),list:"timeline-day-markers",className:"w-full","aria-label":"Timeline scrub bar"}),(0,l.jsx)("datalist",{id:"timeline-day-markers",children:j.map(e=>(0,l.jsx)("option",{value:e.idx,label:new Date(e.day).toLocaleDateString()},e.day))}),null!==k&&u[k]&&(0,l.jsxs)("div",{className:"absolute -top-10 rounded border border-kali-border/70 bg-kali-dark/95 px-2 py-1 text-xs text-kali-text shadow-lg",style:{left:"".concat(u.length>1?k/(u.length-1)*100:0,"%"),transform:"translateX(-50%)"},children:[(0,l.jsx)("div",{children:new Date(u[k].timestamp).toLocaleString()}),(0,l.jsx)("div",{children:u[k].name}),u[k].description&&(0,l.jsx)("div",{className:"text-[10px]",children:u[k].description})]})]}),(0,l.jsx)("div",{ref:o,className:"w-full overflow-x-auto rounded bg-gradient-to-r from-kali-dark/90 to-kali-surface/80 p-1.5",children:(0,l.jsx)("canvas",{ref:n,className:"bg-kali-dark/95",role:"img","aria-label":"File event timeline"})}),(0,l.jsx)("canvas",{ref:s,className:"mt-2 w-full rounded bg-kali-dark/90",height:20,"aria-label":"Timeline overview"})]})}function b(e){let{initialArtifacts:t=null}=e,[o,c]=(0,i.useState)(""),[m,p]=(0,i.useState)(null),[b,v]=(0,i.useState)(""),[k,y]=(0,i.useState)([]),[j,w]=(0,i.useState)(()=>[]),[N,S]=(0,i.useState)(""),[L,C]=(0,i.useState)(""),[E,R]=(0,i.useState)("All"),[T,D]=(0,i.useState)("All"),[_,U]=(0,i.useState)("All"),[M,A]=(0,i.useState)(""),[O,F]=(0,i.useState)(""),[z,I]=(0,i.useState)(null),[Z,H]=(0,i.useState)(null),[B,P]=(0,i.useState)({}),[J,W]=(0,i.useState)(null),[Y,q]=(0,i.useState)(""),[K,X]=(0,i.useState)("hex"),[$]=(0,i.useState)(f.timeline.map(e=>({name:e.event,timestamp:e.timestamp}))),G=(0,i.useRef)(null),Q=(0,i.useRef)(!1);(0,i.useEffect)(()=>{fetch("/plugin-marketplace.json").then(e=>e.json()).then(w).catch(()=>w([]))},[]),(0,i.useEffect)(()=>{if("function"==typeof Worker)try{G.current=new Worker(a.tu(new URL(a.p+a.u(8154),a.b))),G.current.onmessage=e=>y(e.data||[])}catch(e){G.current=null}return()=>{var e;return null==(e=G.current)?void 0:e.terminate()}},[]),(0,i.useEffect)(()=>{m&&(t?y(t):(y(u),fetch("/autopsy-demo.json").then(async e=>{let t=e.text?await e.text():JSON.stringify(await e.json());if(G.current)G.current.postMessage(t);else try{let e=JSON.parse(t);y(e.artifacts||u)}catch(e){y(u)}}).catch(()=>y(u))),fetch("/demo-data/autopsy/filetree.json").then(e=>e.json()).then(e=>H(e&&e.name?e:null)).catch(()=>H(null)),fetch("/demo-data/autopsy/hashes.json").then(e=>e.json()).then(e=>P(e||{})).catch(()=>P({})))},[m,t]),(0,i.useEffect)(()=>{if(!k.length||Q.current)return;let e=new Set(k.map(e=>e.plugin).filter(Boolean)).size;(0,s.recordSimulation)({tool:"autopsy",title:m||"Demo case",summary:"".concat(k.length," artifacts staged across ").concat(e," plugins"),data:{artifactCount:k.length,caseName:m||"demo",plugins:e}}),Q.current=!0},[k,m]);let V=["All",...Array.from(new Set(k.map(e=>e.type)))],ee=["All",...Array.from(new Set(k.map(e=>e.user).filter(Boolean)))],et=["All",...Array.from(new Set(k.map(e=>e.plugin).filter(Boolean)))],ea=k.filter(e=>("All"===E||e.type===E)&&("All"===T||e.user===T)&&("All"===_||e.plugin===_)&&(!M||new Date(e.timestamp)>=new Date(M))&&(!O||new Date(e.timestamp)<=new Date(O))),el=Y.toLowerCase(),ei=ea.filter(e=>e.name.toLowerCase().includes(el)||e.description.toLowerCase().includes(el)||e.user&&e.user.toLowerCase().includes(el)),er=$.filter(e=>(!M||new Date(e.timestamp)>=new Date(M))&&(!O||new Date(e.timestamp)<=new Date(O))).filter(e=>e.name.toLowerCase().includes(el)),en=e=>Array.from(e,(e,t)=>e.toString(16).padStart(2,"0")+(t%8==7?"  ":" ")).join("").trim(),es=async e=>{try{let t,a=(t=e.content||"",Uint8Array.from(atob(t),e=>e.charCodeAt(0))),l=en(a),i=new TextDecoder().decode(a).replace(/[^\x20-\x7E]+/g," "),r="";if(crypto&&crypto.subtle){let e=await crypto.subtle.digest("SHA-256",a);r=en(new Uint8Array(e)).replace(/ /g,"")}let n=B[r],s=null;if(/\.(png|jpe?g|gif|bmp|webp)$/i.test(e.name)&&"undefined"!=typeof URL)try{s=URL.createObjectURL(new Blob([a]))}catch(e){s=null}W({name:e.name,hex:l,strings:i,hash:r,known:n,imageUrl:s}),X("hex")}catch(t){W({name:e.name,hex:"",strings:"",hash:"",known:null,imageUrl:null}),X("hex")}};(0,i.useEffect)(()=>()=>{J&&J.imageUrl&&URL.revokeObjectURL(J.imageUrl)},[J]);let eo=e=>{if(!e)return null;let t=!!e.children;return(0,l.jsxs)("div",{className:"pl-2",children:[(0,l.jsxs)("div",{className:"flex items-center h-8",children:[(0,l.jsx)("span",{className:"mr-1",children:t?"\uD83D\uDCC1":"\uD83D\uDCC4"}),t?(0,l.jsx)("span",{className:"font-bold",children:e.name}):(0,l.jsx)("button",{type:"button",onClick:()=>es(e),className:"text-blue-400 underline",children:e.name})]}),t&&(0,l.jsx)("div",{className:"pl-4",children:e.children.map(e=>eo(e))})]},e.name)};return(0,i.useEffect)(()=>{if(k.length>0){let e=k[k.length-1];C("".concat(h(e.name)," analyzed at ").concat(new Date(e.timestamp).toLocaleString()))}},[k]),(0,l.jsxs)("div",{className:"flex h-full w-full flex-col space-y-4 bg-kali-surface p-4 text-kali-text",children:[(0,l.jsx)("div",{"aria-live":"polite",className:"sr-only",dangerouslySetInnerHTML:{__html:L}}),(0,l.jsx)(r.default,{toolName:"Autopsy",message:"Evidence reviews use offline datasets and deterministic timelines for safe demos."}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)("input",{type:"text",value:o,onChange:e=>c(e.target.value),placeholder:"Case name",className:"flex-grow rounded border border-kali-border/60 bg-kali-dark px-2 py-1 text-kali-text focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus/80"}),(0,l.jsx)("button",{onClick:()=>{let e=o.trim();e&&(p(e),v(""))},className:"rounded border border-kali-accent/80 bg-kali-accent px-3 py-1 font-semibold text-kali-text shadow-sm transition hover:bg-kali-accent/90 focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus",children:"Create Case"})]}),(0,l.jsx)("a",{href:"https://sleuthkit.org/autopsy/docs/user-docs/",target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-kali-accent underline",children:"Autopsy documentation"}),m&&(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"text-sm",children:["Current case: ",m]}),(0,l.jsxs)("div",{className:"flex space-x-2 items-center",children:[(0,l.jsxs)("select",{value:N,onChange:e=>S(e.target.value),className:"rounded border border-kali-border/60 bg-kali-dark px-2 py-1 text-kali-text focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus/80",children:[(0,l.jsx)("option",{value:"",children:"Select Plugin"}),j.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,l.jsx)("input",{"aria-label":"Upload file",type:"file",onChange:e=>{let t=e.target.files[0];if(!t)return;let a=new FileReader;a.onload=e=>{let a=en(new Uint8Array(e.target.result).slice(0,20)),l=h(t.name);v("File: ".concat(l,"\nSize: ").concat(t.size," bytes\nFirst 20 bytes: ").concat(a)),y(e=>[...e,{name:t.name,size:t.size,hex:a,plugin:N||"None",timestamp:new Date().toISOString()}])},a.readAsArrayBuffer(t)},className:"text-sm"})]})]}),b&&(0,l.jsx)("textarea",{readOnly:!0,value:b,className:"resize-none rounded border border-kali-border/60 bg-kali-dark p-2 text-xs text-kali-text"}),k.length>0&&(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsx)("select",{"aria-label":"Filter by type",value:E,onChange:e=>R(e.target.value),className:"rounded border border-kali-border/60 bg-kali-dark px-2 py-1 text-kali-text focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus/80",children:V.map(e=>(0,l.jsx)("option",{value:e,children:e},e))}),(0,l.jsx)("select",{"aria-label":"Filter by user",value:T,onChange:e=>D(e.target.value),className:"rounded border border-kali-border/60 bg-kali-dark px-2 py-1 text-kali-text focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus/80",children:ee.map(e=>(0,l.jsx)("option",{value:e,children:e},e))}),(0,l.jsx)("select",{"aria-label":"Filter by plugin",value:_,onChange:e=>U(e.target.value),className:"rounded border border-kali-border/60 bg-kali-dark px-2 py-1 text-kali-text focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus/80",children:et.map(e=>(0,l.jsx)("option",{value:e,children:e},e))}),(0,l.jsx)("input",{type:"datetime-local","aria-label":"Start time",value:M,onChange:e=>A(e.target.value),className:"rounded border border-kali-border/60 bg-kali-dark px-2 py-1 text-kali-text focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus/80"}),(0,l.jsx)("input",{type:"datetime-local","aria-label":"End time",value:O,onChange:e=>F(e.target.value),className:"rounded border border-kali-border/60 bg-kali-dark px-2 py-1 text-kali-text focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus/80"})]}),(0,l.jsx)(d,{keyword:Y,setKeyword:q,artifacts:ei,onSelect:I}),er.length>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"text-sm font-bold",children:"Timeline"}),(0,l.jsx)(g,{events:er,onSelect:()=>{}})]}),Z&&(0,l.jsxs)("div",{className:"flex space-x-4",children:[(0,l.jsxs)("div",{className:"w-1/3",children:[(0,l.jsx)("div",{className:"text-sm font-bold mb-1",children:"File Explorer"}),eo(Z)]}),J&&(0,l.jsxs)("div",{className:"flex-grow rounded border border-kali-border/60 bg-kali-dark/80 p-2 text-xs text-kali-text",children:[(0,l.jsx)("div",{className:"font-bold mb-1",children:J.name}),(0,l.jsxs)("div",{className:"mb-1",children:["SHA-256: ",J.hash]}),J.known&&(0,l.jsxs)("div",{className:"mb-1 text-kali-accent",children:["Known: ",J.known]}),(0,l.jsxs)("div",{className:"flex space-x-2 mb-2",children:[(0,l.jsx)("button",{className:"".concat("hex"===K?"bg-kali-accent text-kali-text":"bg-kali-dark/70 text-kali-text/80"," rounded px-2 py-1 transition focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus"),onClick:()=>X("hex"),children:"Hex"}),(0,l.jsx)("button",{className:"".concat("text"===K?"bg-kali-accent text-kali-text":"bg-kali-dark/70 text-kali-text/80"," rounded px-2 py-1 transition focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus"),onClick:()=>X("text"),children:"Text"}),J.imageUrl&&(0,l.jsx)("button",{className:"".concat("image"===K?"bg-kali-accent text-kali-text":"bg-kali-dark/70 text-kali-text/80"," rounded px-2 py-1 transition focus:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus"),onClick:()=>X("image"),children:"Image"})]}),"hex"===K&&(0,l.jsx)("pre",{className:"font-mono whitespace-pre-wrap break-all",children:J.hex}),"text"===K&&(0,l.jsx)("pre",{className:"font-mono whitespace-pre-wrap break-all",children:J.strings}),"image"===K&&J.imageUrl&&(0,l.jsx)("img",{src:J.imageUrl,alt:J.name,className:"max-w-full h-auto"})]})]}),(0,l.jsx)(x,{caseName:m||"case",artifacts:k}),(0,l.jsx)(n.default,{})]}),z&&(0,l.jsxs)("div",{className:"fixed right-0 top-0 h-full w-64 overflow-y-auto bg-kali-dark/95 p-4 text-kali-text shadow-2xl",children:[(0,l.jsx)("button",{onClick:()=>I(null),className:"mb-2 text-right w-full",children:"Close"}),(0,l.jsx)("div",{className:"font-bold",dangerouslySetInnerHTML:{__html:h(z.name)}}),(0,l.jsx)("div",{className:"text-kali-text/60",children:z.type}),(0,l.jsx)("div",{className:"text-xs",children:new Date(z.timestamp).toLocaleString()}),(0,l.jsx)("div",{className:"text-xs",children:z.description}),(0,l.jsxs)("div",{className:"text-xs",children:["Plugin: ",z.plugin]}),(0,l.jsxs)("div",{className:"text-xs",children:["User: ",z.user||"Unknown"]}),(0,l.jsxs)("div",{className:"text-xs",children:["Size: ",z.size]})]})]})}let v=b,k=()=>(0,l.jsx)(b,{})}}]);