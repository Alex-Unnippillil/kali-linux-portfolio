(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[236],{12865:(t,e,i)=>{"use strict";i.d(e,{DESKTOP_TOP_PADDING:()=>a,NAVBAR_HEIGHT:()=>n,NAVBAR_VERTICAL_PADDING:()=>o,SNAP_BOTTOM_INSET:()=>h,WINDOW_TOP_INSET:()=>r,WINDOW_TOP_MARGIN:()=>s});let n=56,o=10,s=.33,r=0,a=66.33,h=58},25180:t=>{t.exports={windowFrame:"window_windowFrame__70VpL",windowFrameActive:"window_windowFrameActive__1cuF_",windowFrameInactive:"window_windowFrameInactive__9lOkV",windowFrameResizing:"window_windowFrameResizing__TM_Ah",windowFrameSnapReady:"window_windowFrameSnapReady__Zljli",windowFrameMaximized:"window_windowFrameMaximized__r4Doa",windowFrameMinimized:"window_windowFrameMinimized__KD3dE",snapPreview:"window_snapPreview__Tvl4c",snapPreviewGlass:"window_snapPreviewGlass__bi6tL",snapPreviewLabel:"window_snapPreviewLabel__n4oyt",windowTitlebar:"window_windowTitlebar__ouFXQ",windowTitleBalancer:"window_windowTitleBalancer__amPBW",windowTitle:"window_windowTitle__ZNtmF",windowControls:"window_windowControls__6zGYT",windowControlButton:"window_windowControlButton__42Rht",windowControlButtonPressed:"window_windowControlButtonPressed__gEpQH",windowControlButtonDisabled:"window_windowControlButtonDisabled__R2qil",windowControlButtonClose:"window_windowControlButtonClose__S48NM",windowResizeHandle:"window_windowResizeHandle__Gmzhr",windowControlIcon:"window_windowControlIcon__el2wM",windowYBorder:"window_windowYBorder__AI_3X",windowResizeHandleEdge:"window_windowResizeHandleEdge__kzByh",windowResizeHandleCorner:"window_windowResizeHandleCorner__O3lTM",windowResizeHandleActive:"window_windowResizeHandleActive__U4qnn",windowResizeHandleNorth:"window_windowResizeHandleNorth__FtkLd",windowResizeHandleSouth:"window_windowResizeHandleSouth__vutVw",windowResizeHandleEast:"window_windowResizeHandleEast__0SM_E",windowResizeHandleWest:"window_windowResizeHandleWest__KXTyc",windowResizeHandleCornerNorthWest:"window_windowResizeHandleCornerNorthWest__pmlAP",windowResizeHandleCornerNorthEast:"window_windowResizeHandleCornerNorthEast__ZpOo3",windowResizeHandleCornerSouthEast:"window_windowResizeHandleCornerSouthEast__AbnoP",windowResizeHandleCornerSouthWest:"window_windowResizeHandleCornerSouthWest__KmHc_"}},33618:(t,e,i)=>{"use strict";i.d(e,{DEFAULT_WINDOW_TOP_OFFSET:()=>d,clampWindowPositionWithinViewport:()=>x,clampWindowTopPosition:()=>m,getSafeAreaInsets:()=>h,measureSafeAreaInset:()=>l,measureSnapBottomInset:()=>w,measureWindowTopOffset:()=>u});var n=i(12865);let o=n.NAVBAR_HEIGHT+n.NAVBAR_VERTICAL_PADDING,s={top:"--safe-area-top",right:"--safe-area-right",bottom:"--safe-area-bottom",left:"--safe-area-left"},r=n.SNAP_BOTTOM_INSET,a=(t,e)=>t&&"function"==typeof t.getPropertyValue?(t=>{if("string"!=typeof t)return 0;let e=t.trim();if(!e)return 0;let i=parseFloat(e);return Number.isFinite(i)?i:0})(t.getPropertyValue(e)):0,h=()=>{if("undefined"==typeof document)return{top:0,right:0,bottom:0,left:0};let t=window.getComputedStyle(document.documentElement);return{top:a(t,s.top),right:a(t,s.right),bottom:a(t,s.bottom),left:a(t,s.left)}},l=t=>{let e=h();if(!e||"object"!=typeof e)return 0;let i=e[t];return"number"==typeof i&&Number.isFinite(i)?i:0},d=o+n.WINDOW_TOP_MARGIN+n.WINDOW_TOP_INSET,u=()=>{if("undefined"==typeof document)return d;let t=document.querySelector(".main-navbar-vp");if(!t)return d;let{height:e}=t.getBoundingClientRect();return Math.max((Number.isFinite(e)?Math.ceil(e):o)+n.WINDOW_TOP_MARGIN+n.WINDOW_TOP_INSET,d)},p=t=>{if(!t||"function"!=typeof window.getComputedStyle)return 0;let e=window.getComputedStyle(t);return e?((t,e)=>{if("string"!=typeof t)return 0;let i=t.trim();if(!i)return 0;let n=parseFloat(i);if(!Number.isFinite(n))return 0;if(i.endsWith("rem")||i.endsWith("em"))return n*(t=>{if("string"!=typeof t)return 16;let e=parseFloat(t);return Number.isFinite(e)?e:16})(null==e?void 0:e.fontSize);if(i.endsWith("vh")||i.endsWith("svh")||i.endsWith("lvh")||i.endsWith("dvh")){let t="number"==typeof window.innerHeight?window.innerHeight:0;return t?n/100*t:0}if(i.endsWith("vw")||i.endsWith("svw")||i.endsWith("lvw")||i.endsWith("dvw")){let t="number"==typeof window.innerWidth?window.innerWidth:0;return t?n/100*t:0}return n})(e.getPropertyValue("--shell-taskbar-height"),e):0},w=()=>{let t=(()=>{if("undefined"==typeof document)return r;let t=p(document.querySelector(".desktop-shell"));if(t>0)return t;let e=p(document.documentElement||document.body);return e>0?e:r})();return"number"==typeof t&&Number.isFinite(t)?Math.max(t,r):r},m=(t,e)=>{let i="number"==typeof e?e:u();return"number"!=typeof t||Number.isNaN(t)?i:Math.max(t,i)},c=t=>"number"!=typeof t?0:Number.isFinite(t)?Math.max(t,0):0,f=(t,e)=>"number"==typeof t&&Number.isFinite(t)?t:"number"==typeof window[e]?window[e]:0,g=(t,e)=>"number"==typeof t&&Number.isFinite(t)?t:e,y=t=>"number"==typeof t&&Number.isFinite(t)?t:0,x=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t||"object"!=typeof t)return null;let n=f(i.viewportWidth,"innerWidth"),o=f(i.viewportHeight,"innerHeight"),s=y(i.viewportLeft),r=y(i.viewportTop),a="number"==typeof i.topOffset?i.topOffset:u(),h="number"==typeof i.bottomInset?Math.max(i.bottomInset,0):Math.max(0,l("bottom")),d="number"==typeof i.snapBottomInset?Math.max(i.snapBottomInset,0):w();if(!n||!o){let e=r+a;return{x:g(t.x,s),y:m(t.y,e),bounds:{minX:s,maxX:s,minY:e,maxY:e}}}let p=e&&"object"==typeof e?c(e.width):0,x=e&&"object"==typeof e?c(e.height):0,v=Math.max(Math.max(o-a-d-h,0)-x,0),b=s+Math.max(n-p,0),_=r+a,z=_+v;return{x:Math.min(Math.max(g(t.x,s),s),b),y:Math.min(Math.max(m(t.y,_),_),z),bounds:{minX:s,maxX:b,minY:_,maxY:z}}}},70236:(t,e,i)=>{"use strict";i.d(e,{WindowEditButtons:()=>O,WindowMainScreen:()=>E,default:()=>R});var n=i(37876),o=i(14232),s=i(70186),r=i.n(s),a=i(71885),h=i(72082),l=i(76098),d=i(33618),u=i(12865);let p=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Number.isFinite(t)?t:e},w=t=>{let e=u.WINDOW_TOP_INSET+u.WINDOW_TOP_MARGIN;return Number.isFinite(t)?Math.max(t,e):e},m=(t,e)=>{let i=p(t.width),n=p(t.height),o=p(t.left),s=p(t.top),r=w(e.topInset),a=Math.max(0,n-r-Math.max(p(e.snapBottomInset),0)-Math.max(p(e.safeAreaBottom),0)),h=Math.max(i/2,0),l=Math.max(a/2,0),d=s+r,u=o+Math.max(i-h,0),m=d+l;return{left:{left:o,top:d,width:h,height:a},right:{left:u,top:d,width:h,height:a},top:{left:o,top:d,width:i,height:a},"top-left":{left:o,top:d,width:h,height:l},"top-right":{left:u,top:d,width:h,height:l},"bottom-left":{left:o,top:m,width:h,height:l},"bottom-right":{left:u,top:m,width:h,height:l}}};var c=i(25180),f=i.n(c),g=i(99742);let y=(t,e,i)=>Math.max(e,Math.min(i,t)),x=t=>{if("string"!=typeof t)return null;let e=parseFloat(t);return Number.isFinite(e)?e:null},v=(t,e)=>"number"!=typeof t||!Number.isFinite(t)||t<=0?e:t,b=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.05;return y(t*e,48,160)},_=t=>y(.02*t,24,96),z=()=>{let t="number"==typeof window.innerWidth?window.innerWidth:0,e="number"==typeof window.innerHeight?window.innerHeight:0,i=window.visualViewport;if(i){let n=Number.isFinite(i.width)?i.width:t,o=Number.isFinite(i.height)?i.height:e;return{width:n||t,height:o||e,left:Number.isFinite(i.offsetLeft)?i.offsetLeft:0,top:Number.isFinite(i.offsetTop)?i.offsetTop:0}}return{width:t,height:e,left:0,top:0}},S=(t,e)=>e?t/e*100:0,P={left:"Snap left half",right:"Snap right half",top:"Snap full screen","top-left":"Snap top-left quarter","top-right":"Snap top-right quarter","bottom-left":"Snap bottom-left quarter","bottom-right":"Snap bottom-right quarter"},W=(t,e)=>"function"==typeof window.setTimeout?window.setTimeout(t,e):setTimeout(t,e),M=t=>{null!=t&&("function"==typeof window.clearTimeout?window.clearTimeout(t):clearTimeout(t))},C=t=>"function"==typeof window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(()=>t(Date.now()),16),T=t=>{null!=t&&("function"==typeof window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t))};class B extends o.Component{componentDidMount(){this._isUnmounted=!1,this.id=this.props.id,this.setDefaultWindowDimenstion(),this.restorePersistentLayout(),(0,h.logPageView)("/".concat(this.id),"Custom Title"),window.addEventListener("resize",this.resizeBoundries),window.addEventListener("context-menu-open",this.setInertBackground),window.addEventListener("context-menu-close",this.removeInertBackground);let t=this.getWindowNode();null==t||t.addEventListener("super-arrow",this.handleSuperArrow),null==t||t.addEventListener("super-action",this.handleSuperAction),this._uiExperiments&&this.scheduleUsageCheck(),this.schedulePositionSync(),this.props.isFocused&&this.focusWindow()}componentDidUpdate(t){if(t.minWidth===this.props.minWidth&&t.minHeight===this.props.minHeight)return;let e=v(this.props.minWidth,20),i=v(this.props.minHeight,20),n=this.state.minWidth!==e,o=this.state.minHeight!==i,s=this.state.width<e,r=this.state.height<i,a=!!this.state.lastSize&&(this.state.lastSize.width<e||this.state.lastSize.height<i),h=!!this.state.preMaximizeBounds&&(this.state.preMaximizeBounds.width<e||this.state.preMaximizeBounds.height<i);(n||o||s||r||a||h)&&this.setState(t=>{let l={};return n&&(l.minWidth=e),o&&(l.minHeight=i),s&&(l.width=Math.max(t.width,e)),r&&(l.height=Math.max(t.height,i)),a&&t.lastSize&&(l.lastSize={width:Math.max(t.lastSize.width,e),height:Math.max(t.lastSize.height,i)}),h&&t.preMaximizeBounds&&(l.preMaximizeBounds={...t.preMaximizeBounds,width:Math.max(t.preMaximizeBounds.width,e),height:Math.max(t.preMaximizeBounds.height,i)}),l},()=>{this.resizeBoundries(),(s||r)&&this.notifySizeChange()})}componentWillUnmount(){this._isUnmounted=!0,this.hideSnapPreview(),(0,h.logPageView)("/desktop","Custom Title"),window.removeEventListener("resize",this.resizeBoundries),window.removeEventListener("context-menu-open",this.setInertBackground),window.removeEventListener("context-menu-close",this.removeInertBackground);let t=this.getWindowNode();null==t||t.removeEventListener("super-arrow",this.handleSuperArrow),null==t||t.removeEventListener("super-action",this.handleSuperAction),this._usageTimeout&&clearTimeout(this._usageTimeout),this._closeTimeout&&(M(this._closeTimeout),this._closeTimeout=null),this._dragFrame&&(T(this._dragFrame),this._dragFrame=null),this._positionSyncFrame&&(T(this._positionSyncFrame),this._positionSyncFrame=null),this._snapPreviewTimer&&(M(this._snapPreviewTimer),this._snapPreviewTimer=null),this._pendingDragUpdate=null,this.cancelResizeSession(),this._resizeSession=null}render(){var t,e,i,o;let s=this.getSnapGrid(),h=null!=(i=null==(t=this.state.viewportOffset)?void 0:t.left)?i:0,l=(null!=(o=null==(e=this.state.viewportOffset)?void 0:e.top)?o:0)+this.state.safeAreaTop,d=h+this.state.parentSize.width,u=l+this.state.parentSize.height,p=this.props.minimized?"minimized":this.state.maximized?"maximized":this.state.snapped?"snapped-".concat(this.state.snapped):"active";return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(r(),{nodeRef:this.windowRef,axis:"both",handle:"[data-window-drag-handle]",cancel:".".concat(f().windowControls,", [data-resize-handle]"),grid:this.props.snapEnabled?s:[1,1],scale:1,onStart:this.handleDragStart,onStop:this.handleStop,onDrag:this.handleDrag,allowAnyClick:!1,defaultPosition:{x:this.startX,y:this.startY},position:this.state.position,bounds:{left:h-96,top:l-96,right:d+96,bottom:u+96},children:(0,n.jsxs)("div",{ref:this.windowRef,style:{position:"absolute",width:"".concat(this.state.width,"%"),height:"".concat(this.state.height,"%"),minWidth:"".concat(this.state.minWidth,"%"),minHeight:"".concat(this.state.minHeight,"%"),zIndex:this.props.zIndex},className:[this.state.cursorType,this.state.closed?"closed-window":"",this.props.minimized?f().windowFrameMinimized:"",this.state.grabbed?"opacity-70":"","opened-window overflow-hidden min-w-1/4 min-h-1/4 main-window absolute flex flex-col window-shadow",f().windowFrame,this.props.isFocused?f().windowFrameActive:f().windowFrameInactive,this.state.maximized?f().windowFrameMaximized:"",this.state.resizing?f().windowFrameResizing:""].filter(Boolean).join(" "),id:this.id,role:"dialog","data-window-state":p,"aria-hidden":!!this.props.minimized,"aria-label":this.props.title,tabIndex:0,onKeyDown:this.handleKeyDown,onPointerDown:this.focusWindow,onFocus:this.focusWindow,children:[!1!==this.props.resizable&&!this.state.maximized&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(D,{direction:"n",onResizeStart:this.beginResize,active:"n"===this.state.resizing}),(0,n.jsx)(D,{direction:"s",onResizeStart:this.beginResize,active:"s"===this.state.resizing}),(0,n.jsx)(D,{direction:"e",onResizeStart:this.beginResize,active:"e"===this.state.resizing}),(0,n.jsx)(D,{direction:"w",onResizeStart:this.beginResize,active:"w"===this.state.resizing}),(0,n.jsx)(A,{direction:"nw",onResizeStart:this.beginResize,active:"nw"===this.state.resizing}),(0,n.jsx)(A,{direction:"ne",onResizeStart:this.beginResize,active:"ne"===this.state.resizing}),(0,n.jsx)(A,{direction:"se",onResizeStart:this.beginResize,active:"se"===this.state.resizing}),(0,n.jsx)(A,{direction:"sw",onResizeStart:this.beginResize,active:"sw"===this.state.resizing})]}),(0,n.jsx)(N,{title:this.props.title,onKeyDown:this.handleTitleBarKeyDown,onBlur:this.releaseGrab,grabbed:this.state.grabbed,onPointerDown:this.focusWindow,onDoubleClick:this.handleTitleBarDoubleClick,controls:(0,n.jsx)(O,{minimize:this.minimizeWindow,maximize:this.maximizeWindow,isMaximised:this.state.maximized,close:this.closeWindow,id:this.id,allowMaximize:!1!==this.props.allowMaximize})}),"settings"===this.id?(0,n.jsx)(a.default,{}):(0,n.jsx)(E,{screen:this.props.screen,title:this.props.title,addFolder:"terminal"===this.props.id?this.props.addFolder:null,openApp:this.props.openApp,context:this.props.context,windowMeta:{windowId:this.props.id,isFocused:this.props.isFocused}})]})})})}constructor(t){var e,i;super(t),e=this,this.notifySizeChange=()=>{if("function"==typeof this.props.onSizeChange){let{width:t,height:e}=this.state;this.props.onSizeChange(t,e)}},this.schedulePositionSync=()=>{null!==this._positionSyncFrame&&T(this._positionSyncFrame),this._positionSyncFrame=C(()=>{if(this._positionSyncFrame=null,this._isUnmounted)return;let t=this.getWindowNode();if(!t)return;let{x:e,y:i}=this.readStoredPosition(t);this.updateTransformVariables(t,e,i),this.updatePositionState(e,i)})},this.setDefaultWindowDimenstion=()=>{let{width:t,height:e}=z(),i=t<640,n=e>t,o=(t,e,n,o)=>{if(t&&"object"==typeof t){if(i&&"number"==typeof t.mobile)return t.mobile;if(!i&&"number"==typeof t.desktop)return t.desktop}return"number"==typeof e?e:i?n:o},s=o(this.props.responsiveWidth,this.props.defaultWidth,n?90:95,60),r=o(this.props.responsiveHeight,this.props.defaultHeight,n?85:80,85),a=Math.max(s,this.state.minWidth),h=Math.max(r,this.state.minHeight);(i||n)&&(this.startX=.05*window.innerWidth),this.setState({height:h,width:a,preMaximizeBounds:null},()=>{this.resizeBoundries(),this.notifySizeChange()})},this.resizeBoundries=()=>{let{width:t,height:e,left:i,top:n}=z(),o=(0,d.measureWindowTopOffset)(),s=e*(this.state.height/100),r=t*(this.state.width/100),a=Math.max(0,(0,d.measureSafeAreaInset)("bottom")),h=(0,d.measureSnapBottomInset)(),l=Math.max(t-r,0),u=Math.max(Math.max(e-o-h-a,0)-s,0);this._lastViewportMetrics={width:t,height:e,left:i,top:n},this._lastSnapBottomInset=h,this._lastSafeAreaBottom=a,this.setState({parentSize:{height:u,width:l},safeAreaTop:o,viewportOffset:{left:i,top:n}},()=>{this._uiExperiments&&this.scheduleUsageCheck()})},this.computeContentUsage=()=>{let t=this.getWindowNode();if(!t)return 100;let e=t.querySelector(".windowMainScreen");if(!e)return 100;let i=(e.firstElementChild||e).getBoundingClientRect(),n=e.getBoundingClientRect(),o=n.width*n.height;return 0===o?100:i.width*i.height/o*100},this.scheduleUsageCheck=()=>{this._usageTimeout&&clearTimeout(this._usageTimeout),this._usageTimeout=setTimeout(()=>{65>this.computeContentUsage()&&this.optimizeWindow()},200)},this.optimizeWindow=()=>{let t=this.getWindowNode();if(!t)return;let e=t.querySelector(".windowMainScreen");if(!e)return;e.style.padding="0px";let i=()=>{this.computeContentUsage()>=80||this.setState(t=>({width:Math.max(t.width-1,t.minWidth),height:Math.max(t.height-1,t.minHeight),preMaximizeBounds:null}),()=>{this.notifySizeChange(),80>this.computeContentUsage()&&setTimeout(i,50)})};i()},this.getOverlayRoot=()=>this.props.overlayRoot?"string"==typeof this.props.overlayRoot?document.getElementById(this.props.overlayRoot):this.props.overlayRoot:document.getElementById("__next"),this.getWindowNode=()=>this.windowRef.current?this.windowRef.current:this.id?document.getElementById(this.id):null,this.readStoredPosition=t=>{var e,i;let n=null,o=null;if(t){let i=t.style;if(i&&"function"==typeof i.getPropertyValue){let t=x(i.getPropertyValue("--window-transform-x")),e=x(i.getPropertyValue("--window-transform-y"));null!==t&&(n=t),null!==e&&(o=e)}if((null===n||null===o)&&"string"==typeof(null==(e=t.style)?void 0:e.transform)){let e=/translate\(([-\d.]+)px,\s*([-\d.]+)px\)/.exec(t.style.transform);if(e){let t=parseFloat(e[1]),i=parseFloat(e[2]);null===n&&Number.isFinite(t)&&(n=t),null===o&&Number.isFinite(i)&&(o=i)}}if((null===n||null===o)&&"function"==typeof t.getBoundingClientRect){let e=t.getBoundingClientRect();e&&(null===n&&Number.isFinite(e.left)&&(n=e.left),null===o&&Number.isFinite(e.top)&&(o=e.top))}}if(null===n||null===o){let t=null==(i=this.state)?void 0:i.position;null===n&&t&&Number.isFinite(t.x)&&(n=t.x),null===o&&t&&Number.isFinite(t.y)&&(o=t.y)}return null!==n&&Number.isFinite(n)||(n="number"==typeof this.startX?this.startX:0),null!==o&&Number.isFinite(o)||(o="number"==typeof this.startY?this.startY:0),{x:n,y:o}},this.getLayoutStorageKey=()=>{var t;let e=null!=(t=this.id)?t:this.props.id;return e?"window-layout:".concat(e):null},this.readPersistentLayout=()=>{let t=this.getLayoutStorageKey();if(!t)return null;try{let e=window.localStorage.getItem(t);if(!e)return null;let i=JSON.parse(e);if(!i||"object"!=typeof i)return null;let{width:n,height:o,position:s,maximized:r,snapped:a,lastSize:h,preMaximizeBounds:l}=i,d=v(n,null),u=v(o,null),p=s&&"object"==typeof s?{x:Number.isFinite(s.x)?s.x:null,y:Number.isFinite(s.y)?s.y:null}:null;if(null===d||null===u||!p||null===p.x||null===p.y)return null;let w=h&&"object"==typeof h?{width:v(h.width,null),height:v(h.height,null)}:null,m=l&&"object"==typeof l?{width:v(l.width,null),height:v(l.height,null),x:Number.isFinite(l.x)?l.x:null,y:Number.isFinite(l.y)?l.y:null}:null;return{width:d,height:u,position:p,maximized:!!r,snapped:"string"==typeof a?a:null,lastSize:w,preMaximizeBounds:m}}catch(t){return null}},this.persistLayout=()=>{let t=this.getLayoutStorageKey();if(!t)return;let e=this.getWindowNode(),i=this.readStoredPosition(e),n={width:Math.max(this.state.width,this.state.minWidth),height:Math.max(this.state.height,this.state.minHeight),position:{x:i.x,y:i.y},maximized:!!this.state.maximized,snapped:this.state.snapped||null,lastSize:this.state.lastSize||null,preMaximizeBounds:this.state.preMaximizeBounds||null};try{window.localStorage.setItem(t,JSON.stringify(n))}catch(t){}},this.restorePersistentLayout=()=>{if(this._hasRestoredLayout)return;let t=this.readPersistentLayout();if(!t)return;this._hasRestoredLayout=!0;let{width:e,height:i,position:n,maximized:o,snapped:s,lastSize:r,preMaximizeBounds:a}=t,{width:h,height:l,left:u,top:p}=z(),w=(0,d.measureWindowTopOffset)(),m=(0,d.measureSnapBottomInset)(),c=Math.max(0,(0,d.measureSafeAreaInset)("bottom")),f=Math.max(e,this.state.minWidth),g=Math.max(i,this.state.minHeight),y=(0,d.clampWindowPositionWithinViewport)({x:n.x,y:n.y},{width:h*f/100,height:l*g/100},{viewportWidth:h,viewportHeight:l,viewportLeft:u,viewportTop:p,topOffset:w,bottomInset:c,snapBottomInset:m})||{x:n.x,y:n.y},x=this.getWindowNode(),v=(t,e)=>{x&&this.updateTransformVariables(x,t,e)};if(o){var b,_;let t=a&&"number"==typeof a.width&&"number"==typeof a.height?a:{width:f,height:g,x:y.x,y:y.y};this.setState({width:Math.max(t.width,this.state.minWidth),height:Math.max(t.height,this.state.minHeight),preMaximizeBounds:t,maximized:!1,snapped:null,position:{x:null!=(b=t.x)?b:y.x,y:null!=(_=t.y)?_:y.y}},()=>{var e,i;v(null!=(e=t.x)?e:y.x,null!=(i=t.y)?i:y.y),this.maximizeWindow(),this.persistLayout()});return}if(s){let t=r&&"number"==typeof r.width&&"number"==typeof r.height?r:{width:f,height:g};this.setState({width:Math.max(t.width,this.state.minWidth),height:Math.max(t.height,this.state.minHeight),lastSize:t,maximized:!1,snapped:null,position:{x:y.x,y:y.y}},()=>{v(y.x,y.y),this.snapWindow(s),this.persistLayout()});return}this.setState({width:f,height:g,maximized:!1,snapped:null,position:{x:y.x,y:y.y}},()=>{v(y.x,y.y),this.resizeBoundries(),this.notifySizeChange()})},this.resolveDragNode=t=>t&&t.node?t.node:this.getWindowNode(),this.resolveDragCoordinates=(t,e)=>{var i,n;let o="number"==typeof(null==t?void 0:t.x)&&Number.isFinite(t.x)?t.x:null,s="number"==typeof(null==t?void 0:t.y)&&Number.isFinite(t.y)?t.y:null;if(null===o||null===s){let t=null==(i=this.state)?void 0:i.position;t&&"number"==typeof t.x&&Number.isFinite(t.x)&&null===o&&(o=t.x),t&&"number"==typeof t.y&&Number.isFinite(t.y)&&null===s&&(s=t.y)}if(null!==o&&null!==s)return{x:o,y:s};if(e){let t=e.style;if(t&&"function"==typeof t.getPropertyValue){let e=x(t.getPropertyValue("--window-transform-x")),i=x(t.getPropertyValue("--window-transform-y"));null!==e&&(o=e),null!==i&&(s=i)}let i=null==(n=e.style)?void 0:n.transform;if((null===o||null===s)&&"string"==typeof i&&i.includes("translate")){let t=/translate\(([-\d.]+)px,\s*([-\d.]+)px\)/.exec(i);if(t){let e=parseFloat(t[1]),i=parseFloat(t[2]);null===o&&Number.isFinite(e)&&(o=e),null===s&&Number.isFinite(i)&&(s=i)}}}return{x:Number.isFinite(o)?o:0,y:Number.isFinite(s)?s:0}},this.readNodeRect=t=>{if(!t||"function"!=typeof t.getBoundingClientRect)return null;let e=t.getBoundingClientRect();return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}},this.getCachedViewportMetrics=()=>{if(this._lastViewportMetrics)return this._lastViewportMetrics;let t=z();return this._lastViewportMetrics=t,t},this.getCachedSnapBottomInset=()=>{if("number"==typeof this._lastSnapBottomInset)return this._lastSnapBottomInset;let t=(0,d.measureSnapBottomInset)();return this._lastSnapBottomInset=t,t},this.getCachedSafeAreaBottom=()=>{if("number"==typeof this._lastSafeAreaBottom)return this._lastSafeAreaBottom;let t=Math.max(0,(0,d.measureSafeAreaInset)("bottom"));return this._lastSafeAreaBottom=t,t},this.getCachedSnapRegions=()=>{var t;let{width:e,height:i,left:n,top:o}=this.getCachedViewportMetrics(),s=null!=(t=this.state.safeAreaTop)?t:d.DEFAULT_WINDOW_TOP_OFFSET,r=this.getCachedSnapBottomInset(),a=this.getCachedSafeAreaBottom(),h=[e,i,n,o,s,r,a].join("|");if(this._snapRegionsCache&&this._snapRegionsCache.key===h)return this._snapRegionsCache.regions;let l=m({width:e,height:i,left:n,top:o},{topInset:s,snapBottomInset:r,safeAreaBottom:a});return this._snapRegionsCache={key:h,regions:l},l},this.getCurrentBounds=()=>{let t=this.getWindowNode(),e=this.readStoredPosition(t);return{width:Math.max(this.state.width,this.state.minWidth),height:Math.max(this.state.height,this.state.minHeight),x:e.x,y:e.y}},this.setTransformMotionPreset=(t,e)=>{if(!t)return;let i={maximize:"--window-motion-duration-maximize",restore:"--window-motion-duration-restore",snap:"--window-motion-duration-snap"},n={maximize:"--window-motion-ease-maximize",restore:"--window-motion-ease-restore",snap:"--window-motion-ease-snap"},o=i[e]||i.restore,s=n[e]||n.restore;t.style.setProperty("--window-motion-transform-duration","var(".concat(o,")")),t.style.setProperty("--window-motion-transform-easing","var(".concat(s,")"))},this.activateOverlay=()=>{let t=this.getOverlayRoot();t&&t.setAttribute("inert",""),this._menuOpener=document.activeElement},this.deactivateOverlay=()=>{let t=this.getOverlayRoot();t&&t.removeAttribute("inert"),this._menuOpener&&"function"==typeof this._menuOpener.focus&&this._menuOpener.focus(),this._menuOpener=null},this.changeCursorToMove=()=>{this.focusWindow(),this.state.maximized&&this.restoreWindow(),this.state.snapped&&this.unsnapWindow(),this.setState({cursorType:"cursor-move",grabbed:!0})},this.changeCursorToDefault=()=>{this.setState({cursorType:"cursor-default",grabbed:!1})},this.getSnapGrid=()=>{let t=[8,8];if(!Array.isArray(this.props.snapGrid))return t;let[e,i]=this.props.snapGrid,n=(t,e)=>"number"!=typeof t||!Number.isFinite(t)||t<=0?e:t;return[n(e,t[0]),n(i,t[1])]},this.snapToGrid=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";if(!e.props.snapEnabled)return t;let[n,o]=e.getSnapGrid(),s="y"===i?o:n;return s?Math.round(t/s)*s:t},this.setWinowsPosition=function(){var t,i,n,o,s;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=e.getWindowNode();if(!a)return;let h=e.readStoredPosition(a),l=r&&Number.isFinite(r.x)?r.x:null,u=r&&Number.isFinite(r.y)?r.y:null,p=null!=l?l:h.x,w=null!=u?u:h.y,m=null!=(n=e.state.safeAreaTop)?n:d.DEFAULT_WINDOW_TOP_OFFSET,c=null!=(o=null==(t=e.state.viewportOffset)?void 0:t.left)?o:0,f=null!=(s=null==(i=e.state.viewportOffset)?void 0:i.top)?s:0,g=e.snapToGrid(p-c,"x"),y=c+e.state.parentSize.width,x=Math.min(Math.max(g+c,c),y),v=e.snapToGrid(w-(f+m),"y"),b=f+m,_=b+e.state.parentSize.height,z=Math.min(Math.max((0,d.clampWindowTopPosition)(v+b,b),b),_),S=Number(x.toFixed(1)),P=Number(z.toFixed(1));e.updateTransformVariables(a,S,P),e.updatePositionState(S,P),e.props.onPositionChange&&e.props.onPositionChange(x,z),e.notifySizeChange()},this.unsnapWindow=()=>{if(!this.state.snapped)return;let t=this.getWindowNode();if(t){this.setTransformMotionPreset(t,"snap");let e=t.style.getPropertyValue("--window-transform-x"),i=t.style.getPropertyValue("--window-transform-y");if(e&&i){t.style.transform="translate(".concat(e,",").concat(i,")");let n=x(e),o=x(i);null!==n&&null!==o&&this.updatePositionState(n,o)}}if(this.state.lastSize){let t=Math.max(this.state.lastSize.width,this.state.minWidth),e=Math.max(this.state.lastSize.height,this.state.minHeight);this.setState({width:t,height:e,snapped:null,preMaximizeBounds:null},()=>{this.resizeBoundries(),this.notifySizeChange(),this.persistLayout()})}else this.setState({snapped:null,preMaximizeBounds:null},()=>{this.resizeBoundries(),this.notifySizeChange(),this.persistLayout()})},this.snapWindow=t=>{var e;this.setWinowsPosition(),this.focusWindow();let{width:i,height:n,left:o,top:s}=this.getCachedViewportMetrics(),r=null!=(e=this.state.safeAreaTop)?e:d.DEFAULT_WINDOW_TOP_OFFSET;if(!i||!n)return;let a=this.getCachedSnapBottomInset(),h=this.getCachedSafeAreaBottom(),l=m({width:i,height:n,left:o,top:s},{topInset:r,snapBottomInset:a,safeAreaBottom:h})[t];if(!l)return;let u=Math.max(this.state.width,this.state.minWidth),p=Math.max(this.state.height,this.state.minHeight),w=this.getWindowNode(),c=(0,d.clampWindowPositionWithinViewport)({x:l.left,y:l.top},{width:l.width,height:l.height},{viewportWidth:i,viewportHeight:n,viewportLeft:o,viewportTop:s,topOffset:r,bottomInset:h,snapBottomInset:a})||{x:l.left,y:l.top},f=c.x,g=c.y,x=i,v=n,b=null;if(w){let t=w.offsetParent;t&&"function"==typeof t.getBoundingClientRect&&(b=t.getBoundingClientRect())}let _=b&&Number.isFinite(b.left)?b.left:0,z=b&&Number.isFinite(b.top)?b.top:0,P=b&&Number.isFinite(b.width)&&b.width>0?b.width:null,W=b&&Number.isFinite(b.height)&&b.height>0?b.height:null;f-=_,g-=z,P&&(x=P),W&&(v=W);let M=o-_,C=M+Math.max(i-l.width,0),T=s+r-z,B=T+Math.max(Math.max(n-r-a-h,0)-l.height,0);f=y(f,M,C),g=y(g,T,B),w&&(this.setTransformMotionPreset(w,"snap"),w.style.transform="translate(".concat(f,"px, ").concat(g,"px)"),this.updateTransformVariables(w,f,g),this.updatePositionState(f,g));let R=x||i||l.width||1,N=v||n||l.height||1,F=Math.max(S(l.width,R),this.state.minWidth),I=Math.max(S(l.height,N),this.state.minHeight);this.setState({snapped:t,lastSize:{width:u,height:p},width:F,height:I,preMaximizeBounds:null},()=>{this.resizeBoundries(),this.notifySizeChange(),this.persistLayout()})},this.setInertBackground=()=>{let t=this.getWindowNode();t&&t.setAttribute("inert","")},this.removeInertBackground=()=>{let t=this.getWindowNode();t&&t.removeAttribute("inert")},this.clearSnapPreviewTimer=()=>{this._snapPreviewTimer&&(M(this._snapPreviewTimer),this._snapPreviewTimer=null)},this.showSnapPreview=t=>{if(!t)return;let e=(t=>t&&P[t]||"Snap window")(t.position),i=this.context||{};"function"==typeof i.showPreview&&i.showPreview({rect:t.previewRect,label:e,ownerWindowId:this.id,position:t.position}),this._snapPreviewActive=t;let n=this.getWindowNode();n&&n.classList.add(f().windowFrameSnapReady)},this.hideSnapPreview=()=>{let t=this.context||{};"function"==typeof t.hidePreview&&t.hidePreview(this.id),this._snapPreviewActive=null,this._snapPreviewPending=null,this.clearSnapPreviewTimer();let e=this.getWindowNode();e&&e.classList.remove(f().windowFrameSnapReady)},this.resolvePointerPosition=(t,e,i)=>{let n=t||(null==e?void 0:e.event);if(n){if("number"==typeof n.clientX&&"number"==typeof n.clientY)return{x:n.clientX,y:n.clientY};let t=n.touches||n.changedTouches;if(t&&t.length){let e=t[0];if(e&&"number"==typeof e.clientX&&"number"==typeof e.clientY)return{x:e.clientX,y:e.clientY}}}if(e&&"number"==typeof e.clientX&&"number"==typeof e.clientY)return{x:e.clientX,y:e.clientY};if(i&&"function"==typeof i.getBoundingClientRect){let t=i.getBoundingClientRect();if(t)return{x:t.left+t.width/2,y:t.top+t.height/2}}return null},this.resolveRectSnapCandidate=(t,e,i)=>{var n;if(!t)return null;let{width:o,height:s,left:r,top:a}=this.getCachedViewportMetrics();if(!o||!s)return null;let h=this.getCachedSnapRegions(),l=null!=(n=this.state.safeAreaTop)?n:d.DEFAULT_WINDOW_TOP_OFFSET,u=this.getCachedSnapBottomInset(),p=this.getCachedSafeAreaBottom(),w=t.top<=a+l+i,m=t.bottom>=a+s-u-p-i,c=t.left<=r+e,f=t.right>=r+o-e;return w&&c&&h["top-left"].width>0&&h["top-left"].height>0?{position:"top-left",previewRect:h["top-left"]}:w&&f&&h["top-right"].width>0&&h["top-right"].height>0?{position:"top-right",previewRect:h["top-right"]}:m&&c&&h["bottom-left"].width>0&&h["bottom-left"].height>0?{position:"bottom-left",previewRect:h["bottom-left"]}:m&&f&&h["bottom-right"].width>0&&h["bottom-right"].height>0?{position:"bottom-right",previewRect:h["bottom-right"]}:w&&h.top.height>0?{position:"top",previewRect:h.top}:c&&h.left.width>0?{position:"left",previewRect:h.left}:f&&h.right.width>0?{position:"right",previewRect:h.right}:null},this.resolveSnapCandidateForPointer=(t,e,i,n,o)=>{var s;let{width:r,height:a,left:h,top:l}=this.getCachedViewportMetrics();if(!r||!a||!t)return null;let u=null!=(s=this.state.safeAreaTop)?s:d.DEFAULT_WINDOW_TOP_OFFSET;return(t=>{let{viewport:e,insets:i,pointer:n,thresholds:o,previousCandidate:s=null,hysteresisPadding:r=0}=t,a=m(e,i),h=((t,e,i,n,o)=>{let s=e.left,r=e.left+e.width,a=e.top+w(i.topInset),h=e.top+e.height-Math.max(i.snapBottomInset,0)-Math.max(i.safeAreaBottom,0),l=t.y<=a+n.y,d=t.y>=h-n.y,u=t.x<=s+n.x,p=t.x>=r-n.x;return l&&u&&o["top-left"].width>0&&o["top-left"].height>0?{position:"top-left",previewRect:o["top-left"]}:l&&p&&o["top-right"].width>0&&o["top-right"].height>0?{position:"top-right",previewRect:o["top-right"]}:d&&u&&o["bottom-left"].width>0&&o["bottom-left"].height>0?{position:"bottom-left",previewRect:o["bottom-left"]}:d&&p&&o["bottom-right"].width>0&&o["bottom-right"].height>0?{position:"bottom-right",previewRect:o["bottom-right"]}:l&&o.top.height>0?{position:"top",previewRect:o.top}:u&&o.left.width>0?{position:"left",previewRect:o.left}:p&&o.right.width>0?{position:"right",previewRect:o.right}:null})(n,e,i,o,a);if(h)return h;if(!s)return null;let l={x:o.x+r,y:o.y+r};if(!((t,e,i,n,o)=>{let s=i.left,r=i.left+i.width,a=i.top+w(n.topInset),h=i.top+i.height-Math.max(n.snapBottomInset,0)-Math.max(n.safeAreaBottom,0),l=e.y<=a+o.y,d=e.y>=h-o.y,u=e.x<=s+o.x,p=e.x>=r-o.x;return"top-left"===t?l&&u:"top-right"===t?l&&p:"bottom-left"===t?d&&u:"bottom-right"===t?d&&p:"top"===t?l:"left"===t?u:"right"===t&&p})(s.position,n,e,i,l))return null;let d=a[s.position];return d?{position:s.position,previewRect:d}:null})({viewport:{width:r,height:a,left:h,top:l},insets:{topInset:u,snapBottomInset:this.getCachedSnapBottomInset(),safeAreaBottom:this.getCachedSafeAreaBottom()},pointer:t,thresholds:{x:e,y:i},previousCandidate:n,hysteresisPadding:o})},this.updateSnapPreview=(t,e)=>{var i,n;if(this._isUnmounted)return;let{width:o,height:s}=this.getCachedViewportMetrics();if(!o||!s)return;let r=b(o),a=b(s),h=null;if(t){let e=this._snapPreviewActive||this._snapPreviewPending;h=this.resolveSnapCandidateForPointer(t,r,a,e,16)}else e&&(h=this.resolveRectSnapCandidate(e,r,a));if(!h){(this._snapPreviewActive||this._snapPreviewPending)&&this.hideSnapPreview();return}if((null==(i=this._snapPreviewActive)?void 0:i.position)===h.position)return void this.showSnapPreview(h);let l=null==(n=this._snapPreviewPending)?void 0:n.position;this._snapPreviewPending=h,l!==h.position&&(this.clearSnapPreviewTimer(),this._snapPreviewTimer=W(()=>{var t;(null==(t=this._snapPreviewPending)?void 0:t.position)===h.position&&this.showSnapPreview(h)},80))},this.updatePositionState=(t,e)=>{Number.isFinite(t)&&Number.isFinite(e)&&(this._livePosition={x:t,y:e},this.setState(i=>{let n=i.position;return n&&n.x===t&&n.y===e?null:{position:{x:t,y:e}}}))},this.updateTransformVariables=(t,e,i)=>{t&&(t.style.transform="translate(".concat(e,"px, ").concat(i,"px)"),t.style.setProperty("--window-transform-x","".concat(e,"px")),t.style.setProperty("--window-transform-y","".concat(i,"px")))},this.setLivePosition=(t,e)=>{Number.isFinite(t)&&Number.isFinite(e)&&(this._livePosition={x:t,y:e})},this.scheduleDragUpdate=(t,e)=>{if(this._isUnmounted)return;let i=this.resolveDragNode(e);if(!i){this._pendingDragUpdate=null;return}let n=this.resolveDragCoordinates(e,i),o=this.getResistedPosition(n),s=this.resolvePointerPosition(t,e,i);this._pendingDragUpdate={node:i,x:o.x,y:o.y,pointer:s},null===this._dragFrame&&(this._dragFrame=C(()=>{this._dragFrame=null;let t=this._pendingDragUpdate;if(this._pendingDragUpdate=null,!t||!t.node||this._isUnmounted)return;this.updateTransformVariables(t.node,t.x,t.y),this.setLivePosition(t.x,t.y);let e=t.pointer?null:this.readNodeRect(t.node);this.updateSnapPreview(t.pointer,e)}))},this.flushPendingDragUpdate=()=>{null!==this._dragFrame&&(T(this._dragFrame),this._dragFrame=null);let t=this._pendingDragUpdate;this._pendingDragUpdate=null,t&&t.node&&!this._isUnmounted&&(this.updateTransformVariables(t.node,t.x,t.y),this.setLivePosition(t.x,t.y))},this.getResistedPosition=t=>{var e,i,n,o,s;if(!t)return{x:0,y:0};let{x:r,y:a}=t,h=null!=(n=null==(e=this.state.viewportOffset)?void 0:e.left)?n:0,l=(null!=(o=null==(i=this.state.viewportOffset)?void 0:i.top)?o:0)+(null!=(s=this.state.safeAreaTop)?s:0),d=h+this.state.parentSize.width,u=l+this.state.parentSize.height,p=(t,e,i)=>i<=e||t<e?e:t<e+30?e+(t-e)*.35:t>i?i:t>i-30?i-(i-t)*.35:t;return{x:r=p(r,h,d),y:a=p(a,l,u)}},this.handleDrag=(t,e)=>{this.scheduleDragUpdate(t,e)},this.handleDragStart=(t,e)=>{(null==t?void 0:t.cancelable)&&("touchstart"===t.type||"touch"===t.pointerType)&&t.preventDefault(),this.changeCursorToMove(),this.hideSnapPreview();let i=this.resolveDragNode(e),n=this.resolveDragCoordinates(e,i),o=this.getResistedPosition(n);this.updateTransformVariables(i,o.x,o.y),this.setLivePosition(o.x,o.y)},this.handleStop=(t,e)=>{this.flushPendingDragUpdate(),this.changeCursorToDefault(),this.hideSnapPreview();let i=this.getWindowNode(),{width:n,height:o}=this.getCachedViewportMetrics();if(n&&o){let s=_(n),r=_(o),a=this.resolvePointerPosition(t,e,i),h=null;if(a)h=this.resolveSnapCandidateForPointer(a,s,r,null,0);else if(i&&"function"==typeof i.getBoundingClientRect){let t=i.getBoundingClientRect();h=this.resolveRectSnapCandidate(t,s,r)}if(null==h?void 0:h.position)return void this.snapWindow(h.position)}this._livePosition&&this.updatePositionState(this._livePosition.x,this._livePosition.y),this.persistLayout()},this.beginResize=(t,e)=>{var i,n;if(!1===this.props.resizable||this.state.maximized||!e||"number"==typeof e.button&&0!==e.button)return;let o=this.getWindowNode();if(!o)return;let{width:s,height:r,left:a,top:h}=z();if(!s||!r)return;let l=o.getBoundingClientRect(),u=this.readStoredPosition(o),p=u.x,w=u.y,m=null!=(n=this.state.safeAreaTop)?n:d.DEFAULT_WINDOW_TOP_OFFSET,c=Math.max(0,(0,d.measureSafeAreaInset)("bottom")),f=(0,d.measureSnapBottomInset)();if(this._lastViewportMetrics={width:s,height:r,left:a,top:h},this._lastSafeAreaBottom=c,this._lastSnapBottomInset=f,this.focusWindow(),this.hideSnapPreview(),this.setState({resizing:t,snapped:null,preMaximizeBounds:null}),this._resizeSession={direction:t,pointerId:e.pointerId,startPointerX:e.clientX,startPointerY:e.clientY,startWidth:l.width,startHeight:l.height,startX:p,startY:w,currentX:p,currentY:w,viewportWidth:s,viewportHeight:r,viewportLeft:a,viewportTop:h,handle:e.currentTarget,didResize:!1,topOffset:m,safeAreaBottom:c,snapBottomInset:f},"function"==typeof e.preventDefault&&e.preventDefault(),"function"==typeof e.stopPropagation&&e.stopPropagation(),"function"==typeof(null==(i=e.currentTarget)?void 0:i.setPointerCapture)&&"number"==typeof e.pointerId)try{e.currentTarget.setPointerCapture(e.pointerId)}catch(t){}window.addEventListener("pointermove",this.handleResizePointerMove,{passive:!1}),window.addEventListener("pointerup",this.handleResizePointerUp,!0),window.addEventListener("pointercancel",this.handleResizePointerUp,!0)},this.cancelResizeSession=()=>{if(!this._resizeSession)return;window.removeEventListener("pointermove",this.handleResizePointerMove),window.removeEventListener("pointerup",this.handleResizePointerUp,!0),window.removeEventListener("pointercancel",this.handleResizePointerUp,!0);let t=this._resizeSession.handle;if(t&&"function"==typeof t.releasePointerCapture&&"number"==typeof this._resizeSession.pointerId)try{t.releasePointerCapture(this._resizeSession.pointerId)}catch(t){}},this.handleResizePointerMove=t=>{var e;if(!this._resizeSession||"number"==typeof this._resizeSession.pointerId&&t.pointerId!==this._resizeSession.pointerId)return;"function"==typeof t.preventDefault&&t.preventDefault();let{direction:i,startPointerX:n,startPointerY:o,startWidth:s,startHeight:r,startX:a,startY:h,viewportWidth:l,viewportHeight:u,viewportLeft:p,viewportTop:w,topOffset:m,safeAreaBottom:c,snapBottomInset:f}=this._resizeSession;if(!l||!u)return;let g=t.clientX-n,y=t.clientY-o,x=this._resizeSession.currentWidth,v=this._resizeSession.currentHeight,b=this._resizeSession.currentX,_=this._resizeSession.currentY,z=Math.max(this.state.minWidth/100*l,1),S=Math.max(this.state.minHeight/100*u,1),P=s,W=r,M=a,C=h;i.includes("e")&&(P=s+g),i.includes("s")&&(W=r+y),i.includes("w")&&(P=s-g,M=a+g),i.includes("n")&&(W=r-y,C=h+y),P=Math.max(P,z),W=Math.max(W,S),i.includes("w")&&(M=a+(s-P)),i.includes("n")&&(C=h+(r-W));let T="number"==typeof m&&Number.isFinite(m)?m:null!=(e=this.state.safeAreaTop)?e:d.DEFAULT_WINDOW_TOP_OFFSET,B="number"==typeof c&&Number.isFinite(c)?c:this.getCachedSafeAreaBottom(),R="number"==typeof f&&Number.isFinite(f)?f:this.getCachedSnapBottomInset(),N=(0,d.clampWindowPositionWithinViewport)({x:M,y:C},{width:P,height:W},{viewportWidth:l,viewportHeight:u,viewportLeft:p,viewportTop:w,topOffset:T,bottomInset:B,snapBottomInset:R});N&&(M=N.x,C=N.y);let F=this.getWindowNode();F&&(this.updateTransformVariables(F,M,C),this.updatePositionState(M,C));let I=l?P/l*100:this.state.width,D=u?W/u*100:this.state.height,A=Math.min(100,Math.max(I,this.state.minWidth)),O=Math.min(100,Math.max(D,this.state.minHeight));this._resizeSession.currentX=M,this._resizeSession.currentY=C,this._resizeSession.currentWidth=A,this._resizeSession.currentHeight=O;let E=!!(i.includes("e")||i.includes("w"))&&("number"!=typeof x||Math.abs(x-A)>.05),H=!!(i.includes("n")||i.includes("s"))&&("number"!=typeof v||Math.abs(v-O)>.05),k="number"!=typeof b||"number"!=typeof _||Math.abs(b-M)>.5||Math.abs(_-C)>.5;this._resizeSession.didResize||(this._resizeSession.didResize=E||H||k),this.setState(t=>{var e;let n={resizing:null!=(e=t.resizing)?e:i},o=!1;return((i.includes("e")||i.includes("w"))&&Math.abs(t.width-A)>.05&&(n.width=A,o=!0),(i.includes("n")||i.includes("s"))&&Math.abs(t.height-O)>.05&&(n.height=O,o=!0),o)?(n.preMaximizeBounds=null,n):null})},this.handleResizePointerUp=t=>{if(!this._resizeSession||"number"==typeof this._resizeSession.pointerId&&t.pointerId!==this._resizeSession.pointerId)return;let e=this._resizeSession,i=null==e?void 0:e.didResize;this.cancelResizeSession(),this._resizeSession=null,this.setState({resizing:null},()=>{i&&(this.resizeBoundries(),this.notifySizeChange(),this.persistLayout())})},this.focusWindow=()=>{this.props.focus(this.id);let t=this.getWindowNode();t&&"function"==typeof t.focus&&("undefined"==typeof document||document.activeElement!==t)&&t.focus()},this.handleTitleBarDoubleClick=t=>{t&&(t.preventDefault(),t.stopPropagation()),!1!==this.props.allowMaximize&&(this.state.maximized?this.restoreWindow():this.maximizeWindow())},this.minimizeWindow=()=>{this.setWinowsPosition(),this.props.hasMinimised(this.id),this.persistLayout()},this.restoreWindow=()=>{var t;let e=this.getWindowNode();if(!e)return;let i=this.state.preMaximizeBounds,n=i&&"number"==typeof i.width&&"number"==typeof i.height,o=e.style,s=o&&"function"==typeof o.getPropertyValue?x(o.getPropertyValue("--window-transform-x")):null,r=o&&"function"==typeof o.getPropertyValue?x(o.getPropertyValue("--window-transform-y")):null,{width:a,height:h,left:l,top:u}=z(),p=null!=(t=this.state.safeAreaTop)?t:d.DEFAULT_WINDOW_TOP_OFFSET,w=n&&Number.isFinite(i.x)?i.x:null!==s?s:this.startX,m=n&&Number.isFinite(i.y)?i.y:null!==r?r:this.startY,c=(0,d.clampWindowTopPosition)(m,p),f=n&&Number.isFinite(i.width)?i.width:this.state.width,g=n&&Number.isFinite(i.height)?i.height:this.state.height,y={width:a*Math.max(f,this.state.minWidth)/100,height:h*Math.max(g,this.state.minHeight)/100},v=(0,d.clampWindowPositionWithinViewport)({x:w,y:c},y,{viewportWidth:a,viewportHeight:h,viewportLeft:l,viewportTop:u,topOffset:p,bottomInset:this.getCachedSafeAreaBottom(),snapBottomInset:this.getCachedSnapBottomInset()})||{x:w,y:c};if(n){let t=Math.max(i.width,this.state.minWidth),e=Math.max(i.height,this.state.minHeight);this.setState({width:t,height:e,maximized:!1,preMaximizeBounds:null},()=>{this.resizeBoundries(),this.notifySizeChange(),this.persistLayout()})}else this.setDefaultWindowDimenstion(),this.setState({maximized:!1,preMaximizeBounds:null},()=>{this.persistLayout()});let b="translate(".concat(v.x,"px,").concat(v.y,"px)"),_=window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;if(this.setTransformMotionPreset(e,"restore"),o&&"function"==typeof o.setProperty?(o.setProperty("--window-transform-x","".concat(v.x,"px")),o.setProperty("--window-transform-y","".concat(v.y,"px"))):o&&(o["--window-transform-x"]="".concat(v.x,"px"),o["--window-transform-y"]="".concat(v.y,"px")),this.updatePositionState(v.x,v.y),_){e.style.transform=b;return}e.style.transform=b},this.maximizeWindow=()=>{if(!1!==this.props.allowMaximize)if(this.state.maximized)this.restoreWindow();else{this.focusWindow();let t=this.getWindowNode();this.setWinowsPosition();let{height:e,top:i}=z(),n=(0,d.measureWindowTopOffset)(),o=(0,d.measureSnapBottomInset)(),s=Math.max(0,(0,d.measureSafeAreaInset)("bottom")),r=n,a=i+u.DESKTOP_TOP_PADDING,h=t&&t.offsetParent&&"function"==typeof t.offsetParent.getBoundingClientRect?t.offsetParent:null,l=null==h?void 0:h.getBoundingClientRect();l&&(r=Math.max(r,Math.max(l.top-i,0)),a=l.top);let p=S(Math.max(0,e-r-o-s),e),w=this.getCurrentBounds();if(t){this.setTransformMotionPreset(t,"maximize");let e=Math.max(0,i+r-a),n="translate(-1pt, ".concat(e,"px)");t.style.transform=n;let{style:o}=t;o&&"function"==typeof o.setProperty?(o.setProperty("--window-transform-x","-1pt"),o.setProperty("--window-transform-y","".concat(e,"px"))):o&&(o["--window-transform-x"]="-1pt",o["--window-transform-y"]="".concat(e,"px")),this.updatePositionState(-1,e)}this.setState({maximized:!0,height:p,width:100.2,preMaximizeBounds:w},()=>{this.notifySizeChange(),this.persistLayout()})}},this.closeWindow=()=>{this.setWinowsPosition(),this.setState({closed:!0,preMaximizeBounds:null},()=>{this.deactivateOverlay();let t="function"==typeof window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches,e=((t,e)=>{if("undefined"==typeof document)return e;let i=document.documentElement;if(!i||"function"!=typeof window.getComputedStyle)return e;let n=window.getComputedStyle(i).getPropertyValue(t);return n?((t,e)=>{if("string"!=typeof t)return e;let i=t.trim();if(!i)return e;let n=parseFloat(i);return Number.isFinite(n)?i.endsWith("ms")?n:i.endsWith("s")?1e3*n:n:e})(n.split(",")[0],e):e})("--window-motion-duration-close",180),i=t?0:Math.max(0,Math.round(e));this._closeTimeout&&M(this._closeTimeout),this._closeTimeout=W(()=>{var t;let e=null!=(t=this.id)?t:this.props.id;"function"==typeof this.props.closed&&e&&this.props.closed(e),this._closeTimeout=null},i)})},this.handleTitleBarKeyDown=t=>{let e=t.target;if(!("undefined"!=typeof Element&&e instanceof Element&&e.closest("[data-window-controls]"))){if(" "===t.key||"Space"===t.key||"Enter"===t.key)t.preventDefault(),t.stopPropagation(),this.state.grabbed?this.handleStop():this.changeCursorToMove();else if(this.state.grabbed){let e=0,i=0;if("ArrowLeft"===t.key?e=-10:"ArrowRight"===t.key?e=10:"ArrowUp"===t.key?i=-10:"ArrowDown"===t.key&&(i=10),0!==e||0!==i){t.preventDefault(),t.stopPropagation();let n=this.getWindowNode();if(n){let t=this.state.position||{x:0,y:0},o=Number.isFinite(t.x)?t.x:0,s=Number.isFinite(t.y)?t.y:0,r=o+e,a=s+i;this.setWinowsPosition({x:r,y:a});let h=this.readNodeRect(n);this.updateSnapPreview(null,h)}}}}},this.releaseGrab=()=>{this.state.grabbed&&this.handleStop()},this.handleKeyDown=t=>{"Escape"===t.key?this.closeWindow():"Tab"===t.key?this.focusWindow():t.altKey?("ArrowDown"===t.key?(t.preventDefault(),t.stopPropagation(),this.unsnapWindow()):"ArrowLeft"===t.key?(t.preventDefault(),t.stopPropagation(),this.snapWindow("left")):"ArrowRight"===t.key?(t.preventDefault(),t.stopPropagation(),this.snapWindow("right")):"ArrowUp"===t.key&&(t.preventDefault(),t.stopPropagation(),this.snapWindow("top")),this.focusWindow()):t.shiftKey&&("ArrowLeft"===t.key?(t.preventDefault(),t.stopPropagation(),this.setState(t=>({width:Math.max(t.width-1,t.minWidth),preMaximizeBounds:null}),()=>{this.resizeBoundries(),this.notifySizeChange()})):"ArrowRight"===t.key?(t.preventDefault(),t.stopPropagation(),this.setState(t=>({width:Math.min(t.width+1,100),preMaximizeBounds:null}),()=>{this.resizeBoundries(),this.notifySizeChange()})):"ArrowUp"===t.key?(t.preventDefault(),t.stopPropagation(),this.setState(t=>({height:Math.max(t.height-1,t.minHeight),preMaximizeBounds:null}),()=>{this.resizeBoundries(),this.notifySizeChange()})):"ArrowDown"===t.key&&(t.preventDefault(),t.stopPropagation(),this.setState(t=>({height:Math.min(t.height+1,100),preMaximizeBounds:null}),()=>{this.resizeBoundries(),this.notifySizeChange()})),this.focusWindow())},this.handleSuperArrow=t=>{let e=t.detail;"ArrowLeft"===e?"left"===this.state.snapped?this.unsnapWindow():this.snapWindow("left"):"ArrowRight"===e?"right"===this.state.snapped?this.unsnapWindow():this.snapWindow("right"):"ArrowUp"===e?this.maximizeWindow():"ArrowDown"===e&&(this.state.maximized?this.restoreWindow():this.state.snapped&&this.unsnapWindow())},this.handleSuperAction=t=>{let e=t.detail;"minimize"===e?this.minimizeWindow():"toggle-maximize"===e&&this.maximizeWindow()},this.id=null;let{width:n,height:s,left:r,top:a}=z(),h=s>n,l=(0,d.measureWindowTopOffset)(),p=v(t.minWidth,20),c=v(t.minHeight,20),B="number"==typeof t.defaultWidth?t.defaultWidth:h?90:60,R="number"==typeof t.defaultHeight?t.defaultHeight:85;this.startX=null!=(i=t.initialX)?i:h?.05*window.innerWidth:60,this.startY=(0,d.clampWindowTopPosition)(t.initialY,l),this.state={cursorType:"cursor-default",width:Math.max(B,p),height:Math.max(R,c),closed:!1,maximized:!1,preMaximizeBounds:null,parentSize:{height:100,width:100},safeAreaTop:l,snapped:null,lastSize:null,grabbed:!1,minWidth:p,minHeight:c,resizing:null,position:{x:this.startX,y:this.startY}},this.windowRef=o.createRef(),this._usageTimeout=null,this._uiExperiments="true"===g.env.NEXT_PUBLIC_UI_EXPERIMENTS,this._menuOpener=null,this._closeTimeout=null,this._resizeSession=null,this._dragFrame=null,this._pendingDragUpdate=null,this._lastViewportMetrics=null,this._lastSnapBottomInset=null,this._lastSafeAreaBottom=null,this._positionSyncFrame=null,this._snapPreviewTimer=null,this._snapPreviewPending=null,this._snapPreviewActive=null,this._snapRegionsCache=null,this._livePosition={x:this.startX,y:this.startY},this._isUnmounted=!1,this._hasRestoredLayout=!1}}B.contextType=l.SnapOverlayContext,B.defaultProps={snapGrid:[8,8],minWidth:20,minHeight:20};let R=B;function N(t){let{title:e,onKeyDown:i,onBlur:o,grabbed:s,onPointerDown:r,onDoubleClick:a,controls:h}=t;return(0,n.jsxs)("div",{className:"".concat(f().windowTitlebar," bg-ub-window-title text-white select-none"),tabIndex:0,role:"button","aria-grabbed":s,onKeyDown:i,onBlur:o,onPointerDown:r,onDoubleClick:a,"data-window-titlebar":"","data-window-drag-handle":"",children:[(0,n.jsx)("span",{className:f().windowTitleBalancer,"aria-hidden":"true"}),(0,n.jsx)("div",{className:"".concat(f().windowTitle," text-sm font-bold"),title:e,children:e}),h]})}let F={n:f().windowResizeHandleNorth,s:f().windowResizeHandleSouth,e:f().windowResizeHandleEast,w:f().windowResizeHandleWest},I={nw:f().windowResizeHandleCornerNorthWest,ne:f().windowResizeHandleCornerNorthEast,se:f().windowResizeHandleCornerSouthEast,sw:f().windowResizeHandleCornerSouthWest};function D(t){let{direction:e,onResizeStart:i,active:s}=t,r=(0,o.useCallback)(t=>{"function"==typeof i&&i(e,t)},[e,i]),a=[f().windowResizeHandle,f().windowResizeHandleEdge,F[e]||"",s?f().windowResizeHandleActive:""].filter(Boolean).join(" ");return(0,n.jsx)("div",{role:"presentation","aria-hidden":"true",tabIndex:-1,className:a,"data-resize-handle":"edge","data-resize-direction":e,onPointerDown:r})}function A(t){let{direction:e,onResizeStart:i,active:s}=t,r=(0,o.useCallback)(t=>{"function"==typeof i&&i(e,t)},[e,i]),a=[f().windowResizeHandle,f().windowResizeHandleCorner,I[e]||"",s?f().windowResizeHandleActive:""].filter(Boolean).join(" ");return(0,n.jsx)("div",{role:"presentation","aria-hidden":"true",tabIndex:-1,className:a,"data-resize-handle":"corner","data-resize-direction":e,onPointerDown:r})}function O(t){let e=!1!==t.allowMaximize,i=!!t.isMaximised,s=(0,o.useRef)(null),[r,a]=(0,o.useState)(null),h=(0,o.useRef)(null);(0,o.useEffect)(()=>{let t=s.current;if(!t)return;let e=t.closest("[data-window-titlebar]");if(!e)return;let i=()=>{e.style.setProperty("--window-controls-width","".concat(t.offsetWidth,"px"))};if(i(),"function"==typeof ResizeObserver){let n=new ResizeObserver(()=>i());return n.observe(t),()=>{n.disconnect(),e.style.removeProperty("--window-controls-width")}}let n=()=>i();return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n),e.style.removeProperty("--window-controls-width")}},[]);let l={className:f().windowControlIcon,viewBox:"0 0 16 16","aria-hidden":!0,focusable:"false"},d=(0,o.useCallback)(()=>{h.current=null,a(null)},[]),u=i=>{if(!e){var n;null==i||null==(n=i.preventDefault)||n.call(i);return}"function"==typeof t.maximize&&t.maximize(i)},p=(0,o.useCallback)(t=>e=>{var i;e.stopPropagation(),h.current="pointer","number"==typeof e.pointerId&&"function"==typeof(null==(i=e.currentTarget)?void 0:i.setPointerCapture)&&e.currentTarget.setPointerCapture(e.pointerId),a(t)},[]),w=(0,o.useCallback)((t,e)=>i=>{var n;i.stopPropagation(),"number"==typeof i.pointerId&&"function"==typeof(null==(n=i.currentTarget)?void 0:n.releasePointerCapture)&&(!i.currentTarget.hasPointerCapture||i.currentTarget.hasPointerCapture(i.pointerId))&&i.currentTarget.releasePointerCapture(i.pointerId),a(e=>e===t?null:e),h.current="pointer-handled","function"==typeof e&&e(i)},[]),m=(0,o.useCallback)(t=>e=>{if("pointer"===h.current||"pointer-handled"===h.current){h.current=null,e.stopPropagation(),e.preventDefault();return}"function"==typeof t&&t(e)},[]);return(0,n.jsxs)("div",{ref:s,className:f().windowControls,role:"group","aria-label":"Window controls",onPointerDown:t=>t.stopPropagation(),onMouseDown:t=>t.stopPropagation(),onTouchStart:t=>t.stopPropagation(),"data-window-controls":"",children:[(0,n.jsx)("button",{type:"button","aria-label":"Window minimize",title:"Minimize",className:"".concat(f().windowControlButton," ").concat("minimize"===r?f().windowControlButtonPressed:"").trim(),onPointerDown:p("minimize"),onPointerUp:w("minimize",t.minimize),onPointerLeave:d,onPointerCancel:d,onBlur:d,onClick:m(t.minimize),children:(0,n.jsx)(()=>(0,n.jsx)("svg",{...l,children:(0,n.jsx)("line",{x1:"3",y1:"8",x2:"13",y2:"8",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})}),{})}),(0,n.jsx)("button",{type:"button","aria-label":i?"Restore window size":"Window maximize",title:i?"Restore":"Maximize",className:[f().windowControlButton,e?"":f().windowControlButtonDisabled,"maximize"===r?f().windowControlButtonPressed:""].filter(Boolean).join(" "),onClick:m(u),disabled:!e,"aria-disabled":!e,onPointerDown:e?p("maximize"):void 0,onPointerUp:e?w("maximize",u):void 0,onPointerLeave:d,onPointerCancel:d,onBlur:d,children:i?(0,n.jsx)(()=>(0,n.jsxs)("svg",{...l,children:[(0,n.jsx)("rect",{x:"5",y:"3",width:"8",height:"6.5",rx:"1.4",stroke:"currentColor",strokeWidth:"1.2",fill:"none"}),(0,n.jsx)("rect",{x:"3",y:"6.5",width:"8",height:"6.5",rx:"1.4",stroke:"currentColor",strokeWidth:"1.2",fill:"none"})]}),{}):(0,n.jsx)(()=>(0,n.jsx)("svg",{...l,children:(0,n.jsx)("rect",{x:"3",y:"3",width:"10",height:"10",rx:"1.6",stroke:"currentColor",strokeWidth:"1.4",fill:"none"})}),{})}),(0,n.jsx)("button",{type:"button",id:"close-".concat(t.id),"aria-label":"Window close",title:"Close",className:[f().windowControlButton,f().windowControlButtonClose,"close"===r?f().windowControlButtonPressed:""].filter(Boolean).join(" "),onPointerDown:p("close"),onPointerUp:w("close",t.close),onPointerLeave:d,onPointerCancel:d,onBlur:d,onClick:m(t.close),children:(0,n.jsx)(()=>(0,n.jsxs)("svg",{...l,children:[(0,n.jsx)("line",{x1:"4",y1:"4",x2:"12",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),(0,n.jsx)("line",{x1:"12",y1:"4",x2:"4",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]}),{})})]})}class E extends o.Component{componentDidMount(){setTimeout(()=>{this.setState({setDarkBg:!0})},3e3)}render(){return(0,n.jsx)("div",{className:"w-full flex-grow min-h-0 z-20 max-h-full overflow-y-auto windowMainScreen"+(this.state.setDarkBg?" bg-ub-drk-abrgn ":" bg-ub-cool-grey"),children:this.props.screen(this.props.addFolder,this.props.openApp,this.props.context,this.props.windowMeta)})}constructor(){super(),this.state={setDarkBg:!1}}}},76098:(t,e,i)=>{"use strict";i.d(e,{SnapOverlayContext:()=>a,SnapOverlayProvider:()=>l});var n=i(37876),o=i(14232),s=i(25180),r=i.n(s);let a=(0,o.createContext)({showPreview:()=>{},hidePreview:()=>{}}),h=t=>{let{preview:e}=t;return e?(0,n.jsx)("div",{"data-testid":"snap-preview",className:"fixed pointer-events-none z-40 transition-opacity ".concat(r().snapPreview," ").concat(r().snapPreviewGlass),style:{left:"".concat(e.rect.left,"px"),top:"".concat(e.rect.top,"px"),width:"".concat(e.rect.width,"px"),height:"".concat(e.rect.height,"px"),backdropFilter:"brightness(1.1) saturate(1.2)",WebkitBackdropFilter:"brightness(1.1) saturate(1.2)"},"aria-live":"polite","aria-label":e.label,role:"status",children:(0,n.jsx)("span",{className:r().snapPreviewLabel,"aria-hidden":"true",children:e.label})}):null},l=t=>{let{children:e}=t,[i,s]=(0,o.useState)(null),r=(0,o.useCallback)(t=>{s(e=>e&&e.label===t.label&&e.ownerWindowId===t.ownerWindowId&&e.rect.left===t.rect.left&&e.rect.top===t.rect.top&&e.rect.width===t.rect.width&&e.rect.height===t.rect.height?e:t)},[]),l=(0,o.useCallback)(t=>{s(e=>!e||t&&e.ownerWindowId&&e.ownerWindowId!==t?e:null)},[]),d=(0,o.useMemo)(()=>({showPreview:r,hidePreview:l}),[r,l]);return(0,n.jsxs)(a.Provider,{value:d,children:[e,(0,n.jsx)(h,{preview:i})]})}}}]);