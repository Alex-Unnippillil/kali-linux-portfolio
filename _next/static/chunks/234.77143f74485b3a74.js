"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[234],{50234:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var l=a(37876),n=a(14232),r=a(12227);let s={standard:"@#S%?*+;:,.",blocks:"█▓▒░ ",binary:"01"},c={grayscale:[[0,0,0],[85,85,85],[170,170,170],[255,255,255]],ansi16:[[0,0,0],[128,0,0],[0,128,0],[128,128,0],[0,0,128],[128,0,128],[0,128,128],[192,192,192],[128,128,128],[255,0,0],[0,255,0],[255,255,0],[0,0,255],[255,0,255],[0,255,255],[255,255,255]]};function o(){let[e,t]=(0,n.useState)(""),[a,o]=(0,n.useState)(""),[i,u]=(0,n.useState)(""),[g,d]=(0,n.useState)(""),[p,m]=(0,n.useState)("grayscale"),[h,f]=(0,n.useState)(8),[x,b]=(0,n.useState)(!0),[y,v]=(0,n.useState)(""),[w,j]=(0,n.useState)(!1),[C,N]=(0,n.useState)(1),[k,S]=(0,n.useState)(0),[R,I]=(0,n.useState)(s.standard.length),[E,L]=(0,n.useState)(null),[U,F]=(0,n.useState)("monospace"),_=(0,n.useRef)([]),M=(0,n.useRef)([]),[T,z]=(0,n.useState)(null),A=(0,n.useRef)(null),O=(0,n.useRef)(null),B=(0,n.useRef)(null),D=(0,n.useRef)(!1);(0,n.useEffect)(()=>{let e=window.localStorage.getItem("ascii_char_set"),t=window.localStorage.getItem("ascii_palette");d(e||s.standard),m(t||"grayscale"),D.current=window.matchMedia("(prefers-reduced-motion: reduce)").matches},[]),(0,n.useEffect)(()=>{window.localStorage.setItem("ascii_char_set",g),window.localStorage.setItem("ascii_palette",p)},[g,p]),(0,n.useEffect)(()=>{I(e=>Math.min(e,g.length))},[g]),(0,n.useEffect)(()=>{var e;(null==(e=document)?void 0:e.fonts)&&document.fonts.load("10px monospace")},[]),(0,n.useEffect)(()=>{var e;"monospace"!==U&&(null==(e=document)?void 0:e.fonts)&&document.fonts.load("10px ".concat(U))},[U]);let P=(0,n.useCallback)(async()=>{if(!B.current)return;let e=B.current;if(e.size>2097152)return;let a=await createImageBitmap(e);if(a.width*a.height>4e6)return;let l=(()=>{let e=g.split(""),t=e.length/R,a="";for(let l=0;l<R;l+=1)a+=e[Math.floor(l*t)]||"";return a})(),n=Math.floor(a.width/h),s=Math.floor(a.height/h),i=A.current,d=i.getContext("2d");i.width=n,i.height=s,d.drawImage(a,0,0,n,s);let m=d.getImageData(0,0,n,s).data,f=new Uint8ClampedArray(n*s*3),b=new Float32Array(n*s);for(let e=0;e<n*s;e+=1){let t=4*e,a=m[t],l=.299*a+.587*m[t+1]+.114*m[t+2];l+=k,l=(l-128)*C+128,b[e]=Math.max(0,Math.min(255,l))}let y=c[p]||[],w=(e,t,a)=>{if(!y.length)return[e,t,a];let l=y[0],n=1/0;for(let r=0;r<y.length;r+=1){let s=y[r],c=e-s[0],o=t-s[1],i=a-s[2],u=c*c+o*o+i*i;u<n&&(n=u,l=s)}return l};o(""),t(""),u("");let j=0,N=()=>{let e=performance.now(),a="",c="",i="";for(;j<s&&performance.now()-e<16;){let e="",t="",r="";for(let a=0;a<n;a+=1){let c=j*n+a,o=b[c],i=Math.floor(o/255*(l.length-1)),u=o-i/(l.length-1)*255;a+1<n&&(b[c+1]+=7/16*u),j+1<s&&(a>0&&(b[c+n-1]+=3/16*u),b[c+n]+=5/16*u,a+1<n&&(b[c+n+1]+=1/16*u));let g=4*c,d=m[g],p=m[g+1],h=m[g+2];[d,p,h]=w(d,p,h);let y=3*c;f[y]=d,f[y+1]=p,f[y+2]=h;let v=l[l.length-1-i];e+=v,x?(t+='<span style="color: rgb('.concat(d,",").concat(p,",").concat(h,')">').concat(v,"</span>"),r+="\x1b[38;2;".concat(d,";").concat(p,";").concat(h,"m").concat(v)):(t+=v,r+=v)}a+="".concat(e,"\n"),c+="".concat(t,"<br/>"),i+="".concat(r,"\x1b[0m\n"),j+=1}if(a&&(o(e=>e+a),t(e=>e+r.default.sanitize(c)),u(e=>e+i)),j<s)requestAnimationFrame(N);else{let e=()=>{z({data:f,width:n,height:s}),v("ASCII art ".concat(n,"x").concat(s))};D.current?e():requestAnimationFrame(e)}};requestAnimationFrame(N)},[g,R,h,p,x,C,k]),K=(0,n.useCallback)(e=>{let t=e.target.files[0];t&&t.type.startsWith("image/")&&(B.current=t,L(URL.createObjectURL(t)),P())},[P]);(0,n.useEffect)(()=>{P()},[P,C,k,R,h,g,p,x]);let q=(0,n.useCallback)(()=>{let e=x?i:a;e&&navigator.clipboard.writeText(e)},[x,i,a]),H=(0,n.useCallback)(()=>{if(!i)return;let e=new Blob([i],{type:"text/plain"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="ascii-art.ans",a.click(),URL.revokeObjectURL(t)},[i]),G=(0,n.useCallback)(()=>{if(!a)return;let e=new Blob([a],{type:"text/plain"}),t=URL.createObjectURL(e),l=document.createElement("a");l.href=t,l.download="ascii-art.txt",l.click(),URL.revokeObjectURL(t)},[a]),V=(0,n.useCallback)(async()=>{var e;if(!a||!T)return;let t=a.trimEnd().split("\n"),l=T.width,n=T.height,r=A.current;r.width=l*h,r.height=n*h;let s=r.getContext("2d");s.imageSmoothingEnabled=!1,s.fillStyle="#000",s.fillRect(0,0,r.width,r.height),(null==(e=document)?void 0:e.fonts)&&await document.fonts.load("".concat(h,"px ").concat(U)),s.font="".concat(h,"px ").concat(U),s.textBaseline="top";for(let e=0;e<n;e+=1)for(let a=0;a<l;a+=1){let n=(e*l+a)*3,r=T.data[n],c=T.data[n+1],o=T.data[n+2];s.fillStyle=x?"rgb(".concat(r,",").concat(c,",").concat(o,")"):"#FFFFFF";let i=t[e][a];s.fillText(i,a*h,e*h)}s.strokeStyle="rgba(255,255,255,0.1)";for(let e=0;e<=l;e+=1)s.beginPath(),s.moveTo(e*h+.5,0),s.lineTo(e*h+.5,n*h),s.stroke();for(let e=0;e<=n;e+=1)s.beginPath(),s.moveTo(0,e*h+.5),s.lineTo(l*h,e*h+.5),s.stroke();let c=r.toDataURL("image/png"),o=document.createElement("a");o.href=c,o.download="ascii-art.png",o.click()},[a,T,h,x,U]),W=()=>{if(!_.current.length)return;M.current.push(a);let e=_.current.pop();o(e),t(r.default.sanitize(e.replace(/\n/g,"<br/>")))},X=()=>{if(!M.current.length)return;_.current.push(a);let e=M.current.pop();o(e),t(r.default.sanitize(e.replace(/\n/g,"<br/>")))};return(0,l.jsxs)("div",{className:"h-full w-full flex flex-col p-4 bg-ub-cool-grey text-white overflow-auto",children:[(0,l.jsxs)("div",{className:"mb-2 flex flex-wrap gap-2",children:[(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:K,className:"mb-2"}),(0,l.jsxs)("label",{className:"flex items-center gap-2",children:["Charset:",(0,l.jsx)("input",{type:"text",value:g,onChange:e=>d(r.default.sanitize(e.target.value).slice(0,256)),className:"px-1 bg-gray-700"})]}),(0,l.jsxs)("label",{className:"flex items-center gap-2",children:["Preset:",(0,l.jsx)("select",{onChange:e=>d(s[e.target.value]),className:"bg-gray-700",defaultValue:"standard",children:Object.keys(s).map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]}),(0,l.jsxs)("label",{className:"flex items-center gap-2",children:["Cell:",(0,l.jsx)("input",{type:"number",min:"4",max:"32",value:h,onChange:e=>f(Number(e.target.value)),className:"w-16 px-1 bg-gray-700"})]}),(0,l.jsxs)("label",{className:"flex items-center gap-2",children:["Brightness:",(0,l.jsx)("input",{type:"range",min:"-100",max:"100",step:"10",value:k,onChange:e=>S(Number(e.target.value)),className:"w-24","aria-label":"Brightness"})]}),(0,l.jsxs)("label",{className:"flex items-center gap-2",children:["Contrast:",(0,l.jsx)("input",{type:"range",min:"0.5",max:"2",step:"0.1",value:C,onChange:e=>N(Number(e.target.value)),className:"w-24","aria-label":"Contrast"})]}),(0,l.jsxs)("label",{className:"flex items-center gap-2",children:["Density:",(0,l.jsx)("input",{type:"range",min:"2",max:g.length||2,value:R,onChange:e=>I(Number(e.target.value)),className:"w-24","aria-label":"Character density"})]}),(0,l.jsxs)("label",{className:"flex items-center gap-2",children:["Palette:",(0,l.jsx)("select",{value:p,onChange:e=>m(e.target.value),className:"bg-gray-700",children:Object.keys(c).map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]}),(0,l.jsxs)("label",{className:"flex items-center gap-2",children:["Font:",(0,l.jsx)("select",{value:U,onChange:e=>F(e.target.value),className:"bg-gray-700",children:["monospace","Courier New","Fira Code"].map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]}),(0,l.jsxs)("label",{className:"flex items-center gap-2",children:["Color",(0,l.jsx)("input",{type:"checkbox",checked:x,onChange:e=>b(e.target.checked)})]}),(0,l.jsx)("button",{type:"button",onClick:q,className:"px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded",children:"Copy Text"}),(0,l.jsx)("button",{type:"button",onClick:H,className:"px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded",children:"ANSI"}),(0,l.jsx)("button",{type:"button",onClick:G,className:"px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded",children:"TXT"}),(0,l.jsx)("button",{type:"button",onClick:V,className:"px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded",children:"Export PNG"}),(0,l.jsx)("button",{type:"button",onClick:()=>{j(!w),v("Custom ASCII art typing mode")},className:"px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded",children:w?"Image Mode":"Typing Mode"}),w&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{type:"button",onClick:W,className:"px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded",children:"Undo"}),(0,l.jsx)("button",{type:"button",onClick:X,className:"px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded",children:"Redo"})]}),(0,l.jsx)("button",{type:"button",onClick:()=>{if(!y)return;let e=new SpeechSynthesisUtterance(y);window.speechSynthesis.speak(e)},className:"px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded",children:"Alt"})]}),E&&!w&&(0,l.jsx)("img",{src:E,alt:"original image preview",className:"max-h-48 mb-2 object-contain"}),w?(0,l.jsx)("textarea",{ref:O,value:a,onChange:e=>{_.current.push(a),M.current=[],o(e.target.value),t(r.default.sanitize(e.target.value.replace(/\n/g,"<br/>")))},onKeyDown:e=>{(e.ctrlKey||e.metaKey)&&("z"===e.key.toLowerCase()?(e.preventDefault(),e.shiftKey?X():W()):"y"===e.key.toLowerCase()&&(e.preventDefault(),X()))},className:"flex-1 font-mono bg-gray-800 text-white resize-none",style:{lineHeight:"".concat(h,"px"),fontSize:"".concat(h,"px"),backgroundSize:"".concat(h,"px ").concat(h,"px"),backgroundImage:"linear-gradient(0deg, transparent calc(100% - 1px), rgba(255,255,255,0.1) calc(100% - 1px)), linear-gradient(90deg, transparent calc(100% - 1px), rgba(255,255,255,0.1) calc(100% - 1px))"}}):(0,l.jsx)("pre",{className:"font-mono whitespace-pre overflow-auto flex-1",dangerouslySetInnerHTML:{__html:e}}),(0,l.jsx)("canvas",{ref:A,className:"hidden w-full h-full"}),(0,l.jsx)("div",{className:"sr-only","aria-live":"polite",children:y})]})}}}]);