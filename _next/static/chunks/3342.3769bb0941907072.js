"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3342],{3342:(e,t,a)=>{a.r(t),a.d(t,{default:()=>D,setSeed:()=>p,slide:()=>y});var r=a(37876),s=a(14232),n=a(95220),o=a(17894),l=a(70994),i=a(44716),c=a(85687),d=a(98306),u=a(74273),m=a(88772),f=a(48581);function x(e){let{game:t,children:a,controls:o=null,settings:l=null,onPause:i=()=>{},onResume:c=()=>{},isFocused:d=!0}=e,u=()=>{var e,t;return(null==(t=window.screen)||null==(e=t.orientation)?void 0:e.type)||"landscape-primary"},[x,g]=(0,s.useState)(u);(0,s.useEffect)(()=>{let e=()=>g(u());return window.addEventListener("orientationchange",e),()=>window.removeEventListener("orientationchange",e)},[]);let[b,p]=(0,s.useState)(!1),[h,w]=(0,s.useState)(!1),[v,y]=(0,n.default)("game-speed",1),[j,k]=(0,n.default)("game-muted",!1),N=(0,s.useCallback)(()=>{p(!0),i()},[i]),S=(0,s.useCallback)(()=>{p(!1),c()},[c]);(0,m.default)({onInput:e=>{let{action:t,type:a}=e;"pause"===t&&"keydown"===a&&(b?S():N())},game:t,isFocused:d});let E=(0,s.useRef)(null),A=async e=>{let a=await e.text();(0,f.importGameSettings)(t,a)};return(0,r.jsxs)("div",{className:"game-shell".concat(b?" paused":"").concat(j?" muted":""),"data-speed":v,children:[(0,r.jsx)("div",{className:"game-content",children:a}),o&&(0,r.jsx)("div",{className:"game-controls",children:o}),h&&l&&(0,r.jsx)("div",{className:"game-settings",children:l}),(0,r.jsx)("button",{onClick:b?S:N,"aria-label":b?"Resume":"Pause",children:b?"Resume":"Pause"}),(0,r.jsx)("button",{onClick:()=>k(e=>!e),"aria-label":j?"Unmute":"Mute",children:j?"Unmute":"Mute"}),(0,r.jsxs)("label",{children:["Speed",(0,r.jsxs)("select",{value:v,onChange:e=>y(parseFloat(e.target.value)),children:[(0,r.jsx)("option",{value:.5,children:"0.5x"}),(0,r.jsx)("option",{value:1,children:"1x"}),(0,r.jsx)("option",{value:1.5,children:"1.5x"}),(0,r.jsx)("option",{value:2,children:"2x"})]})]}),l&&(0,r.jsx)("button",{onClick:()=>w(e=>!e),"aria-label":"Settings",children:"Settings"}),(0,r.jsx)("button",{onClick:()=>{let e=new Blob([(0,f.exportGameSettings)(t)],{type:"application/json"}),a=URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.download="".concat(t,"-settings.json"),r.click(),URL.revokeObjectURL(a)},"aria-label":"Export Settings",children:"Export"}),(0,r.jsx)("button",{onClick:()=>{var e;return null==(e=E.current)?void 0:e.click()},"aria-label":"Import Settings",children:"Import"}),(0,r.jsx)("input",{type:"file",accept:"application/json",ref:E,"aria-label":"Import settings file",style:{display:"none"},onChange:e=>{let t=e.target.files&&e.target.files[0];t&&A(t),e.target&&(e.target.value="")}})]})}var g=a(67817),b=a(65422);let p=e=>(0,d.reset)(e),h=e=>e.map(e=>[...e]),w=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Array.from({length:4},()=>[,,,,].fill(0));return v(t,e),v(t,e),t},v=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=[];for(let s=0;s<a;s++){let a=[];if(e.forEach((e,t)=>e.forEach((e,r)=>{0===e&&a.push([t,r])})),0===a.length)break;let s=Math.floor((0,d.random)()*a.length),[n,o]=a[s];e[n][o]=t?4:.9>(0,d.random)()?2:4,r.push("".concat(n,"-").concat(o))}return r},y=e=>{let t=e.filter(e=>0!==e),a=!1,r=0,s=[],n=[];for(let e=0;e<t.length;e++)if(t[e]===t[e+1]){let o=2*t[e];n.push(o),r+=o,a=!0,s.push(n.length-1),e++}else n.push(t[e]);for(;n.length<4;)n.push(0);return{row:n,merged:a,score:r,mergedPositions:s}},j=e=>e[0].map((t,a)=>e.map(e=>e[a])),k=e=>e.map(e=>[...e].reverse()),N=e=>{let t=!1,a=0,r=[];return{board:e.map((e,s)=>{let n=y(e);return n.merged&&(t=!0),a+=n.score,n.mergedPositions.forEach(e=>r.push("".concat(s,"-").concat(e))),n.row}),merged:t,score:a,mergedCells:r}},S=e=>{let t=N(k(e)),a=t.mergedCells.map(e=>{let[t,a]=e.split("-").map(Number);return"".concat(t,"-").concat(3-a)});return{board:k(t.board),merged:t.merged,score:t.score,mergedCells:a}},E=(e,t)=>e.every((e,a)=>e.every((e,r)=>e===t[a][r])),A=e=>e.some(e=>e.some(e=>2048===e)),C=e=>{for(let t=0;t<4;t++)for(let a=0;a<4;a++)if(0===e[t][a]||a<3&&e[t][a]===e[t][a+1]||t<3&&e[t][a]===e[t+1][a])return!0;return!1},M={2:"bg-gradient-to-br from-amber-100 via-amber-200 to-amber-300 text-slate-900",4:"bg-gradient-to-br from-amber-200 via-amber-300 to-amber-400 text-slate-900",8:"bg-gradient-to-br from-orange-300 via-orange-400 to-orange-500 text-white",16:"bg-gradient-to-br from-orange-400 via-orange-500 to-orange-600 text-white",32:"bg-gradient-to-br from-rose-400 via-rose-500 to-rose-600 text-white",64:"bg-gradient-to-br from-rose-500 via-rose-600 to-rose-700 text-white",128:"bg-gradient-to-br from-amber-300 via-amber-400 to-amber-500 text-slate-900",256:"bg-gradient-to-br from-lime-300 via-lime-400 to-lime-500 text-slate-900",512:"bg-gradient-to-br from-emerald-400 via-emerald-500 to-emerald-600 text-white",1024:"bg-gradient-to-br from-teal-500 via-teal-600 to-teal-700 text-white",2048:"bg-gradient-to-br from-cyan-500 via-blue-500 to-indigo-600 text-white"},L={classic:M,colorblind:{2:"bg-gradient-to-br from-sky-200 via-sky-300 to-sky-400 text-slate-900",4:"bg-gradient-to-br from-sky-300 via-sky-400 to-sky-500 text-slate-900",8:"bg-gradient-to-br from-indigo-300 via-indigo-400 to-indigo-500 text-white",16:"bg-gradient-to-br from-indigo-400 via-indigo-500 to-indigo-600 text-white",32:"bg-gradient-to-br from-violet-400 via-violet-500 to-violet-600 text-white",64:"bg-gradient-to-br from-purple-500 via-purple-600 to-purple-700 text-white",128:"bg-gradient-to-br from-green-300 via-green-400 to-green-500 text-slate-900",256:"bg-gradient-to-br from-green-400 via-green-500 to-green-600 text-white",512:"bg-gradient-to-br from-emerald-500 via-emerald-600 to-emerald-700 text-white",1024:"bg-gradient-to-br from-yellow-400 via-yellow-500 to-yellow-600 text-slate-900",2048:"bg-gradient-to-br from-yellow-500 via-amber-500 to-orange-500 text-slate-900"},neon:{2:"bg-gradient-to-br from-pink-400 via-pink-500 to-pink-600 text-white",4:"bg-gradient-to-br from-fuchsia-400 via-fuchsia-500 to-fuchsia-600 text-white",8:"bg-gradient-to-br from-purple-500 via-purple-600 to-purple-700 text-white",16:"bg-gradient-to-br from-indigo-500 via-indigo-600 to-indigo-700 text-white",32:"bg-gradient-to-br from-blue-500 via-blue-600 to-blue-700 text-white",64:"bg-gradient-to-br from-cyan-500 via-cyan-600 to-cyan-700 text-white",128:"bg-gradient-to-br from-teal-500 via-teal-600 to-teal-700 text-white",256:"bg-gradient-to-br from-lime-400 via-lime-500 to-lime-600 text-slate-900",512:"bg-gradient-to-br from-yellow-400 via-yellow-500 to-yellow-600 text-slate-900",1024:"bg-gradient-to-br from-orange-500 via-orange-600 to-orange-700 text-white",2048:"bg-gradient-to-br from-rose-500 via-rose-600 to-red-600 text-white"}},R=[256,512,1024,2048,4096],T=e=>Array.isArray(e)&&e.every(e=>e&&"object"==typeof e&&"number"==typeof e.score&&"number"==typeof e.bestTile&&"number"==typeof e.moves&&"string"==typeof e.date),_={2:"●",4:"■",8:"▲",16:"◆",32:"✚",64:"★",128:"⬟",256:"⬢",512:"⬣",1024:"⬡",2048:"✦"},F=e=>Array.isArray(e)&&4===e.length&&e.every(e=>Array.isArray(e)&&4===e.length&&e.every(e=>"number"==typeof e)),D=function(){var e;let{windowMeta:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},m=null==(e=null==t?void 0:t.isFocused)||e,f=(0,g.default)(),p="undefined"!=typeof jest,[y,k]=(0,n.default)("2048-seed","",e=>"string"==typeof e),[D,G]=(0,n.default)("2048-board",w,F),[O,U]=(0,n.default)("2048-won",!1,e=>"boolean"==typeof e),[I,H]=(0,n.default)("2048-lost",!1,e=>"boolean"==typeof e),[q,P]=(0,s.useState)([]),[z,K]=(0,s.useState)(0),[J,W]=(0,n.default)("2048-hard",!1,e=>"boolean"==typeof e),[B,V]=(0,n.default)("2048-skin","classic",e=>"string"==typeof e),[Y,Q]=(0,s.useState)(new Set),[X,Z]=(0,s.useState)(new Set),[$,ee]=(0,n.default)("2048-score",0,e=>"number"==typeof e),[et,ea]=(0,n.default)("2048-best-score",0,e=>"number"==typeof e),[er,es]=(0,n.default)("2048-history",[],T),[en,eo]=(0,s.useState)(!1),[el,ei]=(0,s.useState)(0),[ec,ed]=(0,s.useState)(null),[eu,em]=(0,s.useState)(!1),[ef,ex]=(0,n.default)("2048-coach",!1,e=>"boolean"==typeof e),[eg,eb]=(0,s.useState)(null),[ep,eh,ew]=(0,o.default)("2048-best.json",{}),[ev,ey]=(0,s.useState)(0),[ej,ek]=(0,s.useState)(5),[eN,eS]=(0,s.useState)(new Set),[eE,eA]=(0,s.useState)(0),[eC,eM]=(0,s.useState)(!1),eL=(0,s.useRef)(!1),eR=(0,s.useRef)(!1),eT=(0,s.useRef)(null),e_=(0,s.useRef)(null),{highContrast:eF}=(0,u.useSettings)(),{record:eD,registerReplay:eG}=(0,l.useInputRecorder)(),eO=(0,s.useRef)(!1),eU=(0,s.useCallback)(()=>{if("undefined"==typeof document)return;let e=document.createElement("div");e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.pointerEvents="none",e.style.overflow="hidden",e.style.zIndex="9999",document.body.appendChild(e);let t=["#FFC107","#8BC34A","#03A9F4","#E91E63"],a=[];for(let r=0;r<100;r+=1){let s=document.createElement("div"),n=4+4*Math.random(),o=220*Math.random();s.style.position="absolute",s.style.width="".concat(n,"px"),s.style.height="".concat(n,"px"),s.style.backgroundColor=t[r%t.length],s.style.top="0px",s.style.left="".concat(100*Math.random(),"%"),s.style.opacity="1",s.style.borderRadius="2px",s.style.transform="translate3d(0, 0, 0) rotate(0deg)",s.style.transition="transform ".concat(3e3,"ms ease-out, opacity ").concat(3e3,"ms ease-out"),s.style.transitionDelay="".concat(o,"ms"),e.appendChild(s),a.push({element:s,delay:o})}requestAnimationFrame(()=>{a.forEach(e=>{let{element:t}=e,a=(Math.random()-.5)*window.innerWidth*.5,r=720*Math.random();t.style.transform="translate3d(".concat(a,"px, ").concat(window.innerHeight+80,"px, 0) rotate(").concat(r,"deg)"),t.style.opacity="0"})}),setTimeout(()=>{e.remove()},3420)},[]),eI=(0,s.useMemo)(()=>Math.max(...D.flat()),[D]);(0,s.useEffect)(()=>{if(Y.size>0){if(p){let e=setTimeout(()=>Q(new Set),200);return()=>clearTimeout(e)}let e=setTimeout(()=>{let e=()=>Q(new Set);"function"!=typeof requestAnimationFrame?e():requestAnimationFrame(e)},200);return()=>{clearTimeout(e)}}},[Y,p]),(0,s.useEffect)(()=>{if(X.size>0){if(p){let e=setTimeout(()=>Z(new Set),400);return()=>clearTimeout(e)}let e=setTimeout(()=>{let e=()=>Z(new Set);"function"!=typeof requestAnimationFrame?e():requestAnimationFrame(e)},400);return()=>{clearTimeout(e)}}},[X,p]),(0,s.useEffect)(()=>{if(en){let e,t=setTimeout(()=>{let t=()=>eo(!1);"function"!=typeof requestAnimationFrame?t():e=requestAnimationFrame(t)},300);return()=>{clearTimeout(t),e&&cancelAnimationFrame(e)}}},[en]),(0,s.useEffect)(()=>{if(eN.size>0){let e,t=setTimeout(()=>{let t=()=>eS(new Set);"function"!=typeof requestAnimationFrame?t():e=requestAnimationFrame(t)},900);return()=>{clearTimeout(t),e&&cancelAnimationFrame(e)}}},[eN]),(0,s.useEffect)(()=>{eR.current&&0===Y.size&&0===X.size&&(eR.current=!1)},[Y,X]),(0,s.useEffect)(()=>{let e=eT.current;return()=>{null!==e&&clearTimeout(e)}},[]);let eH=new Date().toISOString().slice(0,10);(0,s.useEffect)(()=>{if("function"==typeof Worker)return e_.current=new Worker(a.tu(new URL(a.p+a.u(4934),a.b))),e_.current.onmessage=e=>{let{type:t,move:a,scores:r}=e.data;"hint"===t?ed(a):"score"===t&&eb(r)},()=>{var e;return null==(e=e_.current)?void 0:e.terminate()}},[]),(0,s.useEffect)(()=>{ew&&(y!==eH?((0,d.reset)(eH),k(eH),G(w(J)),P([]),K(0),U(!1),H(!1),Q(new Set),Z(new Set),ee(0),ek(5),ey(ep[eH]||0),eS(new Set),eA(0),ei(0),eM(!1),eO.current=!1):((0,d.reset)(y),ey(ep[y]||0)))},[ew,y,J,ep]),(0,s.useEffect)(()=>{e_.current&&(e_.current.postMessage({type:"hint",board:D}),ef?e_.current.postMessage({type:"score",board:D}):eb(null))},[D,ef]),(0,s.useEffect)(()=>{eI>ev&&(ey(eI),ew&&y&&eh({...ep,[y]:eI}))},[eI,ev,y,ew,ep,eh]),(0,s.useEffect)(()=>{O||I||(eO.current=!1)},[O,I]),(0,s.useEffect)(()=>{if((O||I)&&!eO.current){eO.current=!0;let e={score:$,bestTile:eI,moves:z,date:new Date().toISOString()};es(t=>[...t,e].sort((e,t)=>t.score-e.score).slice(0,5))}},[O,I,$,eI,z,es]);let eq=(0,s.useCallback)(e=>{let t,{x:a,y:r}=e;if(O||I||eR.current||eC)return;if(eD({x:a,y:r}),-1===a)t=N(D);else if(1===a)t=S(D);else if(-1===r)t=(e=>{let t=N(j(e)),a=t.mergedCells.map(e=>{let[t,a]=e.split("-").map(Number);return"".concat(a,"-").concat(t)});return{board:j(t.board),merged:t.merged,score:t.score,mergedCells:a}})(D);else{if(1!==r)return;t=(e=>{let t=S(j(e)),a=t.mergedCells.map(e=>{let[t,a]=e.split("-").map(Number);return"".concat(a,"-").concat(t)});return{board:j(t.board),merged:t.merged,score:t.score,mergedCells:a}})(D)}let{board:s,merged:n,score:o,mergedCells:l}=t;if(E(D,s)){p&&K(e=>e+1);return}if(!E(D,s)){eR.current=!0,p&&setTimeout(()=>{eR.current=!1},0);let e=(0,d.serialize)(),t=v(s,J,J?2:1);if(P(t=>[...t,{board:h(D),score:$,moves:z,rng:e}]),Q(new Set(t)),Z(new Set(l)),o>0){let e=$+o;ee(e),eo(!0),e>et&&(ea(e),eU())}G(h(s)),K(e=>e+1);let a=Math.max(...s.flat());if(a>ev&&(ey(a),ew&&y&&eh({...ep,[y]:a})),R.includes(a)&&a>eE){let e=new Set;s.forEach((t,r)=>t.forEach((t,s)=>{t===a&&e.add("".concat(r,"-").concat(s))})),eS(e),eA(a)}n&&(0,c.vibrate)(50),l.length>1?(ei(e=>e+1),eU()):ei(0),A(s)?U(!0):C(s)||H(!0)}},[D,O,I,J,eC,$,z,G,H,U,ee,et,ea,ev,ey,ew,y,ep,eh,eD,eE,eS,eA,eU,p]);(0,i.default)(eq,"2048",{preventDefault:!0,isFocused:m}),(0,s.useEffect)(()=>{let e=e=>{(0,b.shouldHandleGameKey)(e,{isFocused:m})&&((0,b.consumeGameKey)(e),em(!1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[m]),(0,s.useEffect)(()=>{if(!eu||!ec||eC)return;let e={ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0},ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1}},t=setTimeout(()=>{if(!ec)return void em(!1);eq(e[ec])},400);return()=>clearTimeout(t)},[eu,ec,eq,eC]),(0,s.useEffect)(()=>{if(!m&&!eC){eL.current=!0,eM(!0);return}m&&eL.current&&(eL.current=!1,eM(!1))},[m,eC]),(0,s.useEffect)(()=>{let e=e=>{if((0,b.shouldHandleGameKey)(e,{isFocused:m})&&"Escape"===e.key){var t;(0,b.consumeGameKey)(e),null==(t=document.getElementById("close-2048"))||t.click()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[m]);let eP=(0,s.useCallback)(()=>{(0,d.reset)(y||eH),G(w(J)),P([]),K(0),U(!1),H(!1),Q(new Set),Z(new Set),ee(0),ek(5),eS(new Set),eA(0),ei(0),eM(!1),eO.current=!1},[J,y,eH,G,P,K,U,H,Q,Z,ee,ek,eS,eA,ei,eM]);(0,s.useEffect)(()=>{eG((e,t)=>{0===t&&eP(),eq(e)})},[eG,eq,eP]);let ez=(0,s.useCallback)(()=>{if(!q.length||0===ej)return;let e=q[q.length-1];(0,d.deserialize)(e.rng),G(h(e.board)),ee(e.score),K(e.moves),U(A(e.board)),H(!C(e.board)),Q(new Set),Z(new Set),P(e=>e.slice(0,-1)),ek(e=>e-1),eS(new Set),eA(t=>Math.min(t,Math.max(...e.board.flat()))),ei(0),eM(!1)},[q,ej,G,ee,K,U,H,Q,Z,P,ek,eS,eA,ei,eM]);(0,s.useEffect)(()=>{let e=e=>{(0,b.shouldHandleGameKey)(e,{isFocused:m})&&(("u"===e.key||"U"===e.key||"Backspace"===e.key)&&((0,b.consumeGameKey)(e),ez()),("r"===e.key||"R"===e.key)&&((0,b.consumeGameKey)(e),eP()))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[ez,eP,m]);let eK=(0,s.useMemo)(()=>[...er].sort((e,t)=>t.score-e.score),[er]),eJ=ec?ec.replace("Arrow",""):"—",eW=eE>=256?eE:"—",eB=(0,s.useMemo)(()=>O?"2048 achieved! Continue playing or start a new run.":I?"No more moves left. Reset to chase a new high score.":eC?"Game paused.":eu?"Autoplay demo is exploring moves.":"Combine matching tiles to climb the power ladder.",[O,I,eC,eu]),eV=L[B]||M,eY="rounded-2xl border border-white/5 bg-slate-900/60 p-4 shadow-[0_35px_60px_rgba(2,6,23,0.45)] backdrop-blur",eQ=(0,r.jsxs)("div",{className:"flex w-full flex-wrap items-center gap-2 rounded-2xl border border-white/5 bg-slate-900/60 p-3 text-sm text-slate-100 shadow-[0_25px_50px_rgba(2,6,23,0.55)] backdrop-blur",children:[(0,r.jsx)("button",{type:"button",onClick:eP,"aria-label":"Reset game",className:"rounded-xl bg-gradient-to-br from-slate-700 via-slate-800 to-slate-900 px-4 py-2 font-semibold text-slate-100 shadow-[0_12px_24px_rgba(15,23,42,0.45)] transition hover:from-slate-600 hover:to-slate-800 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400",children:"Reset"}),(0,r.jsxs)("button",{type:"button",onClick:ez,"aria-label":"Undo last move",disabled:0===q.length||0===ej,className:"rounded-xl bg-gradient-to-br from-slate-700 via-slate-800 to-slate-900 px-4 py-2 font-semibold text-slate-100 shadow-[0_12px_24px_rgba(15,23,42,0.45)] transition hover:from-slate-600 hover:to-slate-800 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400 disabled:cursor-not-allowed disabled:opacity-40",children:["Undo (",ej,")"]}),(0,r.jsx)("button",{type:"button",onClick:()=>em(e=>!e),"aria-label":eu?"Stop autoplay demo":"Start autoplay demo",className:"rounded-xl px-4 py-2 font-semibold shadow-[0_12px_24px_rgba(15,23,42,0.45)] transition focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400 ".concat(eu?"bg-gradient-to-br from-cyan-500 via-cyan-600 to-sky-600 text-slate-900":"bg-gradient-to-br from-slate-700 via-slate-800 to-slate-900 text-slate-100 hover:from-slate-600 hover:to-slate-800"),children:eu?"Stop demo":"Play demo"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 rounded-xl border border-white/5 bg-slate-800/60 px-3 py-1 text-xs uppercase tracking-wide text-slate-300 md:ml-auto",children:[(0,r.jsx)("span",{children:"Hint"}),(0,r.jsx)("span",{className:"text-base font-semibold text-slate-100",children:eJ})]})]}),eX=f?(0,r.jsxs)("div",{className:"mt-3 grid w-full max-w-xs grid-cols-3 gap-2 text-lg",children:[(0,r.jsx)("div",{}),(0,r.jsx)("button",{type:"button",onPointerDown:()=>eq({x:0,y:-1}),className:"rounded-xl bg-slate-800/80 px-4 py-3 shadow transition hover:bg-slate-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400","aria-label":"Move up",children:"↑"}),(0,r.jsx)("div",{}),(0,r.jsx)("button",{type:"button",onPointerDown:()=>eq({x:-1,y:0}),className:"rounded-xl bg-slate-800/80 px-4 py-3 shadow transition hover:bg-slate-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400","aria-label":"Move left",children:"←"}),(0,r.jsx)("button",{type:"button",onPointerDown:()=>eq({x:0,y:1}),className:"rounded-xl bg-slate-800/80 px-4 py-3 shadow transition hover:bg-slate-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400","aria-label":"Move down",children:"↓"}),(0,r.jsx)("button",{type:"button",onPointerDown:()=>eq({x:1,y:0}),className:"rounded-xl bg-slate-800/80 px-4 py-3 shadow transition hover:bg-slate-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400","aria-label":"Move right",children:"→"})]}):null,eZ=(0,r.jsxs)("div",{className:"flex flex-col gap-3 text-sm text-slate-100",children:[(0,r.jsxs)("label",{className:"flex items-center justify-between gap-3 rounded-xl border border-white/5 bg-slate-900/60 px-3 py-2",children:[(0,r.jsxs)("span",{children:[(0,r.jsx)("span",{className:"block font-semibold",children:"Hard mode"}),(0,r.jsx)("span",{className:"text-xs text-slate-400",children:"Adds an extra tile after every move."})]}),(0,r.jsx)("input",{type:"checkbox",checked:J,onChange:()=>W(!J),"aria-label":"Toggle hard mode",className:"h-4 w-4 accent-cyan-400"})]}),(0,r.jsxs)("label",{className:"flex items-center justify-between gap-3 rounded-xl border border-white/5 bg-slate-900/60 px-3 py-2",children:[(0,r.jsxs)("span",{children:[(0,r.jsx)("span",{className:"block font-semibold",children:"Coach overlay"}),(0,r.jsx)("span",{className:"text-xs text-slate-400",children:"Shows heuristic scores for each direction."})]}),(0,r.jsx)("input",{type:"checkbox",checked:ef,onChange:()=>ex(!ef),"aria-label":"Toggle coach overlay",className:"h-4 w-4 accent-cyan-400"})]}),(0,r.jsxs)("label",{className:"flex items-center justify-between gap-3 rounded-xl border border-white/5 bg-slate-900/60 px-3 py-2",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Skin"}),(0,r.jsx)("select",{value:B,onChange:e=>V(e.target.value),className:"rounded-lg border border-white/10 bg-slate-800/80 px-2 py-1 text-slate-100 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400",children:Object.keys(L).map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]})]});return(0,r.jsx)(l.default,{gameId:"2048",score:$,highScore:et,isFocused:m,children:(0,r.jsx)(x,{game:"2048",controls:eQ,settings:eZ,onPause:()=>eM(!0),onResume:()=>eM(!1),isFocused:m,children:(0,r.jsxs)("div",{className:"flex flex-col gap-4 text-slate-100",children:[(0,r.jsxs)("div",{className:"".concat(eY," space-y-4"),"aria-live":"polite","aria-atomic":"true",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm sm:grid-cols-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:"Score"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-white ".concat(en?"score-pop":""),children:$.toLocaleString()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:"High score"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-cyan-200",children:et.toLocaleString()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:"Best tile"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-emerald-300",children:eI})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:"Milestone"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-amber-300",children:eW})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:"Moves"}),(0,r.jsx)("p",{className:"text-xl font-semibold",children:z})]}),(0,r.jsxs)("div",{"data-testid":"combo-meter",children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:"Combo"}),(0,r.jsx)("p",{className:"text-xl font-semibold",children:el})]}),(0,r.jsxs)("div",{"data-testid":"hint-display",children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:"Hint"}),(0,r.jsx)("p",{className:"text-xl font-semibold",children:eJ})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:"Rewinds left"}),(0,r.jsx)("p",{className:"text-xl font-semibold",children:ej})]})]}),(0,r.jsxs)("p",{className:"sr-only",children:["Moves: ",z]}),(0,r.jsxs)("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:["Daily record: tile ",ev]}),(0,r.jsx)("p",{className:"text-sm font-medium ".concat(O?"text-emerald-300":I?"text-rose-300":eC?"text-amber-300":"text-slate-200"),children:eB})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,r.jsxs)("div",{className:"relative aspect-square w-full max-w-[min(90vw,28rem)] overflow-hidden rounded-3xl border border-white/5 bg-slate-950/80 p-4 shadow-[0_40px_80px_rgba(2,6,23,0.6)] backdrop-blur",children:[(0,r.jsx)("div",{className:"grid h-full w-full grid-cols-4 auto-rows-fr gap-2 sm:gap-3",role:"grid","aria-label":"2048 board",children:D.map((e,t)=>e.map((e,a)=>{let s="".concat(t,"-").concat(a),n="".concat("relative flex aspect-square w-full items-center justify-center rounded-xl border border-white/5 text-2xl font-bold shadow-[0_18px_35px_rgba(15,23,42,0.55)] transition-transform duration-200 ease-[cubic-bezier(0.22,1,0.36,1)] will-change-transform backdrop-blur-sm"," ").concat(e?eV[e]||"bg-slate-700/80 text-slate-100":"bg-slate-900/40 text-transparent shadow-inner border border-slate-800/60"," ").concat(Y.has(s)?"tile-pop":""," ").concat(X.has(s)?"tile-merge":""," ").concat(eN.has(s)?"tile-glow":"");return(0,r.jsx)("div",{className:"relative",children:(0,r.jsxs)("div",{role:"gridcell","aria-label":e?"Tile ".concat(e):"Empty tile row ".concat(t+1," column ").concat(a+1),className:n,"data-value":e,children:[eF&&0!==e&&(0,r.jsx)("span",{"aria-hidden":"true",className:"pointer-events-none absolute inset-0 flex items-center justify-center text-4xl text-white/60 mix-blend-plus-lighter",children:_[e]||""}),(0,r.jsx)("span",{className:"relative z-10",children:e||""}),X.has(s)&&(0,r.jsx)("span",{className:"merge-ripple"})]})},s)}))}),ef&&eg&&(0,r.jsxs)("div",{className:"pointer-events-none absolute inset-0",children:[(0,r.jsxs)("div",{className:"absolute left-1/2 top-3 -translate-x-1/2 text-xs font-semibold text-cyan-200",children:["↑ ",void 0!==eg.ArrowUp?Math.round(eg.ArrowUp):""]}),(0,r.jsxs)("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2 text-xs font-semibold text-cyan-200",children:["↓ ",void 0!==eg.ArrowDown?Math.round(eg.ArrowDown):""]}),(0,r.jsxs)("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-xs font-semibold text-cyan-200",children:["← ",void 0!==eg.ArrowLeft?Math.round(eg.ArrowLeft):""]}),(0,r.jsxs)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs font-semibold text-cyan-200",children:["→ ",void 0!==eg.ArrowRight?Math.round(eg.ArrowRight):""]})]}),(O||I)&&(0,r.jsx)("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center rounded-3xl bg-slate-950/80 text-2xl font-semibold text-white",children:O?"You reached 2048!":"Game over"})]}),(0,r.jsx)("div",{className:"text-xs text-slate-300 sm:text-sm",children:"Use arrow keys, swipe gestures, or a connected gamepad to slide tiles. Press U to undo and R to reset."}),eX]}),eK.length>0&&(0,r.jsxs)("div",{className:eY,children:[(0,r.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wider text-slate-300",children:"High score ledger"}),(0,r.jsx)("ol",{className:"mt-3 space-y-2 text-sm text-slate-200",children:eK.map((e,t)=>(0,r.jsxs)("li",{className:"flex items-center justify-between gap-3 rounded-xl bg-slate-900/40 px-3 py-2",children:[(0,r.jsxs)("span",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-slate-800/80 text-xs font-semibold text-slate-300",children:t+1}),(0,r.jsxs)("span",{children:[new Date(e.date).toLocaleDateString()," \xb7 Tile ",e.bestTile]})]}),(0,r.jsx)("span",{className:"font-semibold text-slate-100",children:e.score.toLocaleString()})]},"".concat(e.date,"-").concat(t)))})]})]})})})}},17894:(e,t,a)=>{a.d(t,{default:()=>s});var r=a(14232);function s(e,t){let[a,s]=(0,r.useState)(t),[n,o]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let a=!0;return(async()=>{var r;if(!(null==(r=navigator.storage)?void 0:r.getDirectory))return o(!0);try{let r=await navigator.storage.getDirectory();try{let t=await r.getFileHandle(e),n=await t.getFile(),o=await n.text();a&&s(JSON.parse(o))}catch(n){let a=await r.getFileHandle(e,{create:!0}),s=await a.createWritable();await s.write(JSON.stringify(t)),await s.close()}}catch(e){}a&&o(!0)})(),()=>{a=!1}},[e,t]),[a,(0,r.useCallback)(async t=>{var a;if(s(t),null==(a=navigator.storage)?void 0:a.getDirectory)try{let a=await navigator.storage.getDirectory(),r=await a.getFileHandle(e,{create:!0}),s=await r.createWritable();await s.write(JSON.stringify(t)),await s.close()}catch(e){}},[e]),n]}},48581:(e,t,a)=>{function r(e){let t={};for(let a=0;a<window.localStorage.length;a+=1){let r=window.localStorage.key(a);if(r&&r.startsWith("".concat(e,":")))try{let a=window.localStorage.getItem(r);t[r.slice(e.length+1)]=a?JSON.parse(a):null}catch(e){}}return JSON.stringify(t)}function s(e,t){let a;try{a=JSON.parse(t)}catch(e){return}Object.entries(a).forEach(t=>{let[a,r]=t;try{window.localStorage.setItem("".concat(e,":").concat(a),JSON.stringify(r))}catch(e){}})}a.d(t,{exportGameSettings:()=>r,importGameSettings:()=>s})},67817:(e,t,a)=>{a.d(t,{default:()=>n});var r=a(14232);let s=()=>"function"==typeof window.matchMedia?window.matchMedia("(pointer: coarse)").matches:"ontouchstart"in window||navigator.maxTouchPoints>0;function n(){let[e,t]=(0,r.useState)(s);return(0,r.useEffect)(()=>{var e,a,r;let s=null==(e=(a=window).matchMedia)?void 0:e.call(a,"(pointer: coarse)");if(!s)return;let n=e=>{t(e.matches)};return null==(r=s.addEventListener)||r.call(s,"change",n),()=>{var e;null==(e=s.removeEventListener)||e.call(s,"change",n)}},[]),e}},85687:(e,t,a)=>{a.d(t,{patterns:()=>n,supportsVibration:()=>r,vibrate:()=>s});let r=()=>"undefined"!=typeof navigator&&"function"==typeof navigator.vibrate,s=e=>{if("false"===window.localStorage.getItem("haptics"))return;let t=Array.isArray(e)?e.reduce((e,t)=>e+(t>0?t:0),0):e;try{r()&&navigator.vibrate(e);if("undefined"!=typeof navigator&&"getGamepads"in navigator&&Array.from(navigator.getGamepads?navigator.getGamepads():[]).some(e=>e&&e.vibrationActuator&&"function"==typeof e.vibrationActuator.playEffect))try{for(let e of navigator.getGamepads())e&&e.vibrationActuator&&e.vibrationActuator.playEffect("dual-rumble",{duration:t,strongMagnitude:1,weakMagnitude:1})}catch(e){}}catch(e){}},n={score:[20],danger:[40,80,40],gameOver:[100,30,100]}},88772:(e,t,a)=>{a.d(t,{default:()=>o});var r=a(14232),s=a(65422);let n={up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",action:"Space",pause:"Escape"};function o(){let{onInput:e,game:t,isFocused:a=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,r.useRef)(n);(0,r.useEffect)(()=>{try{let e=window.localStorage.getItem(t?"".concat(t,":keymap"):"game-keymap");e&&(o.current={...n,...JSON.parse(e)})}catch(e){}},[t]),(0,r.useEffect)(()=>{let t=t=>{if(!(0,s.shouldHandleGameKey)(t,{isFocused:a}))return;let r=o.current,n=Object.keys(r).find(e=>r[e]===t.key);n&&e&&(e({action:n,type:t.type}),(0,s.consumeGameKey)(t))};return window.addEventListener("keydown",t),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",t),window.removeEventListener("keyup",t)}},[e,a])}}}]);