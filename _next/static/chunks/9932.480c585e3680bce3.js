"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9932],{18176:e=>{e.exports=JSON.parse('{"00:11:22":"Acme Corp","66:77:88":"Globex","AA:BB:CC":"Initech"}')},49932:(e,s,a)=>{a.r(s),a.d(s,{default:()=>h});var l=a(37876),r=a(14232),t=a(71999);let i=JSON.parse('[{"mac":"00:11:22:33:44:55","history":[{"ssid":"HomeWiFi","bssid":"00:11:22:00:00:01"},{"ssid":"CoffeeShopWiFi","bssid":"66:77:88:00:00:01"}]},{"mac":"66:77:88:99:AA:BB","history":[{"ssid":"CoffeeShopWiFi","bssid":"66:77:88:00:00:01"},{"ssid":"FreeAirport","bssid":"AA:BB:CC:00:00:01"}]},{"mac":"AA:BB:CC:DD:EE:FF","history":[{"ssid":"FreeAirport","bssid":"AA:BB:CC:00:00:01"}]}]');var n=a(18176);let c=e=>{let s,a=Array.from(e.slice(16,22)).map(e=>e.toString(16).padStart(2,"0")).join(":"),l="",r=36;for(;r+2<=e.length;){let a=e[r],t=e[r+1],i=e.slice(r+2,r+2+t);0===a?l=new TextDecoder().decode(i):3===a&&i.length&&(s=i[0]),r+=2+t}return{ssid:l,bssid:a,channel:s}},o=e=>{let{data:s}=e,a=Object.keys(s).map(Number).sort((e,s)=>e-s),r=Math.max(1,...a.map(e=>s[e]));return(0,l.jsx)("div",{className:"flex h-40 items-end space-x-1 text-kali-muted","aria-label":"Channel chart",children:a.map(e=>(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("div",{className:"w-4 rounded-sm bg-[var(--color-accent)]",style:{height:"".concat(s[e]/r*100,"%")}}),(0,l.jsx)("span",{className:"mt-1 text-xs",children:e})]},e))})},d=e=>{let{data:s}=e,a=Object.keys(s).map(Number).sort((e,s)=>e-s),r=Math.max(1,...a.map(e=>s[e])),t=Math.max(200,20*a.length),i=a.map((e,l)=>{let i=l/Math.max(1,a.length-1)*t,n=100-s[e]/r*100;return"".concat(0===l?"M":"L").concat(i," ").concat(n)}).join(" ");return(0,l.jsx)("svg",{width:t,height:100,className:"bg-[color:var(--color-dark)]","aria-label":"Time chart",children:(0,l.jsx)("path",{d:i,stroke:"var(--color-accent)",strokeWidth:2,fill:"none"})})},x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return n[e.slice(0,8).toUpperCase()]||"Unknown vendor"},m=(e,s)=>{let a={},l={},r={},t=Date.now();return e.forEach((e,i)=>{let n=e.bssid||"".concat(e.ssid,"-").concat(i);a[n]||(a[n]={ssid:e.ssid,bssid:e.bssid||n,channel:e.channel,frames:0,signalSamples:[]},null==s||s({ssid:e.ssid,bssid:e.bssid||n,discoveredAt:t+1e3*i})),a[n].frames+=1,"number"==typeof e.signal&&a[n].signalSamples.push(e.signal),null!=e.channel&&(l[e.channel]=(l[e.channel]||0)+1);let c=Math.floor(i/2);r[c]=(r[c]||0)+1}),{networks:Object.values(a).map(e=>{let s=e.signalSamples.length?Math.round(e.signalSamples.reduce((e,s)=>e+s,0)/e.signalSamples.length):void 0;return{ssid:e.ssid,bssid:e.bssid,channel:e.channel,frames:e.frames,vendor:x(e.bssid),avgSignal:s}}),channelCounts:l,timeCounts:r}},h=e=>{let{onNetworkDiscovered:s}=e,[a,n]=(0,r.useState)([]),[h,u]=(0,r.useState)("fixtures"),[p,b]=(0,r.useState)({}),[f,v]=(0,r.useState)({}),[g,k]=(0,r.useState)([]),[j,N]=(0,r.useState)("all"),[w,y]=(0,r.useState)("all"),[C,S]=(0,r.useState)(!1),[A,F]=(0,r.useState)("");(0,r.useEffect)(()=>{(()=>{try{let e=localStorage.getItem("lab-mode");S("true"===e)}catch(e){S(!1)}})()},[]);let _=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fixtures",a=e.networks.map(e=>({...e,vendor:e.vendor||x(e.bssid)}));n(a),b(e.channelCounts),v(e.timeCounts),u(s);let l=(e=>{let s=new Map;return e.forEach(e=>{s.has(e.bssid)||s.set(e.bssid,e)}),s})(a);if("fixtures"===s)k(i.map(e=>{let s=x(e.mac),a=e.history.map(e=>{var s;let a=l.get(e.bssid);return{...e,channel:null!=(s=null==a?void 0:a.channel)?s:null,vendor:(null==a?void 0:a.vendor)||x(e.bssid)}});return{...e,vendor:s,history:a}}));else k([])};(0,r.useEffect)(()=>{_(m(t,s),"fixtures")},[s]);let M=async e=>{var a;let l=null==(a=e.target.files)?void 0:a[0];if(!l)return;let r=await l.arrayBuffer();try{let{networks:e,channelCounts:a,timeCounts:l}=((e,s)=>{var a;let l=new DataView(e),r=[],t=24;for(;t+16<=l.byteLength;){let s=l.getUint32(t,!0),a=l.getUint32(t+4,!0),i=l.getUint32(t+8,!0),n=new Uint8Array(e,t+=16,i);r.push({tsSec:s,tsUsec:a,data:n}),t+=i}let i={},n={},o={},d=(null==(a=r[0])?void 0:a.tsSec)||0;for(let e of r){if(e.data.length<4)continue;let a=e.data[2]|e.data[3]<<8;if(e.data.length<a+24)continue;let l=e.data.subarray(a),r=l[0]|l[1]<<8,t=r>>2&3,x=r>>4&15;if(0!==t||8!==x&&5!==x)continue;let m=c(l),h=m.bssid||m.ssid;i[h]||(i[h]={...m,frames:0},null==s||s({ssid:m.ssid,bssid:m.bssid,discoveredAt:1e3*e.tsSec+Math.floor(e.tsUsec/1e3)})),i[h].frames+=1,null!=m.channel&&(n[m.channel]=(n[m.channel]||0)+1);let u=e.tsSec-d;o[u]=(o[u]||0)+1}return{networks:Object.values(i),channelCounts:n,timeCounts:o}})(r,s);_({networks:e,channelCounts:a,timeCounts:l},"upload"),N("all"),y("all"),F("")}catch(e){F("Unable to parse capture file.")}},B=(0,r.useMemo)(()=>{if("all"===j)return a;let e=Number(j);return a.filter(s=>s.channel===e)},[a,j]),D=(0,r.useMemo)(()=>g.filter(e=>{let s="all"===w||e.vendor===w,a="all"===j||e.history.some(e=>e.channel===Number(j));return s&&a}),[g,w,j]),E=(0,r.useMemo)(()=>Array.from(new Set(g.map(e=>e.vendor))).sort(),[g]),O=(0,r.useMemo)(()=>((e,s)=>{let a=e.length;return{totalNetworks:a,totalFrames:e.reduce((e,s)=>e+s.frames,0),busiestChannel:Object.keys(s).map(Number).sort((e,a)=>s[a]-s[e])[0]}})(a,p),[a,p]);return(0,l.jsxs)("div",{className:"space-y-6 p-4 text-[color:var(--kali-text)] lg:space-y-8",children:[(0,l.jsx)("div",{className:"rounded-xl border border-kali-border/70 bg-[color:var(--kali-surface)] p-4 text-sm shadow-kali-panel",role:"status",children:(0,l.jsxs)("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("p",{className:"text-base font-semibold uppercase tracking-wide text-kali-accent",children:["Lab Mode ",C?"enabled":"off"]}),(0,l.jsx)("p",{className:"text-xs text-kali-muted",children:C?"All datasets stay local. Upload captures for guided review.":"Enable Lab Mode to explore the full simulator. Offline summary remains available."})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsx)("button",{type:"button",onClick:C?()=>{try{localStorage.removeItem("lab-mode")}catch(e){}S(!1)}:()=>{try{localStorage.setItem("lab-mode","true")}catch(e){}S(!0)},className:"rounded-lg bg-[color:var(--color-accent)] px-3 py-1.5 text-xs font-semibold uppercase tracking-wide text-[color:var(--color-inverse)] shadow-sm transition hover:bg-[color:color-mix(in_srgb,var(--color-accent)_88%,transparent)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",children:C?"Disable Lab Mode":"Enable Lab Mode"}),(0,l.jsx)("button",{type:"button",onClick:()=>{_(m(t,s),"fixtures"),N("all"),y("all"),F("")},className:"rounded-lg border border-kali-border/70 px-3 py-1.5 text-xs font-semibold uppercase tracking-wide text-kali-accent transition hover:bg-[color:color-mix(in_srgb,var(--color-accent)_12%,transparent)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",children:"Reload fixtures"})]})]})}),!C&&(0,l.jsxs)("div",{className:"rounded-xl border border-kali-border/70 bg-[color:var(--kali-surface)] p-4 text-xs shadow-kali-panel",children:[(0,l.jsx)("p",{className:"text-sm font-semibold uppercase tracking-wide text-kali-accent",children:"Offline summary"}),(0,l.jsxs)("ul",{className:"mt-3 list-disc space-y-1 pl-5 text-[color:color-mix(in_srgb,var(--kali-text)_82%,transparent)]",children:[(0,l.jsxs)("li",{children:["Access points discovered: ",O.totalNetworks]}),(0,l.jsxs)("li",{children:["Total beacon frames observed: ",O.totalFrames]}),(0,l.jsxs)("li",{children:["Busiest channel:"," ",null!=O.busiestChannel?O.busiestChannel:"n/a"]})]})]}),C&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-end gap-4 rounded-xl border border-kali-border/60 bg-[color:var(--color-surface-muted)] p-4",children:[(0,l.jsxs)("label",{className:"text-xs",htmlFor:"channel-filter",children:[(0,l.jsx)("span",{className:"mb-1 block text-[0.7rem] font-semibold uppercase tracking-wide",children:"Channel filter"}),(0,l.jsxs)("select",{id:"channel-filter","aria-label":"Channel filter",className:"w-36 rounded-lg border border-kali-border/60 bg-kali-dark p-1.5 text-xs text-[color:var(--kali-text)] shadow-sm focus:border-kali-accent focus:outline-none focus:ring-1 focus:ring-kali-accent/40",value:j,onChange:e=>N(e.target.value),children:[(0,l.jsx)("option",{value:"all",children:"All channels"}),Object.keys(p).map(Number).sort((e,s)=>e-s).map(e=>(0,l.jsxs)("option",{value:e,children:["Channel ",e]},e))]})]}),g.length>0&&(0,l.jsxs)("label",{className:"text-xs",htmlFor:"device-filter",children:[(0,l.jsx)("span",{className:"mb-1 block text-[0.7rem] font-semibold uppercase tracking-wide",children:"Device vendor"}),(0,l.jsxs)("select",{id:"device-filter","aria-label":"Device vendor filter",className:"w-44 rounded-lg border border-kali-border/60 bg-kali-dark p-1.5 text-xs text-[color:var(--kali-text)] shadow-sm focus:border-kali-accent focus:outline-none focus:ring-1 focus:ring-kali-accent/40",value:w,onChange:e=>y(e.target.value),children:[(0,l.jsx)("option",{value:"all",children:"All vendors"}),E.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]}),(0,l.jsxs)("label",{className:"text-xs",htmlFor:"pcap-upload",children:[(0,l.jsx)("span",{className:"mb-1 block text-[0.7rem] font-semibold uppercase tracking-wide",children:"Upload capture"}),(0,l.jsx)("input",{id:"pcap-upload",type:"file",accept:".pcap",onChange:M,"aria-label":"pcap file",className:"block max-w-[14rem] text-xs"})]}),(0,l.jsxs)("div",{className:"text-[10px] uppercase tracking-wide text-kali-muted",children:["Dataset source: ","fixtures"===h?"Demo fixtures":"Upload"]})]}),A&&(0,l.jsx)("div",{className:"rounded-lg border border-[color:color-mix(in_srgb,var(--color-error)_65%,transparent)] bg-[color:color-mix(in_srgb,var(--color-error)_16%,var(--kali-surface))] p-3 text-xs font-semibold uppercase tracking-wide text-[color:color-mix(in_srgb,var(--color-error)_75%,var(--kali-text))] shadow ring-1 ring-[color:color-mix(in_srgb,var(--color-error)_45%,transparent)]",role:"alert","aria-live":"assertive",children:A}),(0,l.jsxs)("div",{className:"grid gap-6 xl:grid-cols-12",children:[(0,l.jsxs)("section",{className:"space-y-4 xl:col-span-7",children:[B.length>0?(0,l.jsx)("div",{className:"overflow-hidden rounded-xl border border-kali-border/60 bg-[color:var(--kali-surface)] shadow-kali-panel",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm","aria-label":"Networks",children:[(0,l.jsx)("thead",{className:"bg-kali-dark/80 text-xs uppercase tracking-wide text-kali-muted",children:(0,l.jsxs)("tr",{className:"text-left",children:[(0,l.jsx)("th",{className:"px-4 py-3",children:"SSID"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"BSSID"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Channel"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Vendor"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Frames"})]})}),(0,l.jsx)("tbody",{className:"text-[color:color-mix(in_srgb,var(--kali-text)_92%,transparent)]",children:B.map(e=>{var s;return(0,l.jsxs)("tr",{className:"odd:bg-[color:var(--color-surface-muted)]",children:[(0,l.jsx)("td",{className:"px-4 py-2",children:e.ssid||"(hidden)"}),(0,l.jsx)("td",{className:"px-4 py-2 font-mono text-xs",children:e.bssid}),(0,l.jsx)("td",{className:"px-4 py-2",children:null!=(s=e.channel)?s:"-"}),(0,l.jsx)("td",{className:"px-4 py-2",children:e.vendor}),(0,l.jsx)("td",{className:"px-4 py-2",children:e.frames})]},e.bssid)})})]})})}):(0,l.jsx)("div",{className:"rounded-xl border border-kali-border/60 bg-[color:var(--color-surface-muted)] p-4 text-xs text-kali-muted",children:"No networks match the selected filters."}),g.length>0&&(0,l.jsx)("div",{className:"overflow-hidden rounded-xl border border-kali-border/60 bg-[color:var(--kali-surface)] shadow-kali-panel",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-xs","aria-label":"Client devices",children:[(0,l.jsx)("thead",{className:"bg-kali-dark/80 uppercase tracking-wide text-kali-muted",children:(0,l.jsxs)("tr",{className:"text-left",children:[(0,l.jsx)("th",{className:"px-4 py-3",children:"MAC"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Vendor"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Known networks"})]})}),(0,l.jsx)("tbody",{className:"text-[color:color-mix(in_srgb,var(--kali-text)_92%,transparent)]",children:D.map(e=>(0,l.jsxs)("tr",{className:"odd:bg-[color:var(--color-surface-muted)]",children:[(0,l.jsx)("td",{className:"px-4 py-2 font-mono text-[0.7rem]",children:e.mac}),(0,l.jsx)("td",{className:"px-4 py-2",children:e.vendor}),(0,l.jsx)("td",{className:"px-4 py-2",children:(0,l.jsx)("ul",{className:"list-disc space-y-1 pl-4 text-[0.75rem]",children:e.history.map((s,a)=>(0,l.jsxs)("li",{children:[s.ssid||"(hidden)"," â€“ ",s.bssid,null!=s.channel&&(0,l.jsxs)("span",{className:"text-kali-muted",children:[" (ch ",s.channel,")"]})]},"".concat(e.mac,"-").concat(a)))})})]},e.mac))})]})})})]}),(0,l.jsxs)("aside",{className:"space-y-4 xl:col-span-5",children:[(0,l.jsxs)("div",{className:"rounded-xl border border-kali-border/60 bg-[color:var(--kali-surface)] p-4 shadow-kali-panel",children:[(0,l.jsx)("h3",{className:"mb-2 text-sm font-semibold uppercase tracking-wide text-kali-accent",children:"Channel utilization"}),(0,l.jsx)("div",{className:"overflow-x-auto pb-2",children:(0,l.jsx)(o,{data:p})})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-kali-border/60 bg-[color:var(--kali-surface)] p-4 shadow-kali-panel",children:[(0,l.jsx)("h3",{className:"mb-2 text-sm font-semibold uppercase tracking-wide text-kali-accent",children:"Frames over time"}),(0,l.jsx)("div",{className:"overflow-x-auto pb-2",children:(0,l.jsx)(d,{data:f})})]})]})]})]})]})}},71999:e=>{e.exports=JSON.parse('[{"ssid":"CoffeeShopWiFi","bssid":"66:77:88:00:00:01","channel":1,"signal":-45},{"ssid":"FreeAirport","bssid":"AA:BB:CC:00:00:01","channel":6,"signal":-70},{"ssid":"HomeWiFi","bssid":"00:11:22:00:00:01","channel":11,"signal":-30},{"ssid":"CoffeeShopWiFi","bssid":"66:77:88:00:00:01","channel":1,"signal":-47},{"ssid":"FreeAirport","bssid":"AA:BB:CC:00:00:01","channel":6,"signal":-72},{"ssid":"NewCafe","bssid":"DD:EE:FF:00:00:01","channel":3,"signal":-80}]')}}]);