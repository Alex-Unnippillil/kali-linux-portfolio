"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[806,9932],{18176:e=>{e.exports=JSON.parse('{"00:11:22":"Acme Corp","66:77:88":"Globex","AA:BB:CC":"Initech"}')},49932:(e,s,a)=>{a.r(s),a.d(s,{default:()=>h});var l=a(37876),t=a(14232),r=a(71999);let i=JSON.parse('[{"mac":"00:11:22:33:44:55","history":[{"ssid":"HomeWiFi","bssid":"00:11:22:00:00:01"},{"ssid":"CoffeeShopWiFi","bssid":"66:77:88:00:00:01"}]},{"mac":"66:77:88:99:AA:BB","history":[{"ssid":"CoffeeShopWiFi","bssid":"66:77:88:00:00:01"},{"ssid":"FreeAirport","bssid":"AA:BB:CC:00:00:01"}]},{"mac":"AA:BB:CC:DD:EE:FF","history":[{"ssid":"FreeAirport","bssid":"AA:BB:CC:00:00:01"}]}]');var n=a(18176);let c=e=>{let s,a=Array.from(e.slice(16,22)).map(e=>e.toString(16).padStart(2,"0")).join(":"),l="",t=36;for(;t+2<=e.length;){let a=e[t],r=e[t+1],i=e.slice(t+2,t+2+r);0===a?l=new TextDecoder().decode(i):3===a&&i.length&&(s=i[0]),t+=2+r}return{ssid:l,bssid:a,channel:s}},o=e=>{let{data:s}=e,a=Object.keys(s).map(Number).sort((e,s)=>e-s),t=Math.max(1,...a.map(e=>s[e]));return(0,l.jsx)("div",{className:"flex h-40 items-end space-x-1 text-kali-muted","aria-label":"Channel chart",children:a.map(e=>(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("div",{className:"w-4 rounded-sm bg-[var(--color-accent)]",style:{height:"".concat(s[e]/t*100,"%")}}),(0,l.jsx)("span",{className:"mt-1 text-xs",children:e})]},e))})},d=e=>{let{data:s}=e,a=Object.keys(s).map(Number).sort((e,s)=>e-s),t=Math.max(1,...a.map(e=>s[e])),r=Math.max(200,20*a.length),i=a.map((e,l)=>{let i=l/Math.max(1,a.length-1)*r,n=100-s[e]/t*100;return"".concat(0===l?"M":"L").concat(i," ").concat(n)}).join(" ");return(0,l.jsx)("svg",{width:r,height:100,className:"bg-[color:var(--color-dark)]","aria-label":"Time chart",children:(0,l.jsx)("path",{d:i,stroke:"var(--color-accent)",strokeWidth:2,fill:"none"})})},m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return n[e.slice(0,8).toUpperCase()]||"Unknown vendor"},x=(e,s)=>{let a={},l={},t={},r=Date.now();return e.forEach((e,i)=>{let n=e.bssid||"".concat(e.ssid,"-").concat(i);a[n]||(a[n]={ssid:e.ssid,bssid:e.bssid||n,channel:e.channel,frames:0,signalSamples:[]},null==s||s({ssid:e.ssid,bssid:e.bssid||n,discoveredAt:r+1e3*i})),a[n].frames+=1,"number"==typeof e.signal&&a[n].signalSamples.push(e.signal),null!=e.channel&&(l[e.channel]=(l[e.channel]||0)+1);let c=Math.floor(i/2);t[c]=(t[c]||0)+1}),{networks:Object.values(a).map(e=>{let s=e.signalSamples.length?Math.round(e.signalSamples.reduce((e,s)=>e+s,0)/e.signalSamples.length):void 0;return{ssid:e.ssid,bssid:e.bssid,channel:e.channel,frames:e.frames,vendor:m(e.bssid),avgSignal:s}}),channelCounts:l,timeCounts:t}},h=e=>{let{onNetworkDiscovered:s}=e,[a,n]=(0,t.useState)([]),[h,u]=(0,t.useState)("fixtures"),[p,b]=(0,t.useState)({}),[f,g]=(0,t.useState)({}),[v,j]=(0,t.useState)([]),[k,N]=(0,t.useState)("all"),[y,w]=(0,t.useState)("all"),[F,C]=(0,t.useState)(!1),[S,A]=(0,t.useState)("");(0,t.useEffect)(()=>{(()=>{try{let e=localStorage.getItem("lab-mode");C("true"===e)}catch(e){C(!1)}})()},[]);let D=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fixtures",a=e.networks.map(e=>({...e,vendor:e.vendor||m(e.bssid)}));n(a),b(e.channelCounts),g(e.timeCounts),u(s);let l=(e=>{let s=new Map;return e.forEach(e=>{s.has(e.bssid)||s.set(e.bssid,e)}),s})(a);if("fixtures"===s)j(i.map(e=>{let s=m(e.mac),a=e.history.map(e=>{var s;let a=l.get(e.bssid);return{...e,channel:null!=(s=null==a?void 0:a.channel)?s:null,vendor:(null==a?void 0:a.vendor)||m(e.bssid)}});return{...e,vendor:s,history:a}}));else j([])};(0,t.useEffect)(()=>{D(x(r,s),"fixtures")},[s]);let _=async e=>{var a;let l=null==(a=e.target.files)?void 0:a[0];if(!l)return;let t=await l.arrayBuffer();try{let{networks:e,channelCounts:a,timeCounts:l}=((e,s)=>{var a;let l=new DataView(e),t=[],r=24;for(;r+16<=l.byteLength;){let s=l.getUint32(r,!0),a=l.getUint32(r+4,!0),i=l.getUint32(r+8,!0),n=new Uint8Array(e,r+=16,i);t.push({tsSec:s,tsUsec:a,data:n}),r+=i}let i={},n={},o={},d=(null==(a=t[0])?void 0:a.tsSec)||0;for(let e of t){if(e.data.length<4)continue;let a=e.data[2]|e.data[3]<<8;if(e.data.length<a+24)continue;let l=e.data.subarray(a),t=l[0]|l[1]<<8,r=t>>2&3,m=t>>4&15;if(0!==r||8!==m&&5!==m)continue;let x=c(l),h=x.bssid||x.ssid;i[h]||(i[h]={...x,frames:0},null==s||s({ssid:x.ssid,bssid:x.bssid,discoveredAt:1e3*e.tsSec+Math.floor(e.tsUsec/1e3)})),i[h].frames+=1,null!=x.channel&&(n[x.channel]=(n[x.channel]||0)+1);let u=e.tsSec-d;o[u]=(o[u]||0)+1}return{networks:Object.values(i),channelCounts:n,timeCounts:o}})(t,s);D({networks:e,channelCounts:a,timeCounts:l},"upload"),N("all"),w("all"),A("")}catch(e){A("Unable to parse capture file.")}},M=(0,t.useMemo)(()=>{if("all"===k)return a;let e=Number(k);return a.filter(s=>s.channel===e)},[a,k]),B=(0,t.useMemo)(()=>v.filter(e=>{let s="all"===y||e.vendor===y,a="all"===k||e.history.some(e=>e.channel===Number(k));return s&&a}),[v,y,k]),E=(0,t.useMemo)(()=>Array.from(new Set(v.map(e=>e.vendor))).sort(),[v]),O=(0,t.useMemo)(()=>((e,s)=>{let a=e.length;return{totalNetworks:a,totalFrames:e.reduce((e,s)=>e+s.frames,0),busiestChannel:Object.keys(s).map(Number).sort((e,a)=>s[a]-s[e])[0]}})(a,p),[a,p]);return(0,l.jsxs)("div",{className:"space-y-6 p-4 text-[color:var(--kali-text)] lg:space-y-8",children:[(0,l.jsx)("div",{className:"rounded-xl border border-kali-border/70 bg-[color:var(--kali-surface)] p-4 text-sm shadow-kali-panel",role:"status",children:(0,l.jsxs)("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("p",{className:"text-base font-semibold uppercase tracking-wide text-kali-accent",children:["Lab Mode ",F?"enabled":"off"]}),(0,l.jsx)("p",{className:"text-xs text-kali-muted",children:F?"All datasets stay local. Upload captures for guided review.":"Enable Lab Mode to explore the full simulator. Offline summary remains available."})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsx)("button",{type:"button",onClick:F?()=>{try{localStorage.removeItem("lab-mode")}catch(e){}C(!1)}:()=>{try{localStorage.setItem("lab-mode","true")}catch(e){}C(!0)},className:"rounded-lg bg-[color:var(--color-accent)] px-3 py-1.5 text-xs font-semibold uppercase tracking-wide text-[color:var(--color-inverse)] shadow-sm transition hover:bg-[color:color-mix(in_srgb,var(--color-accent)_88%,transparent)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",children:F?"Disable Lab Mode":"Enable Lab Mode"}),(0,l.jsx)("button",{type:"button",onClick:()=>{D(x(r,s),"fixtures"),N("all"),w("all"),A("")},className:"rounded-lg border border-kali-border/70 px-3 py-1.5 text-xs font-semibold uppercase tracking-wide text-kali-accent transition hover:bg-[color:color-mix(in_srgb,var(--color-accent)_12%,transparent)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",children:"Reload fixtures"})]})]})}),!F&&(0,l.jsxs)("div",{className:"rounded-xl border border-kali-border/70 bg-[color:var(--kali-surface)] p-4 text-xs shadow-kali-panel",children:[(0,l.jsx)("p",{className:"text-sm font-semibold uppercase tracking-wide text-kali-accent",children:"Offline summary"}),(0,l.jsxs)("ul",{className:"mt-3 list-disc space-y-1 pl-5 text-[color:color-mix(in_srgb,var(--kali-text)_82%,transparent)]",children:[(0,l.jsxs)("li",{children:["Access points discovered: ",O.totalNetworks]}),(0,l.jsxs)("li",{children:["Total beacon frames observed: ",O.totalFrames]}),(0,l.jsxs)("li",{children:["Busiest channel:"," ",null!=O.busiestChannel?O.busiestChannel:"n/a"]})]})]}),F&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-end gap-4 rounded-xl border border-kali-border/60 bg-[color:var(--color-surface-muted)] p-4",children:[(0,l.jsxs)("label",{className:"text-xs",htmlFor:"channel-filter",children:[(0,l.jsx)("span",{className:"mb-1 block text-[0.7rem] font-semibold uppercase tracking-wide",children:"Channel filter"}),(0,l.jsxs)("select",{id:"channel-filter","aria-label":"Channel filter",className:"w-36 rounded-lg border border-kali-border/60 bg-kali-dark p-1.5 text-xs text-[color:var(--kali-text)] shadow-sm focus:border-kali-accent focus:outline-none focus:ring-1 focus:ring-kali-accent/40",value:k,onChange:e=>N(e.target.value),children:[(0,l.jsx)("option",{value:"all",children:"All channels"}),Object.keys(p).map(Number).sort((e,s)=>e-s).map(e=>(0,l.jsxs)("option",{value:e,children:["Channel ",e]},e))]})]}),v.length>0&&(0,l.jsxs)("label",{className:"text-xs",htmlFor:"device-filter",children:[(0,l.jsx)("span",{className:"mb-1 block text-[0.7rem] font-semibold uppercase tracking-wide",children:"Device vendor"}),(0,l.jsxs)("select",{id:"device-filter","aria-label":"Device vendor filter",className:"w-44 rounded-lg border border-kali-border/60 bg-kali-dark p-1.5 text-xs text-[color:var(--kali-text)] shadow-sm focus:border-kali-accent focus:outline-none focus:ring-1 focus:ring-kali-accent/40",value:y,onChange:e=>w(e.target.value),children:[(0,l.jsx)("option",{value:"all",children:"All vendors"}),E.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]}),(0,l.jsxs)("label",{className:"text-xs",htmlFor:"pcap-upload",children:[(0,l.jsx)("span",{className:"mb-1 block text-[0.7rem] font-semibold uppercase tracking-wide",children:"Upload capture"}),(0,l.jsx)("input",{id:"pcap-upload",type:"file",accept:".pcap",onChange:_,"aria-label":"pcap file",className:"block max-w-[14rem] text-xs"})]}),(0,l.jsxs)("div",{className:"text-[10px] uppercase tracking-wide text-kali-muted",children:["Dataset source: ","fixtures"===h?"Demo fixtures":"Upload"]})]}),S&&(0,l.jsx)("div",{className:"rounded-lg border border-[color:color-mix(in_srgb,var(--color-error)_65%,transparent)] bg-[color:color-mix(in_srgb,var(--color-error)_16%,var(--kali-surface))] p-3 text-xs font-semibold uppercase tracking-wide text-[color:color-mix(in_srgb,var(--color-error)_75%,var(--kali-text))] shadow ring-1 ring-[color:color-mix(in_srgb,var(--color-error)_45%,transparent)]",role:"alert","aria-live":"assertive",children:S}),(0,l.jsxs)("div",{className:"grid gap-6 xl:grid-cols-12",children:[(0,l.jsxs)("section",{className:"space-y-4 xl:col-span-7",children:[M.length>0?(0,l.jsx)("div",{className:"overflow-hidden rounded-xl border border-kali-border/60 bg-[color:var(--kali-surface)] shadow-kali-panel",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm","aria-label":"Networks",children:[(0,l.jsx)("thead",{className:"bg-kali-dark/80 text-xs uppercase tracking-wide text-kali-muted",children:(0,l.jsxs)("tr",{className:"text-left",children:[(0,l.jsx)("th",{className:"px-4 py-3",children:"SSID"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"BSSID"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Channel"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Vendor"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Frames"})]})}),(0,l.jsx)("tbody",{className:"text-[color:color-mix(in_srgb,var(--kali-text)_92%,transparent)]",children:M.map(e=>{var s;return(0,l.jsxs)("tr",{className:"odd:bg-[color:var(--color-surface-muted)]",children:[(0,l.jsx)("td",{className:"px-4 py-2",children:e.ssid||"(hidden)"}),(0,l.jsx)("td",{className:"px-4 py-2 font-mono text-xs",children:e.bssid}),(0,l.jsx)("td",{className:"px-4 py-2",children:null!=(s=e.channel)?s:"-"}),(0,l.jsx)("td",{className:"px-4 py-2",children:e.vendor}),(0,l.jsx)("td",{className:"px-4 py-2",children:e.frames})]},e.bssid)})})]})})}):(0,l.jsx)("div",{className:"rounded-xl border border-kali-border/60 bg-[color:var(--color-surface-muted)] p-4 text-xs text-kali-muted",children:"No networks match the selected filters."}),v.length>0&&(0,l.jsx)("div",{className:"overflow-hidden rounded-xl border border-kali-border/60 bg-[color:var(--kali-surface)] shadow-kali-panel",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-xs","aria-label":"Client devices",children:[(0,l.jsx)("thead",{className:"bg-kali-dark/80 uppercase tracking-wide text-kali-muted",children:(0,l.jsxs)("tr",{className:"text-left",children:[(0,l.jsx)("th",{className:"px-4 py-3",children:"MAC"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Vendor"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"Known networks"})]})}),(0,l.jsx)("tbody",{className:"text-[color:color-mix(in_srgb,var(--kali-text)_92%,transparent)]",children:B.map(e=>(0,l.jsxs)("tr",{className:"odd:bg-[color:var(--color-surface-muted)]",children:[(0,l.jsx)("td",{className:"px-4 py-2 font-mono text-[0.7rem]",children:e.mac}),(0,l.jsx)("td",{className:"px-4 py-2",children:e.vendor}),(0,l.jsx)("td",{className:"px-4 py-2",children:(0,l.jsx)("ul",{className:"list-disc space-y-1 pl-4 text-[0.75rem]",children:e.history.map((s,a)=>(0,l.jsxs)("li",{children:[s.ssid||"(hidden)"," â€“ ",s.bssid,null!=s.channel&&(0,l.jsxs)("span",{className:"text-kali-muted",children:[" (ch ",s.channel,")"]})]},"".concat(e.mac,"-").concat(a)))})})]},e.mac))})]})})})]}),(0,l.jsxs)("aside",{className:"space-y-4 xl:col-span-5",children:[(0,l.jsxs)("div",{className:"rounded-xl border border-kali-border/60 bg-[color:var(--kali-surface)] p-4 shadow-kali-panel",children:[(0,l.jsx)("h3",{className:"mb-2 text-sm font-semibold uppercase tracking-wide text-kali-accent",children:"Channel utilization"}),(0,l.jsx)("div",{className:"overflow-x-auto pb-2",children:(0,l.jsx)(o,{data:p})})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-kali-border/60 bg-[color:var(--kali-surface)] p-4 shadow-kali-panel",children:[(0,l.jsx)("h3",{className:"mb-2 text-sm font-semibold uppercase tracking-wide text-kali-accent",children:"Frames over time"}),(0,l.jsx)("div",{className:"overflow-x-auto pb-2",children:(0,l.jsx)(d,{data:f})})]})]})]})]})]})}},50806:(e,s,a)=>{a.r(s),a.d(s,{default:()=>d});var l=a(37876),t=a(14232),r=a(49932);let i=a(71999)[0],n=[{seq:1,src:i.bssid,dst:"11:22:33:44:55:66",type:"Data"},{seq:2,src:i.bssid,dst:"11:22:33:44:55:66",type:"Data"},{seq:3,src:i.bssid,dst:"FF:FF:FF:FF:FF:FF",type:"Deauth"},{seq:4,src:i.bssid,dst:"FF:FF:FF:FF:FF:FF",type:"Deauth"},{seq:5,src:i.bssid,dst:"11:22:33:44:55:66",type:"Data"}],c=()=>(0,l.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"text-left",children:[(0,l.jsx)("th",{className:"pr-2",children:"Seq"}),(0,l.jsx)("th",{className:"pr-2",children:"Source"}),(0,l.jsx)("th",{className:"pr-2",children:"Destination"}),(0,l.jsx)("th",{children:"Type"})]})}),(0,l.jsx)("tbody",{children:n.map(e=>(0,l.jsxs)("tr",{className:"odd:bg-gray-800 ".concat("Deauth"===e.type?"bg-red-900 text-red-100":""),children:[(0,l.jsx)("td",{className:"pr-2",children:e.seq}),(0,l.jsx)("td",{className:"pr-2",children:e.src}),(0,l.jsx)("td",{className:"pr-2",children:e.dst}),(0,l.jsx)("td",{children:e.type})]},e.seq))})]}),(0,l.jsx)("p",{className:"mt-4",children:"Frames 3 and 4 show back-to-back deauthentication messages, a pattern often used to forcibly disconnect clients from an access point."}),(0,l.jsxs)("p",{className:"mt-2",children:["For defensive guidance, review the"," ",(0,l.jsx)("a",{href:"/docs/deauth-mitigation.md",className:"text-blue-400 underline",children:"mitigation notes"}),"."]})]});var o=a(16932);let d=()=>{let e=(0,t.useCallback)(e=>{e&&(0,o.createLogger)().info("network discovered",{ssid:e.ssid||e.bssid,time:new Date(e.discoveredAt).toISOString()})},[]);return(0,l.jsxs)("div",{className:"space-y-10 lg:space-y-12",children:[(0,l.jsxs)("aside",{"aria-label":"Simulation notice",className:"rounded-xl border border-amber-500/40 bg-amber-900/20 p-5 text-sm text-amber-100/90 shadow",role:"note",children:[(0,l.jsx)("p",{className:"text-base font-semibold uppercase tracking-wide text-amber-100",children:"Simulation notice"}),(0,l.jsxs)("p",{className:"mt-2",children:["All telemetry in this workspace is replayed from bundled fixture data (",(0,l.jsx)("code",{className:"font-mono",children:"sampleCapture.json"})," and"," ",(0,l.jsx)("code",{className:"font-mono",children:"sampleClients.json"}),") so the demo can run entirely offline."]}),(0,l.jsx)("p",{className:"mt-2",children:"Safe Mode keeps radio controls, uploads, and outbound probes disabled; toggling Lab Mode only unlocks additional filters on the simulated dataset."})]}),(0,l.jsxs)("section",{"aria-labelledby":"kismet-monitor-heading",className:"rounded-2xl border border-slate-700/70 bg-slate-950/70 p-8 shadow-xl",children:[(0,l.jsx)("h1",{id:"kismet-monitor-heading",className:"mb-6 text-3xl font-bold tracking-tight text-sky-50 sm:text-4xl",children:"Kismet Live Monitor (Simulated)"}),(0,l.jsx)(r.default,{onNetworkDiscovered:e})]}),(0,l.jsxs)("section",{"aria-labelledby":"deauth-walkthrough-heading",className:"rounded-2xl border border-slate-700/70 bg-slate-950/70 p-8 shadow-xl",children:[(0,l.jsx)("h2",{id:"deauth-walkthrough-heading",className:"mb-4 text-2xl font-semibold tracking-tight text-sky-50",children:"Deauthentication Walkthrough"}),(0,l.jsx)(c,{})]})]})}},71999:e=>{e.exports=JSON.parse('[{"ssid":"CoffeeShopWiFi","bssid":"66:77:88:00:00:01","channel":1,"signal":-45},{"ssid":"FreeAirport","bssid":"AA:BB:CC:00:00:01","channel":6,"signal":-70},{"ssid":"HomeWiFi","bssid":"00:11:22:00:00:01","channel":11,"signal":-30},{"ssid":"CoffeeShopWiFi","bssid":"66:77:88:00:00:01","channel":1,"signal":-47},{"ssid":"FreeAirport","bssid":"AA:BB:CC:00:00:01","channel":6,"signal":-72},{"ssid":"NewCafe","bssid":"DD:EE:FF:00:00:01","channel":3,"signal":-80}]')}}]);