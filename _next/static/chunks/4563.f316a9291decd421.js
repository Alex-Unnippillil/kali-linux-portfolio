"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4563],{84563:(e,r,t)=>{t.r(r),t.d(r,{checkWinner:()=>c,default:()=>y,minimax:()=>g});var l=t(37876),s=t(14232),n=t(70994);let a=new Map,i=e=>{if(a.has(e))return a.get(e);let r=[];for(let t=0;t<e;t++){let l=t*e;r.push(Array.from({length:e},(e,r)=>l+r))}for(let t=0;t<e;t++)r.push(Array.from({length:e},(r,l)=>l*e+t));return r.push(Array.from({length:e},(r,t)=>t*e+t)),r.push(Array.from({length:e},(r,t)=>t*e+(e-1-t))),a.set(e,r),r},o=e=>Array(e*e).fill(null),c=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.sqrt(e.length),t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(let l of i(r)){let[r,...s]=l,n=e[r];if(n&&s.every(r=>e[r]===n))return{winner:t?"X"===n?"O":"X":n,line:l}}return e.every(Boolean)?{winner:"draw",line:[]}:{winner:null,line:[]}},u=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"X",t=e.filter(e=>"X"===e).length,l=e.filter(e=>"O"===e).length;if("X"===r){if(t===l)return"X";if(t===l+1)return"O"}else{if(l===t)return"O";if(l===t+1)return"X"}return r},d=e=>e.reduce((e,r,t)=>(r||e.push(t),e),[]),h=(e,r,t)=>{if(r<0||r>=e.length)throw Error("Illegal move");if(e[r])throw Error("Cell occupied");let l=e.slice();return l[r]=t,l},f=e=>{let r=(e-1)/2,t=+(e%2==0);return Array.from({length:e*e},(e,r)=>r).sort((l,s)=>{let n=Math.abs(Math.floor(l/e)-r)+Math.abs(l%e-r),a=Math.abs(Math.floor(s/e)-r)+Math.abs(s%e-r),i=(r,l)=>l===t?0:((e,r)=>{let t=r-1,l=Math.floor(e/r),s=e%r;return(0===l||l===t)&&(0===s||s===t)})(r,e)?1:((e,r)=>{let t=r-1,l=Math.floor(e/r),s=e%r;return 0===l||0===s||l===t||s===t})(r,e)?2:3,o=i(l,n),c=i(s,a);return o!==c?o-c:n!==a?n-a:l-s})},m=new Map,x=(e,r,t,l,s)=>{let{winner:n}=c(e,l,"misere"===s);if(n)return"draw"===n?{index:-1,score:0}:{index:-1,score:n===t?1:-1};let a=d(e),i=f(l).filter(e=>a.includes(e)),o={index:-1,score:r===t?-1/0:1/0};for(let n of i){let a=x(h(e,n,r),"X"===r?"O":"X",t,l,s);if(r===t?a.score>o.score&&(o={index:n,score:a.score}):a.score<o.score&&(o={index:n,score:a.score}),o.score===(r===t?1:-1))break}return o},g=(e,r,t)=>{let{size:l,mode:s,maximizeFor:n,depthLeft:a,alpha:o=-1/0,beta:u=1/0}=t,{winner:x}=c(e,l,"misere"===s);if(x){if("draw"===x)return{index:-1,score:0};let e=10+(null!=a?a:0);return{index:-1,score:x===n?e:-e}}if(0===a)return{index:-1,score:((e,r,t,l)=>{let s="X"===t?"O":"X",n=0;for(let a of i(r)){let[r,i]=a.reduce((r,l)=>{let n=e[l];return n===t?r[0]+=1:n===s&&(r[1]+=1),r},[0,0]);if(r&&i)continue;let o=e=>e*e;"classic"===l?n+=o(r)-o(i):n+=o(i)-o(r)}return n})(e,l,n,s)};let v="".concat(s,"|").concat(l,"|").concat(r,"|").concat(n,"|").concat(null!=a?a:"inf","|").concat(e.map(e=>e||"-").join("")),p=m.get(v);if(p&&void 0!==p.index)return p;let y=d(e),j=f(l).filter(e=>y.includes(e)),w={index:-1,score:r===n?-1/0:1/0},b=o,X=u;for(let t of j){let i=g(h(e,t,r),"X"===r?"O":"X",{size:l,mode:s,maximizeFor:n,depthLeft:void 0!==a?a-1:void 0,alpha:b,beta:X});if(r===n?(i.score>w.score&&(w={index:t,score:i.score}),b=Math.max(b,i.score)):(i.score<w.score&&(w={index:t,score:i.score}),X=Math.min(X,i.score)),X<=b)break}return m.set(v,w),w},v={classic:{X:"X",O:"O"},emoji:{X:"❌",O:"⭕"},animals:{X:"\uD83D\uDC31",O:"\uD83D\uDC36"},fruits:{X:"\uD83C\uDF4E",O:"\uD83C\uDF4C"}},p=()=>{var e,r,t,n,a,i;let[m,p]=(0,s.useState)(3),[y,j]=(0,s.useState)("classic"),[w,b]=(0,s.useState)("classic"),[X,N]=(0,s.useState)("hard"),[O,k]=(0,s.useState)(o(3)),[M,S]=(0,s.useState)(null),[C,A]=(0,s.useState)(null),[E,T]=(0,s.useState)("Choose X or O"),[I,L]=(0,s.useState)(null),[D,R]=(0,s.useState)(!1),[W,_]=(0,s.useState)(()=>{try{return JSON.parse(localStorage.getItem("tictactoeStats")||"{}")}catch(e){return{}}}),q=(0,s.useRef)(null),z=(0,s.useRef)(null),B="".concat(y,"-").concat(m),F=(0,s.useCallback)(e=>{_(r=>{let t=r[B]||{wins:0,losses:0,draws:0},l={...r,[B]:{wins:"win"===e?t.wins+1:t.wins,losses:"loss"===e?t.losses+1:t.losses,draws:"draw"===e?t.draws+1:t.draws}};return localStorage.setItem("tictactoeStats",JSON.stringify(l)),l})},[B]);(0,s.useEffect)(()=>{k(o(m)),S(null),A(null),T("Choose X or O"),L(null),R(!1),z.current&&(clearTimeout(z.current),z.current=null)},[m,y]),(0,s.useEffect)(()=>()=>{z.current&&clearTimeout(z.current)},[]);let J=e=>{S(e),A("X"===e?"O":"X"),k(o(m)),T("".concat(v[w][e],"'s turn")),L(null)};(0,s.useEffect)(()=>{if(null===M||null===C)return;let{winner:e,line:r}=c(O,m,"misere"===y);if(e){T("draw"===e?"Draw":"".concat(v[w][e]," wins")),L(r),R(!1),"draw"===e?F("draw"):e===M?F("win"):F("loss");return}let t=u(O);t!==C||D?t!==M||D||T("".concat(v[w][M],"'s turn")):(T("AI thinking..."),R(!0),z.current&&clearTimeout(z.current),z.current=setTimeout(()=>{k(e=>{if(c(e,m,"misere"===y).winner||u(e)!==C)return e;let r=((e,r,t)=>{var l,s,n;let{size:a,mode:i,difficulty:o,rng:c=Math.random}=t;if(u(e)!==r)return -1;let m=null!=(s=null==(l=({3:{hard:a*a,medium:5,easy:2},4:{hard:6,medium:4,easy:2}})[a])?void 0:l[o])?s:({hard:3===a?void 0:a*a,medium:4,easy:2})[o],v=d(e),p=f(a),y=new Map;p.forEach((e,r)=>y.set(e,r));let j=v.map(t=>{if("hard"===o&&3===a){let l=x(h(e,t,r),"X"===r?"O":"X",r,a,i);return{move:t,score:l.score}}let l=h(e,t,r);return{move:t,score:g(l,"X"===r?"O":"X",{size:a,mode:i,maximizeFor:r,depthLeft:m?m-1:void 0}).score}}).sort((e,r)=>{var t,l;return r.score!==e.score?r.score-e.score:(null!=(t=y.get(e.move))?t:0)-(null!=(l=y.get(r.move))?l:0)}),w=j.slice(0,Math.min(3,j.length)),b=c()<({hard:0,medium:.1,easy:.35})[o]?w[Math.floor(c()*w.length)]:j[0];return null!=(n=null==b?void 0:b.move)?n:-1})(e,C,{size:m,mode:"misere"===y?"misere":"classic",difficulty:X,rng:Math.random});if(r<0||e[r])return e;try{return h(e,r,C)}catch(r){return e}}),R(!1)},200))},[C,D,O,X,y,M,F,m,w]),(0,s.useEffect)(()=>{if(I&&q.current){let e=q.current,r=e.getTotalLength();e.style.transition="none",e.style.strokeDasharray=String(r),e.style.strokeDashoffset=String(r),requestAnimationFrame(()=>{e.style.transition="stroke-dashoffset 0.5s ease",e.style.strokeDashoffset="0"})}},[I]);let H=v[w];return null===M?(0,l.jsxs)("div",{className:"h-full w-full flex flex-col items-center justify-center bg-ub-cool-grey text-white p-4",children:[(0,l.jsxs)("div",{className:"mb-4",children:["Size:",(0,l.jsxs)("select",{value:m,onChange:e=>p(parseInt(e.target.value,10)),className:"bg-gray-700 rounded p-1 ml-2",children:[(0,l.jsx)("option",{value:3,children:"3\xd73"}),(0,l.jsx)("option",{value:4,children:"4\xd74"})]})]}),(0,l.jsxs)("div",{className:"mb-4",children:["Mode:",(0,l.jsxs)("select",{value:y,onChange:e=>j(e.target.value),className:"bg-gray-700 rounded p-1 ml-2",children:[(0,l.jsx)("option",{value:"classic",children:"Classic"}),(0,l.jsx)("option",{value:"misere",children:"Mis\xe8re (three-in-a-row loses)"})]})]}),(0,l.jsxs)("div",{className:"mb-4",children:["AI Level:",(0,l.jsxs)("select",{value:X,onChange:e=>N(e.target.value),className:"bg-gray-700 rounded p-1 ml-2",children:[(0,l.jsx)("option",{value:"easy",children:"Easy"}),(0,l.jsx)("option",{value:"medium",children:"Medium"}),(0,l.jsx)("option",{value:"hard",children:"Hard"})]})]}),(0,l.jsxs)("div",{className:"mb-4",children:["Skin:",(0,l.jsx)("select",{value:w,onChange:e=>b(e.target.value),className:"bg-gray-700 rounded p-1 ml-2",children:Object.keys(v).map(e=>(0,l.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]}),(0,l.jsx)("div",{className:"mb-4",children:"Choose X or O"}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[(0,l.jsx)("button",{className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded",onClick:()=>J("X"),children:H.X}),(0,l.jsx)("button",{className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded",onClick:()=>J("O"),children:H.O})]}),(0,l.jsxs)("div",{className:"mt-4 text-sm",children:[(0,l.jsxs)("div",{children:["Stats for ",y," ",m,"\xd7",m,":"]}),(0,l.jsxs)("div",{children:["Wins: ",(null==(n=W[B])?void 0:n.wins)||0," | Losses: ",(null==(a=W[B])?void 0:a.losses)||0," | Draws: ",(null==(i=W[B])?void 0:i.draws)||0]})]})]}):(0,l.jsxs)("div",{className:"h-full w-full flex flex-col items-center justify-center bg-ub-cool-grey text-white p-4",children:[(0,l.jsx)("div",{className:"mb-2","aria-live":"polite",children:E}),(0,l.jsxs)("div",{className:"relative",style:{width:"".concat(4.5*m,"rem"),height:"".concat(4.5*m,"rem")},children:[(0,l.jsx)("div",{className:"absolute inset-0 grid gap-px bg-gray-500",style:{gridTemplateColumns:"repeat(".concat(m,",1fr)")},children:O.map((e,r)=>(0,l.jsx)("button",{className:"w-full h-full flex items-center justify-center bg-gray-700 text-5xl",onClick:()=>(e=>{if(null===M||D)return;let{winner:r}=c(O,m,"misere"===y);if(!r&&u(O)===M&&!O[e])try{k(r=>h(r,e,M))}catch(e){}})(r),children:e?H[e]:""},r))}),I&&(0,l.jsx)("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none",viewBox:"0 0 ".concat(100*m," ").concat(100*m),children:(()=>{let e=I[0],r=I[I.length-1],t=e%m*100+50,s=100*Math.floor(e/m)+50,n=r%m*100+50,a=100*Math.floor(r/m)+50;return(0,l.jsx)("line",{ref:q,x1:t,y1:s,x2:n,y2:a,stroke:"red",strokeWidth:"10",strokeLinecap:"round"})})()})]}),(0,l.jsxs)("div",{className:"flex space-x-4 mt-4",children:[(0,l.jsx)("button",{className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 rounded",onClick:()=>{z.current&&(clearTimeout(z.current),z.current=null),k(o(m)),T("".concat(H[M],"'s turn")),L(null),R(!1)},children:"Restart"}),(0,l.jsx)("button",{className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded",onClick:()=>{z.current&&(clearTimeout(z.current),z.current=null),S(null),A(null),k(o(m)),T("Choose X or O"),L(null),R(!1)},children:"Reset"})]}),(0,l.jsxs)("div",{className:"mt-4 text-sm",children:[(0,l.jsxs)("div",{children:["Stats for ",y," ",m,"\xd7",m,":"]}),(0,l.jsxs)("div",{children:["Wins: ",(null==(e=W[B])?void 0:e.wins)||0," | Losses: ",(null==(r=W[B])?void 0:r.losses)||0," | Draws: ",(null==(t=W[B])?void 0:t.draws)||0]})]})]})};function y(){return(0,l.jsx)(n.default,{gameId:"tictactoe",children:(0,l.jsx)(p,{})})}}}]);