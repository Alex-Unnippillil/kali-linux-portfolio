"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7021],{97021:(e,a,l)=>{l.r(a),l.d(a,{default:()=>W});var t=l(37876),s=l(14232),n=l(70994),r=l(95220);let i=[[0,1],[1,0],[1,1],[1,-1]],c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return Array.from({length:e},()=>Array(e).fill(null))},o=(e,a,l)=>a>=0&&a<e&&l>=0&&l<e,d=(e,a,l,t,s,n)=>{let r=e.length,i=1,c=0,d=a+s,u=l+n;for(;o(r,d,u)&&e[d][u]===t;)i+=1,d+=s,u+=n;for(o(r,d,u)&&null===e[d][u]&&(c+=1),d=a-s,u=l-n;o(r,d,u)&&e[d][u]===t;)i+=1,d-=s,u-=n;return o(r,d,u)&&null===e[d][u]&&(c+=1),{count:i,openEnds:c}},u=e=>{let{count:a,openEnds:l}=e;return a>=5?1e6:4===a?2===l?5e4:1e4:3===a?2===l?2e3:400:2===a&&2===l?120:10},h=function(e,a,l){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=e.length,n=0;for(let r=a-t;r<=a+t;r+=1)for(let i=l-t;i<=l+t;i+=1)o(s,r,i)&&(r!==a||i!==l)&&null!==e[r][i]&&(n+=1);return n},m=(e,a,l,t,s)=>{let n=i.map(s=>u(d(e,a,l,t,s[0],s[1]))),r=i.map(t=>u(d(e,a,l,s,t[0],t[1]))),c=Math.max(...n),o=Math.max(...r),m=h(e,a,l,2);return{row:a,col:l,attack:c,defense:o,heuristic:2*c+1.6*o+15*m}},x=["casual","balanced","advanced"],f=function(e,a,l){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"balanced",s=e.length,n=[];for(let t=0;t<s;t+=1)for(let r=0;r<s;r+=1)null===e[t][r]&&n.push(m(e,t,r,a,l));if(0===n.length)return null;let r=n.filter(e=>e.attack>=1e6);if(r.length>0){let e=r[Math.floor(Math.random()*r.length)];return{row:e.row,col:e.col}}let i=n.filter(e=>e.defense>=1e6);if(i.length>0){i.sort((e,a)=>a.defense-e.defense);let e=i[0];return{row:e.row,col:e.col}}if(n.sort((e,a)=>a.heuristic-e.heuristic),"advanced"===t||n.length<=2){let e=n[0];return{row:e.row,col:e.col}}if("casual"===t){let e=Math.min(5,n.length),a=n[Math.floor(Math.random()*e)];return{row:a.row,col:a.col}}let c=Math.min(3,n.length),o=n[.75>Math.random()?0:Math.floor(Math.random()*c)];return{row:o.row,col:o.col}},b=()=>({ai:{playerWins:0,aiWins:0,draws:0,streak:0,bestStreak:0},local:{blackWins:0,whiteWins:0,draws:0},totalGames:0,lastWinner:null}),g=e=>"number"==typeof e&&Number.isFinite(e)&&e>=0,p=e=>!!e&&"object"==typeof e&&(e=>!!e&&"object"==typeof e&&g(e.playerWins)&&g(e.aiWins)&&g(e.draws)&&g(e.streak)&&g(e.bestStreak))(e.ai)&&(e=>!!e&&"object"==typeof e&&g(e.blackWins)&&g(e.whiteWins)&&g(e.draws))(e.local)&&g(e.totalGames)&&(e=>null===e||"draw"===e||"black"===e||"white"===e)(e.lastWinner),w=e=>"black"===e?"white":"black",j={black:"Black",white:"White"},k={casual:"Casual",balanced:"Balanced",advanced:"Advanced"},y=[{id:"ai",label:"AI Match"},{id:"local",label:"Local (2 players)"}],v=[{id:"black",label:"Play First (Black)"},{id:"white",label:"Play Second (White)"}],N=(e,a)=>"".concat(e,"-").concat(a),W=()=>{let[e,a]=(0,r.default)("gomoku:stats",b,p),[l,d]=(0,r.default)("gomoku:mode","ai",e=>"ai"===e||"local"===e),[u,h]=(0,r.default)("gomoku:difficulty","balanced",e=>x.includes(e)),[m,g]=(0,r.default)("gomoku:human","black",e=>"black"===e||"white"===e),[W,S]=(0,r.default)("gomoku:sound",!0,e=>"boolean"==typeof e),[C,M]=(0,s.useState)(()=>c()),[A,T]=(0,s.useState)("black"),[B,G]=(0,s.useState)(null),[E,I]=(0,s.useState)([]),[D,F]=(0,s.useState)("Black to move"),[R,_]=(0,s.useState)(!1),[O,P]=(0,s.useState)(null),V="ai"===l?w(m):null,Y=(0,s.useRef)(null),q=(0,s.useRef)(null),L=(0,s.useMemo)(()=>E&&0!==E.length?new Set(E.map(e=>N(e.row,e.col))):new Set,[E]),z="ai"===l?e.ai.streak:void 0,H=e.ai.bestStreak,J=(0,s.useCallback)(()=>{q.current&&(clearTimeout(q.current),q.current=null)},[]),K=(0,s.useCallback)(()=>{if(!W)return;let e=window.AudioContext||window.webkitAudioContext;if(!e)return;let a=Y.current||new e;Y.current=a;let l=a.createOscillator(),t=a.createGain();l.type="sine",l.frequency.setValueAtTime(440,a.currentTime),t.gain.setValueAtTime(.2,a.currentTime),t.gain.exponentialRampToValueAtTime(.001,a.currentTime+.18),l.connect(t),t.connect(a.destination),l.start(),l.stop(a.currentTime+.2)},[W]),Q=(0,s.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"black";J(),M(c()),T(e),G(null),I([]),F("".concat(j[e]," to move")),_(!1),P(null)},[J]);(0,s.useEffect)(()=>Q("black"),[l,m,u,Q]),(0,s.useEffect)(()=>()=>J(),[J]);let U=(0,s.useCallback)(e=>{G(e),"draw"===e?F("Draw game"):F("".concat(j[e]," wins!")),a(a=>((e,a,l,t)=>{let s={ai:{...e.ai},local:{...e.local},totalGames:e.totalGames+1,lastWinner:l};if("ai"===a)if("draw"===l)s.ai.draws+=1,s.ai.streak=0;else if(l===t){s.ai.playerWins+=1;let e=s.ai.streak+1;s.ai.streak=e,e>s.ai.bestStreak&&(s.ai.bestStreak=e)}else s.ai.aiWins+=1,s.ai.streak=0;else"draw"===l?s.local.draws+=1:"black"===l?s.local.blackWins+=1:s.local.whiteWins+=1;return s})(a,l,e,m)),_(!1)},[m,l,a]),X=(0,s.useCallback)((e,a,t)=>{if(B||null!==C[e][a]||"ai"===l&&V&&t!==m&&t!==V)return;let s=C.map(e=>e.slice());s[e][a]=t,M(s),P({row:e,col:a,player:t}),K();let n=((e,a,l,t)=>{let s=e.length;for(let[n,r]of i){let i=[{row:a,col:l}],c=a+n,d=l+r;for(;o(s,c,d)&&e[c][d]===t;)i.push({row:c,col:d}),c+=n,d+=r;for(c=a-n,d=l-r;o(s,c,d)&&e[c][d]===t;)i.unshift({row:c,col:d}),c-=n,d-=r;if(i.length>=5)return{winner:t,line:i}}return null})(s,e,a,t);if(n){I(n.line),U(t);return}if(s.every(e=>e.every(e=>null!==e)))return void U("draw");let r=w(t);T(r),F("".concat(j[r]," to move"))},[V,C,U,m,l,K,B]),Z="ai"===l?A===m&&!B:!B;(0,s.useEffect)(()=>{if("ai"===l&&V&&!B&&A===V&&!R)return _(!0),q.current=setTimeout(()=>{let e=f(C,V,m,u);e&&X(e.row,e.col,V),_(!1)},350),()=>J()},[R,V,C,J,A,u,X,m,l,B]);let $=(0,s.useMemo)(()=>({gridTemplateColumns:"repeat(".concat(15,", minmax(1.75rem, 1fr))")}),[]),ee="You (".concat(j[m],") vs AI (").concat(j[V||"white"],")");return(0,t.jsx)(n.default,{gameId:"gomoku",score:z,highScore:H,children:(0,t.jsxs)("div",{className:"h-full w-full flex flex-col bg-ub-cool-grey text-white p-4 overflow-auto",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("span",{className:"uppercase tracking-wide text-gray-300",children:"Mode"}),(0,t.jsx)("select",{value:l,onChange:e=>d(e.target.value),className:"rounded bg-gray-800 px-2 py-1 text-white",children:y.map(e=>(0,t.jsx)("option",{value:e.id,children:e.label},e.id))})]}),"ai"===l&&(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("span",{className:"uppercase tracking-wide text-gray-300",children:"Difficulty"}),(0,t.jsx)("select",{value:u,onChange:e=>h(e.target.value),className:"rounded bg-gray-800 px-2 py-1 text-white",children:x.map(e=>(0,t.jsx)("option",{value:e,children:k[e]},e))})]}),"ai"===l&&(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("span",{className:"uppercase tracking-wide text-gray-300",children:"Side"}),(0,t.jsx)("select",{value:m,onChange:e=>g(e.target.value),className:"rounded bg-gray-800 px-2 py-1 text-white",children:v.map(e=>(0,t.jsx)("option",{value:e.id,children:e.label},e.id))})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsx)("button",{type:"button",className:"rounded bg-gray-800 px-3 py-1 text-sm hover:bg-gray-700",onClick:()=>Q("black"),children:"Reset Board"}),(0,t.jsxs)("button",{type:"button",className:"rounded bg-gray-800 px-3 py-1 text-sm hover:bg-gray-700",onClick:()=>S(e=>!e),children:["Sound ",W?"On":"Off"]}),(0,t.jsx)("button",{type:"button",className:"rounded bg-gray-800 px-3 py-1 text-sm hover:bg-gray-700",onClick:()=>{a(b())},children:"Clear Stats"})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex flex-col items-center gap-4",children:[(0,t.jsx)("div",{className:"text-lg font-semibold",role:"status",children:D}),"ai"===l&&(0,t.jsx)("div",{className:"text-sm text-gray-300",children:ee}),R&&(0,t.jsx)("div",{className:"text-sm text-yellow-300",children:"AI is thinkingâ€¦"}),(0,t.jsx)("div",{className:"rounded-lg border border-black/40 bg-gradient-to-br from-amber-700 to-amber-900 p-3 shadow-inner",children:(0,t.jsx)("div",{className:"grid gap-[3px]",style:$,children:C.map((e,a)=>e.map((e,l)=>((e,a,l)=>{let s=N(a,l),n=L.has(s),r=O&&O.row===a&&O.col===l;return(0,t.jsx)("button",{type:"button",className:"relative h-7 w-7 sm:h-8 sm:w-8 md:h-9 md:w-9 border border-black/30 flex items-center justify-center rounded-sm focus:outline-none focus:ring-2 focus:ring-yellow-300/70 transition-colors ".concat(n?"bg-yellow-500/40":"bg-amber-800/70 hover:bg-amber-700/80"),"aria-label":"Place stone at row ".concat(a+1,", column ").concat(l+1),onClick:()=>{Z&&!R&&X(a,l,A)},disabled:!!e||!Z||R||!!B,children:e&&(0,t.jsx)("div",{className:"h-5 w-5 sm:h-6 sm:w-6 md:h-7 md:w-7 rounded-full shadow-inner ".concat("black"===e?"bg-black":"bg-white"," ").concat(r?"ring-2 ring-cyan-400":"")})},s)})(e,a,l)))})}),(0,t.jsxs)("div",{className:"grid w-full max-w-xl gap-3 rounded-lg bg-gray-900/40 p-3 text-sm",children:["ai"===l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"You"}),(0,t.jsx)("span",{children:e.ai.playerWins})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"AI"}),(0,t.jsx)("span",{children:e.ai.aiWins})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Draws"}),(0,t.jsx)("span",{children:e.ai.draws})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Current Streak"}),(0,t.jsx)("span",{children:e.ai.streak})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Best Streak"}),(0,t.jsx)("span",{children:e.ai.bestStreak})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Black Wins"}),(0,t.jsx)("span",{children:e.local.blackWins})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"White Wins"}),(0,t.jsx)("span",{children:e.local.whiteWins})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Draws"}),(0,t.jsx)("span",{children:e.local.draws})]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-gray-300",children:[(0,t.jsx)("span",{children:"Total Games"}),(0,t.jsx)("span",{children:e.totalGames})]})]})]})]})})}}}]);