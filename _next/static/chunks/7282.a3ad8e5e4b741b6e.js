(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7282],{27282:e=>{self,e.exports=(()=>{"use strict";var e={345:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.runAndSubscribe=t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=e=>(this._listeners.push(e),{dispose:()=>{if(!this._disposed){for(let t=0;t<this._listeners.length;t++)if(this._listeners[t]===e)return void this._listeners.splice(t,1)}}})),this._event}fire(e,t){let i=[];for(let e=0;e<this._listeners.length;e++)i.push(this._listeners[e]);for(let s=0;s<i.length;s++)i[s].call(void 0,e,t)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},t.forwardEvent=function(e,t){return e(e=>t.fire(e))},t.runAndSubscribe=function(e,t){return t(void 0),e(e=>t(e))}},859:(e,t)=>{function i(e){for(let t of e)t.dispose();e.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.MutableDisposable=t.Disposable=void 0,t.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){for(let e of(this._isDisposed=!0,this._disposables))e.dispose();this._disposables.length=0}register(e){return this._disposables.push(e),e}unregister(e){let t=this._disposables.indexOf(e);-1!==t&&this._disposables.splice(t,1)}},t.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}},t.toDisposable=function(e){return{dispose:e}},t.disposeArray=i,t.getDisposeArrayDisposable=function(e){return{dispose:()=>i(e)}}}},t={};function i(s){var r=t[s];if(void 0!==r)return r.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,i),o.exports}var s={};return(()=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SearchAddon=void 0;let e=i(345),t=i(859),r=" ~!@#$%^&*()+`-=[]{}|\\;:\"',./<>?";class o extends t.Disposable{constructor(i){super(),this._highlightedLines=new Set,this._highlightDecorations=[],this._selectedDecoration=this.register(new t.MutableDisposable),this._linesCacheTimeoutId=0,this._linesCacheDisposables=new t.MutableDisposable,this._onDidChangeResults=this.register(new e.EventEmitter),this.onDidChangeResults=this._onDidChangeResults.event,this._highlightLimit=i?.highlightLimit??1e3}activate(e){this._terminal=e,this.register(this._terminal.onWriteParsed(()=>this._updateMatches())),this.register(this._terminal.onResize(()=>this._updateMatches())),this.register((0,t.toDisposable)(()=>this.clearDecorations()))}_updateMatches(){this._highlightTimeout&&window.clearTimeout(this._highlightTimeout),this._cachedSearchTerm&&this._lastSearchOptions?.decorations&&(this._highlightTimeout=setTimeout(()=>{let e=this._cachedSearchTerm;this._cachedSearchTerm=void 0,this.findPrevious(e,{...this._lastSearchOptions,incremental:!0,noScroll:!0})},200))}clearDecorations(e){this._selectedDecoration.clear(),(0,t.disposeArray)(this._highlightDecorations),this._highlightDecorations=[],this._highlightedLines.clear(),e||(this._cachedSearchTerm=void 0)}clearActiveDecoration(){this._selectedDecoration.clear()}findNext(e,t){if(!this._terminal)throw Error("Cannot use addon until it has been loaded");let i=!this._lastSearchOptions||this._didOptionsChange(this._lastSearchOptions,t);this._lastSearchOptions=t,t?.decorations&&(void 0===this._cachedSearchTerm||e!==this._cachedSearchTerm||i)&&this._highlightAllMatches(e,t);let s=this._findNextAndSelect(e,t);return this._fireResults(t),this._cachedSearchTerm=e,s}_highlightAllMatches(e,t){if(!this._terminal)throw Error("Cannot use addon until it has been loaded");if(!e||0===e.length)return void this.clearDecorations();t=t||{},this.clearDecorations(!0);let i=[],s,r=this._find(e,0,0,t);for(;r&&(s?.row!==r.row||s?.col!==r.col)&&!(i.length>=this._highlightLimit);)i.push(s=r),r=this._find(e,s.col+s.term.length>=this._terminal.cols?s.row+1:s.row,s.col+s.term.length>=this._terminal.cols?0:s.col+1,t);for(let e of i){let i=this._createResultDecoration(e,t.decorations);i&&(this._highlightedLines.add(i.marker.line),this._highlightDecorations.push({decoration:i,match:e,dispose(){i.dispose()}}))}}_find(e,t,i,s){let r;if(!this._terminal||!e||0===e.length)return this._terminal?.clearSelection(),void this.clearDecorations();if(i>this._terminal.cols)throw Error(`Invalid col: ${i} to search in terminal of ${this._terminal.cols} cols`);this._initLinesCache();let o={startRow:t,startCol:i};if(!(r=this._findInLine(e,o,s)))for(let i=t+1;i<this._terminal.buffer.active.baseY+this._terminal.rows&&(o.startRow=i,o.startCol=0,!(r=this._findInLine(e,o,s)));i++);return r}_findNextAndSelect(e,t){if(!this._terminal||!e||0===e.length)return this._terminal?.clearSelection(),this.clearDecorations(),!1;let i=this._terminal.getSelectionPosition();this._terminal.clearSelection();let s=0,r=0;i&&(this._cachedSearchTerm===e?(s=i.end.x,r=i.end.y):(s=i.start.x,r=i.start.y)),this._initLinesCache();let o={startRow:r,startCol:s},l=this._findInLine(e,o,t);if(!l)for(let i=r+1;i<this._terminal.buffer.active.baseY+this._terminal.rows&&(o.startRow=i,o.startCol=0,!(l=this._findInLine(e,o,t)));i++);if(!l&&0!==r)for(let i=0;i<r&&(o.startRow=i,o.startCol=0,!(l=this._findInLine(e,o,t)));i++);return!l&&i&&(o.startRow=i.start.y,o.startCol=0,l=this._findInLine(e,o,t)),this._selectResult(l,t?.decorations,t?.noScroll)}findPrevious(e,t){if(!this._terminal)throw Error("Cannot use addon until it has been loaded");let i=!this._lastSearchOptions||this._didOptionsChange(this._lastSearchOptions,t);this._lastSearchOptions=t,t?.decorations&&(void 0===this._cachedSearchTerm||e!==this._cachedSearchTerm||i)&&this._highlightAllMatches(e,t);let s=this._findPreviousAndSelect(e,t);return this._fireResults(t),this._cachedSearchTerm=e,s}_didOptionsChange(e,t){return!!t&&(e.caseSensitive!==t.caseSensitive||e.regex!==t.regex||e.wholeWord!==t.wholeWord)}_fireResults(e){if(e?.decorations){let e=-1;if(this._selectedDecoration.value){let t=this._selectedDecoration.value.match;for(let i=0;i<this._highlightDecorations.length;i++){let s=this._highlightDecorations[i].match;if(s.row===t.row&&s.col===t.col&&s.size===t.size){e=i;break}}}this._onDidChangeResults.fire({resultIndex:e,resultCount:this._highlightDecorations.length})}}_findPreviousAndSelect(e,t){let i;if(!this._terminal)throw Error("Cannot use addon until it has been loaded");if(!this._terminal||!e||0===e.length)return this._terminal?.clearSelection(),this.clearDecorations(),!1;let s=this._terminal.getSelectionPosition();this._terminal.clearSelection();let r=this._terminal.buffer.active.baseY+this._terminal.rows-1,o=this._terminal.cols;this._initLinesCache();let l={startRow:r,startCol:o};if(s&&(l.startRow=r=s.start.y,l.startCol=o=s.start.x,this._cachedSearchTerm!==e&&((i=this._findInLine(e,l,t,!1))||(l.startRow=r=s.end.y,l.startCol=o=s.end.x))),i||(i=this._findInLine(e,l,t,!0)),!i){l.startCol=Math.max(l.startCol,this._terminal.cols);for(let s=r-1;s>=0&&(l.startRow=s,!(i=this._findInLine(e,l,t,!0)));s--);}if(!i&&r!==this._terminal.buffer.active.baseY+this._terminal.rows-1)for(let s=this._terminal.buffer.active.baseY+this._terminal.rows-1;s>=r&&(l.startRow=s,!(i=this._findInLine(e,l,t,!0)));s--);return this._selectResult(i,t?.decorations,t?.noScroll)}_initLinesCache(){let e=this._terminal;this._linesCache||(this._linesCache=Array(e.buffer.active.length),this._linesCacheDisposables.value=(0,t.getDisposeArrayDisposable)([e.onLineFeed(()=>this._destroyLinesCache()),e.onCursorMove(()=>this._destroyLinesCache()),e.onResize(()=>this._destroyLinesCache())])),window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=window.setTimeout(()=>this._destroyLinesCache(),15e3)}_destroyLinesCache(){this._linesCache=void 0,this._linesCacheDisposables.clear(),this._linesCacheTimeoutId&&(window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=0)}_isWholeWord(e,t,i){return(0===e||r.includes(t[e-1]))&&(e+i.length===t.length||r.includes(t[e+i.length]))}_findInLine(e,t,i={},s=!1){let r=this._terminal,o=t.startRow,l=t.startCol,n=r.buffer.active.getLine(o);if(n?.isWrapped)return s?void(t.startCol+=r.cols):(t.startRow--,t.startCol+=r.cols,this._findInLine(e,t,i));let h=this._linesCache?.[o];h||(h=this._translateBufferLineToStringWithWrap(o,!0),this._linesCache&&(this._linesCache[o]=h));let[a,c]=h,d=this._bufferColsToStringOffset(o,l),_=i.caseSensitive?e:e.toLowerCase(),u=i.caseSensitive?a:a.toLowerCase(),f=-1;if(i.regex){let t,i=RegExp(_,"g");if(s)for(;t=i.exec(u.slice(0,d));)f=i.lastIndex-t[0].length,e=t[0],i.lastIndex-=e.length-1;else(t=i.exec(u.slice(d)))&&t[0].length>0&&(f=d+(i.lastIndex-t[0].length),e=t[0])}else s?d-_.length>=0&&(f=u.lastIndexOf(_,d-_.length)):f=u.indexOf(_,d);if(f>=0){if(i.wholeWord&&!this._isWholeWord(f,u,e))return;let t=0;for(;t<c.length-1&&f>=c[t+1];)t++;let s=t;for(;s<c.length-1&&f+e.length>=c[s+1];)s++;let l=f-c[t],n=f+e.length-c[s],h=this._stringLengthToBufferSize(o+t,l);return{term:e,col:h,row:o+t,size:this._stringLengthToBufferSize(o+s,n)-h+r.cols*(s-t)}}}_stringLengthToBufferSize(e,t){let i=this._terminal.buffer.active.getLine(e);if(!i)return 0;for(let e=0;e<t;e++){let s=i.getCell(e);if(!s)break;let r=s.getChars();r.length>1&&(t-=r.length-1);let o=i.getCell(e+1);o&&0===o.getWidth()&&t++}return t}_bufferColsToStringOffset(e,t){let i=this._terminal,s=e,r=0,o=i.buffer.active.getLine(s);for(;t>0&&o;){for(let e=0;e<t&&e<i.cols;e++){let t=o.getCell(e);if(!t)break;t.getWidth()&&(r+=0===t.getCode()?1:t.getChars().length)}if(s++,(o=i.buffer.active.getLine(s))&&!o.isWrapped)break;t-=i.cols}return r}_translateBufferLineToStringWithWrap(e,t){let i=this._terminal,s=[],r=[0],o=i.buffer.active.getLine(e);for(;o;){let l=i.buffer.active.getLine(e+1),n=!!l&&l.isWrapped,h=o.translateToString(!n&&t);if(n&&l){let e=o.getCell(o.length-1);e&&0===e.getCode()&&1===e.getWidth()&&2===l.getCell(0)?.getWidth()&&(h=h.slice(0,-1))}if(s.push(h),!n)break;r.push(r[r.length-1]+h.length),e++,o=l}return[s.join(""),r]}_selectResult(e,i,s){let r=this._terminal;if(this._selectedDecoration.clear(),!e)return r.clearSelection(),!1;if(r.select(e.col,e.row,e.size),i){let s=r.registerMarker(-r.buffer.active.baseY-r.buffer.active.cursorY+e.row);if(s){let o=r.registerDecoration({marker:s,x:e.col,width:e.size,backgroundColor:i.activeMatchBackground,layer:"top",overviewRulerOptions:{color:i.activeMatchColorOverviewRuler}});if(o){let r=[];r.push(s),r.push(o.onRender(e=>this._applyStyles(e,i.activeMatchBorder,!0))),r.push(o.onDispose(()=>(0,t.disposeArray)(r))),this._selectedDecoration.value={decoration:o,match:e,dispose(){o.dispose()}}}}}if(!s&&(e.row>=r.buffer.active.viewportY+r.rows||e.row<r.buffer.active.viewportY)){let t=e.row-r.buffer.active.viewportY;t-=Math.floor(r.rows/2),r.scrollLines(t)}return!0}_applyStyles(e,t,i){e.classList.contains("xterm-find-result-decoration")||(e.classList.add("xterm-find-result-decoration"),t&&(e.style.outline=`1px solid ${t}`)),i&&e.classList.add("xterm-find-active-result-decoration")}_createResultDecoration(e,i){let s=this._terminal,r=s.registerMarker(-s.buffer.active.baseY-s.buffer.active.cursorY+e.row);if(!r)return;let o=s.registerDecoration({marker:r,x:e.col,width:e.size,backgroundColor:i.matchBackground,overviewRulerOptions:this._highlightedLines.has(r.line)?void 0:{color:i.matchOverviewRuler,position:"center"}});if(o){let e=[];e.push(r),e.push(o.onRender(e=>this._applyStyles(e,i.matchBorder,!1))),e.push(o.onDispose(()=>(0,t.disposeArray)(e)))}return o}}s.SearchAddon=o})(),s})()}}]);