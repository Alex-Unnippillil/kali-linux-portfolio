"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4378],{4378:(e,t,r)=>{r.r(t),r.d(t,{default:()=>D});var a=r(37876),s=r(14232);let l=(e,t,r,a)=>{let s=e[r],l=t.filter(e=>e.offset!==r),o="string"==typeof a?a.trim().slice(0,2).toLowerCase():"";return void 0!==s&&/^[0-9a-f]{2}$/i.test(o)&&s.toLowerCase()!==o&&l.push({offset:r,original:s,value:o}),l},o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;if(!Array.isArray(e))return{patches:[],errors:["Import must be a JSON array of patches."]};let r=[],a=[];return e.forEach((e,s)=>{if(!e||"object"!=typeof e)return void r.push("Patch ".concat(s+1," must be an object."));let{offset:l,value:o,original:n}=e;return!Number.isInteger(l)||l<0?void r.push("Patch ".concat(s+1," has an invalid offset.")):l>=t?void r.push("Patch ".concat(s+1," offset exceeds file length.")):"string"==typeof o&&/^[0-9a-f]{2}$/i.test(o.trim())?void 0===n||"string"==typeof n&&/^[0-9a-f]{2}$/i.test(n.trim())?void a.push({offset:l,value:o.trim().toLowerCase(),original:"string"==typeof n?n.trim().toLowerCase():void 0}):void r.push("Patch ".concat(s+1," has an invalid original byte.")):void r.push("Patch ".concat(s+1," has an invalid value."))}),{patches:a,errors:r}},n=e=>{if("number"==typeof e&&Number.isFinite(e))return e;if("string"!=typeof e)return null;let t=e.trim().toLowerCase();if(!t)return null;let r=t.startsWith("0x")?t.slice(2):t;return/^[0-9a-f]+$/.test(r)?parseInt(r,16):null},c=e=>{if("string"==typeof e){let t=n(e);return null===t?null:"0x".concat(t.toString(16))}return"number"==typeof e&&Number.isFinite(e)?"0x".concat(e.toString(16)):null},i="r2-notes-",d="r2-bookmarks-",u="r2-patches-",p=e=>{try{return localStorage.getItem(e)}catch(e){return null}},x=(e,t)=>{try{localStorage.setItem(e,t)}catch(e){}},m=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0x0",r=(e.match(/.{1,2}/g)||[]).map(e=>parseInt(e,16)),a=parseInt(t,16)||0,s=[],l=e=>e>=32&&e<=126;for(let e=0;e<r.length;e++){if(l(r[e])&&0===r[e+1]){let t=e,o="";for(;t+1<r.length&&l(r[t])&&0===r[t+1];)o+=String.fromCharCode(r[t]),t+=2;if(o.length>=2){s.push({addr:"0x"+(a+e).toString(16),text:o}),e=t-1;continue}}if(l(r[e])){let t=e,o="";for(;t<r.length&&l(r[t]);)o+=String.fromCharCode(r[t]),t++;o.length>=4&&s.push({addr:"0x"+(a+e).toString(16),text:o}),e=t-1}}return s},b=(e,t)=>e.length===t.length&&e.every((e,r)=>e.offset===t[r].offset&&e.value===t[r].value&&e.original===t[r].original),h=e=>{let{hex:t,theme:i,file:d,baseAddress:m,onPatchesChange:h,onSelectAddress:f}=e,[g,y]=(0,s.useState)([]),[v,j]=(0,s.useState)([]),[N,k]=(0,s.useState)([]),[C,w]=(0,s.useState)([]),[S,E]=(0,s.useState)(!1),[M,R]=(0,s.useState)(!1),[L,T]=(0,s.useState)(null),[A,P]=(0,s.useState)(!1),[D,F]=(0,s.useState)(""),[I,O]=(0,s.useState)(""),[_,B]=(0,s.useState)([]),[J,U]=(0,s.useState)(""),K=(0,s.useRef)(null),V=(0,s.useRef)(null),H=(0,s.useRef)(null),W=(0,s.useRef)(!1),z=(0,s.useRef)(!0),q=(0,s.useRef)({surface:"#374151",accent:"#fbbf24",text:"#ffffff",border:"#4b5563"}),$=n(m)||0,G="function"==typeof Worker,X=(0,s.useMemo)(()=>(t||"").replace(/[^0-9a-fA-F]/g,"").match(/.{1,2}/g)||[],[t]),Y=(0,s.useMemo)(()=>{let e=new Map;return v.forEach(t=>{e.set(t.offset,t)}),e},[v]),Z=(0,s.useMemo)(()=>G?g:((e,t)=>{let r=[...e];return t.forEach(e=>{let{offset:t,value:a}=e;t>=0&&t<r.length&&(r[t]=a)}),r})(X,v),[X,g,G,v]);(0,s.useEffect)(()=>{let e=getComputedStyle(document.documentElement);q.current={surface:e.getPropertyValue("--r2-surface").trim()||"#374151",accent:e.getPropertyValue("--r2-accent").trim()||"#fbbf24",text:e.getPropertyValue("--r2-text").trim()||"#ffffff",border:e.getPropertyValue("--r2-border").trim()||"#4b5563"}},[i]),(0,s.useEffect)(()=>{W.current=window.matchMedia("(prefers-reduced-motion: reduce)").matches},[]),(0,s.useEffect)(()=>{if(G)return K.current=new Worker(r.tu(new URL(r.p+r.u(8116),r.b))),K.current.onmessage=e=>{let{type:t,bytes:r=[],patches:a=[],canUndo:s,canRedo:l}=e.data||{};if("bytes"===t)y(r),j(a),E(!!s),R(!!l);else if("export"===t){let e=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="".concat(d||"patches",".json"),r.click(),URL.revokeObjectURL(t)}},()=>{var e;return null==(e=K.current)?void 0:e.terminate()}},[G,d]),(0,s.useEffect)(()=>{if(!G)return;let e=()=>{var e;if("undefined"==typeof document)return;let t="visible"===document.visibilityState;z.current=t,null==(e=K.current)||e.postMessage({type:t?"resume":"pause"})};if("undefined"!=typeof document)return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[G]),(0,s.useEffect)(()=>{G&&K.current&&z.current&&K.current.postMessage({type:"hex",hex:t}),G||y(X)},[X,G,t]),(0,s.useEffect)(()=>{if(!d)return;let e=(e=>{let t=p(u+e);if(!t)return[];try{let e=JSON.parse(t);return Array.isArray(e)?e:[]}catch(e){return[]}})(d);j(e),k([]),w([]),E(!1),R(!1),G&&K.current&&K.current.postMessage({type:"load",patches:e})},[G,d]),(0,s.useEffect)(()=>{if(!G){let e=v.reduce((e,t)=>l(X,e,t.offset,t.value),[]);b(e,v)||j(e)}},[X,G,v]),(0,s.useEffect)(()=>{d&&x(u+d,JSON.stringify(v)),null==h||h(v)},[d,h,v]),(0,s.useEffect)(()=>{E(N.length>0),R(C.length>0)},[C.length,N.length]),(0,s.useEffect)(()=>{let e,t=()=>{let e=H.current;if(!e)return;let t=e.getContext("2d"),r=Z.length||1;if(t.fillStyle=q.current.surface,t.fillRect(0,0,e.width,e.height),null!==L){let a=L/r;t.fillStyle=q.current.accent,t.fillRect(a*e.width,0,4,e.height)}};return W.current?t():z.current&&(e=requestAnimationFrame(t)),()=>cancelAnimationFrame(e)},[L,Z.length]);let Q=(0,s.useMemo)(()=>{let e=[];for(let t=0;t<Z.length;t+=16)e.push(Z.slice(t,t+16));return e},[Z]),ee=(0,s.useCallback)(e=>{T(e),P(!1),F("");let t=c($+e);t&&(null==f||f(t)),U("Selected byte ".concat(e))},[$,f]),et=(0,s.useCallback)((e,t)=>{if(G&&K.current)return void K.current.postMessage({type:"patch",offset:e,value:t});let r=l(X,v,e,t);b(r,v)||(k(e=>[...e,v]),w([]),j(r))},[X,G,v]),er=()=>{if(G&&K.current)return void K.current.postMessage({type:"undo"});let e=N[N.length-1];e&&(k(e=>e.slice(0,-1)),w(e=>[v,...e]),j(e))},ea=()=>{if(G&&K.current)return void K.current.postMessage({type:"redo"});let e=C[0];e&&(w(e=>e.slice(1)),k(e=>[...e,v]),j(e))},es=e=>{if("Escape"===e.key){e.preventDefault(),P(!1),F("");return}if("Enter"===e.key){if(e.preventDefault(),null===L)return;let t=D.trim().slice(0,2);/^[0-9a-f]{2}$/i.test(t)&&(et(L,t),U("Patched byte ".concat(L))),P(!1),F("")}};return(0,a.jsxs)("div",{className:"mb-6","aria-label":"hex editor",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("div",{ref:V,className:"overflow-auto p-2 rounded max-h-64 flex-1",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},tabIndex:0,onKeyDown:e=>{let t=e.key.toLowerCase(),r=e.metaKey||e.ctrlKey;if(r&&"z"===t){e.preventDefault(),e.shiftKey?ea():er();return}if(r&&"y"===t){e.preventDefault(),ea();return}if(null===L||A)return;let a=L;if("arrowright"===t&&(a+=1),"arrowleft"===t&&(a-=1),"arrowdown"===t&&(a+=16),"arrowup"===t&&(a-=16),"enter"===t){e.preventDefault(),P(!0),F(Z[L]||"");return}if(a!==L&&(e.preventDefault(),a>=0&&a<Z.length)){ee(a);let e=Math.floor(a/16);V.current&&(V.current.scrollTop=24*e)}},"aria-label":"Hex bytes",children:(0,a.jsx)("div",{className:"text-xs font-mono",children:Q.map((e,t)=>(0,a.jsxs)("div",{className:"flex mb-1",children:[(0,a.jsx)("span",{className:"w-14 text-right pr-2 text-[11px] opacity-70",children:c($+16*t)}),e.map((e,r)=>{let s=16*t+r,l=s===L,o=Y.get(s),n=e||"00";return(0,a.jsx)("button",{type:"button",onClick:()=>ee(s),onDoubleClick:()=>{T(s),P(!0),F(n)},className:"w-7 h-6 flex items-center justify-center rounded focus:outline-none focus-visible:ring-2",style:{backgroundColor:l?"var(--r2-accent)":o?"color-mix(in srgb, var(--r2-accent) 30%, transparent)":"var(--r2-surface)",color:l?"#000":"var(--r2-text)","--tw-ring-color":"var(--r2-accent)",marginLeft:8===r?"0.5rem":void 0},"aria-label":"Byte ".concat(s," value ").concat(n),children:l&&A?(0,a.jsx)("input",{value:D,onChange:e=>F(e.target.value.replace(/[^0-9a-fA-F]/g,"")),onKeyDown:es,className:"w-6 bg-transparent text-center outline-none",maxLength:2,autoFocus:!0}):n},s)})]},t))})}),(0,a.jsx)("canvas",{ref:H,width:64,height:64,onClick:e=>{let t=H.current;if(!t||!V.current)return;let r=t.getBoundingClientRect(),a=(e.clientX-r.left)/t.width,s=Math.floor(Z.length*a/16);V.current.scrollTop=24*s},className:"rounded cursor-pointer",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},"aria-label":"hex mini map"})]}),(0,a.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2 text-sm",children:[(0,a.jsx)("button",{type:"button",onClick:er,disabled:!S,className:"px-3 py-1 rounded disabled:opacity-50",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},children:"Undo (Ctrl/Cmd+Z)"}),(0,a.jsx)("button",{type:"button",onClick:ea,disabled:!M,className:"px-3 py-1 rounded disabled:opacity-50",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},children:"Redo (Ctrl/Cmd+Shift+Z)"}),(0,a.jsx)("button",{type:"button",onClick:()=>{if(G&&K.current)return void K.current.postMessage({type:"export"});let e=new Blob([JSON.stringify(v,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="".concat(d||"patches",".json"),r.click(),URL.revokeObjectURL(t)},className:"px-3 py-1 rounded",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},children:"Export Patches"}),(0,a.jsx)("button",{type:"button",onClick:()=>{if(G&&K.current)return void K.current.postMessage({type:"clear"});v.length>0&&(k(e=>[...e,v]),w([]),j([]))},className:"px-3 py-1 rounded",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},children:"Clear All"})]}),(0,a.jsxs)("div",{className:"mt-4 grid gap-3 lg:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wide",children:"Patch Ledger"}),0===v.length?(0,a.jsx)("p",{className:"text-sm opacity-70",children:"No patches staged."}):(0,a.jsx)("ul",{className:"space-y-2 text-sm",children:v.map(e=>(0,a.jsxs)("li",{className:"flex items-center justify-between gap-3 rounded px-2 py-1",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},children:[(0,a.jsxs)("div",{className:"font-mono text-xs",children:[(0,a.jsx)("div",{children:c($+e.offset)}),(0,a.jsxs)("div",{children:[e.original||X[e.offset]," →"," ",e.value]})]}),(0,a.jsx)("button",{type:"button",onClick:()=>(e=>{if(G&&K.current)return void K.current.postMessage({type:"revert",offset:e});let t=v.filter(t=>t.offset!==e);b(t,v)||(k(e=>[...e,v]),w([]),j(t))})(e.offset),className:"text-xs underline",children:"Revert"})]},e.offset))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wide",children:"Import Patches"}),(0,a.jsx)("textarea",{value:I,onChange:e=>O(e.target.value),rows:4,placeholder:'[{"offset":4,"value":"90"}]',className:"w-full rounded p-2 text-sm",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)",color:"var(--r2-text)"}}),(0,a.jsx)("button",{type:"button",onClick:()=>{let e;B([]);try{e=JSON.parse(I)}catch(e){B(["Import is not valid JSON."]);return}let{patches:t,errors:r}=o(e,X.length);if(r.length)return void B(r);G&&K.current?K.current.postMessage({type:"import",patches:t}):(k(e=>[...e,v]),w([]),j(t)),O(""),U("Imported ".concat(t.length," patches"))},className:"px-3 py-1 rounded",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},children:"Import JSON"}),_.length>0&&(0,a.jsx)("ul",{className:"text-xs text-red-300 space-y-1",children:_.map(e=>(0,a.jsx)("li",{children:e},e))})]})]}),(0,a.jsx)("div",{"aria-live":"polite",className:"sr-only",children:J})]})};var f=r(18847);let g=r.n(f)()(()=>Promise.all([r.e(7544),r.e(7391),r.e(5334),r.e(9162),r.e(6888)]).then(r.bind(r,96888)).then(e=>e.ForceGraph2D),{loadableGenerated:{webpack:()=>[96888]},ssr:!1}),y=e=>{var t;let{blocks:r,theme:l}=e,o=(0,s.useRef)(null),[n,c]=(0,s.useState)({x:0,y:0}),[i,d]=(0,s.useState)(null),[u,p]=(0,s.useState)({bg:"#000",surface:"#374151",text:"#fff",accent:"#fbbf24",border:"#4b5563"}),x=(0,s.useMemo)(()=>{let e=r.map(e=>({id:e.addr})),t=[];return r.forEach(e=>(e.edges||[]).forEach(r=>t.push({source:e.addr,target:r}))),{nodes:e,links:t}},[r]);(0,s.useEffect)(()=>{let e=getComputedStyle(document.documentElement);p({bg:e.getPropertyValue("--r2-bg").trim()||"#000",surface:e.getPropertyValue("--r2-surface").trim()||"#374151",text:e.getPropertyValue("--r2-text").trim()||"#fff",accent:e.getPropertyValue("--r2-accent").trim()||"#fbbf24",border:e.getPropertyValue("--r2-border").trim()||"#4b5563"})},[l]),(0,s.useEffect)(()=>{let e=o.current;if(e){e.zoomToFit(400,20);let t=e.getGraphBbox();c({x:t.x+t.width/2,y:t.y+t.height/2})}},[x]);let m=(e,t)=>{let r=o.current;r&&c(a=>{let s=a.x+e,l=a.y+t;return r.centerAt(s,l,200),{x:s,y:l}})},b=(e,t,r,a,s,l)=>{e.beginPath(),e.moveTo(t+l,r),e.lineTo(t+a-l,r),e.quadraticCurveTo(t+a,r,t+a,r+l),e.lineTo(t+a,r+s-l),e.quadraticCurveTo(t+a,r+s,t+a-l,r+s),e.lineTo(t+l,r+s),e.quadraticCurveTo(t,r+s,t,r+s-l),e.lineTo(t,r+l),e.quadraticCurveTo(t,r,t+l,r),e.closePath()},h=e=>i&&"string"!=typeof e.source&&e.source.id===i.addr?u.accent:u.border;return(0,a.jsxs)("div",{className:"h-full w-full",children:[(0,a.jsxs)("div",{className:"flex gap-2 mb-2 flex-wrap",children:[(0,a.jsx)("button",{onClick:()=>{let e=o.current;if(!e)return;let t=e.zoom();e.zoom(1.2*t,200)},className:"px-2 py-1 rounded",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},children:"+"}),(0,a.jsx)("button",{onClick:()=>{let e=o.current;if(!e)return;let t=e.zoom();e.zoom(t/1.2,200)},className:"px-2 py-1 rounded",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},children:"-"}),(0,a.jsx)("button",{onClick:()=>m(0,-20),className:"px-2 py-1 rounded",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},children:"↑"}),(0,a.jsx)("button",{onClick:()=>m(0,20),className:"px-2 py-1 rounded",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},children:"↓"}),(0,a.jsx)("button",{onClick:()=>m(-20,0),className:"px-2 py-1 rounded",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},children:"←"}),(0,a.jsx)("button",{onClick:()=>m(20,0),className:"px-2 py-1 rounded",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},children:"→"})]}),(0,a.jsx)("div",{className:"h-64 rounded",style:{backgroundColor:"var(--r2-surface)"},children:(0,a.jsx)(g,{ref:o,graphData:x,backgroundColor:u.surface,linkColor:h,linkWidth:e=>i&&"string"!=typeof e.source&&e.source.id===i.addr?2:1,linkDirectionalArrowLength:4,linkDirectionalArrowRelPos:1,linkDirectionalArrowColor:h,nodeCanvasObject:(e,t,r)=>{let a=e.id,s=12/r,l=i&&i.addr===e.id;t.font="".concat(s,"px Sans-Serif");let o=t.measureText(a).width+8,n=s+6,c=e.x-o/2,d=e.y-n/2;t.fillStyle=l?u.accent:u.surface,t.strokeStyle=u.accent,t.lineWidth=1,b(t,c,d,o,n,6),t.fill(),t.stroke(),t.fillStyle=l?"#000":u.text,t.textAlign="center",t.textBaseline="middle",t.fillText(a,e.x,e.y)},nodePointerAreaPaint:(e,t,r,a)=>{let s=e.id,l=12/a;r.font="".concat(l,"px Sans-Serif");let o=r.measureText(s).width+8,n=l+6;b(r,e.x-o/2,e.y-n/2,o,n,6),r.fillStyle=t,r.fill()},onNodeClick:e=>{d(r.find(t=>t.addr===e.id)||null)}})}),i&&(0,a.jsxs)("div",{className:"mt-2 p-2 rounded text-sm",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},children:[(0,a.jsxs)("div",{children:["Block: ",i.addr]}),(0,a.jsxs)("div",{children:["Outgoing edges: ",(null==(t=i.edges)?void 0:t.join(", "))||"None"]})]})]})},v=["S1: This is a simulated Radare2 workspace. All data is local and deterministic.","S2: Use the Disassembly tab to browse instructions and set bookmarks.","S3: Open Hex to edit bytes inline and track patches in the ledger.","S4: Explore Strings and Xrefs to jump between addresses.","S5: Record notes for later review in the Notes tab."];function j(e){let{onClose:t}=e,[r,l]=(0,s.useState)(0),[o,n]=(0,s.useState)(!1),c=(0,s.useRef)(null),i=(0,s.useRef)(null),d=(0,s.useRef)(null),u=(0,s.useRef)(null);(0,s.useEffect)(()=>{var e;"undefined"!=typeof document&&(u.current=document.activeElement),null==(e=i.current)||e.focus()},[]);let p=()=>{if(o)try{localStorage.setItem("r2HelpDismissed","true")}catch(e){}u.current&&u.current.focus&&u.current.focus(),t()},x=()=>l(e=>Math.max(0,e-1)),m=()=>l(e=>Math.min(v.length-1,e+1));return(0,a.jsx)("div",{ref:c,tabIndex:-1,onKeyDown:e=>{if("Escape"===e.key&&(e.preventDefault(),p()),"ArrowRight"===e.key&&m(),"ArrowLeft"===e.key&&x(),"Tab"===e.key){let t=[i.current,d.current].filter(Boolean);if(0===t.length)return;let[r,a]=t;e.shiftKey&&document.activeElement===r?(e.preventDefault(),a.focus()):e.shiftKey||document.activeElement!==a||(e.preventDefault(),r.focus())}},className:"absolute inset-0 bg-black bg-opacity-75 text-white flex items-center justify-center z-50",role:"dialog","aria-modal":"true","aria-labelledby":"r2-guide-title",children:(0,a.jsxs)("div",{className:"max-w-md p-4 bg-gray-800 rounded shadow-lg space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{id:"r2-guide-title",className:"text-xl font-bold mb-2",children:"Radare2 Tutorial"}),(0,a.jsx)("p",{className:"mb-2",children:v[r]}),(0,a.jsx)("p",{className:"text-xs opacity-75",children:"Simulation only. No real binaries."})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("button",{type:"button",onClick:x,disabled:0===r,ref:i,className:"px-3 py-1 bg-gray-700 rounded disabled:opacity-50 focus:outline-none focus:ring",children:"Prev"}),(0,a.jsxs)("span",{children:[r+1," / ",v.length]}),(0,a.jsx)("button",{type:"button",onClick:m,disabled:r===v.length-1,className:"px-3 py-1 bg-gray-700 rounded disabled:opacity-50 focus:outline-none focus:ring",children:"Next"})]}),(0,a.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:o,onChange:e=>n(e.target.checked)}),(0,a.jsx)("span",{children:"Don't show again"})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("button",{onClick:p,ref:d,className:"px-3 py-1 bg-gray-700 rounded focus:outline-none focus:ring",children:"Close"})})]})})}var N=r(4454),k=r(42979);let C=e=>{let{tabs:t,activeTab:r,onChange:s}=e;return(0,a.jsx)("div",{className:"flex flex-wrap gap-2",role:"tablist","aria-label":"Radare2 sections",children:t.map(e=>{let t=r===e.id;return(0,a.jsx)("button",{type:"button",role:"tab","aria-selected":t,"aria-controls":"tab-panel-".concat(e.id),id:"tab-".concat(e.id),onClick:()=>s(e.id),className:"px-3 py-1 rounded text-sm transition-colors ".concat(t?"font-semibold":""),style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)",color:"var(--r2-text)",boxShadow:t?"0 0 0 2px color-mix(in srgb, var(--r2-accent) 35%, transparent)":"none"},children:e.label},e.id)})})},w=e=>{let{file:t,selectedAddress:r,selectedLine:l,bookmarkCount:o,patchCount:n,activeFilter:c}=e,[i,d]=(0,s.useState)(!1),[u,p]=(0,s.useState)(""),x=async(e,t)=>{if(t)try{var r,a;if(!(null==(a=navigator)||null==(r=a.clipboard)?void 0:r.writeText))return void p("Clipboard unavailable");await navigator.clipboard.writeText(t),p("".concat(e," copied"))}catch(t){p("Unable to copy ".concat(e.toLowerCase()))}};return(0,a.jsx)("aside",{className:"w-full lg:w-72 shrink-0","aria-label":"Inspector sidebar",children:(0,a.jsxs)("div",{className:"rounded-xl border p-4 space-y-4 transition-shadow sticky top-4",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold uppercase tracking-wide",children:"Inspector"}),(0,a.jsx)("button",{type:"button",onClick:()=>d(e=>!e),className:"text-xs underline",children:i?"Expand":"Collapse"})]}),!i&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("dl",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,a.jsx)("dt",{className:"text-xs uppercase opacity-70",children:"File"}),(0,a.jsx)("dd",{"data-testid":"process-name",className:"font-mono",children:t})]}),(0,a.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,a.jsx)("dt",{className:"text-xs uppercase opacity-70",children:"Bookmarks"}),(0,a.jsx)("dd",{"data-testid":"bookmark-count",className:"font-semibold",children:o})]}),(0,a.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,a.jsx)("dt",{className:"text-xs uppercase opacity-70",children:"Patches"}),(0,a.jsx)("dd",{"data-testid":"patch-count",className:"font-semibold",children:n})]}),(0,a.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,a.jsx)("dt",{className:"text-xs uppercase opacity-70",children:"Active Filter"}),(0,a.jsx)("dd",{"data-testid":"active-filter",className:"text-right",children:c})]}),(0,a.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,a.jsx)("dt",{className:"text-xs uppercase opacity-70",children:"Selected Addr"}),(0,a.jsx)("dd",{className:"font-mono",children:r||"--"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-xs uppercase opacity-70",children:"Quick copy"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>x("Address",r),disabled:!r,className:"px-2 py-1 rounded text-xs disabled:opacity-50",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},children:"Copy address"}),(0,a.jsx)("button",{type:"button",onClick:()=>x("Instruction",(null==l?void 0:l.text)||""),disabled:!(null==l?void 0:l.text),className:"px-2 py-1 rounded text-xs disabled:opacity-50",style:{backgroundColor:"var(--r2-surface)",border:"1px solid var(--r2-border)"},children:"Copy instruction"})]})]})]}),(0,a.jsx)("div",{"aria-live":"polite",className:"sr-only",children:u})]})})},S=e=>{let{filteredDisasm:t,currentAddr:r,selectedLine:l,onSelectAddr:o,onSelectLine:c,bookmarks:i,toggleBookmark:d,activeHeuristic:u,setActiveHeuristic:p,heuristicMatches:x,lineWarnings:m,warningPalette:b,themeTokens:h,lineIndexByAddr:f,onScrollToAddr:g,lineIdForAddr:y}=e,[v,j]=(0,s.useState)(""),[N,k]=(0,s.useState)(""),[C,w]=(0,s.useState)(""),[S,E]=(0,s.useState)(0),M=(0,s.useMemo)(()=>{if(!C)return[];let e=C.toLowerCase();return t.map((t,r)=>({line:t,index:r,matches:t.text.toLowerCase().includes(e)||t.addr.toLowerCase()===e})).filter(e=>e.matches)},[t,C]),R=(0,s.useMemo)(()=>new Set(M.map(e=>e.line.addr)),[M]);(0,s.useEffect)(()=>{E(0)},[M.length,C]);let L=e=>{if(!M.length)return;let t=(S+e+M.length)%M.length;E(t),g(M[t].line.addr)},T=()=>{let e=n(v);if(null===e)return void k("Enter a hex address (0x or raw).");let t="0x".concat(e.toString(16));if(!f.has(t.toLowerCase()))return void k("Address not found in this view.");k(""),g(t)},A=async e=>{if(e)try{var t,r;if(!(null==(r=navigator)||null==(t=r.clipboard)?void 0:t.writeText))return;await navigator.clipboard.writeText(e)}catch(e){}};return(0,a.jsxs)("div",{className:"space-y-4",id:"tab-panel-disassembly",role:"tabpanel",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 items-end",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-xs uppercase",htmlFor:"seek-input",children:"Seek"}),(0,a.jsx)("input",{id:"seek-input",value:v,onChange:e=>j(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),T())},placeholder:"0x1000",className:"px-2 py-1 rounded","aria-label":"Seek to address",style:{backgroundColor:h.panel,color:h.text,border:"1px solid ".concat(h.border)}})]}),(0,a.jsx)("button",{type:"button",onClick:T,className:"px-3 py-1 rounded",style:{backgroundColor:h.panel,color:h.text,border:"1px solid ".concat(h.border)},children:"Seek"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-xs uppercase",htmlFor:"find-input",children:"Find"}),(0,a.jsx)("input",{id:"find-input",value:C,onChange:e=>w(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),L(e.shiftKey?-1:1))},placeholder:"mov",className:"px-2 py-1 rounded","aria-label":"Find instruction",style:{backgroundColor:h.panel,color:h.text,border:"1px solid ".concat(h.border)}})]}),(0,a.jsx)("button",{type:"button",onClick:()=>L(-1),className:"px-3 py-1 rounded",style:{backgroundColor:h.panel,color:h.text,border:"1px solid ".concat(h.border)},children:"Prev"}),(0,a.jsx)("button",{type:"button",onClick:()=>L(1),className:"px-3 py-1 rounded",style:{backgroundColor:h.panel,color:h.text,border:"1px solid ".concat(h.border)},children:"Next"}),(0,a.jsx)("span",{className:"text-xs opacity-70",children:M.length?"".concat(S+1," / ").concat(M.length):"0 / 0"}),(0,a.jsx)("button",{type:"button",onClick:()=>A(r),className:"px-2 py-1 rounded text-xs",style:{backgroundColor:h.panel,color:h.text,border:"1px solid ".concat(h.border)},disabled:!r,children:"Copy address"}),(0,a.jsx)("button",{type:"button",onClick:()=>A(null==l?void 0:l.text),className:"px-2 py-1 rounded text-xs",style:{backgroundColor:h.panel,color:h.text,border:"1px solid ".concat(h.border)},disabled:!(null==l?void 0:l.text),children:"Copy line"})]}),N&&(0,a.jsx)("p",{className:"text-xs text-red-300",role:"status",children:N}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:x.map(e=>{let t=u===e.id,r=e.matches.length>0;return(0,a.jsxs)("button",{type:"button",className:"px-2 py-1 text-xs rounded border transition-colors focus:outline-none focus-visible:ring ".concat(t?"font-semibold":""," ").concat(r?"shadow-sm":""),style:{borderColor:h.border,backgroundColor:t?h.accent:r?b.surface:h.panel,color:t?h.accentForeground:h.text},"aria-pressed":t,title:"".concat(e.label," – ").concat(e.description),onClick:()=>p(t=>t===e.id?null:e.id),children:[e.label," (",e.matches.length,")"]},e.id)})}),(0,a.jsx)("div",{className:"overflow-auto rounded-lg border",style:{borderColor:h.border,backgroundColor:h.highlight,maxHeight:"20rem"},children:(0,a.jsxs)("ul",{className:"text-sm space-y-1 p-2 font-mono",role:"listbox","aria-label":"Disassembly listing",children:[t.map(e=>{var t;let s=r===e.addr,l=i.includes(e.addr),n=m.get(e.addr)||[],u=n.length>0,p=R.has(e.addr),x=M.length&&(null==(t=M[S])?void 0:t.line.addr)===e.addr;return(0,a.jsx)("li",{id:y(e.addr),"data-testid":"disasm-item",className:"cursor-pointer rounded-md border px-2 py-1 transition-colors",role:"option",style:{borderColor:s?h.border:x?h.accent:u?b.border:"transparent",backgroundColor:s?h.accent:x?"color-mix(in srgb, ".concat(h.accent," 20%, transparent)"):p?"color-mix(in srgb, ".concat(h.accent," 10%, transparent)"):u?b.overlay:"transparent",color:s?h.accentForeground:h.text},onClick:()=>{o(e.addr),c(e)},"aria-selected":s,children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("button",{type:"button",onClick:t=>{t.stopPropagation(),d(e.addr)},className:"mr-1","aria-label":"".concat(l?"Remove bookmark":"Bookmark address"," ").concat(e.addr),title:l?"Remove bookmark for ".concat(e.addr):"Bookmark ".concat(e.addr),children:l?"★":"☆"}),(0,a.jsxs)("span",{children:[e.addr,": "]}),(0,a.jsx)("span",{children:e.text})]}),u&&(0,a.jsx)("div",{className:"flex flex-wrap gap-1 text-[10px] uppercase",children:n.map(t=>(0,a.jsx)("span",{className:"px-1.5 py-0.5 rounded-full",style:{backgroundColor:b.badge,color:h.text},children:t.label},"".concat(e.addr,"-").concat(t.id)))})]})},e.addr)}),0===t.length&&(0,a.jsx)("li",{className:"text-xs italic","data-testid":"disasm-empty",children:"No instructions match the selected heuristic."})]})}),(0,a.jsxs)("section",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wide",children:"Bookmarks"}),0===i.length?(0,a.jsx)("p",{className:"text-sm opacity-70",children:"No bookmarks saved yet."}):(0,a.jsx)("ul",{className:"space-y-2 text-sm",children:i.map(e=>(0,a.jsxs)("li",{className:"flex items-center justify-between gap-2 rounded px-2 py-1",style:{backgroundColor:h.panel,border:"1px solid ".concat(h.border)},children:[(0,a.jsx)("button",{type:"button",onClick:()=>g(e),className:"font-mono underline",children:e}),(0,a.jsx)("button",{type:"button",onClick:()=>d(e),className:"text-xs underline",children:"Remove"})]},e))})]})]})},E=e=>{let{consoleMessages:t,strings:r,onJump:l,xrefs:o,currentAddr:n,themeTokens:i,warningPalette:d}=e,[u,p]=(0,s.useState)(""),x=(0,s.useMemo)(()=>{if(!u)return r;let e=u.toLowerCase();return r.filter(t=>t.text.toLowerCase().includes(e)||t.addr.toLowerCase().includes(e))},[u,r]),m=async e=>{if(e)try{var t,r;if(!(null==(r=navigator)||null==(t=r.clipboard)?void 0:t.writeText))return;await navigator.clipboard.writeText(e)}catch(e){}},b=r.map(e=>({...e,addr:c(e.addr)||e.addr})),h=x.map(e=>({...e,addr:c(e.addr)||e.addr})),f=n&&o[n]||[];return(0,a.jsxs)("div",{id:"tab-panel-overview",role:"tabpanel",className:"space-y-4",children:[(0,a.jsxs)("section",{className:"rounded-xl border p-4 space-y-3",style:{backgroundColor:i.panel,border:"1px solid ".concat(i.border)},children:[(0,a.jsxs)("header",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold uppercase tracking-wide",children:"Console Output"}),(0,a.jsx)("span",{className:"text-[10px] uppercase",style:{color:i.muted},children:"Simulated"})]}),(0,a.jsx)("ul",{className:"space-y-2 text-sm",children:t.map(e=>{let t="warn"===e.type,r="active"===e.type,s="muted"===e.type;return(0,a.jsx)("li",{className:"rounded-lg border px-3 py-2 ".concat(r?"font-semibold":""),style:{borderColor:r?i.accent:t?d.border:"transparent",backgroundColor:r?i.accent:t?d.surface:s?"color-mix(in srgb, ".concat(i.muted," 45%, transparent)"):i.highlight,color:r?i.accentForeground:i.text},children:e.label},e.id)})})]}),(0,a.jsxs)("section",{className:"rounded-xl border p-4 space-y-3",style:{backgroundColor:i.panel,border:"1px solid ".concat(i.border)},children:[(0,a.jsxs)("header",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold uppercase tracking-wide",children:"Strings"}),(0,a.jsxs)("span",{className:"text-xs",style:{color:i.muted},children:[b.length," found"]})]}),(0,a.jsx)("input",{value:u,onChange:e=>p(e.target.value),placeholder:"Filter strings",className:"px-2 py-1 rounded w-full",style:{backgroundColor:i.panel,color:i.text,border:"1px solid ".concat(i.border)}}),0===h.length?(0,a.jsx)("p",{className:"text-sm opacity-70",children:"No strings match this filter."}):(0,a.jsx)("ul",{className:"space-y-2 text-sm",children:h.map(e=>(0,a.jsxs)("li",{className:"flex flex-wrap items-center gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>l(e.addr),className:"underline font-mono",children:e.addr}),(0,a.jsx)("span",{children:e.text}),(0,a.jsx)("button",{type:"button",onClick:()=>m(e.text),className:"text-xs underline",children:"Copy"})]},"".concat(e.addr,"-").concat(e.text)))})]}),(0,a.jsxs)("section",{className:"rounded-xl border p-4 space-y-3",style:{backgroundColor:i.panel,border:"1px solid ".concat(i.border)},children:[(0,a.jsxs)("header",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold uppercase tracking-wide",children:"Xrefs"}),(0,a.jsx)("span",{className:"text-xs font-mono",children:n||"No selection"})]}),0===f.length?(0,a.jsx)("p",{className:"text-sm opacity-70",children:"No cross-references for this address."}):(0,a.jsx)("div",{className:"flex flex-wrap gap-2 text-sm",children:f.map(e=>{let t=c(e)||e;return(0,a.jsx)("button",{type:"button",onClick:()=>l(t),className:"px-2 py-1 rounded-full font-mono",style:{backgroundColor:i.highlight,border:"1px solid ".concat(i.border)},children:t},e)})})]})]})},M=e=>{let{currentAddr:t,notes:r,onAddNote:l,themeTokens:o}=e,[n,c]=(0,s.useState)("");return(0,a.jsxs)("div",{id:"tab-panel-notes",role:"tabpanel",className:"space-y-4",children:[(0,a.jsxs)("section",{className:"rounded-xl border p-4 space-y-3",style:{backgroundColor:o.panel,border:"1px solid ".concat(o.border)},children:[(0,a.jsxs)("header",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold uppercase tracking-wide",children:"Notes"}),(0,a.jsx)("span",{className:"text-xs font-mono",children:t||"No selection"})]}),(0,a.jsx)("textarea",{value:n,onChange:e=>c(e.target.value),placeholder:t?"Add note for selected address":"Select an address first",className:"w-full p-2 rounded","aria-label":t?"Add note for ".concat(t):"Add note",style:{backgroundColor:o.panel,color:o.text,border:"1px solid ".concat(o.border)}}),(0,a.jsx)("button",{onClick:()=>{t&&n.trim()&&(l(t,n.trim()),c(""))},className:"px-3 py-1 rounded self-end",style:{backgroundColor:o.panel,color:o.text,border:"1px solid ".concat(o.border)},disabled:!t||!n.trim(),children:"Save Note"})]}),r.length>0&&(0,a.jsxs)("section",{className:"rounded-xl border p-4 space-y-2",style:{backgroundColor:o.panel,border:"1px solid ".concat(o.border)},children:[(0,a.jsx)("h3",{className:"text-sm font-semibold uppercase tracking-wide",children:"Saved Notes"}),(0,a.jsx)("ul",{className:"space-y-1 text-sm",children:r.map((e,t)=>(0,a.jsxs)("li",{className:"font-mono",children:[e.addr,": ",e.text]},"".concat(e.addr,"-").concat(t)))})]})]})},R=[{id:"stack-ops",label:"Stack Ops",description:"Push/pop patterns that may hint at pivots",predicate:e=>/\b(push|pop)\b/i.test(e.text)},{id:"memory-writes",label:"Memory Writes",description:"MOV operations that alter memory",predicate:e=>/\bmov\b/i.test(e.text)},{id:"exits",label:"Return Paths",description:"RET or JMP instructions often used in gadgets",predicate:e=>/\b(ret|jmp)\b/i.test(e.text)}],L=e=>"asm-".concat(e.toLowerCase()),T=[{id:"overview",label:"Overview"},{id:"disassembly",label:"Disassembly"},{id:"hex",label:"Hex"},{id:"graph",label:"Graph"},{id:"notes",label:"Notes"}],A=e=>{var t;let{initialData:r={}}=e,{file:l="demo",hex:o="",disasm:n=[],xrefs:u={},blocks:b=[]}=r,[f,g]=(0,s.useState)("overview"),[v,A]=(0,s.useState)(null),[P,D]=(0,s.useState)(null),[F,I]=(0,s.useState)([]),[O,_]=(0,s.useState)([]),[B,J]=(0,s.useState)(!1),[U,K]=(0,s.useState)([]),[V,H]=(0,s.useState)(null),[W,z]=(0,s.useState)([]),{theme:q}=(0,N.useTheme)(),$=(0,s.useMemo)(()=>{let e=null!=q?q:"default",t=getComputedStyle(document.documentElement),r=(e,r)=>t.getPropertyValue(e).trim()||r;return{bg:r("--kali-bg","rgba(9, 15, 23, 0.9)"),panel:r("--kali-panel","rgba(17, 27, 36, 0.92)"),border:r("--kali-border","rgba(15, 148, 210, 0.18)"),accent:r("--kali-blue","#0f94d2"),text:r("--kali-text","#f5faff"),highlight:r("--kali-panel-highlight","rgba(15, 148, 210, 0.06)"),muted:r("--kali-panel-border","rgba(148, 163, 184, 0.65)"),accentForeground:"light"===e?r("--kali-bg","rgba(9, 15, 23, 0.9)"):r("--kali-bg-solid","#0b121a")}},[q]),G=(0,s.useMemo)(()=>{let e=$.border,t=$.panel,r=$.accent;return{border:"color-mix(in srgb, ".concat(r," 35%, ").concat(e,")"),surface:"color-mix(in srgb, ".concat(e," 35%, ").concat(t,")"),overlay:"color-mix(in srgb, ".concat(r," 18%, transparent)"),badge:"color-mix(in srgb, ".concat(r," 24%, ").concat(t,")")}},[$.accent,$.border,$.panel]),X=(0,s.useMemo)(()=>R.map(e=>({...e,matches:n.filter(t=>e.predicate(t))})),[n]),Y=(0,s.useMemo)(()=>X.find(e=>e.id===V)||null,[V,X]),Z=(0,s.useMemo)(()=>Y?Y.matches:n,[Y,n]),Q=(0,s.useMemo)(()=>{let e=new Map;return n.forEach(t=>{let r=R.filter(e=>e.predicate(t));r.length&&e.set(t.addr,r)}),e},[n]),ee=(0,s.useMemo)(()=>[{id:"load",type:"info",label:"Loaded ".concat(n.length," instructions for analysis")},{id:"strings",type:U.length?"info":"muted",label:U.length?"".concat(U.length," printable strings recovered"):"No printable strings detected in current window"},...X.filter(e=>e.matches.length>0).map(e=>({id:"heuristic-".concat(e.id),type:V===e.id?"active":"warn",label:"".concat(e.label," triggered ").concat(e.matches.length," time").concat(1===e.matches.length?"":"s")}))],[V,n.length,X,U.length]),et=(0,s.useMemo)(()=>{let e=new Map;return n.forEach((t,r)=>{e.set(t.addr.toLowerCase(),r)}),e},[n]);(0,s.useEffect)(()=>{I((e=>{let t=p(i+e);if(!t)return[];try{return JSON.parse(t)}catch(e){return[]}})(l)),_((e=>{let t=p(d+e);if(!t)return[];try{return JSON.parse(t)}catch(e){return[]}})(l))},[l]),(0,s.useEffect)(()=>{try{localStorage.getItem("r2HelpDismissed")||J(!0)}catch(e){}},[]),(0,s.useEffect)(()=>{var e;let t=(null==(e=n[0])?void 0:e.addr)||"0x0";K(m(o,c(t)||t))},[o,n]);let er=(0,s.useCallback)(e=>{var t;let r=c(e)||e,a=et.get(r.toLowerCase());if(void 0===a)return;let s=null==(t=n[a])?void 0:t.addr;if(s&&(A(s),D(n[a]),"undefined"!=typeof document)){let e=document.getElementById(L(s));e&&e.scrollIntoView({behavior:"smooth",block:"center"})}},[n,et]),ea=(null==(t=n[0])?void 0:t.addr)||"0x0",es=Y?"".concat(Y.label," (").concat(Y.matches.length,")"):"None";return(0,a.jsxs)("div",{className:"h-full w-full p-6 overflow-auto",style:{backgroundColor:$.bg,color:$.text},children:[B&&(0,a.jsx)(j,{onClose:()=>J(!1)}),(0,a.jsx)(k.default,{toolName:"Radare2"}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3 mb-4",children:[(0,a.jsx)("img",{src:"/themes/Yaru/apps/radare2.svg",alt:"Radare2 badge",className:"w-12 h-12"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("h1",{className:"text-lg font-semibold",children:"Radare2 Workspace"}),(0,a.jsxs)("span",{className:"text-xs opacity-70",children:["Simulated analysis on ",l]})]}),(0,a.jsx)("div",{className:"flex-1"}),(0,a.jsx)("button",{onClick:()=>J(!0),className:"px-3 py-1 rounded",style:{backgroundColor:$.panel,color:$.text,border:"1px solid ".concat($.border)},children:"Help"})]}),(0,a.jsx)(C,{tabs:T,activeTab:f,onChange:g}),(0,a.jsxs)("div",{className:"mt-4 flex flex-col xl:flex-row gap-4 items-start",children:[(0,a.jsxs)("main",{className:"flex-1 space-y-4",children:["overview"===f&&(0,a.jsx)(E,{consoleMessages:ee,strings:U,onJump:er,xrefs:u,currentAddr:v,themeTokens:$,warningPalette:G}),"disassembly"===f&&(0,a.jsx)(S,{filteredDisasm:Z,currentAddr:v,selectedLine:P,onSelectAddr:A,onSelectLine:D,bookmarks:O,toggleBookmark:e=>{let t=O.includes(e)?O.filter(t=>t!==e):[...O,e];_(t),x(d+l,JSON.stringify(t))},activeHeuristic:V,setActiveHeuristic:H,heuristicMatches:X,lineWarnings:Q,warningPalette:G,themeTokens:$,lineIndexByAddr:et,onScrollToAddr:er,lineIdForAddr:L}),"hex"===f&&(0,a.jsx)("div",{id:"tab-panel-hex",role:"tabpanel",children:(0,a.jsx)(h,{hex:o,theme:q,file:l,baseAddress:ea,onPatchesChange:z,onSelectAddress:er})}),"graph"===f&&(0,a.jsx)("div",{id:"tab-panel-graph",role:"tabpanel",children:(0,a.jsx)("div",{className:"rounded-xl border p-4",style:{backgroundColor:$.panel,border:"1px solid ".concat($.border)},children:(0,a.jsx)(y,{blocks:b,theme:q})})}),"notes"===f&&(0,a.jsx)(M,{currentAddr:v,notes:F,onAddNote:(e,t)=>{let r=[...F,{addr:e,text:t}];I(r),x(i+l,JSON.stringify(r))},themeTokens:$})]}),(0,a.jsx)(w,{file:l,selectedAddress:v,selectedLine:P,bookmarkCount:O.length,patchCount:W.length,activeFilter:es})]})]})},P={file:"demo.bin",hex:"554889e5b8000000005dc3",disasm:[{addr:"0x1000",text:"push rbp"},{addr:"0x1001",text:"mov rbp, rsp"},{addr:"0x1004",text:"mov eax, 0"},{addr:"0x1009",text:"pop rbp"},{addr:"0x100a",text:"ret"}],xrefs:{"0x1004":["0x1009"]},blocks:[{addr:"0x1000",edges:["0x1004"]},{addr:"0x1004",edges:["0x1009"]},{addr:"0x1009",edges:[]}]},D=e=>{let{initialData:t=P}=e;return(0,a.jsx)(A,{initialData:t})}},4454:(e,t,r)=>{r.d(t,{useTheme:()=>l});var a=r(14232),s=r(43239);let l=()=>{let[e,t]=(0,a.useState)(()=>(0,s.getTheme)());return(0,a.useEffect)(()=>{let e=e=>{if(e.key===s.THEME_KEY){let e=(0,s.getTheme)();t(e),(0,s.setTheme)(e)}};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),{theme:e,setTheme:e=>{t(e),(0,s.setTheme)(e)}}}},42979:(e,t,r)=>{r.d(t,{default:()=>s});var a=r(37876);r(14232);let s=e=>{let{toolName:t,message:r="Deterministic demo output. No live hosts, credentials, or network calls.",className:s=""}=e;return(0,a.jsxs)("div",{className:"mb-3 flex items-start gap-3 rounded-md border border-[color:color-mix(in_srgb,var(--color-accent)_55%,transparent)] bg-[color:color-mix(in_srgb,var(--kali-panel)_88%,var(--kali-overlay)_12%)] px-3 py-2 text-sm text-[color:var(--color-text)] shadow-[0_8px_24px_rgba(0,0,0,0.28)] ".concat(s),role:"status","aria-live":"polite",children:[(0,a.jsx)("span",{"aria-hidden":!0,className:"mt-0.5 inline-flex h-7 w-7 items-center justify-center rounded-full bg-[color:color-mix(in_srgb,var(--color-accent)_30%,transparent)] text-base font-bold text-kali-accent shadow-[0_0_0_1px_color-mix(in_srgb,var(--color-accent)_75%,transparent)]",children:"SIM"}),(0,a.jsxs)("div",{className:"leading-snug",children:[(0,a.jsxs)("p",{className:"font-semibold uppercase tracking-wide text-[color:var(--color-muted)]",children:[t," Simulation"]}),(0,a.jsx)("p",{className:"text-[color:var(--color-text)]",children:r})]})]})}}}]);