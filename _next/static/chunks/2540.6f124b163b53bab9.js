"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2540],{92540:(e,r,a)=>{a.r(r),a.d(r,{default:()=>c});var t=a(37876),i=a(14232),l=a(43617);let s=e=>(0,t.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:(0,t.jsx)("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),o=e=>(0,t.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,t.jsx)("path",{d:"M23 4v6h-6"}),(0,t.jsx)("path",{d:"M1 20v-6h6"}),(0,t.jsx)("path",{d:"M3.51 9a9 9 0 0 1 14.13-3.36L23 10"}),(0,t.jsx)("path",{d:"M20.49 15a9 9 0 0 1-14.13 3.36L1 14"})]}),n=e=>(0,t.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,t.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,t.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),c=()=>{let e=(0,i.useRef)(null),r=(0,i.useRef)(null),c=(0,i.useRef)(null),[d,u]=(0,i.useState)(""),[b,f]=(0,i.useState)(""),[h,g]=(0,i.useState)("environment"),[x,k]=(0,i.useState)(!1),[p,v]=(0,i.useState)("");(0,i.useEffect)(()=>{let t=!0,i=e.current;return(async()=>{var i;if(!(null==(i=navigator.mediaDevices)?void 0:i.getUserMedia))return f("Camera API not supported");try{let i=await navigator.mediaDevices.getUserMedia({video:{facingMode:h}});if(c.current=i,r.current=i.getVideoTracks()[0]||null,!t)return;let l=e.current;if(l&&(l.srcObject=i,await l.play()),"BarcodeDetector"in window){let r=new window.BarcodeDetector({formats:["qr_code"]}),a=async()=>{if(t){try{let a=await r.detect(e.current);a[0]&&u(a[0].rawValue)}catch(e){}requestAnimationFrame(a)}};a()}else{let r=(await a.e(8067).then(a.t.bind(a,21746,23))).default,i=async()=>{if(t){try{let a=e.current;if(a&&a.readyState===a.HAVE_ENOUGH_DATA){let e=document.createElement("canvas");e.width=a.videoWidth,e.height=a.videoHeight;let t=e.getContext("2d");if(t){t.drawImage(a,0,0,e.width,e.height);let i=t.getImageData(0,0,e.width,e.height),l=r(i.data,e.width,e.height);l&&u(l.data)}}}catch(e){}requestAnimationFrame(i)}};i()}}catch(e){e instanceof DOMException&&"NotAllowedError"===e.name?f("Camera access was denied"):f("Could not start camera")}})(),()=>{var e;t=!1,null==(e=c.current)||e.getTracks().forEach(e=>e.stop()),i&&(i.srcObject=null),r.current=null}},[h]),(0,i.useEffect)(()=>{var e;let a=r.current;if(!a)return;let t=null==(e=a.getCapabilities)?void 0:e.call(a);(null==t?void 0:t.torch)&&a.applyConstraints({advanced:[{torch:x}]}).catch(()=>{})},[x]),(0,i.useEffect)(()=>{d?l.toDataURL(d,{width:128}).then(v).catch(()=>v("")):v("")},[d]);let m=!!b;return(0,t.jsxs)("div",{className:"flex h-full flex-col items-center space-y-4 bg-kali-surface/95 p-4 text-kali-text",children:[(0,t.jsxs)("div",{className:"relative w-full max-w-sm",children:[(0,t.jsx)("video",{ref:e,"aria-label":"QR scanner preview",className:"w-full rounded-xl border border-kali-border/70 bg-kali-surface/80 shadow-kali-panel"}),(0,t.jsxs)("div",{className:"absolute top-2 right-2 flex gap-2 rounded-xl border p-1.5 shadow-lg backdrop-blur-sm transition ".concat(m?"border-kali-error/60 bg-kali-error/10":"border-kali-border/70 bg-kali-surface/80"),children:[(0,t.jsx)("button",{type:"button",onClick:()=>{k(e=>!e)},"aria-label":"Toggle flashlight",className:"rounded-lg border p-1.5 transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus focus-visible:ring-offset-2 focus-visible:ring-offset-[var(--kali-bg)] ".concat(m?"border-kali-error/70 bg-kali-error/15 text-kali-error":"border-kali-primary/50 bg-kali-primary/15 text-kali-primary"),children:(0,t.jsx)(s,{className:"w-6 h-6"})}),(0,t.jsx)("button",{type:"button",onClick:()=>{g(e=>"environment"===e?"user":"environment")},"aria-label":"Switch camera",className:"rounded-lg border p-1.5 transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus focus-visible:ring-offset-2 focus-visible:ring-offset-[var(--kali-bg)] ".concat(m?"border-kali-error/70 bg-kali-error/15 text-kali-error":"border-kali-primary/50 bg-kali-primary/15 text-kali-primary"),children:(0,t.jsx)(o,{className:"w-6 h-6"})})]})]}),b&&(0,t.jsx)("p",{className:"rounded-lg border border-kali-error/60 bg-kali-error/10 px-3 py-2 text-sm text-kali-error shadow-[0_0_0_1px_color-mix(in_srgb,var(--color-error)_55%,transparent)]",children:b}),d&&(0,t.jsxs)("div",{className:"flex w-full max-w-sm items-center gap-3 rounded-xl border border-kali-primary/60 bg-kali-surface/90 p-3 text-kali-text shadow-[0_12px_35px_rgba(15,148,210,0.16)]",children:[p&&(0,t.jsx)("img",{src:p,alt:"QR preview",className:"h-32 w-32 rounded-lg border border-kali-border/70 bg-kali-surface/80 p-1"}),(0,t.jsx)("div",{className:"flex-1 min-w-0",children:(0,t.jsx)("p",{className:"break-all text-sm text-[color:color-mix(in_srgb,var(--color-text)_90%,transparent)]",children:d})}),(0,t.jsx)("button",{type:"button",onClick:()=>{var e;d&&(null==(e=navigator.clipboard)||e.writeText(d).catch(()=>{}))},"aria-label":"Copy result",className:"rounded-lg border border-transparent p-1.5 text-kali-primary transition hover:border-kali-primary/60 hover:bg-kali-primary/15 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-kali-focus focus-visible:ring-offset-2 focus-visible:ring-offset-[var(--kali-bg)]",children:(0,t.jsx)(n,{className:"w-6 h-6"})})]})]})}}}]);