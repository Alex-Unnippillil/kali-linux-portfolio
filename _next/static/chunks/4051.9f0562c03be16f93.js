"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4051],{10911:(e,t,s)=>{s.d(t,{BlackjackGame:()=>d,Shoe:()=>n,basicStrategy:()=>h,calculateBustProbability:()=>u,cardValue:()=>a,handValue:()=>o,isSoft:()=>c});let i=["♠","♥","♦","♣"],r=["A","2","3","4","5","6","7","8","9","10","J","Q","K"],l=()=>{let e=[];for(let t of i)for(let s of r)e.push({suit:t,value:s});return e};class n{shuffle(){this.cards=[];for(let e=0;e<this.decks;e+=1)this.cards.push(...l());var e=this.cards;for(let t=e.length-1;t>0;t-=1){let s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}this.shufflePoint=Math.floor(this.cards.length*this.penetration),this.dealt=0,this.shuffleCount+=1,this.runningCount=0,this.composition={},r.forEach(e=>{this.composition[e]=4*this.decks}),this.draw()}draw(){(this.dealt>=this.shufflePoint||0===this.cards.length)&&this.shuffle(),this.dealt+=1;let e=this.cards.pop(),t=e.value;return void 0!==this.composition[t]&&(this.composition[t]-=1),["2","3","4","5","6"].includes(t)?this.runningCount+=1:["10","J","Q","K","A"].includes(t)&&(this.runningCount-=1),e}constructor(e=6,t=.75){this.decks=e,this.penetration=t,this.shuffleCount=0,this.runningCount=0,this.composition={},this.shuffle()}}let a=e=>["J","Q","K"].includes(e.value)?10:"A"===e.value?11:parseInt(e.value,10),o=e=>{let t=0,s=0;for(e.forEach(e=>{t+=a(e),"A"===e.value&&(s+=1)});t>21&&s>0;)t-=10,s-=1;return t},u=(e,t)=>{if(!e||!t)return 0;let s=Object.entries(t),i=s.reduce((e,t)=>{let[,s]=t;return e+s},0);return 0===i?0:s.reduce((t,s)=>{let[i,r]=s;return r<=0?t:t+(o([...e,{value:i,suit:"♠"}])>21?r:0)},0)/i},c=e=>{let t=0,s=0;return e.forEach(e=>{t+=a(e),"A"===e.value&&(s+=1)}),s>0&&t<=21};function h(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{canSplit:i=!1,canDouble:r=!1,canSurrender:l=!1}=s,n="A"===t.value?11:a(t),u=e.map(e=>e.value),c=o(e),h=2===u.length&&a(e[0])===a(e[1]),d=u.includes("A")&&c<=21;if(l&&(16===c&&[9,10,11].includes(n)||15===c&&10===n))return"surrender";if(h&&i){let t=a(e[0]);if([8,11].includes(t)||[2,3,7].includes(t)&&n>=2&&n<=7||6===t&&n>=2&&n<=6||9===t&&[2,3,4,5,6,8,9].includes(n)||4===t&&[5,6].includes(n)||2===t&&[2,3,4,5,6,7].includes(n)||3===t&&[2,3,4,5,6,7].includes(n)||7===t&&[2,3,4,5,6,7].includes(n)||6===t&&[2,3,4,5,6].includes(n))return"split";if(5===t)return r&&n>=2&&n<=9?"double":"hit"}if(d){if(c<=17)return r&&n>=3&&n<=6?"double":"hit";if(18===c){if(r&&n>=3&&n<=6)return"double";if(n>=9||11===n)return"hit"}return"stand"}return c<=8?"hit":9===c?r&&n>=3&&n<=6?"double":"hit":10===c?r&&n>=2&&n<=9?"double":"hit":11===c?r&&11!==n?"double":"hit":12===c?n>=4&&n<=6?"stand":"hit":c>=13&&c<=16?n>=2&&n<=6?"stand":"hit":"stand"}class d{resetRound(){this.playerHands=[],this.dealerHand=[],this.current=0,this.bet=0,this.insuranceBet=0,this.dealerBlackjack=!1,this.insuranceResolved=!1}startRound(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(e*s>this.bankroll)throw Error("Bet exceeds bankroll");this.resetRound(),this.bet=e,this.bankroll-=e*s,t&&(this.shoe.cards=this.shoe.cards.concat(t.slice().reverse()));let i=Array.from({length:s},()=>({cards:[this.shoe.draw(),this.shoe.draw()],bet:e,finished:!1,doubled:!1,surrendered:!1})),r=[this.shoe.draw(),this.shoe.draw()];return this.playerHands=i,this.dealerHand=r,this.dealerBlackjack=21===o(r),{player:i[0],dealer:r}}currentHand(){return this.playerHands[this.current]}hit(){let e=this.currentHand();e.cards.push(this.shoe.draw()),o(e.cards)>21&&(e.finished=!0,e.busted=!0,this.nextHand())}stand(){this.currentHand().finished=!0,this.nextHand()}double(){let e=this.currentHand();if(this.bankroll<e.bet)throw Error("Not enough bankroll");this.bankroll-=e.bet,e.bet*=2,e.doubled=!0,e.cards.push(this.shoe.draw()),e.finished=!0,o(e.cards)>21&&(e.busted=!0),this.nextHand()}split(){let e=this.currentHand(),t=e.cards[0],s=e.cards[1];if(a(t)!==a(s))throw Error("Cannot split");if(this.bankroll<e.bet)throw Error("Not enough bankroll");this.bankroll-=e.bet;let i={cards:[s,this.shoe.draw()],bet:e.bet,finished:!1,doubled:!1,surrendered:!1};e.cards=[t,this.shoe.draw()],this.playerHands.splice(this.current+1,0,i)}surrender(){let e=this.currentHand();if(2!==e.cards.length||e.finished)throw Error("Cannot surrender");e.finished=!0,e.surrendered=!0,this.bankroll+=Math.floor(e.bet/2),this.nextHand()}takeInsurance(){if("A"!==this.dealerHand[0].value)throw Error("Insurance not offered");if(this.insuranceResolved)return;let e=Math.floor(this.bet*this.playerHands.length/2);if(e>this.bankroll)throw Error("Not enough bankroll");this.bankroll-=e,this.insuranceBet=e,this.insuranceResolved=!0,this.dealerBlackjack&&(this.bankroll+=3*e)}nextHand(){for(;this.current<this.playerHands.length&&this.playerHands[this.current].finished;)this.current+=1;this.current>=this.playerHands.length&&this.dealerPlayAndSettle()}dealerPlayAndSettle(){if(!this.dealerBlackjack)for(;17>o(this.dealerHand)||this.hitSoft17&&17===o(this.dealerHand)&&c(this.dealerHand)&&this.dealerHand.some(e=>"A"===e.value);)this.dealerHand.push(this.shoe.draw());let e=o(this.dealerHand);this.playerHands.forEach(t=>{if(t.surrendered){this.stats.losses+=1,this.stats.hands+=1,t.result="lose";return}let s=o(t.cards),i=2===t.cards.length&&21===s;t.busted||!this.dealerBlackjack&&e>s&&e<=21?(this.stats.losses+=1,t.result="lose"):i&&!this.dealerBlackjack?(this.bankroll+=Math.floor(5*t.bet/2),this.stats.wins+=1,t.result="win"):e>21||s>e?(this.bankroll+=2*t.bet,this.stats.wins+=1,t.result="win"):s===e?(this.bankroll+=t.bet,this.stats.pushes+=1,t.result="push"):(this.stats.losses+=1,t.result="lose"),this.stats.hands+=1}),this.history.push({dealer:[...this.dealerHand],playerHands:this.playerHands.map(e=>({cards:[...e.cards],bet:e.bet,result:e.result}))})}constructor({decks:e=6,bankroll:t=1e4,hitSoft17:s=!0,penetration:i=.75}={}){this.shoe=new n(e,i),this.bankroll=t,this.stats={wins:0,losses:0,pushes:0,hands:0},this.hitSoft17=s,this.history=[],this.resetRound()}}},34051:(e,t,s)=>{s.d(t,{default:()=>a});var i=s(37876),r=s(14232),l=s(95220),n=s(10911);let a=e=>{let{onExit:t,showExit:s=!0,showNewShoe:a=!0,streakStorageKey:o="bj_best_streak",revealStorageKey:u="bj_reveal_count",className:c="",title:h="Practice Count",onBestStreakChange:d}=e,f=(0,r.useRef)(new n.Shoe(1)),[b,x]=(0,r.useState)(null),[k,p]=(0,r.useState)(""),[m,v]=(0,r.useState)(""),[g,y]=(0,r.useState)(0),[w,H]=(0,l.default)(o,0,e=>"number"==typeof e),[j,C]=(0,l.default)(u,!1,e=>"boolean"==typeof e),[N,S]=(0,r.useState)(!1),[E,A]=(0,r.useState)(null),[B,R]=(0,r.useState)(f.current.runningCount),[_,M]=(0,r.useState)({...f.current.composition}),P=(0,r.useRef)(null),I=(0,r.useCallback)(()=>{x(f.current.draw()),R(f.current.runningCount),M({...f.current.composition})},[]),J=(0,r.useCallback)(()=>{f.current.shuffle(),y(0),v(""),S(!1),A(null),I()},[I]),K=(0,r.useCallback)(()=>{P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{S(!1),A(null),v(""),I()},1200)},[I]);(0,r.useEffect)(()=>(I(),()=>{P.current&&clearTimeout(P.current)}),[I]),(0,r.useEffect)(()=>{d&&d(w)},[w,d]);let Q=(0,r.useCallback)(()=>{if(!b)return;let e=parseInt(k,10),t=f.current.runningCount,s=(e=>e?["2","3","4","5","6"].includes(e.value)?1:["10","J","Q","K","A"].includes(e.value)?-1:0:0)(b);e===t?(y(e=>{let t=e+1;return H(e=>t>e?t:e),t}),v("Correct! Count is ".concat(t,"."))):(y(0),v("Not quite. Count is ".concat(t,"."))),p(""),A({actual:t,delta:s,cardLabel:"".concat(b.value).concat(b.suit)}),S(!0),K()},[b,k,K,H]),L=j||N;return(0,i.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-center gap-4 bg-[color:color-mix(in_srgb,var(--color-surface)_65%,transparent)] p-4 text-kali-text select-none ".concat(c),children:[(0,i.jsx)("div",{className:"text-xs uppercase tracking-[0.2em] text-kali-control",children:h}),b&&(0,i.jsx)("div",{className:"text-4xl",children:"".concat(b.value).concat(b.suit)}),(0,i.jsx)("input",{type:"number",value:k,onChange:e=>p(e.target.value),className:"w-28 rounded border border-[color:var(--kali-border)] bg-[var(--kali-surface)] px-2 py-1 text-center text-kali-text transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus","aria-label":"Enter running count guess"}),(0,i.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[(0,i.jsx)("button",{type:"button",className:"rounded bg-kali-muted px-3 py-1 text-sm font-medium text-kali-text transition-colors hover:bg-kali-primary hover:text-kali-inverse focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus disabled:cursor-not-allowed disabled:opacity-50",onClick:Q,disabled:""===k.trim(),children:"Submit"}),a&&(0,i.jsx)("button",{type:"button",className:"rounded bg-kali-muted px-3 py-1 text-sm font-medium text-kali-text transition-colors hover:bg-kali-primary hover:text-kali-inverse focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",onClick:J,children:"New Shoe"}),s&&(0,i.jsx)("button",{type:"button",className:"rounded bg-kali-muted px-3 py-1 text-sm font-medium text-kali-text transition-colors hover:bg-kali-primary hover:text-kali-inverse focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",onClick:t,children:"Exit"})]}),(0,i.jsxs)("label",{className:"flex items-center gap-2 text-xs uppercase tracking-wide text-kali-control",children:[(0,i.jsx)("input",{type:"checkbox",checked:j,onChange:e=>C(e.target.checked),"aria-label":"Reveal running count"}),"Reveal count"]}),m&&(0,i.jsx)("div",{className:"text-center text-sm","aria-live":"polite",children:m}),N&&E&&(0,i.jsxs)("div",{className:"text-center text-xs text-kali-text",children:["Hi-Lo impact for ",E.cardLabel,": ",(e=>e>0?"+".concat(e):e<0?"".concat(e):"0")(E.delta)," (2-6:+1, 7-9:0, 10-A:-1)"]}),(0,i.jsxs)("div",{className:"text-sm sm:text-base",children:["Streak: ",g]}),(0,i.jsxs)("div",{className:"text-sm sm:text-base",children:["Best: ",w]}),L?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"text-sm sm:text-base",children:["RC: ",B]}),(0,i.jsx)("div",{className:"text-center text-xs sm:text-sm",children:Object.entries(_).map(e=>{let[t,s]=e;return"".concat(t,":").concat(s)}).join(" ")})]}):(0,i.jsx)("div",{className:"text-xs text-kali-muted",children:"Count hidden until you submit."})]})}}}]);