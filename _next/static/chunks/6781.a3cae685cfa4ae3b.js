"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6781],{66781:(e,t,s)=>{s.r(t),s.d(t,{default:()=>i,displayCamera:()=>d});var a=s(37876),l=s(14232);let r=()=>{var e;let t=(0,l.useRef)(null),[s,r]=(0,l.useState)(null),[i,d]=(0,l.useState)("idle"),[n,c]=(0,l.useState)(null),[o,x]=(0,l.useState)([]),[m,h]=(0,l.useState)(""),[u,p]=(0,l.useState)(!0),[b,f]=(0,l.useState)([]),g="undefined"!=typeof navigator&&!!(null==(e=navigator.mediaDevices)?void 0:e.getUserMedia),v=(0,l.useCallback)(()=>{s&&(s.getTracks().forEach(e=>e.stop()),r(null))},[s]),w=(0,l.useCallback)(async()=>{var e;(null==(e=navigator.mediaDevices)?void 0:e.enumerateDevices)&&x((await navigator.mediaDevices.enumerateDevices()).filter(e=>"videoinput"===e.kind))},[]),j=(0,l.useCallback)(async e=>{if(!g){c("Camera access is not supported in this browser."),d("error");return}d("loading"),c(null);try{v();let s=await navigator.mediaDevices.getUserMedia({video:{deviceId:e?{exact:e}:void 0,facingMode:e?void 0:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1});if(r(s),t.current&&(t.current.srcObject=s,await t.current.play()),await w(),!e){let e=s.getVideoTracks()[0].getSettings();e.deviceId&&h(e.deviceId)}d("streaming")}catch(e){console.error("Camera start error:",e),d("error"),e instanceof DOMException&&"NotAllowedError"===e.name?c("Camera access denied. Please allow access to continue."):c("Unable to start the camera. Check permissions or hardware.")}},[g,w,v]);(0,l.useEffect)(()=>()=>v(),[v]);let N=async e=>{let t=e.target.value;h(t),t&&await j(t)},y=(0,l.useMemo)(()=>{let e=o.find(e=>e.deviceId===m);return(null==e?void 0:e.label)||"Default camera"},[o,m]);return(0,a.jsxs)("div",{className:"flex h-full w-full flex-col bg-slate-950 text-white",children:[(0,a.jsx)("div",{className:"border-b border-white/10 bg-slate-900/80 px-4 py-3 sm:px-6",children:(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm uppercase tracking-[0.2em] text-cyan-300",children:"Kali Lens"}),(0,a.jsx)("h1",{className:"text-xl font-semibold sm:text-2xl",children:"Camera Studio"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 text-xs text-slate-300",children:[(0,a.jsx)("span",{className:"rounded-full border border-white/10 bg-white/5 px-3 py-1",children:"streaming"===i?"Live":"Offline"}),(0,a.jsxs)("span",{className:"rounded-full border border-white/10 bg-white/5 px-3 py-1",children:[b.length," capture",1===b.length?"":"s"]})]})]})}),(0,a.jsxs)("div",{className:"flex flex-1 flex-col gap-6 overflow-hidden p-4 sm:p-6 lg:flex-row",children:[(0,a.jsxs)("section",{className:"flex flex-1 flex-col gap-4",children:[(0,a.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-gradient-to-br from-slate-900 via-slate-950 to-black p-4",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.2em] text-slate-400",children:"Active Camera"}),(0,a.jsx)("p",{className:"text-lg font-medium text-white",children:y})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,a.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm font-medium text-white hover:bg-white/10",onClick:()=>j(m||void 0),disabled:"loading"===i,children:"streaming"===i?"Restart":"Start Camera"}),(0,a.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm font-medium text-white hover:bg-white/10",onClick:v,disabled:!s,children:"Stop"})]})]}),n&&(0,a.jsx)("div",{className:"mt-3 rounded-lg border border-red-500/40 bg-red-500/10 px-3 py-2 text-sm text-red-200",children:n}),(0,a.jsxs)("div",{className:"mt-4 grid gap-3 md:grid-cols-2",children:[(0,a.jsxs)("label",{className:"flex flex-col gap-1 text-xs text-slate-400",children:["Camera Source",(0,a.jsxs)("select",{className:"rounded-lg border border-white/10 bg-black/60 px-3 py-2 text-sm text-white",onChange:N,value:m,children:[(0,a.jsx)("option",{value:"",children:"Default camera"}),o.map((e,t)=>(0,a.jsx)("option",{value:e.deviceId,children:e.label||"Camera ".concat(t+1)},e.deviceId))]})]}),(0,a.jsxs)("label",{className:"flex flex-col gap-1 text-xs text-slate-400",children:["Preview Orientation",(0,a.jsx)("button",{className:"rounded-lg border border-white/10 bg-black/60 px-3 py-2 text-sm text-white hover:bg-white/10",onClick:()=>p(e=>!e),children:u?"Mirrored (Selfie Mode)":"Standard View"})]})]})]}),(0,a.jsxs)("div",{className:"relative flex min-h-[260px] flex-1 items-center justify-center overflow-hidden rounded-3xl border border-white/10 bg-black/70",children:[!g&&(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-2 p-6 text-center text-sm text-slate-300",children:[(0,a.jsx)("p",{children:"Camera APIs are not available in this browser."}),(0,a.jsx)("p",{children:"Please open the app in a modern desktop or mobile browser."})]}),(0,a.jsx)("video",{ref:t,className:"h-full w-full object-cover ".concat(u?"-scale-x-100":""),playsInline:!0,muted:!0,autoPlay:!0}),"streaming"!==i&&g&&(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3 bg-black/60 text-center text-sm text-slate-200",children:[(0,a.jsx)("p",{className:"text-base font-medium",children:"Camera feed is offline"}),(0,a.jsx)("p",{className:"max-w-xs text-slate-400",children:"Tap “Start Camera” to begin. We never upload your photos."})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3 rounded-2xl border border-white/10 bg-slate-900/60 px-4 py-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.2em] text-slate-400",children:"Capture"}),(0,a.jsx)("p",{className:"text-sm text-slate-200",children:"Snap a photo and keep it in your local gallery."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{className:"rounded-full bg-cyan-500 px-6 py-2 text-sm font-semibold text-slate-900 shadow-lg shadow-cyan-500/30 transition hover:bg-cyan-400 disabled:cursor-not-allowed disabled:bg-slate-600",onClick:()=>{if(!t.current)return;let e=t.current,s=e.videoWidth||1280,a=e.videoHeight||720,l=document.createElement("canvas");l.width=s,l.height=a;let r=l.getContext("2d");if(!r)return;u&&(r.translate(s,0),r.scale(-1,1)),r.drawImage(e,0,0,s,a);let i=l.toDataURL("image/png");f(e=>[{id:"".concat(Date.now(),"-").concat(Math.random().toString(16).slice(2)),url:i,timestamp:new Date,width:s,height:a},...e])},disabled:!s||"streaming"!==i,children:"Capture Photo"}),(0,a.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm text-white hover:bg-white/10 disabled:cursor-not-allowed",onClick:()=>f([]),disabled:0===b.length,children:"Clear"})]})]})]}),(0,a.jsxs)("aside",{className:"flex w-full flex-col gap-4 lg:w-[360px]",children:[(0,a.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-slate-900/70 p-4",children:[(0,a.jsx)("h2",{className:"text-base font-semibold",children:"Session Details"}),(0,a.jsxs)("div",{className:"mt-4 grid gap-3 text-sm text-slate-300",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Status"}),(0,a.jsx)("span",{className:"text-slate-100",children:"streaming"===i?"Streaming":"Idle"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Device"}),(0,a.jsx)("span",{className:"text-slate-100",children:y})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Preview"}),(0,a.jsx)("span",{className:"text-slate-100",children:u?"Mirrored":"Standard"})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-1 flex-col overflow-hidden rounded-2xl border border-white/10 bg-slate-900/70",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between border-b border-white/10 px-4 py-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-base font-semibold",children:"Capture Gallery"}),(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Stored locally in this session"})]}),(0,a.jsxs)("span",{className:"text-xs text-slate-400",children:[b.length," total"]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:0===b.length?(0,a.jsx)("div",{className:"flex h-full items-center justify-center text-center text-sm text-slate-400",children:"No captures yet. Take a photo to start your gallery."}):(0,a.jsx)("div",{className:"grid gap-4",children:b.map(e=>(0,a.jsxs)("div",{className:"overflow-hidden rounded-xl border border-white/10 bg-slate-950/60",children:[(0,a.jsx)("img",{src:e.url,alt:"Captured",className:"h-40 w-full object-cover"}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2 px-3 py-2 text-xs text-slate-300",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-100",children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),(0,a.jsxs)("p",{className:"text-slate-500",children:[e.width," \xd7 ",e.height]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs text-white hover:bg-white/10",onClick:()=>((e,t)=>{let s=document.createElement("a");s.href=e,s.download="camera-shot-".concat(t.toISOString().slice(0,19),".png"),document.body.appendChild(s),s.click(),document.body.removeChild(s)})(e.url,e.timestamp),children:"Download"}),(0,a.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs text-white hover:bg-white/10",onClick:()=>{var t;return t=e.id,void f(e=>e.filter(e=>e.id!==t))},children:"Remove"})]})]})]},e.id))})})]})]})]})]})},i=r,d=()=>(0,a.jsx)(r,{})}}]);