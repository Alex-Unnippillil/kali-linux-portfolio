"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1830,6747],{16747:(e,t,a)=>{a.r(t),a.d(t,{default:()=>u,displayMimikatzOffline:()=>b,parseDump:()=>c});var i=a(37876),l=a(14232);function s(e){let{children:t}=e;return(0,i.jsxs)("div",{className:"flex items-center bg-amber-100 text-amber-900 p-2",role:"alert",children:[(0,i.jsx)("span",{className:"mr-2",role:"img","aria-label":"warning",children:"âš ï¸"}),(0,i.jsx)("span",{children:t})]})}let r=JSON.parse('[{"id":"training-workstation","title":"Training Workstation Snapshot","summary":"Extract from a sanitized LSASS memory capture of a training workstation where a domain admin signed in to the demo environment.","labSafety":"Redacted and synthetic credentials. Use only inside the closed training lab. Do not export or reuse in production networks.","riskRating":"Moderate (synthetic admin exposure)","artifacts":[{"label":"Capture time","value":"2024-04-02 18:22 UTC"},{"label":"Acquisition","value":"sekurlsa::logonpasswords"}],"flow":["Review the briefing to confirm sanitized dataset use and ensure lab mode is toggled on in the shell.","Load the dump to inspect credential artifacts and identify the demo administrator account.","Pivot into remediation guidance by documenting the synthetic password rotation steps."],"dump":"[*] sekurlsa::logonpasswords\\\\n    username : LAB\\\\\\\\analyst\\\\n    domain   : LAB.LOCAL\\\\n    password : 0ffline!Lab2024\\\\n\\\\n[*] sekurlsa::logonpasswords\\\\n    username : DEMO\\\\\\\\domain-admin\\\\n    domain   : DEMO.LOCAL\\\\n    password : Adm1n-Reset-Only\\\\n"},{"id":"incident-playback","title":"Incident Playback Timeline","summary":"Canned event timeline from an incident response tabletop with two exposed service accounts.","labSafety":"All values are fictional and reserved for tabletop exercises. Keep the dataset offline and delete exports after drills.","riskRating":"Low (tabletop replay)","artifacts":[{"label":"Source","value":"Event log replay"},{"label":"Suggested module","value":"sekurlsa::tickets"}],"flow":["Load the playback dataset and correlate accounts with the tabletop inject briefing.","Use the checklist below to determine which accounts require resets and which can be disabled.","Summarize containment steps in the lab notebook before clearing the dataset from the window."],"dump":"[timestamp] 2024-03-11 09:32:18Z\\\\nusername: SERVICE\\\\\\\\backup-job\\\\npassword: Backup!RotationOnly\\\\n\\\\n[timestamp] 2024-03-11 09:45:02Z\\\\nuser = SERVICE\\\\\\\\monitoring-bot\\\\npassword = M0nitor!ng-Play\\\\n"}]'),n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.toLowerCase();return t.startsWith("critical")?"critical":t.startsWith("high")?"high":t.startsWith("moderate")||t.startsWith("medium")?"medium":"low"},o={low:"border border-kali-severity-low/50 bg-kali-severity-low/15 text-white",medium:"border border-kali-severity-medium/60 bg-kali-severity-medium/20 text-white",high:"border border-kali-severity-high/60 bg-kali-severity-high/20 text-white",critical:"border border-kali-severity-critical/60 bg-kali-severity-critical/25 text-white"},d={low:"border-kali-severity-low/60 bg-kali-severity-low/10 text-white/90",medium:"border-kali-severity-medium/70 bg-kali-severity-medium/15 text-white/95",high:"border-kali-severity-high/70 bg-kali-severity-high/15 text-white",critical:"border-kali-severity-critical/70 bg-kali-severity-critical/20 text-white"},c=e=>{let t=e.split(/\r?\n/),a=[],i={},l=/user(?:name)?\s*[:=]\s*(\S+)/i,s=/pass(?:word)?\s*[:=]\s*(\S+)/i;return t.forEach(e=>{let t=e.match(l),r=e.match(s);t&&(i.user=t[1]),r&&(i.password=r[1]),i.user&&i.password&&(a.push(i),i={})}),a},m=()=>{let[e,t]=(0,l.useState)([]),[a,m]=(0,l.useState)(""),[u,b]=(0,l.useState)(""),f=(0,l.useMemo)(()=>{let e=new Map;return r.forEach((t,a)=>{e.set(String(a+1),t.id)}),e},[]),h=(0,l.useMemo)(()=>r.find(e=>e.id===u)||null,[u]),x=(0,l.useCallback)(function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"No credentials found",i=c(e);t(i),m(i.length?"":a)},[]),p=(0,l.useCallback)(e=>{b(e);let t=r.find(t=>t.id===e);t&&x(t.dump,"No credentials found in dataset")},[x]);return(0,l.useEffect)(()=>{let e=e=>{if(e.defaultPrevented||e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;let t=e.target;if(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||t instanceof HTMLSelectElement||t instanceof HTMLElement&&t.isContentEditable)return;let a=f.get(e.key);a&&(e.preventDefault(),p(a))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[f,p]),(0,i.jsxs)("div",{className:"h-full w-full flex flex-col bg-ub-cool-grey text-white",children:[(0,i.jsx)(s,{children:"Offline simulator. Sanitized datasets only. Keep exports inside the training lab and reset before closing the window."}),(0,i.jsxs)("div",{className:"p-4 flex flex-col gap-6 overflow-y-auto",children:[(0,i.jsxs)("header",{className:"space-y-2 rounded-lg border border-kali-border/60 bg-kali-surface/80 p-4 shadow-inner",children:[(0,i.jsx)("h1",{className:"text-xl font-semibold",children:"Mimikatz Offline Workbench"}),(0,i.jsx)("p",{className:"text-sm text-kali-muted",children:"Explore canned LSASS dumps and tabletop injects without any network calls. Load a packaged scenario below or import your own sanitized log to practice credential hunting in a safe lab."})]}),(0,i.jsxs)("section",{"aria-labelledby":"offline-datasets",className:"rounded-lg border border-kali-border/60 bg-kali-surface/80 p-4 shadow-inner",children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,i.jsx)("h2",{id:"offline-datasets",className:"text-lg font-semibold",children:"Packaged datasets"}),(0,i.jsx)("span",{className:"rounded-full border border-kali-accent/30 bg-kali-accent/10 px-2 py-1 text-xs uppercase tracking-wide text-kali-accent",children:"Offline ready"})]}),(0,i.jsx)("p",{className:"mt-2 text-xs text-kali-muted",children:"Choose a prebuilt scenario to auto-load sanitized artifacts and follow the guided investigation steps."}),(0,i.jsx)("div",{className:"mt-4 grid gap-3 md:grid-cols-2",children:r.map((e,t)=>{var a,l,s,r,c;let m=e.id===u,b=String(t+1),f=null!=(s=null==(a=e.artifacts)?void 0:a.length)?s:0,h=n(e.riskRating||""),x=null!=(r=o[h])?r:o.low,g=null!=(c=d[h])?c:d.low;return(0,i.jsxs)("article",{className:"flex h-full flex-col gap-3 rounded-lg border p-4 text-sm transition-all ".concat(m?"border-kali-accent/70 bg-kali-surface shadow-[0_0_0_1px_rgba(15,148,210,0.3)]":"border-kali-border/60 bg-kali-surface/80 hover:border-kali-accent/40"),children:[(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-base font-semibold",children:e.title}),(0,i.jsx)("p",{className:"mt-1 text-kali-muted",children:e.summary})]}),(0,i.jsx)("p",{className:"rounded-md border border-l-4 px-3 py-2 text-xs leading-relaxed ".concat(g),"data-testid":"".concat(e.id,"-safety"),children:e.labSafety})]}),(null==(l=e.artifacts)?void 0:l.length)?(0,i.jsx)("dl",{className:"grid gap-2 text-xs text-kali-muted","aria-label":"Dataset artifacts",children:e.artifacts.map(t=>(0,i.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,i.jsx)("dt",{className:"font-semibold text-kali-text",children:t.label}),(0,i.jsx)("dd",{className:"text-right text-kali-muted",children:t.value})]},"".concat(e.id,"-").concat(t.label)))}):null,(0,i.jsxs)("div",{className:"mt-auto flex flex-wrap items-center justify-between gap-2 border-t border-kali-border/60 pt-3",children:[(0,i.jsxs)("div",{className:"flex flex-wrap gap-2 text-[0.7rem] font-semibold",children:[(0,i.jsxs)("span",{className:"rounded-full bg-kali-accent/15 px-2 py-1 text-kali-accent",children:[f," ",1===f?"artifact":"artifacts"]}),(0,i.jsxs)("span",{className:"rounded-full px-2 py-1 uppercase tracking-wide ".concat(x),children:["Risk: ",e.riskRating||"Not rated"]})]}),(0,i.jsx)("button",{type:"button",onClick:()=>p(e.id),className:"inline-flex items-center justify-center rounded-md bg-kali-control px-3 py-2 text-xs font-semibold uppercase tracking-wide text-slate-950 shadow transition-colors hover:bg-kali-control/90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",children:m?"Reload dataset (Shortcut ".concat(b,")"):"Load ".concat(e.title," (Shortcut ").concat(b,")")})]})]},e.id)})})]}),h?(0,i.jsxs)("section",{"aria-labelledby":"investigation-flow",className:"rounded-lg border border-kali-border/60 bg-kali-surface/80 p-4 text-sm shadow-inner",children:[(0,i.jsx)("h2",{id:"investigation-flow",className:"text-lg font-semibold",children:"Investigation flow"}),(0,i.jsx)("ol",{className:"mt-2 list-decimal space-y-1 pl-5 text-kali-text",children:h.flow.map((e,t)=>(0,i.jsx)("li",{children:e},"".concat(h.id,"-flow-").concat(t)))})]}):null,(0,i.jsx)("section",{"aria-labelledby":"custom-import",className:"rounded-lg border border-kali-border/60 bg-kali-surface/80 p-4 shadow-inner",children:(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("h2",{id:"custom-import",className:"text-lg font-semibold",children:"Import sanitized dump"}),(0,i.jsx)("p",{className:"text-xs text-kali-muted",children:"Upload `.txt` or `.log` exports from your own drills to parse usernames and passwords locally. Files never leave this browser tab."}),(0,i.jsx)("label",{htmlFor:"custom-import-file",className:"text-xs font-semibold uppercase tracking-wide text-kali-muted",children:"Upload sanitized dump"}),(0,i.jsx)("input",{id:"custom-import-file",type:"file",accept:".txt,.log,application/octet-stream",onChange:e=>{var a;let i=null==(a=e.target.files)?void 0:a[0];i&&(b(""),i.text().then(e=>{x(e)}).catch(()=>{m("Failed to read file"),t([])}))},"aria-label":"Upload sanitized dump",className:"block w-full rounded-md border border-kali-border/60 bg-kali-surface/80 p-2 text-sm text-kali-text shadow-inner shadow-black/30 transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus file:mr-3 file:rounded-md file:border-0 file:bg-kali-control file:px-3 file:py-1 file:text-xs file:font-semibold file:uppercase file:tracking-wide file:text-black hover:file:bg-kali-control/90"})]})}),a?(0,i.jsx)("div",{className:"rounded-lg border border-kali-severity-high/70 bg-kali-severity-high/15 p-3 text-sm text-white shadow-inner",role:"alert",children:a}):null,(0,i.jsxs)("section",{"aria-labelledby":"parsed-credentials",className:"flex-1 rounded-lg border border-kali-border/60 bg-kali-surface/80 p-4 text-sm shadow-inner",children:[(0,i.jsx)("h2",{id:"parsed-credentials",className:"text-lg font-semibold",children:"Parsed credentials"}),e.length?(0,i.jsx)("ul",{className:"mt-3 space-y-2",children:e.map((e,t)=>(0,i.jsx)("li",{className:"rounded-lg border border-kali-border/60 bg-kali-surface p-3",children:(0,i.jsxs)("dl",{className:"space-y-1",children:[(0,i.jsxs)("div",{className:"flex justify-between gap-3",children:[(0,i.jsx)("dt",{className:"font-semibold text-kali-accent",children:"User"}),(0,i.jsx)("dd",{className:"font-mono text-kali-text","data-testid":"credential-user-".concat(t),children:e.user})]}),(0,i.jsxs)("div",{className:"flex justify-between gap-3",children:[(0,i.jsx)("dt",{className:"font-semibold text-kali-accent",children:"Password"}),(0,i.jsx)("dd",{className:"break-all font-mono text-kali-text","data-testid":"credential-password-".concat(t),children:e.password})]})]})},"".concat(e.user,"-").concat(t)))}):(0,i.jsx)("p",{className:"mt-3 rounded-md border border-dashed border-kali-border/60 bg-kali-surface/80 p-3 text-kali-muted",children:"No credentials parsed yet."})]})]})]})},u=m,b=(e,t)=>(0,i.jsx)(m,{addFolder:e,openApp:t})},41830:(e,t,a)=>{a.r(t),a.d(t,{default:()=>s});var i=a(37876);a(14232);var l=a(16747);let s=()=>(0,i.jsx)(l.default,{})}}]);