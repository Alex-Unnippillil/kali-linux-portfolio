"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9432],{69432:(e,a,t)=>{t.r(a),t.d(a,{WeatherFetchError:()=>i,default:()=>h,displayWeather:()=>p,fetchWeather:()=>d});var r=t(37876),n=t(18847),o=t.n(n);let l=()=>(0,r.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-[color:var(--kali-panel)] p-6 text-[color:var(--kali-text)]",children:(0,r.jsxs)("div",{className:"w-full max-w-4xl space-y-4",children:[(0,r.jsx)("div",{className:"h-6 w-48 rounded bg-[color:color-mix(in_srgb,var(--kali-panel)_82%,transparent)] animate-pulse"}),(0,r.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 xl:grid-cols-3",children:Array.from({length:6}).map((e,a)=>(0,r.jsxs)("div",{className:"space-y-3 rounded border border-[color:var(--kali-panel-border)] bg-[color:color-mix(in_srgb,var(--kali-panel)_90%,transparent)] p-4 shadow-[0_1px_0_rgba(255,255,255,0.04)]",children:[(0,r.jsx)("div",{className:"h-4 w-24 rounded bg-[color:color-mix(in_srgb,var(--kali-panel)_70%,transparent)] animate-pulse"}),(0,r.jsx)("div",{className:"h-8 w-32 rounded bg-[color:color-mix(in_srgb,var(--kali-panel)_75%,transparent)] animate-pulse"}),(0,r.jsx)("div",{className:"h-4 w-16 rounded bg-[color:color-mix(in_srgb,var(--kali-panel)_70%,transparent)] animate-pulse"}),(0,r.jsx)("div",{className:"grid grid-cols-5 gap-2",children:Array.from({length:5}).map((e,t)=>(0,r.jsx)("div",{className:"h-12 rounded bg-[color:color-mix(in_srgb,var(--kali-panel)_78%,transparent)] animate-pulse"},"weather-skel-sub-".concat(a,"-").concat(t)))})]},"weather-skel-".concat(a)))})]})}),c=o()(()=>t.e(9053).then(t.bind(t,9053)),{loadableGenerated:{webpack:()=>[9053]},ssr:!1,loading:()=>(0,r.jsx)(l,{})}),s="weather-data";class i extends Error{constructor(e,a,t){super(a),this.name="WeatherFetchError",this.type=e,this.info=t}}let u=e=>"".concat("weather-cache-meta:").concat(e);async function d(e){var a;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={openWeather:e=>{let{city:a,apiKey:t}=e;return"https://api.openweathermap.org/data/2.5/weather?q=".concat(encodeURIComponent(a),"&units=metric&appid=").concat(t)},openMeteo:e=>{let{lat:a,lon:t,timezone:r="auto",hourly:n="apparent_temperature",daily:o="weathercode,temperature_2m_max,temperature_2m_min,sunrise,sunset",forecast_days:l=5,current_weather:c=!0}=e,s=new URLSearchParams({latitude:String(a),longitude:String(t),timezone:null!=r?r:"auto",forecast_days:String(l)});return c&&s.set("current_weather","true"),n&&s.set("hourly",n),o&&s.set("daily",o),"https://api.open-meteo.com/v1/forecast?".concat(s.toString())},openMeteoGeo:e=>{let{name:a,count:t=6,language:r="en",format:n="json"}=e,o=new URLSearchParams({name:null!=a?a:"",count:String(t),language:r,format:n});return"https://geocoding-api.open-meteo.com/v1/search?".concat(o.toString())}}[e];if(!r)throw new i("unsupported","Unsupported weather provider: ".concat(e));let{strategy:n="network-first",ttl:o=6e5,allowNetwork:l=!0,signal:c,revalidate:d=!1}=t,h=r(t),p="undefined"!=typeof globalThis&&"caches"in globalThis,m="undefined"!=typeof navigator&&!1===navigator.onLine,w=async()=>{if(!p)return null;try{let e=await caches.open(s),a=await e.match(h);if(!a)return null;let t=await a.json(),r=(e=>{if("undefined"==typeof localStorage)return null;try{let a=localStorage.getItem(u(e));if(!a)return null;let t=Number(a);return Number.isFinite(t)?t:null}catch(e){return null}})(h),n="number"!=typeof r||Date.now()-r>o;return{data:t,timestamp:r,stale:n}}catch(e){throw new i("parsing","Unable to read cached weather data.",{error:e})}},f=async(e,a)=>{if(p)try{let t=await caches.open(s);await t.put(h,e.clone());if("undefined"!=typeof localStorage)try{localStorage.setItem(u(h),String(a))}catch(e){}}catch(e){}},g=async()=>{let e;if(!l)throw new i("network-disabled","Network access is disabled.");if(m)throw new i("offline","You appear to be offline.");let a=await fetch(h,{signal:c});if(!a.ok)throw new i("http","Failed to fetch weather (".concat(a.status,")"),{status:a.status});let t=a.clone();try{e=await a.json()}catch(e){throw new i("parsing","Unable to parse weather response.",{error:e})}let r=Date.now();return await f(t,r),{data:e,meta:{source:"network",cached:!1,stale:!1,timestamp:r}}},b=await w().catch(e=>(e instanceof i,null)),v=b?{data:b.data,meta:{source:"cache",cached:!0,stale:b.stale,timestamp:null!=(a=b.timestamp)?a:void 0}}:null,y=l||"cache-only"===n?n:"cache-only";if("cache-only"===y){if(v)return v;throw new i(l?"offline":"network-disabled",l?"You appear to be offline.":"Network access is disabled.")}if("cache-first"===y){if(v){if(d&&l&&!m){let e=g().catch(()=>null);return{...v,revalidate:e}}return v}return g()}try{return await g()}catch(e){if(v)return v;throw e}}let h=c,p=()=>(0,r.jsx)(c,{})}}]);