"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4293],{4293:(e,s,t)=>{t.r(s),t.d(s,{default:()=>k,displayNessus:()=>w,loadFalsePositives:()=>j,loadJobDefinitions:()=>f,recordFalsePositive:()=>N,saveJobDefinition:()=>y});var a=t(37876),l=t(14232);let r=["All","Critical","High","Medium","Low"],i={Critical:"#991b1b",High:"#b45309",Medium:"#a16207",Low:"#1e40af"},n=[{id:1,host:"192.168.0.1",cvss:9.8,severity:"Critical"},{id:2,host:"192.168.0.2",cvss:7.5,severity:"High"},{id:3,host:"192.168.0.3",cvss:5,severity:"Medium"},{id:4,host:"192.168.0.4",cvss:2.5,severity:"Low"}],c=e=>{let{hosts:s=n}=e,[c,o]=(0,l.useState)("All"),[d,m]=(0,l.useState)(s),u=(0,l.useRef)(null),x=(0,l.useRef)(0),h=(0,l.useMemo)(()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches,[]);return(0,l.useEffect)(()=>{if("function"==typeof Worker){u.current=new Worker(t.tu(new URL(t.p+t.u(5850),t.b)));let e=u.current;return e.onmessage=e=>{x.current&&cancelAnimationFrame(x.current);let s=e.data||[];x.current=requestAnimationFrame(()=>m(s))},e.postMessage({hosts:s,filter:c}),()=>{e.terminate(),x.current&&cancelAnimationFrame(x.current)}}},[]),(0,l.useEffect)(()=>{var e;null==(e=u.current)||e.postMessage({hosts:s,filter:c})},[s,c]),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("div",{role:"radiogroup","aria-label":"Filter hosts by severity",className:"flex flex-wrap gap-2 mb-2",children:r.map(e=>(0,a.jsx)("button",{onClick:()=>o(e),"aria-pressed":c===e,className:"px-3 py-1 rounded-full text-sm border focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ".concat(c===e?"bg-white text-black border-gray-300":"bg-gray-800 text-white border-gray-600"),children:e},e))}),(0,a.jsx)("svg",{width:"400",height:"300",role:"img","aria-label":"Host vulnerabilities bubble chart",className:"mx-auto",children:d.map(e=>{let s=(e.index+1)*400/(d.length+1);return(0,a.jsxs)("g",{transform:"translate(".concat(s,",").concat(150,")"),children:[(0,a.jsx)("circle",{r:e.radius,fill:i[e.severity],"aria-label":"".concat(e.host," severity ").concat(e.severity," CVSS ").concat(e.cvss),style:{transition:h?"none":"all 0.3s ease"}}),(0,a.jsx)("text",{textAnchor:"middle",dy:"0.3em",className:"text-xs fill-white",children:e.cvss})]},e.id)})}),(0,a.jsxs)("div",{"aria-live":"polite",className:"sr-only",children:["Showing ",d.length," hosts for ",c," severity"]})]})};var o=t(8606);let d=["All","Critical","High","Medium","Low"],m=e=>{let{plugins:s=o}=e,[t,r]=(0,l.useState)("All"),i=(0,l.useMemo)(()=>"All"===t?s:s.filter(e=>e.severity===t),[t,s]);return(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"text-lg mb-2",children:"Plugin Feed"}),(0,a.jsx)("div",{role:"radiogroup","aria-label":"Filter plugins by severity",className:"flex flex-wrap gap-2 mb-2",children:d.map(e=>(0,a.jsx)("button",{onClick:()=>r(e),"aria-pressed":t===e,className:"px-3 py-1 rounded-full text-sm border focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ".concat(t===e?"bg-white text-black border-gray-300":"bg-gray-800 text-white border-gray-600"),children:e},e))}),(0,a.jsx)("ul",{className:"space-y-1",children:i.map(e=>(0,a.jsxs)("li",{className:"border-b border-gray-700 pb-1 text-sm",children:[(0,a.jsx)("div",{className:"font-semibold",children:e.name}),(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:[e.severity," - CVSS ",e.cvss]})]},e.id))})]})},u=JSON.parse('[{"id":"1","name":"OpenSSL Heartbeat Information Disclosure","cvss":5,"severity":"Medium","host":"server1.example.com"},{"id":"2","name":"Apache HTTP Server Privilege Escalation","cvss":7.5,"severity":"High","host":"server1.example.com"},{"id":"3","name":"Weak SSH Cipher","cvss":9.8,"severity":"Critical","host":"server2.example.com"}]'),x=JSON.parse('[{"id":"2","name":"Apache HTTP Server Privilege Escalation","cvss":7.5,"severity":"Medium","host":"server1.example.com"},{"id":"3","name":"Weak SSH Cipher","cvss":9.8,"severity":"Critical","host":"server2.example.com"},{"id":"4","name":"Outdated Software","cvss":2.5,"severity":"Low","host":"server3.example.com"}]'),h=["Critical","High","Medium","Low"],p={Critical:"#991b1b",High:"#b45309",Medium:"#a16207",Low:"#1e40af"},v=e=>{let{previous:s=u,current:t=x}=e,{added:r,removed:i,changed:n}=(0,l.useMemo)(()=>{let e=new Map(s.map(e=>[e.id,e])),a=new Map(t.map(e=>[e.id,e])),l=t.filter(s=>!e.has(s.id));return{added:l,removed:s.filter(e=>!a.has(e.id)),changed:t.filter(s=>{let t=e.get(s.id);return t&&t.severity!==s.severity}).map(s=>({...s,previousSeverity:e.get(s.id).severity}))}},[s,t]),c=(0,l.useMemo)(()=>(e=>{let s={Critical:0,High:0,Medium:0,Low:0};return e.forEach(e=>{void 0!==s[e.severity]&&(s[e.severity]+=1)}),s})(t),[t]),o=Math.max(...h.map(e=>c[e]||0),1);return(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"text-lg mb-2",children:"Executive Summary"}),(0,a.jsx)("svg",{width:"260",height:"120",role:"img","aria-label":"Executive summary chart",className:"mx-auto mb-4",children:h.map((e,s)=>{let t=c[e]||0,l=t/o*80,r=60*s+20,i=100-l;return(0,a.jsxs)("g",{children:[(0,a.jsx)("rect",{x:r,y:i,width:"40",height:l,fill:p[e]}),(0,a.jsx)("text",{x:r+20,y:i-4,textAnchor:"middle",className:"text-xs fill-white",children:t}),(0,a.jsx)("text",{x:r+20,y:110,textAnchor:"middle",className:"text-xs fill-white",children:e})]},e)})}),(0,a.jsxs)("div",{className:"space-y-2",children:[r.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-green-400",children:"New Findings"}),(0,a.jsx)("ul",{className:"ml-4 list-disc",children:r.map(e=>(0,a.jsxs)("li",{className:"text-sm",children:[e.name," (",e.severity,")"]},e.id))})]}),i.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-blue-400",children:"Resolved"}),(0,a.jsx)("ul",{className:"ml-4 list-disc",children:i.map(e=>(0,a.jsxs)("li",{className:"text-sm",children:[e.name," (",e.severity,")"]},e.id))})]}),n.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-yellow-400",children:"Severity Changes"}),(0,a.jsx)("ul",{className:"ml-4 list-disc",children:n.map(e=>(0,a.jsxs)("li",{className:"text-sm",children:[e.name,": ",e.previousSeverity," â†’ ",e.severity]},e.id))})]})]})]})},b=e=>{let{findings:s=[]}=e,t=(0,l.useMemo)(()=>{let e=new Map;s.forEach(s=>{if("number"!=typeof s.cvss)return;let t=e.get(s.name)||{name:s.name,total:0,count:0};t.total+=s.cvss,t.count+=1,e.set(s.name,t)});let t=Array.from(e.values()).map(e=>{let{name:s,total:t,count:a}=e;return{name:s,avg:t/a}});return t.sort((e,s)=>s.avg-e.avg),t},[s]);return 0===t.length?(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"No plugin scores available."}):(0,a.jsxs)("div",{className:"my-4",children:[(0,a.jsx)("h3",{className:"text-lg mb-2",children:"Plugin Score Heatmap"}),(0,a.jsx)("ul",{className:"space-y-1",children:t.map(e=>{let{name:s,avg:t}=e,l=(1-t/10)*120;return(0,a.jsxs)("li",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"w-48 truncate mr-2 text-sm",children:s}),(0,a.jsx)("div",{className:"flex-1 h-4",role:"img","aria-label":"".concat(s," average score ").concat(t.toFixed(1)),style:{backgroundColor:"hsl(".concat(l,", 70%, 50%)"),width:"".concat(t/10*100,"%")}}),(0,a.jsx)("span",{className:"ml-2 text-sm",children:t.toFixed(1)})]},s)})})]})};var g=t(75758);let f=()=>{try{return JSON.parse(localStorage.getItem("nessusJobs")||"[]")}catch(e){return[]}},y=e=>{let s=[...f(),e];return localStorage.setItem("nessusJobs",JSON.stringify(s)),s},j=()=>{try{return JSON.parse(localStorage.getItem("nessusFalsePositives")||"[]")}catch(e){return[]}},N=(e,s)=>{let t=[...j(),{findingId:e,reason:s}];return localStorage.setItem("nessusFalsePositives",JSON.stringify(t)),t},S=()=>{let[e,s]=(0,l.useState)("https://localhost:8834"),[r,i]=(0,l.useState)(""),[n,o]=(0,l.useState)(""),[d,u]=(0,l.useState)(""),[x,h]=(0,l.useState)([]),[p,S]=(0,l.useState)(""),[k,w]=(0,l.useState)([]),[C,M]=(0,l.useState)({scanId:"",schedule:""}),[H,F]=(0,l.useState)(null),[L,A]=(0,l.useState)(""),[I,P]=(0,l.useState)([]),[E,O]=(0,l.useState)([]),[R,J]=(0,l.useState)(""),[U,D]=(0,l.useState)(null),T=(0,l.useRef)(null),W=(0,l.useMemo)(()=>x.map((e,s)=>{var t,a,l;return{id:null!=(t=e.id)?t:s,host:null!=(a=e.name)?a:"Host ".concat(s+1),cvss:null!=(l=e.cvss)?l:s%10+1,severity:e.severity||["Low","Medium","High","Critical"][s%4]}}),[x]);(0,l.useEffect)(()=>(w(f()),P(j()),T.current=new Worker(t.tu(new URL(t.p+t.u(9497),t.b))),T.current.onmessage=e=>{let{findings:s=[],error:t}=e.data||{};t?(J(t),O([])):(O(s),J(""))},()=>{var e;return null==(e=T.current)?void 0:e.terminate()}),[]);let V=async e=>{var s;let t=null==(s=e.target.files)?void 0:s[0];if(t)try{let e=await t.text();T.current.postMessage(e)}catch(e){J("Failed to read file")}},X=async s=>{s.preventDefault(),S("");try{let s=await fetch("".concat(e,"/session"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:r,password:n})});if(!s.ok)throw Error("Authentication failed");let t=await s.json();u(t.token),_(t.token,e)}catch(e){S(e.message)}},_=async function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;try{let e=await fetch("".concat(t,"/scans"),{headers:{"X-Cookie":"token=".concat(s),"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});if(!e.ok)throw Error("Unable to fetch scans");let a=await e.json();h(a.scans||[])}catch(e){S(e.message)}},q=e=>{e.preventDefault(),N(H,L),P(j()),F(null),A("")};return d?(0,a.jsxs)("div",{className:"h-full w-full overflow-auto bg-kali-surface/95 p-4 text-kali-text",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl",children:"Scans"}),(0,a.jsx)("button",{onClick:()=>{u(""),h([])},className:"rounded bg-kali-error px-2 py-1 text-sm font-medium text-white transition hover:bg-kali-error/90",children:"Logout"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"nessus-upload",className:"block text-sm mb-1",children:"Upload Nessus XML"}),(0,a.jsx)("input",{id:"nessus-upload",type:"file",accept:".nessus,.xml",onChange:V,className:"text-black mb-2","aria-label":"Upload Nessus XML"}),R&&(0,a.jsx)(g.default,{children:R}),E.length>0&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("button",{onClick:()=>{let e=new Blob([[["Host","ID","Finding","CVSS","Severity"],...E.map(e=>[e.host,e.id,e.name,e.cvss,e.severity])].map(e=>e.map(e=>'"'.concat(String(e).replace(/"/g,'""'),'"')).join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.setAttribute("download","nessus-findings.csv"),document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(s)},className:"mb-2 rounded bg-kali-success px-2 py-1 text-sm font-medium text-kali-inverse transition hover:bg-kali-success/90",children:"Export CSV"}),(0,a.jsx)("div",{className:"overflow-auto max-h-64 border border-gray-700",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left p-1",children:"Host"}),(0,a.jsx)("th",{className:"text-left p-1",children:"Vulnerability"}),(0,a.jsx)("th",{className:"text-left p-1",children:"CVSS"}),(0,a.jsx)("th",{className:"text-left p-1",children:"Severity"}),(0,a.jsx)("th",{className:"text-left p-1",children:"Action"})]})}),(0,a.jsx)("tbody",{children:E.map((e,s)=>(0,a.jsxs)("tr",{className:"border-t border-gray-700 cursor-pointer",onClick:()=>D(e),children:[(0,a.jsx)("td",{className:"p-1",children:e.host}),(0,a.jsx)("td",{className:"p-1",children:e.name}),(0,a.jsx)("td",{className:"p-1",children:e.cvss}),(0,a.jsx)("td",{className:"p-1",children:e.severity}),(0,a.jsx)("td",{className:"p-1",children:I.some(s=>s.findingId===e.id)?(0,a.jsx)("span",{className:"text-xs text-kali-success",children:"Marked"}):H===e.id?(0,a.jsxs)("form",{onSubmit:q,className:"space-y-1",children:[(0,a.jsx)("input",{className:"w-full p-1 rounded text-black",value:L,onChange:e=>A(e.target.value),placeholder:"Reason","aria-label":"False positive reason"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{type:"submit",className:"rounded bg-kali-success px-2 py-1 text-xs font-medium text-kali-inverse transition hover:bg-kali-success/90",children:"Submit"}),(0,a.jsx)("button",{type:"button",className:"rounded bg-kali-surface-muted px-2 py-1 text-xs text-kali-text/80 transition hover:bg-kali-surface",onClick:()=>F(null),children:"Cancel"})]})]}):(0,a.jsx)("button",{className:"text-xs font-medium text-kali-inverse transition hover:brightness-105 rounded bg-kali-severity-medium px-2 py-1",onClick:()=>F(e.id),children:"False Positive"})})]},s))})]})})]})]}),(0,a.jsx)(c,{hosts:W}),(0,a.jsx)(m,{}),(0,a.jsx)(v,{}),(0,a.jsx)(b,{findings:E}),p&&(0,a.jsx)(g.default,{className:"mb-2",children:p}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),C.scanId&&(w(y(C)),M({scanId:"",schedule:""}))},className:"mb-4 space-x-2",children:[(0,a.jsx)("input",{className:"p-1 rounded text-black",placeholder:"Scan ID",value:C.scanId,onChange:e=>M({...C,scanId:e.target.value}),"aria-label":"Scan ID"}),(0,a.jsx)("input",{className:"p-1 rounded text-black",placeholder:"Schedule",value:C.schedule,onChange:e=>M({...C,schedule:e.target.value}),"aria-label":"Scan schedule"}),(0,a.jsx)("button",{type:"submit",className:"rounded bg-kali-primary px-2 py-1 text-sm font-medium text-kali-inverse transition hover:bg-kali-primary/90",children:"Add Job"})]}),k.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"text-lg mb-1",children:"Scheduled Jobs"}),(0,a.jsx)("ul",{className:"space-y-1",children:k.map((e,s)=>(0,a.jsxs)("li",{className:"text-sm",children:["Scan ",e.scanId," - ",e.schedule]},s))})]}),(0,a.jsx)("ul",{className:"space-y-1",children:x.map(e=>(0,a.jsxs)("li",{className:"border-b border-gray-700 pb-1",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("span",{children:[e.name," - ",e.status]}),(0,a.jsx)("button",{className:"text-xs font-medium text-kali-inverse transition hover:brightness-105 rounded bg-kali-severity-medium px-2 py-1",onClick:()=>F(e.id),children:"False Positive"})]}),H===e.id&&(0,a.jsxs)("form",{onSubmit:q,className:"mt-2 space-y-1",children:[(0,a.jsx)("input",{className:"w-full p-1 rounded text-black",value:L,onChange:e=>A(e.target.value),placeholder:"Reason","aria-label":"False positive reason"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{type:"submit",className:"rounded bg-kali-success px-2 py-1 text-xs font-medium text-kali-inverse transition hover:bg-kali-success/90",children:"Submit"}),(0,a.jsx)("button",{type:"button",className:"rounded bg-kali-surface-muted px-2 py-1 text-xs text-kali-text/80 transition hover:bg-kali-surface",onClick:()=>F(null),children:"Cancel"})]})]})]},e.id))}),U&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex justify-end bg-kali-overlay/80 backdrop-blur-sm",children:(0,a.jsxs)("aside",{className:"h-full w-80 overflow-auto border border-white/10 bg-kali-surface-raised/95 p-4 text-kali-text shadow-kali-panel",children:[(0,a.jsx)("button",{type:"button",onClick:()=>D(null),className:"mb-2 rounded bg-kali-error px-2 py-1 text-sm font-medium text-white transition hover:bg-kali-error/90",children:"Close"}),(0,a.jsx)("h3",{className:"mb-2 text-xl",children:U.name}),(0,a.jsxs)("p",{className:"mb-2 text-sm",children:[(0,a.jsx)("span",{className:"font-bold",children:"Host:"})," ",U.host]}),(0,a.jsxs)("p",{className:"mb-2 text-sm",children:[(0,a.jsx)("span",{className:"font-bold",children:"CVSS:"})," ",U.cvss," (",U.severity,")"]}),(0,a.jsx)("p",{className:"mb-2 whitespace-pre-wrap text-sm",children:U.description}),(0,a.jsx)("p",{className:"text-sm text-kali-success",children:U.solution||"No solution provided."})]})})]}):(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-kali-surface/95 text-kali-text",children:(0,a.jsxs)("form",{onSubmit:X,className:"w-64 space-y-2 p-4",children:[(0,a.jsx)("label",{htmlFor:"nessus-url",className:"block text-sm",children:"Nessus URL"}),(0,a.jsx)("input",{id:"nessus-url",className:"w-full p-2 rounded text-black",value:e,onChange:e=>s(e.target.value),"aria-invalid":p?"true":void 0,"aria-describedby":p?"nessus-error":void 0,placeholder:"https://nessus:8834","aria-label":"Nessus URL"}),(0,a.jsx)("label",{htmlFor:"nessus-username",className:"block text-sm",children:"Username"}),(0,a.jsx)("input",{id:"nessus-username",className:"w-full p-2 rounded text-black",value:r,onChange:e=>i(e.target.value),"aria-invalid":p?"true":void 0,"aria-describedby":p?"nessus-error":void 0,"aria-label":"Username"}),(0,a.jsx)("label",{htmlFor:"nessus-password",className:"block text-sm",children:"Password"}),(0,a.jsx)("input",{id:"nessus-password",type:"password",className:"w-full p-2 rounded text-black",value:n,onChange:e=>o(e.target.value),"aria-invalid":p?"true":void 0,"aria-describedby":p?"nessus-error":void 0,"aria-label":"Password"}),(0,a.jsx)("button",{type:"submit",className:"w-full rounded bg-kali-primary py-2 text-kali-inverse transition hover:bg-kali-primary/90",children:"Login"}),p&&(0,a.jsx)(g.default,{id:"nessus-error",children:p})]})})},k=S,w=()=>(0,a.jsx)(S,{})},8606:e=>{e.exports=JSON.parse('[{"id":"1","name":"OpenSSL Heartbeat Information Disclosure","cvss":5,"severity":"Medium","host":"server1.example.com","pluginFamily":"SSL","description":"OpenSSL 1.0.1 Heartbeat extension allows remote attackers to obtain sensitive information."},{"id":"2","name":"Apache HTTP Server Privilege Escalation","cvss":7.5,"severity":"High","host":"server1.example.com","pluginFamily":"Web Servers","description":"Apache may allow local users to escalate privileges."},{"id":"3","name":"Weak SSH Cipher","cvss":9.8,"severity":"Critical","host":"server2.example.com","pluginFamily":"SSH","description":"The SSH server is configured to allow weak ciphers."},{"id":"4","name":"Outdated Software","cvss":2.5,"severity":"Low","host":"server3.example.com","pluginFamily":"General","description":"Installed software is outdated."}]')},75758:(e,s,t)=>{t.d(s,{default:()=>l});var a=t(37876);t(14232);let l=e=>{let{id:s,className:t="",role:l="status",ariaLive:r,children:i}=e;return(0,a.jsx)("p",{id:s,role:l,"aria-live":null!=r?r:"alert"===l?"assertive":"polite",className:"text-red-600 text-sm mt-2 ".concat(t).trim(),children:i})}}}]);