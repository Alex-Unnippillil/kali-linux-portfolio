"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1495],{51495:(e,t,r)=>{r.r(t),r.d(t,{default:()=>B});var l=r(37876),n=r(14232);let a=JSON.parse('{"......../......../...B..../...BB.../...BW.../......../......../........":[2,2],"......../......../......../..BBB.../...BW.../......../......../........":[2,2],"......../......../......../...WB.../...BBB../......../......../........":[5,5],"......../......../......../...WB.../...BB.../....B.../......../........":[5,5]}'),s=[[0,1],[1,0],[0,-1],[-1,0],[1,1],[1,-1],[-1,1],[-1,-1]],o=()=>{let e=Array.from({length:8},()=>Array(8).fill(null));return e[3][3]="W",e[3][4]="B",e[4][3]="B",e[4][4]="W",e},i=(e,t)=>e>=0&&e<8&&t>=0&&t<8,c=(e,t,r,l)=>{if(e[t][r])return[];let n="B"===l?"W":"B",a=[],o=new Set;return s.forEach(s=>{let[c,u]=s,d=t+c,f=r+u,h=[];for(;i(d,f)&&e[d][f]===n;)h.push([d,f]),d+=c,f+=u;h.length&&i(d,f)&&e[d][f]===l&&h.forEach(e=>{let[t,r]=e,l="".concat(t,"-").concat(r);o.has(l)||(a.push([t,r]),o.add(l))})}),a},u=(e,t)=>{let r={};for(let l=0;l<8;l+=1)for(let n=0;n<8;n+=1){if(e[l][n])continue;let a=c(e,l,n,t);a.length&&(r["".concat(l,"-").concat(n)]=a)}return r},d=function(e,t,r,l){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,a=null!=n?n:c(e,t,r,l);if(!a.length)throw Error("Illegal move: no flips available");let s=e.map(e=>e.slice());return s[t][r]=l,a.forEach(e=>{let[t,r]=e;s[t][r]=l}),s},f=e=>{let t=0,r=0;return e.forEach(e=>e.forEach(e=>{"B"===e&&(t+=1),"W"===e&&(r+=1)})),{black:t,white:r}},h=e=>e.map(e=>e.map(e=>e||".").join("")).join("/"),p=[[0,0],[0,7],[7,0],[7,7]],b=[{corner:[0,0],adj:[[0,1],[1,0],[1,1]]},{corner:[0,7],adj:[[0,6],[1,7],[1,6]]},{corner:[7,0],adj:[[6,0],[7,1],[6,1]]},{corner:[7,7],adj:[[6,7],[7,6],[6,6]]}],m=(e,t,r)=>e+(t-e)*r,g={mobilityStart:8,mobilityEnd:2,parityStart:0,parityEnd:12,corners:25,edges:6,cornerAdjPenalty:-10},x=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g,l="B"===t?"W":"B",n=0;p.forEach(r=>{let[a,s]=r;e[a][s]===t?n+=1:e[a][s]===l&&(n-=1)});let a=Object.keys(u(e,t)).length-Object.keys(u(e,l)).length,s=0;for(let r=1;r<7;r+=1)e[0][r]===t?s+=1:e[0][r]===l&&(s-=1),e[7][r]===t?s+=1:e[7][r]===l&&(s-=1),e[r][0]===t?s+=1:e[r][0]===l&&(s-=1),e[r][7]===t?s+=1:e[r][7]===l&&(s-=1);let o=0;b.forEach(r=>{let{corner:n,adj:a}=r,[s,i]=n;a.forEach(r=>{let[n,a]=r;e[n][a]===t&&e[s][i]!==t?o+=1:e[n][a]===l&&e[s][i]!==l&&(o-=1)})});let{black:i,white:c}=f(e),d=(i+c)/64,h="B"===t?i-c:c-i,x=m(r.mobilityStart,r.mobilityEnd,d),v=m(r.parityStart,r.parityEnd,d);return r.corners*n+x*a+r.edges*s+v*h+r.cornerAdjPenalty*o},v=e=>{let t=new Set(p.map(e=>{let[t,r]=e;return"".concat(t,"-").concat(r)})),r=new Set;for(let e=1;e<7;e+=1)r.add("0-".concat(e)),r.add("".concat(7,"-").concat(e)),r.add("".concat(e,"-0")),r.add("".concat(e,"-").concat(7));return e.sort((e,l)=>{let[n]=e,[a]=l,[s,o]=n.split("-").map(Number),[i,c]=a.split("-").map(Number),u=(e,l)=>t.has("".concat(e,"-").concat(l))?3:r.has("".concat(e,"-").concat(l))?2:+!b.some(t=>{let{adj:r}=t;return r.some(t=>{let[r,n]=t;return r===e&&n===l})});return u(i,c)-u(s,o)})},y=function(e,t,r,l,n){let a,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1/0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1/0,i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:new Map,c=v(Object.entries(u(e,t))),p="B"===t?"W":"B";if(r<=0||0===c.length){if(0===c.length){if(0!==Object.keys(u(e,p)).length&&r>0)return y(e,p,r-1,l,n,s,o,i);let{black:t,white:a}=f(e);return 1e3*("B"===l?t-a:a-t)}return x(e,l,n)}let b="".concat(h(e),"|").concat(t,"|").concat(r);if(i.has(b))return i.get(b);if(t===l)for(let[u,f]of(a=-1/0,c)){let[c,h]=u.split("-").map(Number),b=y(d(e,c,h,t,f),p,r-1,l,n,s,o,i);if(a=Math.max(a,b),(s=Math.max(s,b))>=o)break}else for(let[u,f]of(a=1/0,c)){let[c,h]=u.split("-").map(Number),b=y(d(e,c,h,t,f),p,r-1,l,n,s,o,i);if(a=Math.min(a,b),(o=Math.min(o,b))<=s)break}return i.set(b,a),a},k=function(e,t,r){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:g,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=v(Object.entries(u(e,t)));if(0===a.length)return null;let s="B"===t?"W":"B",o=[],i=null,c=-1/0,f=0,{onProgress:h,randomizeTop:p=0}=n,b=a.length,m=new Map;for(let[n,u]of a){let[a,p]=n.split("-").map(Number),g=y(d(e,a,p,t,u),s,r-1,t,l,-1/0,1/0,m);o.push({move:[a,p],score:g}),g>c&&(c=g,i=[a,p]),f+=1,"function"==typeof h&&h({evaluated:f,total:b,candidate:[a,p],score:g,bestMove:i,bestScore:c,completed:f===b})}if(p>0){let e=o.sort((e,t)=>t.score-e.score),t=e.slice(0,Math.min(p,e.length)),r=Math.random()*t.reduce((e,r,l)=>e+(t.length-l),0);for(let e=0;e<t.length;e+=1)if((r-=t.length-e)<=0)return t[e].move}return i},w={easy:{depth:2,randomizeTop:3,weights:{mobilityStart:7,mobilityEnd:3,parityStart:0,parityEnd:10,corners:22,edges:5,cornerAdjPenalty:-12}},medium:{depth:4,randomizeTop:0,weights:{mobilityStart:8,mobilityEnd:2.5,parityStart:0,parityEnd:12,corners:26,edges:6,cornerAdjPenalty:-12}},hard:{depth:5,randomizeTop:0,weights:{mobilityStart:8,mobilityEnd:2,parityStart:0,parityEnd:14,corners:28,edges:6,cornerAdjPenalty:-14}}},j="reversiSettings",S="reversiWins",N={boardStart:"#1a463b",boardMid:"#236457",boardEnd:"#2f7d67",ambientHighlight:"rgba(255, 255, 255, 0.15)",ambientShadow:"rgba(0, 0, 0, 0.45)",gridLight:"rgba(255,255,255,0.35)",gridDark:"rgba(0,0,0,0.5)",legalGlow:"rgba(255, 240, 200, 0.45)",legalCore:"rgba(255, 255, 255, 0.75)",hintGlow:"rgba(120, 190, 255, 0.6)",hintCore:"rgba(210, 240, 255, 0.95)",lastMove:"rgba(255, 215, 0, 0.55)"},B=()=>{let e=(0,n.useRef)(null),t=(0,n.useRef)(null),s=(0,n.useRef)(null),i=(0,n.useRef)(420),c=(0,n.useRef)(o()),p=(0,n.useRef)({}),b=(0,n.useRef)("B"),m=(0,n.useRef)(!1),g=(0,n.useRef)(0),x=(0,n.useRef)(null),v=(0,n.useRef)(null),y=(0,n.useRef)(0),B=(0,n.useRef)(!1),C=(0,n.useRef)(!1),E=(0,n.useRef)(!0),R=(0,n.useRef)([]),W=(0,n.useRef)(null),A=(0,n.useRef)(null),M=(0,n.useRef)(null),T=(0,n.useRef)({r:3,c:3}),I=(0,n.useRef)(!1),P=(0,n.useRef)(null),O=(0,n.useRef)(!0),D=(0,n.useRef)(!1),[L,Y]=(0,n.useState)(()=>o()),[G,U]=(0,n.useState)(420),[_,H]=(0,n.useState)("B"),[z,q]=(0,n.useState)(!1),[F,J]=(0,n.useState)(!0),[V,X]=(0,n.useState)("Your turn"),[K,Q]=(0,n.useState)({player:0,ai:0}),[Z,$]=(0,n.useState)({player:0,ai:0}),[ee,et]=(0,n.useState)("Tip: Control the corners to gain an advantage."),[er,el]=(0,n.useState)("medium"),[en,ea]=(0,n.useState)(!0),[es,eo]=(0,n.useState)([]),[ei,ec]=(0,n.useState)(()=>f(L)),[eu,ed]=(0,n.useState)("dark"),[ef,eh]=(0,n.useState)(null),[ep,eb]=(0,n.useState)(!1),[em,eg]=(0,n.useState)({r:3,c:3}),[ex,ev]=(0,n.useState)(!1),[ey,ek]=(0,n.useState)(null),[ew,ej]=(0,n.useState)(null),[eS,eN]=(0,n.useState)(!1),[eB,eC]=(0,n.useState)(null),[eE,eR]=(0,n.useState)(null),[eW,eA]=(0,n.useState)(!0),eM=(0,n.useRef)("dark"),eT=n.useMemo(()=>en,[en]);(0,n.useEffect)(()=>{i.current=G},[G]),(0,n.useEffect)(()=>{A.current=ew},[ew]),(0,n.useEffect)(()=>{M.current=ey},[ey]),(0,n.useEffect)(()=>{T.current=em},[em]),(0,n.useEffect)(()=>{I.current=ex},[ex]),(0,n.useEffect)(()=>{E.current=F},[F]),(0,n.useEffect)(()=>{O.current=eW},[eW]),(0,n.useEffect)(()=>{D.current=eS},[eS]),(0,n.useEffect)(()=>{c.current=L},[L]),(0,n.useEffect)(()=>{b.current=_},[_]),(0,n.useEffect)(()=>{m.current=z},[z]),(0,n.useEffect)(()=>{eM.current=eu},[eu]),(0,n.useEffect)(()=>{ec(f(L))},[L]),(0,n.useEffect)(()=>()=>clearTimeout(P.current),[]),(0,n.useEffect)(()=>{if("undefined"==typeof document)return;let e=()=>{eA(!document.hidden)};return e(),document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[]),(0,n.useEffect)(()=>{let e,r=t.current;if(!r)return;let l=()=>{let e=r.getBoundingClientRect();e.width&&U(Math.min(Math.max(e.width-16,240),520))};return l(),"undefined"!=typeof ResizeObserver?(e=new ResizeObserver(l)).observe(r):window.addEventListener("resize",l),()=>{e?e.disconnect():window.removeEventListener("resize",l)}},[]),(0,n.useEffect)(()=>{try{let e=window.localStorage.getItem(j);if(!e)return;let t=JSON.parse(e);(null==t?void 0:t.difficulty)&&el(t.difficulty),"boolean"==typeof(null==t?void 0:t.useBook)&&ea(t.useBook),(null==t?void 0:t.diskTheme)&&ed(t.diskTheme),"boolean"==typeof(null==t?void 0:t.sound)&&J(t.sound)}catch(e){}},[]),(0,n.useEffect)(()=>{try{window.localStorage.setItem(j,JSON.stringify({difficulty:er,useBook:en,diskTheme:eu,sound:F}))}catch(e){}},[er,en,eu,F]),(0,n.useEffect)(()=>{try{let e=window.localStorage.getItem(S);e&&Q(JSON.parse(e))}catch(e){}},[]),(0,n.useEffect)(()=>{try{window.localStorage.setItem(S,JSON.stringify(K))}catch(e){}},[K]);let eI=n.useCallback(()=>{if(E.current)try{let e=window.AudioContext||window.webkitAudioContext;if(!e)return;let t=x.current||new e;x.current=t,"suspended"===t.state&&t.resume().catch(()=>{});let r=t.createOscillator(),l=t.createGain();r.connect(l),l.connect(t.destination),r.frequency.value=500,r.start(),l.gain.setValueAtTime(.3,t.currentTime),l.gain.exponentialRampToValueAtTime(.001,t.currentTime+.1),r.stop(t.currentTime+.1)}catch(e){}},[]),eP=(0,n.useCallback)((e,t,r,l,n)=>{if(C.current)return;let a=performance.now();l.forEach((e,t)=>{let[l,s]=e;R.current.push({key:"".concat(l,"-").concat(s),from:n[l][s],to:r,start:a+80*t,duration:360})})},[]),eO=(0,n.useCallback)(function(e,t,r){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=u(c.current,r),a=l||n["".concat(e,"-").concat(t)];if(!a)return!1;let s=c.current.map(e=>e.slice()),o=d(s,e,t,r,a);return eP(e,t,r,a,s),eo(l=>[...l,{board:s,player:r,move:{r:e,c:t},flips:a}]),Y(o),H("B"===r?"W":"B"),ej({r:e,c:t,player:r}),ek(null),W.current=null,eN(!1),eg({r:e,c:t}),eI(),!0},[eI,eP]),eD=(0,n.useCallback)(()=>{if(m.current||D.current||!O.current)return;let e=eT?((e,t)=>{if("W"!==t)return null;let{black:r,white:l}=f(e);return r+l>5?null:a[h(e)]||null})(c.current,"W"):null;if(e){let[t,r]=e;eO(t,r,"W");return}B.current=!0,eb(!0),eh(null);let{depth:t,weights:r,randomizeTop:l}=w[er],n=y.current+1;if(y.current=n,v.current)return void v.current.postMessage({type:"search",id:n,board:c.current,player:"W",depth:t,weights:r,randomizeTop:l});let s=k(c.current,"W",t,r,{randomizeTop:l,onProgress:e=>{let{evaluated:t,total:r}=e;y.current===n&&eh({evaluated:t,total:r})}});if(B.current=!1,eb(!1),eh(null),!s||y.current!==n)return;let[o,i]=s;if(m.current||!O.current)return void eR({r:o,c:i,player:"W"});eO(o,i,"W")},[eT,eO,er]);(0,n.useEffect)(()=>{if(C.current=window.matchMedia("(prefers-reduced-motion: reduce)").matches,"function"==typeof Worker)try{v.current=new Worker(r.tu(new URL(r.p+r.u(8238),r.b))),v.current.onmessage=e=>{let{type:t,id:r}=e.data;if(r&&r!==y.current)return;if("progress"===t){let{evaluated:t,total:r}=e.data;eh({evaluated:t,total:r});return}if("done"!==t)return;B.current=!1,eb(!1),eh(null);let{move:l}=e.data;if(!l||D.current||"W"!==b.current)return;let[n,a]=l;if(m.current||!O.current)return void eR({r:n,c:a,player:"W"});eO(n,a,"W")}}catch(e){v.current=null}return()=>{var e;return null==(e=v.current)?void 0:e.terminate()}},[eO]),(0,n.useEffect)(()=>{let t=e.current;if(!t)return;let r=t.getContext("2d"),l=()=>{(()=>{let e=i.current,t=e/8,l=A.current,n=M.current,a=T.current,s=I.current;r.clearRect(0,0,e,e);let o=r.createLinearGradient(0,0,e,e);o.addColorStop(0,N.boardStart),o.addColorStop(.45,N.boardMid),o.addColorStop(1,N.boardEnd),r.fillStyle=o,r.fillRect(0,0,e,e);let u=r.createRadialGradient(.2*e,.2*e,.1*e,.5*e,.5*e,.8*e);u.addColorStop(0,N.ambientHighlight),u.addColorStop(1,N.ambientShadow),r.fillStyle=u,r.fillRect(0,0,e,e),r.lineWidth=2;for(let l=0;l<=8;l+=1){let n=l*t,a=r.createLinearGradient(0,n,e,n);a.addColorStop(0,N.gridDark),a.addColorStop(.5,N.gridLight),a.addColorStop(1,N.gridDark),r.strokeStyle=a,r.beginPath(),r.moveTo(0,n),r.lineTo(e,n),r.stroke();let s=r.createLinearGradient(n,0,n,e);s.addColorStop(0,N.gridDark),s.addColorStop(.5,N.gridLight),s.addColorStop(1,N.gridDark),r.strokeStyle=s,r.beginPath(),r.moveTo(n,0),r.lineTo(n,e),r.stroke()}r.lineWidth=4;let d=r.createLinearGradient(0,0,e,e);d.addColorStop(0,"rgba(0,0,0,0.6)"),d.addColorStop(.5,"rgba(255,255,255,0.2)"),d.addColorStop(1,"rgba(0,0,0,0.6)"),r.strokeStyle=d,r.strokeRect(2,2,e-4,e-4);let f=c.current,h=performance.now(),g="dark"===eM.current?{B:"#1b263b",W:"#f8fafc"}:{B:"#2f3e46",W:"#e0fbfc"},x=function(e,l,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{scaleY:s=1,tilt:o=0,highlight:i=!1}=a;r.save(),r.translate(e,l),r.scale(1,s),r.translate(0,o);let c=t/2-6,u=r.createRadialGradient(0,-(.4*c),.2*c,0,0,c);u.addColorStop(0,i?"#ffffff":"#f1f5f9"),u.addColorStop(.4,n),u.addColorStop(1,"#0f172a"),r.beginPath(),r.shadowColor="rgba(0,0,0,0.6)",r.shadowBlur=8,r.shadowOffsetY=4,r.arc(0,0,c,0,2*Math.PI),r.fillStyle=u,r.fill(),r.lineWidth=1.6,r.strokeStyle="dark"===eM.current?"#0f172a":"#1e293b",r.stroke(),r.restore()};for(let e=0;e<8;e+=1)for(let n=0;n<8;n+=1){let a=f[e][n],s=R.current.find(t=>t.key==="".concat(e,"-").concat(n)),o=n*t+t/2,i=e*t+t/2;if(l&&l.r===e&&l.c===n){r.save();let l=r.createRadialGradient(o,i,.1*t,o,i,.6*t);l.addColorStop(0,N.lastMove),l.addColorStop(1,"rgba(255, 215, 0, 0)"),r.fillStyle=l,r.fillRect(n*t,e*t,t,t),r.restore()}if(s){let e=(h-s.start)/s.duration;if(e<=0)x(o,i,g[s.from]);else if(e>=1){let e=R.current.indexOf(s);-1!==e&&R.current.splice(e,1),x(o,i,g[s.to])}else{let r=Math.min(Math.max(e,0),1)*Math.PI,l=Math.max(Math.abs(Math.cos(r)),.08),n=e>=.5,a=.08*t*Math.sin(r);x(o,i,n?g[s.to]:g[s.from],{scaleY:l,tilt:a,highlight:n})}continue}a&&x(o,i,g[a])}if(!m.current&&W.current){let{r:e,c:l,flips:n}=W.current,a=l*t+t/2,s=e*t+t/2;r.save(),r.globalAlpha=.65,x(a,s,"B"===b.current?g.B:g.W),r.restore(),r.strokeStyle="rgba(255,255,255,0.8)",r.lineWidth=1.5,n.forEach(e=>{let[l,n]=e;r.beginPath(),r.arc(n*t+t/2,l*t+t/2,t/2-6,0,2*Math.PI),r.stroke()})}if(!m.current&&"B"===b.current){if(r.save(),Object.keys(p.current).forEach(e=>{let[l,a]=e.split("-").map(Number),s=a*t+t/2,o=l*t+t/2,i=r.createRadialGradient(s,o,.1*t,s,o,.45*t),c=n&&n.r===l&&n.c===a;i.addColorStop(0,c?N.hintCore:N.legalCore),i.addColorStop(1,c?N.hintGlow:N.legalGlow),r.fillStyle=i,r.fillRect(a*t,l*t,t,t)}),a&&s){let{r:e,c:l}=a;r.strokeStyle="rgba(255,255,255,0.85)",r.lineWidth=2.5,r.strokeRect(l*t+3,e*t+3,t-6,t-6)}Object.keys(p.current).forEach(e=>{let[l,a]=e.split("-").map(Number);if(n&&n.r===l&&n.c===a){let e=a*t+t/2,n=l*t+t/2;r.beginPath(),r.strokeStyle="rgba(120, 190, 255, 0.9)",r.lineWidth=2,r.arc(e,n,t/2-10,0,2*Math.PI),r.stroke()}}),r.restore()}})(),g.current=requestAnimationFrame(l)};return g.current=requestAnimationFrame(l),()=>cancelAnimationFrame(g.current)},[]),(0,n.useEffect)(()=>{clearTimeout(P.current);let e=((e,t)=>{let r=u(e,t);if(Object.keys(r).length>0)return{kind:"play",legalMoves:r};let l="B"===t?"W":"B";if(Object.keys(u(e,l)).length>0)return{kind:"pass",nextPlayer:l,legalMoves:r};let n=f(e),a=n.black===n.white?"D":n.black>n.white?"B":"W";return{kind:"gameover",score:n,winner:a}})(L,_),t="play"===e.kind?e.legalMoves:{};if(p.current=t,$({player:Object.keys(u(L,"B")).length,ai:Object.keys(u(L,"W")).length}),et(["0-0","0-".concat(7),"".concat(7,"-0"),"".concat(7,"-").concat(7)].some(e=>t[e])?"Tip: Corners are powerful—capture them when you can!":"Tip: Control the corners to gain an advantage."),"gameover"===e.kind){let{score:t,winner:r}=e;eb(!1),B.current=!1,eh(null),eN(!0),eC({winner:r,score:t}),"B"===r?(Q(e=>({...e,player:e.player+1})),X("You win!")):"W"===r?(Q(e=>({...e,ai:e.ai+1})),X("AI wins!")):X("Draw!"),ec(t);return}if(eN(!1),eC(null),z||!eW)return void(z?X(eE?"Paused — AI move queued":"Paused"):X("Tab inactive — resume to continue"));if(eE&&"W"===_)return void X("AI move queued");if("pass"===e.kind){eb(!1),B.current=!1,eh(null),X("No legal moves, passing turn"),ek(null),W.current=null,P.current=setTimeout(()=>{H(e.nextPlayer)},600);return}"W"!==_||B.current||eD(),"B"===_?X("Your turn"):B.current?X("AI is thinking..."):X("AI's turn")},[L,_,z,eW,eE,eD]);let eL=(0,n.useCallback)((e,t)=>{if(z||"B"!==_||eS)return;let r="".concat(e,"-").concat(t),l=p.current[r];l&&(W.current=null,eO(e,t,"B",l))},[z,_,eS,eO]),eY=()=>{var e;null==(e=s.current)||e.focus()},eG=()=>{clearTimeout(P.current),Y(o()),H("B"),X("Your turn"),q(!1),eo([]),eh(null),eb(!1),B.current=!1,y.current+=1,ek(null),ej(null),eN(!1),eC(null),eR(null),eg({r:3,c:3})},eU=()=>{window.confirm("Reset win counters for this device?")&&Q({player:0,ai:0})},e_=(0,n.useCallback)(()=>{if(!es.length)return;clearTimeout(P.current);let e="W"===es[es.length-1].player&&es.length>=2?2:1,t=es[es.length-e],r=es.slice(0,-e);Y(t.board.map(e=>e.slice())),H(t.player),eo(r),X("B"===t.player?"Your turn":"AI's turn"),W.current=null,R.current=[],B.current=!1,y.current+=1,eb(!1),eh(null);let l=r[r.length-1];(null==l?void 0:l.move)?ej({r:l.move.r,c:l.move.c,player:l.player}):ej(null),ek(null),eN(!1),eC(null),eR(null),t.move&&eg({r:t.move.r,c:t.move.c})},[es]);(0,n.useEffect)(()=>{if(!eE)return;if("W"!==_||eS)return void eR(null);if(z||!eW)return;let{r:e,c:t}=eE;eO(e,t,"W")&&eR(null)},[eE,z,eW,eS,_,eO]),(0,n.useEffect)(()=>{ek(null)},[_,L]);let eH=(0,n.useCallback)(()=>{if("B"!==_||z||eS)return;let{weights:e}=w[er]||w.medium,t=k(c.current,"B",3,e)||null;if(t){let[e,r]=t,l=p.current["".concat(e,"-").concat(r)];ek({r:e,c:r,flips:l||[]}),eg({r:e,c:r})}else ek(null)},[er,z,_,eS]),ez=ei.black+ei.white||1,eq=ei.black/ez*100,eF="reversi-instructions";return(0,l.jsx)("div",{className:"h-full w-full overflow-y-auto bg-ub-cool-grey text-white",children:(0,l.jsxs)("div",{className:"mx-auto flex w-full max-w-5xl flex-col gap-6 p-4 md:flex-row",children:[(0,l.jsxs)("div",{ref:t,className:"flex flex-1 flex-col items-center gap-3",children:[(0,l.jsxs)("div",{ref:s,role:"application","aria-roledescription":"Reversi board","aria-describedby":eF,"aria-keyshortcuts":"ArrowUp ArrowDown ArrowLeft ArrowRight Enter Space H U Backspace R P",tabIndex:0,onFocus:()=>ev(!0),onBlur:()=>ev(!1),onKeyDown:e=>{let{key:t}=e;if("p"===t||"P"===t){e.preventDefault(),q(e=>!e);return}if("r"===t||"R"===t){e.preventDefault(),eG();return}if("u"===t||"U"===t||"Backspace"===t){e.preventDefault(),e_();return}if(z||eS||!em)return;let r=(t,r)=>{e.preventDefault(),eg(e=>{let l=(e.r+t+8)%8,n=(e.c+r+8)%8,a="".concat(l,"-").concat(n);return"B"===_&&p.current[a]?W.current={r:l,c:n,flips:p.current[a]}:W.current=null,{r:l,c:n}})};if("ArrowUp"===t)return void r(-1,0);if("ArrowDown"===t)return void r(1,0);if("ArrowLeft"===t)return void r(0,-1);if("ArrowRight"===t)return void r(0,1);if("Enter"===t||" "===t){e.preventDefault(),eL(em.r,em.c);return}("h"===t||"H"===t)&&(e.preventDefault(),eH())},className:"relative rounded-lg focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-400 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-950",children:[(0,l.jsx)("canvas",{ref:e,width:G,height:G,onPointerDown:eY,onClick:t=>{eY();let r=e.current.getBoundingClientRect(),l=i.current/8,n=t.clientX-r.left,a=Math.floor((t.clientY-r.top)/l),s=Math.floor(n/l);a<0||a>=8||s<0||s>=8||(eg({r:a,c:s}),eL(a,s))},onMouseMove:t=>{if(m.current||"B"!==b.current||eS){W.current=null;return}let r=e.current.getBoundingClientRect(),l=i.current/8,n=t.clientX-r.left,a=Math.floor((t.clientY-r.top)/l),s=Math.floor(n/l);if(a<0||a>=8||s<0||s>=8){W.current=null;return}let o="".concat(a,"-").concat(s),c=p.current[o];W.current=c?{r:a,c:s,flips:c}:null,eg({r:a,c:s})},onMouseLeave:()=>{W.current=null},className:"rounded-lg shadow-[0_35px_60px_-15px_rgba(0,0,0,0.45)]","aria-label":"Reversi board"}),eS&&eB&&(0,l.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-lg bg-slate-950/85 p-4 text-center",children:(0,l.jsxs)("div",{className:"w-full max-w-xs space-y-3 rounded-lg border border-slate-700/70 bg-slate-900/90 p-4 shadow-xl",children:[(0,l.jsx)("div",{className:"text-lg font-semibold text-slate-100",children:"B"===eB.winner?"You win!":"W"===eB.winner?"AI wins!":"Draw game"}),(0,l.jsxs)("div",{className:"text-sm text-slate-300",children:["Final score — You ",eB.score.black," : AI ",eB.score.white]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("button",{className:"w-full rounded border border-slate-700 bg-slate-900/80 px-3 py-2 text-sm font-semibold uppercase tracking-widest text-slate-100 transition hover:border-sky-400 hover:text-sky-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-400",onClick:eG,children:"Play Again"}),(0,l.jsx)("button",{className:"w-full rounded border border-slate-700 bg-slate-900/80 px-3 py-2 text-xs font-semibold uppercase tracking-widest text-slate-200 transition hover:border-rose-400 hover:text-rose-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-400",onClick:eU,children:"Reset Wins"})]})]})}),(0,l.jsxs)("div",{className:"pointer-events-none absolute inset-x-3 top-3 flex justify-between text-xs font-semibold uppercase tracking-widest text-slate-200/80",children:[(0,l.jsxs)("span",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"h-3 w-3 rounded-full ".concat("dark"===eu?"bg-slate-900":"bg-slate-600"),"aria-hidden":"true"}),"You ",ei.black]}),(0,l.jsxs)("span",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"h-3 w-3 rounded-full ".concat("dark"===eu?"bg-slate-100":"bg-slate-300"),"aria-hidden":"true"}),"AI ",ei.white]})]}),(0,l.jsx)("p",{id:eF,className:"sr-only",children:"Use arrow keys to move around the board and press Enter or Space to place a disk. Press H for a hint, U or Backspace to undo, R to reset, or P to pause. Click cells directly to play."})]}),(0,l.jsxs)("div",{className:"w-full space-y-3 rounded-lg bg-slate-900/60 p-4 shadow-inner",children:[(0,l.jsx)("div",{className:"text-sm font-semibold uppercase tracking-widest text-slate-200",children:"Score Balance"}),(0,l.jsx)("div",{className:"h-3 w-full overflow-hidden rounded-full bg-slate-800","aria-hidden":"true",children:(0,l.jsx)("div",{className:"h-full rounded-full bg-gradient-to-r from-sky-500 via-cyan-400 to-emerald-400 transition-all",style:{width:"".concat(eq,"%")}})}),(0,l.jsxs)("div",{className:"flex justify-between text-xs text-slate-300",children:[(0,l.jsxs)("span",{children:["You • ",ei.black]}),(0,l.jsxs)("span",{children:["AI • ",ei.white]})]}),(0,l.jsx)("div",{className:"text-sm font-semibold uppercase tracking-widest text-slate-200",children:"Mobility"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs text-slate-300",children:[(0,l.jsxs)("div",{className:"rounded border border-slate-700/70 bg-slate-900/80 p-2 text-center",children:[(0,l.jsx)("div",{className:"font-semibold text-slate-100",children:"You"}),(0,l.jsx)("div",{className:"text-lg font-bold text-sky-300",children:Z.player})]}),(0,l.jsxs)("div",{className:"rounded border border-slate-700/70 bg-slate-900/80 p-2 text-center",children:[(0,l.jsx)("div",{className:"font-semibold text-slate-100",children:"AI"}),(0,l.jsx)("div",{className:"text-lg font-bold text-rose-300",children:Z.ai})]})]})]})]}),(0,l.jsxs)("div",{className:"flex w-full max-w-md flex-col gap-4 rounded-lg bg-slate-950/70 p-4 text-slate-100 shadow-lg",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("div",{className:"text-lg font-semibold tracking-wide text-slate-50",children:"Reversi Control Center"}),(0,l.jsx)("div",{className:"text-sm",role:"status","aria-live":"polite",children:V}),z&&eE&&(0,l.jsx)("div",{className:"text-xs text-amber-200",role:"status","aria-live":"polite",children:"AI move queued — resume to apply it."}),ep&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-xs text-slate-300",role:"status","aria-live":"polite",children:[(0,l.jsx)("span",{"aria-hidden":"true",className:"inline-flex h-3 w-3 animate-spin rounded-full border border-slate-400/30 border-t-transparent"}),(0,l.jsx)("span",{children:ef&&ef.total?"AI evaluating moves (".concat(ef.evaluated,"/").concat(ef.total,")"):"AI evaluating moves..."})]}),(0,l.jsx)("div",{className:"text-xs uppercase tracking-wider text-slate-400",children:ee}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2 text-xs text-slate-300",children:[(0,l.jsxs)("span",{className:"rounded border border-slate-700/70 bg-slate-900/60 px-2 py-1 font-semibold uppercase tracking-widest",children:["Wins • You ",K.player," / AI ",K.ai]}),(0,l.jsxs)("span",{className:"rounded border border-slate-700/70 bg-slate-900/60 px-2 py-1 font-semibold uppercase tracking-widest",children:["Turn • ","B"===_?"You":"AI"]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,l.jsxs)("button",{className:"flex items-center justify-center gap-2 rounded border border-slate-700 bg-slate-900/70 px-3 py-2 font-semibold text-slate-100 transition hover:border-sky-400 hover:text-sky-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-400",onClick:eG,children:[(0,l.jsx)("img",{src:"/themes/Yaru/status/chrome_refresh.svg",width:"18",height:"18",alt:""}),"Reset"]}),(0,l.jsxs)("button",{className:"flex items-center justify-center gap-2 rounded border border-slate-700 bg-slate-900/70 px-3 py-2 font-semibold text-slate-100 transition hover:border-sky-400 hover:text-sky-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-400 disabled:cursor-not-allowed disabled:opacity-50",onClick:e_,disabled:!es.length,children:[(0,l.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",width:"18",height:"18","aria-hidden":"true",children:[(0,l.jsx)("path",{d:"M9 15L3 9l6-6"}),(0,l.jsx)("path",{d:"M3 9h11a4 4 0 0 1 0 8h-1"})]}),"Undo"]}),(0,l.jsx)("button",{className:"flex items-center justify-center gap-2 rounded border border-slate-700 bg-slate-900/70 px-3 py-2 font-semibold transition hover:border-emerald-400 hover:text-emerald-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",onClick:()=>q(e=>!e),"aria-pressed":z,children:z?"Resume":"Pause"}),(0,l.jsx)("button",{className:"flex items-center justify-center gap-2 rounded border border-slate-700 bg-slate-900/70 px-3 py-2 font-semibold transition hover:border-emerald-400 hover:text-emerald-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",onClick:()=>J(e=>!e),"aria-pressed":F,children:F?"Sound: On":"Sound: Off"}),(0,l.jsx)("button",{className:"flex items-center justify-center gap-2 rounded border border-slate-700 bg-slate-900/70 px-3 py-2 font-semibold transition hover:border-violet-400 hover:text-violet-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-violet-400",onClick:()=>ed(e=>"dark"===e?"light":"dark"),"aria-pressed":"light"===eu,children:"dark"===eu?"Theme: Dark":"Theme: Light"}),(0,l.jsx)("button",{className:"flex items-center justify-center gap-2 rounded border border-slate-700 bg-slate-900/70 px-3 py-2 font-semibold transition hover:border-sky-400 hover:text-sky-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-400",onClick:eH,disabled:"B"!==_||z||eS,children:"Hint"})]}),(0,l.jsx)("button",{className:"w-full rounded border border-slate-700 bg-slate-900/70 px-3 py-2 text-xs font-semibold uppercase tracking-widest text-slate-200 transition hover:border-rose-400 hover:text-rose-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-400",onClick:eU,children:"Reset Wins"}),(0,l.jsxs)("div",{className:"flex flex-col gap-2 text-sm",children:[(0,l.jsx)("label",{className:"text-xs font-semibold uppercase tracking-widest text-slate-300",htmlFor:"reversi-difficulty",children:"Difficulty"}),(0,l.jsx)("select",{id:"reversi-difficulty",className:"rounded border border-slate-700 bg-slate-900/70 px-3 py-2 font-semibold text-slate-100 focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-400",value:er,onChange:e=>el(e.target.value),children:Object.keys(w).map(e=>(0,l.jsx)("option",{value:e,children:"Difficulty: ".concat(e.charAt(0).toUpperCase()).concat(e.slice(1))},e))}),(0,l.jsx)("button",{className:"w-full rounded border border-slate-700 bg-slate-900/70 px-3 py-2 text-sm font-semibold uppercase tracking-widest text-slate-100 transition hover:border-amber-400 hover:text-amber-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-amber-400",onClick:()=>ea(e=>!e),"aria-pressed":en,children:en?"Opening Book: Enabled":"Opening Book: Disabled"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("div",{className:"text-xs font-semibold uppercase tracking-widest text-slate-300",children:"Move History"}),(0,l.jsx)("ul",{className:"max-h-40 space-y-1 overflow-y-auto rounded border border-slate-800/80 bg-slate-900/60 p-3 text-xs font-mono text-slate-200",children:es.length?es.map((e,t)=>(0,l.jsx)("li",{children:((e,t)=>{if(!e.move)return"Move ".concat(t+1);let{r,c:l}=e.move,n=String.fromCharCode(65+l);return"".concat(t+1,". ").concat("B"===e.player?"You":"AI"," → ").concat(n).concat(r+1)})(e,t)},"".concat(e.player,"-").concat(t,"-").concat(e.move?"".concat(e.move.r,"-").concat(e.move.c):"na"))):(0,l.jsx)("li",{children:"No moves yet. Claim a corner to start strong!"})}),ey&&(0,l.jsxs)("div",{className:"rounded border border-sky-500/50 bg-sky-500/10 px-3 py-2 text-xs text-sky-200",children:["Suggested move: ",String.fromCharCode(65+ey.c),ey.r+1,". Press Enter or click to place."]})]}),(0,l.jsxs)("div",{className:"space-y-1 text-xs text-slate-400",children:[(0,l.jsx)("div",{className:"font-semibold uppercase tracking-widest text-slate-300",children:"Accessibility & Tips"}),(0,l.jsx)("p",{children:"Color palette is tuned for high contrast and colorblind-friendly play. Navigate with keyboard arrows, use Tab to focus the board, and toggle hints with the H key."})]})]})]})})}}}]);