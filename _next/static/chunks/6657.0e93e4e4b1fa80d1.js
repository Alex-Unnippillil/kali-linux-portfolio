"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6657],{16657:(e,t,r)=>{r.r(t),r.d(t,{default:()=>S});var l=r(37876),a=r(14232),s=r(95220),n=r(16924);let o=["I","J","L","O","S","T","Z"];class i{setMode(e){this.mode=e,"seven-bag"===e&&(this.bag=[])}next(){return"seven-bag"===this.mode?(0===this.bag.length&&(this.bag=(e=>{for(let t=e.length-1;t>0;t--){let r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e})([...o])),this.bag.pop()):o[Math.floor(Math.random()*o.length)]}constructor(e="seven-bag"){this.bag=[],this.mode=e}}var c=r(67817),u=r(65422);let d={I:{shape:[[1,1,1,1]],color:"#06b6d4"},J:{shape:[[1,0,0],[1,1,1]],color:"#3b82f6"},L:{shape:[[0,0,1],[1,1,1]],color:"#f97316"},O:{shape:[[1,1],[1,1]],color:"#eab308"},S:{shape:[[0,1,1],[1,1,0]],color:"#22c55e"},T:{shape:[[0,1,0],[1,1,1]],color:"#a855f7"},Z:{shape:[[1,1,0],[0,1,1]],color:"#ef4444"}},p=Object.values(d).map(e=>e.color),b=()=>Array.from({length:20},()=>Array(10).fill(0)),h=(e,t)=>{let{r,g:l,b:a}=(e=>{let t=parseInt(e.replace("#",""),16);return{r:t>>16&255,g:t>>8&255,b:255&t}})(e),s=e=>Math.min(255,Math.max(0,e+t));return"rgb(".concat(s(r),", ").concat(s(l),", ").concat(s(a),")")},m=e=>({shape:d[e].shape.map(e=>e.slice()),color:d[e].color,type:e,rotation:0}),x=(e,t,r)=>Math.min(r,Math.max(t,e)),f=e=>"number"==typeof e&&Number.isFinite(e),g=e=>null===e||f(e),v=e=>!!e&&"object"==typeof e&&Object.keys(N).every(t=>"string"==typeof e[t]&&e[t].length>0),y={JLSTZ:{0:{1:[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],3:[[0,0],[1,0],[1,1],[0,-2],[1,-2]]},1:{0:[[0,0],[1,0],[1,-1],[0,2],[1,2]],2:[[0,0],[1,0],[1,-1],[0,2],[1,2]]},2:{1:[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],3:[[0,0],[1,0],[1,1],[0,-2],[1,-2]]},3:{2:[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],0:[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]]}},I:{0:{1:[[0,0],[-2,0],[1,0],[-2,-1],[1,2]],3:[[0,0],[-1,0],[2,0],[-1,2],[2,-1]]},1:{0:[[0,0],[2,0],[-1,0],[2,1],[-1,-2]],2:[[0,0],[-1,0],[2,0],[-1,2],[2,-1]]},2:{1:[[0,0],[1,0],[-2,0],[1,-2],[-2,1]],3:[[0,0],[2,0],[-1,0],[2,1],[-1,-2]]},3:{2:[[0,0],[-2,0],[1,0],[-2,-1],[1,2]],0:[[0,0],[1,0],[-2,0],[1,-2],[-2,1]]}}},w=[0,100,300,500,800],j=[400,800,1200,1600],k=(e,t,r,l)=>{for(let a=0;a<t.length;a+=1)for(let s=0;s<t[a].length;s+=1)if(t[a][s]){let t=r+s,n=l+a;if(t<0||t>=10||n>=20||n>=0&&e[n][t])return!1}return!0},N={left:"ArrowLeft",right:"ArrowRight",down:"ArrowDown",rotate:"ArrowUp",drop:"Space",hold:"Shift",pause:"p",reset:"r",sound:"m",settings:"s"},S=function(){var e,t;let{windowMeta:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=null==(e=null==r?void 0:r.isFocused)||e,S=(0,c.default)(),C=(0,n.default)(160,320),R=(0,a.useRef)(null),E=(0,a.useRef)(null),M=(0,a.useRef)(new i),[A,T]=(0,s.default)("tetris-use-bag",!0,e=>"boolean"==typeof e);(0,a.useEffect)(()=>{M.current.setMode(A?"seven-bag":"true-random")},[A]);let L=(0,a.useCallback)(()=>m(M.current.next()),[]),[D,P]=(0,a.useState)(b),[F,_]=(0,a.useState)(L),[O,G]=(0,a.useState)({x:Math.floor(5)-2,y:0}),[H,I]=(0,a.useState)(()=>[L(),L(),L()]),[q,K]=(0,a.useState)(null),[z,B]=(0,a.useState)(!0),[U,J]=(0,a.useState)(0),[Z,Y]=(0,a.useState)(1),[W,X]=(0,a.useState)(0),[Q,V]=(0,a.useState)(0),[$,ee]=(0,a.useState)(0),[et,er]=(0,s.default)("tetris-high-score",0,f),[el,ea]=(0,s.default)("tetris-max-level",1,f),[es,en]=(0,s.default)("tetris-keys",N,v),[eo,ei]=(0,a.useState)(!1),[ec,eu]=(0,a.useState)(!1),ed=(0,a.useRef)(!1),[ep,eb]=(0,s.default)("tetris-sound",!0,e=>"boolean"==typeof e),[eh,em]=(0,a.useState)(""),[ex,ef]=(0,a.useState)("marathon"),eg=(0,a.useRef)(null),[ev,ey]=(0,a.useState)(0),[ew,ej]=(0,s.default)("tetris-best-time",null,g),[ek,eN]=(0,a.useState)(null),[eS,eC]=(0,a.useState)(null),eR=(0,a.useRef)(null),[eE,eM]=(0,a.useState)(""),[eA,eT]=(0,a.useState)(!1),[eL,eD]=(0,s.default)("tetris-das",150,f),[eP,eF]=(0,s.default)("tetris-arr",50,f),[e_,eO]=(0,a.useState)(!1),[eG,eH]=(0,a.useState)(!1),eI=(0,a.useRef)(!1),[eq,eK]=(0,a.useState)(!1),[ez,eB]=(0,a.useState)(null),eU=ec||!!eS||eq||eo;(0,a.useEffect)(()=>{let e=window.matchMedia("(prefers-reduced-motion: reduce)"),t=()=>{eI.current=e.matches};return t(),e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[]);let eJ=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;if(eI.current||"undefined"==typeof document)return;let t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.pointerEvents="none",t.style.overflow="hidden",t.style.zIndex="9999",document.body.appendChild(t);let r=[];for(let l=0;l<e;l+=1){let e=document.createElement("div"),a=4+5*Math.random(),s=180*Math.random();e.style.position="absolute",e.style.width="".concat(a,"px"),e.style.height="".concat(a,"px"),e.style.backgroundColor=p[l%p.length],e.style.top="0px",e.style.left="".concat(100*Math.random(),"%"),e.style.opacity="1",e.style.borderRadius="2px",e.style.transform="translate3d(0, 0, 0) rotate(0deg)",e.style.transition="transform ".concat(2600,"ms ease-out, opacity ").concat(2600,"ms ease-out"),e.style.transitionDelay="".concat(s,"ms"),t.appendChild(e),r.push(e)}requestAnimationFrame(()=>{r.forEach(e=>{let t=(Math.random()-.5)*window.innerWidth*.6,r=720*Math.random();e.style.transform="translate3d(".concat(t,"px, ").concat(window.innerHeight+100,"px, 0) rotate(").concat(r,"deg)"),e.style.opacity="0"})}),setTimeout(()=>{t.remove()},2980)},[]),eZ=(0,a.useRef)(!1),eY=(0,a.useRef)(null),eW=(0,a.useRef)(!1),eX=(0,a.useRef)(0),eQ=(0,a.useRef)(0),eV=(0,a.useRef)(null),e$=(0,a.useRef)({left:null,right:null}),e0=(0,a.useRef)({left:null,right:null}),e1=(0,a.useRef)({left:0,right:0}),e2=(0,a.useRef)({left:!1,right:!1}),e5=(0,a.useRef)({leftStart:0,leftRepeat:0,rightStart:0,rightRepeat:0,downRepeat:0,rotate:!1,drop:!1,hold:!1,pause:!1,reset:!1}),e4=(0,a.useRef)(D),e3=(0,a.useRef)(F),e6=(0,a.useRef)(O);(0,a.useEffect)(()=>{e4.current=D},[D]),(0,a.useEffect)(()=>{e3.current=F},[F]),(0,a.useEffect)(()=>{e6.current=O},[O]),(0,a.useEffect)(()=>{let e=D.findIndex(e=>e.some(e=>e));eT(-1!==e&&e<4)},[D]),(0,a.useEffect)(()=>{eD(e=>{let t=x(e,50,500);return t===e?e:t}),eF(e=>{let t=x(e,10,200);return t===e?e:t})},[eF,eD]),(0,a.useEffect)(()=>{var e,t;eo?(null==(e=E.current)||e.focus(),e2.current.left=!1,e2.current.right=!1,eZ.current=!1,["left","right"].forEach(e=>{e$.current[e]&&(clearTimeout(e$.current[e]),e$.current[e]=null),e0.current[e]&&(cancelAnimationFrame(e0.current[e]),e0.current[e]=null,e1.current[e]=0)})):null==(t=R.current)||t.focus()},[eo]),(0,a.useEffect)(()=>{let e=()=>{"undefined"!=typeof navigator&&eH((navigator.getGamepads?navigator.getGamepads():[]).some(e=>e))};return e(),window.addEventListener("gamepadconnected",e),window.addEventListener("gamepaddisconnected",e),()=>{window.removeEventListener("gamepadconnected",e),window.removeEventListener("gamepaddisconnected",e)}},[]);let e8=Math.max(100,1e3-(Z-1)*100),e7=(0,a.useRef)(null),e9=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:440,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;if(ep)try{let r=e7.current||new(window.AudioContext||window.webkitAudioContext);e7.current=r;let l=r.createOscillator();l.type="square",l.frequency.value=e,l.connect(r.destination),l.start(),l.stop(r.currentTime+t)}catch(e){}},[ep]);(0,a.useEffect)(()=>()=>{var e,t;null==(t=e7.current)||null==(e=t.close)||e.call(t)},[]);let te=(0,a.useCallback)(()=>{e9(120,.05),eI.current||(eO(!0),setTimeout(()=>eO(!1),100))},[e9]),tt=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e4.current,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e3.current.shape,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e6.current.x,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e6.current.y,a=l;for(;k(e,t,r,a+1);)a+=1;return a},[]),tr=(0,a.useCallback)(()=>{let e=performance.now()-eg.current;eN(e),(!ew||e<ew)&&ej(e),eu(!0)},[ew,ej]),tl=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ex;P(b()),M.current.setMode(A?"seven-bag":"true-random"),_(L()),I([L(),L(),L()]),G({x:Math.floor(5)-2,y:0}),J(0),Y(1),X(0),K(null),B(!0),eC(null),eR.current=null,V(0),eM(""),eu(!1),eK(!1),eX.current=0,eZ.current=!1,eY.current&&(clearTimeout(eY.current),eY.current=null),"sprint"===e?eg.current=performance.now():eg.current=null,ey(0),eN(null),ef(e)},[L,ex,A]),ta=(0,a.useCallback)((e,t,r)=>{if("T"!==t.type||!eW.current)return!1;let l=[[r.x,r.y],[r.x+2,r.y],[r.x,r.y+2],[r.x+2,r.y+2]],a=0;return l.forEach(t=>{let[r,l]=t;(l<0||l>=20||r<0||r>=10||e[l][r])&&(a+=1)}),a>=3},[]),ts=(0,a.useCallback)(()=>{let e=eR.current;if(!e)return;let{board:t,lines:r,gained:l,nextPiece:a,upcoming:s}=e,n=t.filter((e,t)=>!r.includes(t));for(;n.length<20;)n.unshift(Array(10).fill(0));P(n),J(e=>{let t=e+l;return t>et&&er(t),t}),X(e=>{let t=e+r.length,l=Math.floor(t/10)+1;return l>Z&&(Y(l),l>el&&ea(l)),"sprint"===ex&&t>=40&&tr(),t}),V(e=>{let t=e+1;return ee(e=>Math.max(e,t)),t}),_(a),I(s),G({x:Math.floor(5)-2,y:0}),B(!0),eW.current=!1,eR.current=null,eX.current=0,k(n,a.shape,Math.floor(5)-2,0)||(eK(!0),eu(!0))},[tr,et,Z,el,ex,er,ea]),tn=(0,a.useCallback)(e=>{eY.current&&(clearTimeout(eY.current),eY.current=null);let t=null!=e?e:e6.current,r=((e,t,r,l,a)=>{let s=e.map(e=>e.slice());for(let e=0;e<t.length;e+=1)for(let n=0;n<t[e].length;n+=1)t[e][n]&&(s[l+e][r+n]=a);return s})(e4.current,e3.current.shape,t.x,t.y,e3.current.type);te();let l=[];for(let e=0;e<20;e+=1)r[e].every(e=>e)&&l.push(e);let a=ta(r,e3.current,t),s=0;a?(em(["T-Spin","T-Spin Single","T-Spin Double","T-Spin Triple"][l.length]),e9(880,.2),s=j[l.length],setTimeout(()=>em(""),1e3)):l.length&&(e9(),s=w[l.length]);let[n,...o]=H,i=[...o,L()];if(l.length){let e=4===l.length&&!a;e?(eJ(200),eM("TETRIS!"),setTimeout(()=>eM(""),1200)):a?eJ(120):eJ(80),P(r),eR.current={board:r,lines:l,gained:s,nextPiece:n,upcoming:i},eX.current=0,eC({lines:l,start:performance.now(),progress:0,isTetris:e})}else P(r),V(0),s&&J(e=>{let t=e+s;return t>et&&er(t),t}),_(n),I(i),G({x:Math.floor(5)-2,y:0}),B(!0),eW.current=!1,k(r,n.shape,Math.floor(5)-2,0)||(eK(!0),eu(!0))},[L,et,ta,eJ,H,e9,er,te]),to=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];eS||eq||ec||eo||(eZ.current=e,k(e4.current,e3.current.shape,e6.current.x,e6.current.y+1)?(eY.current&&(clearTimeout(eY.current),eY.current=null),G(e=>({...e,y:e.y+1}))):eY.current||(eY.current=setTimeout(()=>{tn()},500)))},[eS,eq,ec,tn,eo]),ti=(0,a.useCallback)(e=>{if(eS||eq||ec||eo)return;let t=e6.current.x+e;k(e4.current,e3.current.shape,t,e6.current.y)&&(G(e=>({...e,x:t})),eY.current&&(clearTimeout(eY.current),eY.current=null),k(e4.current,e3.current.shape,t,e6.current.y+1)||(eY.current=setTimeout(()=>{tn()},500))),eW.current=!1},[eS,eq,ec,tn,eo]),tc=(0,a.useCallback)(function(e,t,r,l){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},{opacity:s=1,shadow:n=!0,padding:o=0,outline:i=!0}=a,c=16*t+o,u=16*r+o,d=16-2*o,p=e.createLinearGradient(c,u,c+d,u+d);p.addColorStop(0,h(l,70)),p.addColorStop(.3,l),p.addColorStop(1,h(l,-70)),e.save(),e.globalAlpha=s,n&&(e.shadowColor="rgba(0, 0, 0, 0.35)",e.shadowBlur=6,e.shadowOffsetY=3),e.fillStyle=p,e.fillRect(c,u,d,d),i&&(e.strokeStyle=h(l,-100),e.lineWidth=1,e.strokeRect(c+.5,u+.5,d-1,d-1),e.strokeStyle=h(l,100),e.beginPath(),e.moveTo(c+1,u+d-1),e.lineTo(c+d-1,u+d-1),e.stroke()),e.restore()},[]),tu=(0,a.useCallback)(()=>{var e;let t;if(eS||eq||ec||eo)return;let r=e3.current,l=r.rotation,a=(r.rotation+1)%4,s=(t=r.shape)[0].map((e,r)=>t.map(e=>e[r]).reverse());for(let[t,n]of(null==(e=("O"===r.type?{[a]:[[0,0]]}:y["I"===r.type?"I":"JLSTZ"])[l])?void 0:e[a])||[[0,0]]){let e=e6.current.x+t,l=e6.current.y+n;if(k(e4.current,s,e,l)){_({...r,shape:s,rotation:a}),G({x:e,y:l}),eW.current=!0,eY.current&&(clearTimeout(eY.current),eY.current=null),k(e4.current,s,e,l+1)||(eY.current=setTimeout(()=>{tn()},500));return}}},[eS,eq,ec,tn,eo]),td=(0,a.useCallback)(()=>{if(eS||eq||ec||eo)return;let e=tt();eY.current&&(clearTimeout(eY.current),eY.current=null);let t=e-e6.current.y;t>0&&J(e=>{let r=e+2*t;return r>et&&er(r),r}),tn({x:e6.current.x,y:e}),eW.current=!1},[eS,eq,tt,et,ec,tn,er,eo]),tp=(0,a.useCallback)(()=>{if(!z||eS||eq||ec||eo)return;B(!1),eY.current&&(clearTimeout(eY.current),eY.current=null);let e=m(e3.current.type);q?(K(e),_(q)):(K(e),_(H[0]),I([...H.slice(1),L()])),G({x:Math.floor(5)-2,y:0}),eW.current=!1},[z,eS,eq,L,q,H,ec,eo]),tb=(0,a.useCallback)((e,t)=>{let r=Object.entries(es).find(r=>{let[,l]=r;return l.toLowerCase()===e.toLowerCase()||l.toLowerCase()===t.toLowerCase()});return r?r[0]:null},[es]),th=(0,a.useCallback)(()=>{eq||eu(e=>!e)},[eq,eu]),tm=(0,a.useCallback)(()=>eb(e=>!e),[eb]);(0,a.useEffect)(()=>{if(!o&&!ec&&!eq){ed.current=!0,eu(!0);return}o&&ed.current&&(ed.current=!1,eu(!1))},[eq,o,ec]);let tx=(0,a.useCallback)(e=>{if(!(0,u.shouldHandleGameKey)(e,{isFocused:o})||eo)return;let t=tb(e.key,e.code);if(t)if(e.preventDefault(),e.stopPropagation(),"left"===t||"right"===t){if(eU)return;let e="left"===t?-1:1;ti(e),e2.current[t]||(e2.current[t]=!0,e$.current[t]=setTimeout(()=>{let r=l=>{e2.current[t]&&(e1.current[t]||(e1.current[t]=l),l-e1.current[t]>=eP&&(ti(e),e1.current[t]=l),e0.current[t]=requestAnimationFrame(r))};e0.current[t]=requestAnimationFrame(r)},eL))}else if("down"===t){if(eU)return;to(!0)}else if("rotate"===t){if(eU)return;tu()}else if("drop"===t){if(eU)return;td()}else if("hold"===t){if(eU)return;tp()}else if("pause"===t){if(eS)return;th()}else"reset"===t?tl():"sound"===t?tm():"settings"===t&&ei(!0)},[tb,eP,eS,eL,td,tp,eU,ti,to,tl,tu,eo,th,tm,o]),tf=(0,a.useCallback)(e=>{if(!(0,u.shouldHandleGameKey)(e,{isFocused:o})||eo)return;let t=tb(e.key,e.code);t&&((0,u.consumeGameKey)(e),"left"===t||"right"===t?(e2.current[t]=!1,e$.current[t]&&(clearTimeout(e$.current[t]),e$.current[t]=null),e0.current[t]&&(cancelAnimationFrame(e0.current[t]),e0.current[t]=null,e1.current[t]=0)):"down"===t&&(eZ.current=!1))},[tb,o,eo]),tg=(0,a.useCallback)(e=>{if(!eS&&!eq&&!ec&&!eo){if("left"===e||"right"===e){if(eU)return;ti("left"===e?-1:1);return}if("down"===e){if(eU)return;to(!0);return}if("rotate"===e){if(eU)return;tu();return}if("drop"===e){if(eU)return;td();return}if("hold"===e)return void tp();"pause"===e&&th()}},[eS,eq,td,tp,eU,ti,to,ec,tu,eo,th]);(0,a.useEffect)(()=>()=>{let e=e$.current,t=e0.current;Object.values(e).forEach(e=>e&&clearTimeout(e)),Object.values(t).forEach(e=>e&&cancelAnimationFrame(e))},[]);let tv=null!=(t=null==eS?void 0:eS.start)?t:null;(0,a.useEffect)(()=>{let e;if(!eS||null===tv)return;let t=r=>{let l=Math.min((r-tv)/320,1);if(eC(e=>e?{...e,progress:l}:null),l>=1){ts(),eC(null);return}e=requestAnimationFrame(t)};return e=requestAnimationFrame(t),()=>cancelAnimationFrame(e)},[tv,eS,ts]);let ty=(0,a.useCallback)(()=>{var e,t,r,l,a,s,n,o,i,c,u,d;if("undefined"==typeof navigator)return;let p=(navigator.getGamepads?navigator.getGamepads():[]).find(e=>e),b=e5.current;if(!p){b.leftStart=0,b.leftRepeat=0,b.rightStart=0,b.rightRepeat=0,b.downRepeat=0,b.rotate=!1,b.drop=!1,b.hold=!1,b.pause=!1,b.reset=!1,eZ.current=!1;return}let h=performance.now(),m=p.axes[0]<-.4||(null==(e=p.buttons[14])?void 0:e.pressed),x=p.axes[0]>.4||(null==(t=p.buttons[15])?void 0:t.pressed),f=p.axes[1]>.4||(null==(r=p.buttons[13])?void 0:r.pressed),g=null==(l=p.buttons[9])?void 0:l.pressed;g&&!b.pause&&th(),b.pause=g;let v=null==(a=p.buttons[8])?void 0:a.pressed;if(v&&!b.reset&&tl(),b.reset=v,ec||eS||eo||eq){b.leftStart=0,b.leftRepeat=0,b.rightStart=0,b.rightRepeat=0,b.downRepeat=0,b.rotate=!1,b.drop=!1,b.hold=!1,eZ.current=!1;return}m?b.leftStart?h-b.leftStart>eL&&h-b.leftRepeat>eP&&(ti(-1),b.leftRepeat=h):(ti(-1),b.leftStart=h,b.leftRepeat=h):(b.leftStart=0,b.leftRepeat=0),x?b.rightStart?h-b.rightStart>eL&&h-b.rightRepeat>eP&&(ti(1),b.rightRepeat=h):(ti(1),b.rightStart=h,b.rightRepeat=h):(b.rightStart=0,b.rightRepeat=0),f?h-b.downRepeat>70&&(to(!0),b.downRepeat=h):(b.downRepeat=0,eZ.current=!1);let y=(null==(s=p.buttons[0])?void 0:s.pressed)||(null==(n=p.buttons[3])?void 0:n.pressed)||(null==(o=p.buttons[5])?void 0:o.pressed);y&&!b.rotate&&tu(),b.rotate=y;let w=(null==(i=p.buttons[1])?void 0:i.pressed)||(null==(c=p.buttons[7])?void 0:c.pressed);w&&!b.drop&&td(),b.drop=w;let j=(null==(u=p.buttons[2])?void 0:u.pressed)||(null==(d=p.buttons[4])?void 0:d.pressed);j&&!b.hold&&tp(),b.hold=j},[eP,eS,eL,eq,td,tp,ti,to,ec,tl,tu,eo,th]);(0,a.useEffect)(()=>{let e,t=()=>{ty(),e=requestAnimationFrame(t)};return e=requestAnimationFrame(t),()=>cancelAnimationFrame(e)},[ty]);let tw=(0,a.useCallback)(e=>{var t;e.clearRect(0,0,160,320);let r=e.createLinearGradient(0,0,160,320);r.addColorStop(0,"#0f172a"),r.addColorStop(1,"#111827"),e.fillStyle=r,e.fillRect(0,0,160,320),e.save(),e.strokeStyle="rgba(255,255,255,0.04)";for(let t=0;t<=10;t+=1)e.beginPath(),e.moveTo(16*t+.5,0),e.lineTo(16*t+.5,320),e.stroke();for(let t=0;t<=20;t+=1)e.beginPath(),e.moveTo(0,16*t+.5),e.lineTo(160,16*t+.5),e.stroke();e.restore();let l=null!=(t=null==eS?void 0:eS.progress)?t:0;if(e4.current.forEach((t,r)=>{var a;let s=null==eS||null==(a=eS.lines)?void 0:a.includes(r),n=s?8*Math.pow(l,1.2):0,o=s?Math.max(0,1-l):1;if(t.forEach((t,l)=>{t&&tc(e,l,r,d[t].color,{opacity:o,padding:n,shadow:!s})}),s){e.save(),e.globalAlpha=Math.max(0,.55-.55*l);let t=e.createLinearGradient(0,16*r,160,(r+1)*16);t.addColorStop(0,"rgba(255,255,255,0)"),t.addColorStop(.5,"rgba(255,255,255,0.8)"),t.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=t,e.fillRect(0,16*r,160,16),e.restore()}}),!eS){let t=tt();e3.current.shape.forEach((r,l)=>{r.forEach((r,a)=>{if(r){let r=e6.current.x+a,s=t+l;tc(e,r,s,e3.current.color,{opacity:.2,shadow:!1,outline:!1}),e.save(),e.setLineDash([4,4]),e.strokeStyle=h(e3.current.color,80),e.globalAlpha=.6,e.strokeRect(16*r+.5,16*s+.5,15,15),e.restore()}})}),e.save(),e.globalAlpha=.45,e3.current.shape.forEach((t,r)=>{t.forEach((t,l)=>{if(t){let t=(e6.current.x+l)*16,a=(e6.current.y+r)*16;e.fillStyle="rgba(0,0,0,0.5)",e.beginPath(),e.ellipse(t+8,a+16,5.6,3.2,0,0,2*Math.PI),e.fill()}})}),e.restore(),e3.current.shape.forEach((t,r)=>{t.forEach((t,l)=>{t&&tc(e,e6.current.x+l,e6.current.y+r,e3.current.color)})})}},[eS,tc,tt]),tj=(0,a.useCallback)(e=>{if(!e)return"";let t=1===e.length?e.toUpperCase():e;return({ArrowLeft:"←",ArrowRight:"→",ArrowDown:"↓",ArrowUp:"↑",Space:"Space"," ":"Space",Shift:"Shift",Control:"Ctrl",Alt:"Alt",Enter:"Enter",Escape:"Esc"})[t]||t.toUpperCase()},[]),tk=(0,a.useMemo)(()=>[{label:"Move",keys:[es.left,es.right]},{label:"Soft Drop",keys:[es.down]},{label:"Hard Drop",keys:[es.drop]},{label:"Rotate",keys:[es.rotate]},{label:"Hold",keys:[es.hold]},{label:"Pause",keys:[es.pause]}],[es]),tN=S?(0,l.jsxs)("div",{className:"mt-4 grid w-full max-w-xs grid-cols-3 gap-2 text-lg",children:[(0,l.jsx)("div",{}),(0,l.jsx)("button",{type:"button",onPointerDown:()=>tg("rotate"),className:"rounded-xl bg-slate-800/80 px-4 py-3 shadow transition hover:bg-slate-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400","aria-label":"Rotate",children:"⟳"}),(0,l.jsx)("div",{}),(0,l.jsx)("button",{type:"button",onPointerDown:()=>tg("left"),className:"rounded-xl bg-slate-800/80 px-4 py-3 shadow transition hover:bg-slate-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400","aria-label":"Move left",children:"←"}),(0,l.jsx)("button",{type:"button",onPointerDown:()=>tg("down"),className:"rounded-xl bg-slate-800/80 px-4 py-3 shadow transition hover:bg-slate-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400","aria-label":"Soft drop",children:"↓"}),(0,l.jsx)("button",{type:"button",onPointerDown:()=>tg("right"),className:"rounded-xl bg-slate-800/80 px-4 py-3 shadow transition hover:bg-slate-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400","aria-label":"Move right",children:"→"}),(0,l.jsx)("button",{type:"button",onPointerDown:()=>tg("hold"),className:"rounded-xl bg-slate-800/80 px-4 py-3 shadow transition hover:bg-slate-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400","aria-label":"Hold piece",children:"H"}),(0,l.jsx)("button",{type:"button",onPointerDown:()=>tg("drop"),className:"rounded-xl bg-slate-800/80 px-4 py-3 shadow transition hover:bg-slate-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400","aria-label":"Hard drop",children:"⤓"}),(0,l.jsx)("button",{type:"button",onPointerDown:()=>tg("pause"),className:"rounded-xl bg-slate-800/80 px-4 py-3 shadow transition hover:bg-slate-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400","aria-label":ec?"Resume":"Pause",children:ec?"▶":"Ⅱ"})]}):null,tS=(0,a.useMemo)(()=>{let e=Object.entries(es),t=e.map(e=>{let[t,r]=e;return[t,r.toLowerCase()]}).reduce((e,t)=>{let[,r]=t;return e[r]=(e[r]||0)+1,e},{});return e.filter(e=>{let[,r]=e;return t[r.toLowerCase()]>1})},[es]),tC=(0,a.useCallback)((e,t)=>{if(!t)return;e.preventDefault();let r=" "===e.key||"Space"===e.code?"Space":1===e.key.length?e.key.toLowerCase():e.key;en(e=>({...e,[t]:r})),eB(null)},[en]),tR=(0,a.useCallback)(e=>{if("Escape"===e.key){e.preventDefault(),eB(null),ei(!1);return}ez&&tC(e,ez)},[ez,tC,ei]),tE=(0,a.useMemo)(()=>[{label:"Move",value:"D-Pad / Left Stick"},{label:"Soft Drop",value:"Down / LS ↓"},{label:"Hard Drop",value:"B / RT"},{label:"Rotate",value:"A / Y / RB"},{label:"Hold",value:"X / LB"},{label:"Pause",value:"Start"}],[]),tM=(0,a.useMemo)(()=>{let e=[{label:"Score",value:U.toLocaleString()},{label:"High",value:et.toLocaleString()},{label:"Combo",value:Q>0?"".concat(Q,"x"):"—"},{label:"Max Combo",value:$>0?"".concat($,"x"):"—"},{label:"Level",value:Z},{label:"Lines",value:"sprint"===ex?"".concat(W,"/40"):W}];return"sprint"===ex&&e.push({label:"Time",value:"".concat((ev/1e3).toFixed(2),"s")},{label:"Best",value:ew?"".concat((ew/1e3).toFixed(2),"s"):"—"}),e},[ew,Q,et,Z,W,$,ex,U,ev]),tA=(0,a.useMemo)(()=>"sprint"===ex?Math.min(W/40,1):0,[W,ex]);(0,a.useEffect)(()=>{var e;let t=null==(e=C.current)?void 0:e.getContext("2d");if(!t)return()=>{};let r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,l=e-eQ.current;if(eQ.current=e,!ec&&!eq){if("sprint"===ex&&eg.current&&ey(e-eg.current),!eS){eX.current+=l;let e=eZ.current?e8/10:e8;eX.current>e&&(to(eZ.current),eX.current=0)}tw(t)}eV.current=requestAnimationFrame(r)};return eV.current=requestAnimationFrame(r),()=>cancelAnimationFrame(eV.current)},[C,eS,tw,eq,to,ec,e8,ex]);let tT=e=>e.shape.map((t,r)=>t.map((t,a)=>t?(0,l.jsx)("div",{className:"absolute h-4 w-4 rounded-sm border border-slate-900/60 shadow-[0_4px_10px_rgba(15,23,42,0.35)]",style:{top:16*r,left:16*a,backgroundImage:"linear-gradient(135deg, ".concat(h(e.color,70),", ").concat(h(e.color,-60),")")}},"".concat(r,"-").concat(a)):null));return(0,l.jsxs)("div",{className:"relative h-full w-full overflow-y-auto bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 text-slate-100",children:[(0,l.jsx)("div",{className:"mx-auto flex min-h-full max-w-6xl flex-col gap-6 p-4 md:p-8",children:(0,l.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[minmax(0,1fr)_19rem]",children:[(0,l.jsxs)("div",{className:"relative rounded-3xl border border-slate-800/70 bg-slate-900/70 p-4 shadow-[0_25px_70px_rgba(15,23,42,0.65)]",children:[(0,l.jsxs)("div",{className:"relative mx-auto flex w-full max-w-[320px] aspect-[10/20] justify-center focus:outline-none",ref:R,tabIndex:0,role:"application","aria-label":"Tetris board. Click or focus to enable keyboard controls.",onKeyDown:tx,onKeyUp:tf,onClick:()=>{var e;return null==(e=R.current)?void 0:e.focus()},children:[(0,l.jsx)("canvas",{ref:C,className:"rounded-2xl border border-slate-800/70 bg-slate-950/60 shadow-[0_20px_60px_rgba(15,23,42,0.7)] transition-transform duration-150",style:{transform:e_?"translateY(2px)":"none"},"aria-label":"Active Tetris board"}),eA&&(0,l.jsx)("div",{className:"pointer-events-none absolute inset-0 rounded-2xl border border-rose-500/60 shadow-[0_0_30px_rgba(244,63,94,0.35)]"}),(null==eS?void 0:eS.isTetris)&&(0,l.jsx)("div",{className:"pointer-events-none absolute inset-0 rounded-2xl bg-[radial-gradient(circle_at_top,#facc15_0%,rgba(250,204,21,0.0)_55%)]"}),eE&&(0,l.jsx)("div",{className:"pointer-events-none absolute inset-x-0 top-8 flex justify-center",children:(0,l.jsx)("span",{className:"rounded-full bg-amber-400/20 px-6 py-2 text-2xl font-semibold tracking-[0.2em] text-amber-100 shadow-lg backdrop-blur",children:eE})}),eh&&(0,l.jsx)("div",{className:"pointer-events-none absolute inset-x-0 top-1/3 flex justify-center",children:(0,l.jsx)("span",{className:"rounded-full bg-purple-500/20 px-4 py-2 text-xl font-semibold tracking-[0.2em] text-purple-100 shadow-lg backdrop-blur",children:eh})}),Q>1&&(0,l.jsx)("div",{className:"pointer-events-none absolute inset-x-0 bottom-10 flex justify-center",children:(0,l.jsxs)("span",{className:"rounded-full bg-sky-500/20 px-4 py-1 text-sm font-semibold uppercase tracking-[0.4em] text-sky-200 shadow-lg backdrop-blur",children:[Q,"x Combo"]})}),ec&&null===ek&&!eq&&(0,l.jsx)("div",{className:"absolute inset-0 z-20 flex items-center justify-center rounded-2xl bg-slate-950/85 backdrop-blur",role:"dialog","aria-modal":"true","aria-labelledby":"tetris-paused-title",children:(0,l.jsxs)("div",{className:"w-full max-w-xs space-y-4 rounded-2xl border border-slate-700/70 bg-slate-900/90 p-6 text-center shadow-2xl",children:[(0,l.jsx)("h3",{id:"tetris-paused-title",className:"text-lg font-semibold uppercase tracking-[0.4em] text-sky-400",children:"Paused"}),(0,l.jsxs)("div",{className:"flex flex-col gap-2 text-sm",children:[(0,l.jsx)("button",{type:"button",className:"rounded-full border border-slate-600 bg-slate-800/80 px-4 py-2 font-semibold text-slate-100 transition hover:border-slate-400 hover:text-white",onClick:th,children:"Resume"}),(0,l.jsx)("button",{type:"button",className:"rounded-full border border-slate-600 bg-slate-800/80 px-4 py-2 font-semibold text-slate-100 transition hover:border-slate-400 hover:text-white",onClick:()=>tl(ex),children:"Restart"}),(0,l.jsx)("button",{type:"button",className:"rounded-full border border-slate-600 bg-slate-800/80 px-4 py-2 font-semibold text-slate-100 transition hover:border-slate-400 hover:text-white",onClick:tm,children:ep?"Mute Audio":"Enable Audio"}),(0,l.jsx)("button",{type:"button",className:"rounded-full border border-slate-600 bg-slate-800/80 px-4 py-2 font-semibold text-slate-100 transition hover:border-slate-400 hover:text-white",onClick:()=>ei(!0),children:"Control Settings"})]}),(0,l.jsxs)("p",{className:"text-xs text-slate-400",children:["Press ",tj(es.pause)," or Start to resume."]})]})}),null!==ek&&(0,l.jsx)("div",{className:"absolute inset-0 z-30 flex items-center justify-center rounded-2xl bg-slate-950/85 backdrop-blur",role:"dialog","aria-modal":"true","aria-labelledby":"tetris-sprint-title",children:(0,l.jsxs)("div",{className:"w-full max-w-sm space-y-4 rounded-2xl border border-slate-700/70 bg-slate-900/95 p-6 text-center shadow-2xl",children:[(0,l.jsx)("p",{id:"tetris-sprint-title",className:"text-xs uppercase tracking-[0.45em] text-sky-400",children:"Sprint Complete"}),(0,l.jsxs)("p",{className:"text-3xl font-semibold text-white",children:[(ek/1e3).toFixed(2),"s",ew===ek?" • PB":""]}),(0,l.jsx)("button",{type:"button",className:"rounded-full border border-sky-500/60 bg-sky-500/20 px-4 py-2 font-semibold text-sky-200 transition hover:border-sky-400 hover:text-white",onClick:()=>tl("sprint"),children:"Run it back"})]})}),eq&&(0,l.jsx)("div",{className:"absolute inset-0 z-30 flex items-center justify-center rounded-2xl bg-slate-950/85 backdrop-blur",role:"dialog","aria-modal":"true","aria-labelledby":"tetris-gameover-title",children:(0,l.jsxs)("div",{className:"w-full max-w-sm space-y-4 rounded-2xl border border-rose-500/40 bg-slate-900/95 p-6 text-center shadow-2xl",children:[(0,l.jsx)("p",{id:"tetris-gameover-title",className:"text-xs uppercase tracking-[0.45em] text-rose-400",children:"Game Over"}),(0,l.jsx)("p",{className:"text-3xl font-semibold text-white",children:U.toLocaleString()}),(0,l.jsxs)("div",{className:"text-xs text-slate-300",children:[(0,l.jsxs)("p",{children:["Lines: ",W]}),(0,l.jsxs)("p",{children:["Level: ",Z]})]}),(0,l.jsx)("button",{type:"button",className:"rounded-full border border-rose-500/60 bg-rose-500/20 px-4 py-2 font-semibold text-rose-200 transition hover:border-rose-400 hover:text-white",onClick:()=>tl(ex),children:"Restart Run"})]})})]}),(0,l.jsxs)("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3 text-[0.7rem] uppercase tracking-[0.4em] text-slate-400",children:[(0,l.jsx)("span",{children:"sprint"===ex?"Sprint 40 Lines":"Marathon Endless"}),(0,l.jsx)("span",{children:ep?"Audio On":"Muted"})]}),"sprint"===ex&&(0,l.jsx)("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-slate-800/80",children:(0,l.jsx)("div",{className:"h-full rounded-full bg-gradient-to-r from-sky-500 to-emerald-400",style:{width:"".concat(100*tA,"%")}})}),tN]}),(0,l.jsxs)("aside",{className:"space-y-4",children:[(0,l.jsxs)("section",{className:"rounded-2xl border border-slate-800/70 bg-slate-900/60 p-4 shadow-lg","aria-labelledby":"piece-queue",children:[(0,l.jsx)("h2",{id:"piece-queue",className:"text-xs font-semibold uppercase tracking-[0.4em] text-slate-400",children:"Piece Queue"}),(0,l.jsxs)("div",{className:"mt-3 grid gap-4 sm:grid-cols-2",children:[(0,l.jsxs)("div",{"aria-live":"polite",children:[(0,l.jsx)("p",{id:"hold-label",className:"mb-2 text-[0.65rem] uppercase tracking-[0.35em] text-slate-500",children:"Hold"}),(0,l.jsx)("div",{className:"relative h-20 w-20 rounded-xl border border-slate-800/70 bg-slate-950/60","aria-labelledby":"hold-label",children:q?(0,l.jsxs)(l.Fragment,{children:[tT(q),(0,l.jsxs)("span",{className:"sr-only",children:["Hold piece: ",q.type]})]}):(0,l.jsx)("div",{className:"flex h-full items-center justify-center text-xs text-slate-600",children:"Empty"})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"mb-2 text-[0.65rem] uppercase tracking-[0.35em] text-slate-500",children:"Next"}),(0,l.jsx)("div",{className:"space-y-2",children:H.map((e,t)=>(0,l.jsx)("div",{className:"relative h-16 w-16 rounded-xl border border-slate-800/70 bg-slate-950/60",children:tT(e)},"".concat(e.type,"-").concat(t)))})]})]})]}),(0,l.jsxs)("section",{className:"rounded-2xl border border-slate-800/70 bg-slate-900/60 p-4 shadow-lg","aria-live":"polite",children:[(0,l.jsx)("h2",{className:"text-xs font-semibold uppercase tracking-[0.4em] text-slate-400",children:"Mission Data"}),(0,l.jsx)("dl",{className:"mt-3 grid grid-cols-2 gap-x-4 gap-y-2 text-sm",children:tM.map(e=>(0,l.jsxs)("div",{children:[(0,l.jsx)("dt",{className:"text-[0.65rem] uppercase tracking-[0.35em] text-slate-500",children:e.label}),(0,l.jsx)("dd",{className:"text-base font-semibold text-slate-100",children:e.value})]},e.label))})]}),(0,l.jsxs)("section",{className:"rounded-2xl border border-slate-800/70 bg-slate-900/60 p-4 shadow-lg",children:[(0,l.jsx)("h2",{className:"text-xs font-semibold uppercase tracking-[0.4em] text-slate-400",children:"Controls"}),(0,l.jsxs)("div",{className:"mt-3 grid gap-4 sm:grid-cols-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"mb-2 text-[0.65rem] uppercase tracking-[0.35em] text-slate-500",children:"Keyboard"}),(0,l.jsx)("ul",{className:"space-y-2 text-xs text-slate-300",children:tk.map(e=>(0,l.jsxs)("li",{className:"flex items-center justify-between gap-3",children:[(0,l.jsx)("span",{className:"text-slate-400",children:e.label}),(0,l.jsx)("span",{className:"flex flex-wrap justify-end gap-1",children:e.keys.map((t,r)=>(0,l.jsx)("kbd",{className:"rounded bg-slate-800/80 px-2 py-1 text-[0.65rem] font-semibold text-slate-100 shadow-[0_2px_6px_rgba(15,23,42,0.4)]",children:tj(t)},"".concat(e.label,"-").concat(t||r)))})]},e.label))})]}),(0,l.jsxs)("div",{className:eG?"":"opacity-60",children:[(0,l.jsxs)("p",{className:"mb-2 flex items-center gap-2 text-[0.65rem] uppercase tracking-[0.35em] text-slate-500",children:["Gamepad",(0,l.jsx)("span",{className:"rounded-full px-2 py-0.5 text-[0.6rem] font-semibold ".concat(eG?"bg-emerald-500/20 text-emerald-300":"bg-slate-800 text-slate-400"),children:eG?"Connected":"Standby"})]}),(0,l.jsx)("ul",{className:"space-y-2 text-xs text-slate-300",children:tE.map(e=>(0,l.jsxs)("li",{className:"flex items-center justify-between gap-3",children:[(0,l.jsx)("span",{className:"text-slate-400",children:e.label}),(0,l.jsx)("span",{className:"text-right font-semibold text-slate-100",children:e.value})]},e.label))})]})]})]}),(0,l.jsxs)("section",{className:"rounded-2xl border border-slate-800/70 bg-slate-900/60 p-4 shadow-lg",children:[(0,l.jsx)("h2",{className:"text-xs font-semibold uppercase tracking-[0.4em] text-slate-400",children:"Operations"}),(0,l.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-3 text-sm sm:grid-cols-3",children:[(0,l.jsx)("button",{type:"button",className:"rounded-full border border-slate-700 bg-slate-800/70 px-3 py-2 font-semibold text-slate-100 transition hover:border-slate-500 hover:text-white",onClick:th,children:ec?"Resume":"Pause"}),(0,l.jsx)("button",{type:"button",className:"rounded-full border border-slate-700 bg-slate-800/70 px-3 py-2 font-semibold text-slate-100 transition hover:border-slate-500 hover:text-white",onClick:tm,children:ep?"Mute Audio":"Enable Audio"}),(0,l.jsx)("button",{type:"button",className:"rounded-full border border-slate-700 bg-slate-800/70 px-3 py-2 font-semibold text-slate-100 transition hover:border-slate-500 hover:text-white",onClick:()=>tl(ex),children:"Restart"}),(0,l.jsx)("button",{type:"button",className:"rounded-full border px-3 py-2 font-semibold transition hover:text-white ".concat("marathon"===ex?"border-sky-500/60 bg-sky-500/20 text-sky-200 hover:border-sky-400":"border-slate-700 bg-slate-800/70 text-slate-100 hover:border-slate-500"),onClick:()=>tl("marathon"),children:"Marathon"}),(0,l.jsx)("button",{type:"button",className:"rounded-full border px-3 py-2 font-semibold transition hover:text-white ".concat("sprint"===ex?"border-emerald-500/60 bg-emerald-500/20 text-emerald-200 hover:border-emerald-400":"border-slate-700 bg-slate-800/70 text-slate-100 hover:border-slate-500"),onClick:()=>tl("sprint"),children:"Sprint 40"}),(0,l.jsx)("button",{type:"button",className:"rounded-full border border-slate-700 bg-slate-800/70 px-3 py-2 font-semibold text-slate-100 transition hover:border-slate-500 hover:text-white",onClick:()=>ei(!0),children:"Edit Controls"})]}),(0,l.jsx)("p",{className:"mt-3 text-xs text-slate-400",children:"Audio cues, DAS, ARR, and bindings can be tuned without leaving your run."})]})]})]})}),eo&&(0,l.jsx)("div",{className:"absolute inset-0 z-40 flex items-center justify-center bg-slate-950/80 backdrop-blur",role:"dialog","aria-modal":"true","aria-labelledby":"tetris-settings-title",onKeyDown:tR,tabIndex:-1,ref:E,children:(0,l.jsxs)("div",{className:"w-full max-w-lg rounded-2xl border border-slate-700/70 bg-slate-900/95 p-6 shadow-2xl",children:[(0,l.jsx)("h2",{id:"tetris-settings-title",className:"mb-4 text-center text-lg font-semibold uppercase tracking-[0.4em] text-sky-400",children:"Control Settings"}),(0,l.jsxs)("div",{className:"mb-4 grid gap-3 sm:grid-cols-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2 text-sm text-slate-200",children:[(0,l.jsx)("label",{htmlFor:"bag-toggle",children:"7-Bag"}),(0,l.jsx)("input",{id:"bag-toggle",type:"checkbox",checked:A,onChange:e=>T(e.target.checked),"aria-label":"Toggle seven-bag randomizer"})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1 text-sm text-slate-200",children:[(0,l.jsxs)("label",{htmlFor:"das-range",children:["DAS ",eL,"ms"]}),(0,l.jsx)("input",{id:"das-range",type:"range",min:"50",max:"500",value:eL,onChange:e=>eD(Number(e.target.value)),"aria-label":"Adjust DAS in milliseconds"})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1 text-sm text-slate-200",children:[(0,l.jsxs)("label",{htmlFor:"arr-range",children:["ARR ",eP,"ms"]}),(0,l.jsx)("input",{id:"arr-range",type:"range",min:"10",max:"200",value:eP,onChange:e=>eF(Number(e.target.value)),"aria-label":"Adjust ARR in milliseconds"})]})]}),(0,l.jsx)("h3",{className:"mb-2 text-sm font-semibold uppercase tracking-[0.35em] text-slate-400",children:"Key Bindings"}),(0,l.jsx)("p",{className:"mb-3 text-xs text-slate-400",children:"Select an action, then press a key to bind it. Press Esc to close settings."}),tS.length>0&&(0,l.jsxs)("div",{className:"mb-3 rounded-lg border border-amber-500/40 bg-amber-500/10 p-3 text-xs text-amber-200",children:["Duplicate bindings detected:",(0,l.jsx)("ul",{className:"mt-1 list-disc space-y-1 pl-4",children:tS.map(e=>{let[t,r]=e;return(0,l.jsxs)("li",{children:[t," ⇢ ",tj(r)]},"".concat(t,"-").concat(r))})})]}),(0,l.jsx)("div",{className:"grid gap-3 sm:grid-cols-2",children:Object.keys(es).map(e=>{let t=ez===e;return(0,l.jsxs)("div",{className:"flex flex-col gap-1 text-sm text-slate-200",children:[(0,l.jsx)("span",{className:"uppercase tracking-[0.3em] text-slate-500",children:e}),(0,l.jsx)("button",{type:"button",className:"rounded border px-2 py-1 text-left text-slate-100 transition focus:outline-none ".concat(t?"border-sky-500 bg-slate-800/80":"border-slate-700 bg-slate-800"),"aria-label":"Set ".concat(e," key binding"),onClick:()=>eB(e),children:t?"Press a key…":tj(es[e])})]},e)})}),(0,l.jsx)("div",{className:"mt-6 flex justify-end",children:(0,l.jsx)("button",{type:"button",className:"rounded-full border border-slate-700 bg-slate-800/70 px-4 py-2 font-semibold text-slate-100 transition hover:border-slate-500 hover:text-white",onClick:()=>{eB(null),ei(!1)},children:"Close"})})]})})]})}},16924:(e,t,r)=>{r.d(t,{default:()=>a});var l=r(14232);function a(e,t){let r=(0,l.useRef)(null);return(0,l.useEffect)(()=>{let l=r.current;if(!l)return;let a=l.getContext("2d");if(!a)return;let s=()=>{let r=(()=>{let e=l.parentElement;if(!e)return null;let{clientWidth:t,clientHeight:r}=e;if(t>0&&r>0)return e;let a=e.closest("[data-game-viewport]");if(a)return a;let s=e.closest(".windowMainScreen");return null!=s?s:e})();if(!r)return;let{clientWidth:s,clientHeight:n}=r;if(s<=0||n<=0)return;let o=Math.min(s/e,n/t),i=e*o,c=t*o,u=window.devicePixelRatio||1;l.style.width="".concat(i,"px"),l.style.height="".concat(c,"px"),l.width=Math.floor(i*u),l.height=Math.floor(c*u),a.setTransform(u*o,0,0,u*o,0,0)};s();let n=l.parentElement,o=null==n?void 0:n.closest("[data-game-viewport]"),i=null==n?void 0:n.closest(".windowMainScreen"),c="undefined"!=typeof ResizeObserver?new ResizeObserver(s):null;return n&&c&&c.observe(n),o&&c&&o!==n&&c.observe(o),i&&c&&i!==n&&c.observe(i),window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s),null==c||c.disconnect()}},[e,t]),r}},65422:(e,t,r)=>{r.d(t,{consumeGameKey:()=>a,formatGameKey:()=>s,shouldHandleGameKey:()=>l});let l=function(e){let{isFocused:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!(!t||(e=>{if(!e||!(e instanceof HTMLElement))return!1;let t=e.tagName;return"INPUT"===t||"TEXTAREA"===t||e.isContentEditable})(e.target))},a=e=>{(null==e?void 0:e.cancelable)&&e.preventDefault(),(null==e?void 0:e.stopPropagation)&&e.stopPropagation()},s=e=>{if(!e)return"";if(" "===e)return"Space";let t=e.toLowerCase();return"escape"===t?"Esc":"arrowup"===t?"ArrowUp":"arrowdown"===t?"ArrowDown":"arrowleft"===t?"ArrowLeft":"arrowright"===t?"ArrowRight":1===e.length?e.toUpperCase():e}},67817:(e,t,r)=>{r.d(t,{default:()=>s});var l=r(14232);let a=()=>"function"==typeof window.matchMedia?window.matchMedia("(pointer: coarse)").matches:"ontouchstart"in window||navigator.maxTouchPoints>0;function s(){let[e,t]=(0,l.useState)(a);return(0,l.useEffect)(()=>{var e,r,l;let a=null==(e=(r=window).matchMedia)?void 0:e.call(r,"(pointer: coarse)");if(!a)return;let s=e=>{t(e.matches)};return null==(l=a.addEventListener)||l.call(a,"change",s),()=>{var e;null==(e=a.removeEventListener)||e.call(a,"change",s)}},[]),e}}}]);