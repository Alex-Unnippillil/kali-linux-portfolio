"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3205],{16924:(e,t,r)=>{r.d(t,{default:()=>s});var a=r(14232);function s(e,t){let r=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let a=r.current;if(!a)return;let s=a.getContext("2d");if(!s)return;let n=()=>{let r=(()=>{let e=a.parentElement;if(!e)return null;let{clientWidth:t,clientHeight:r}=e;if(t>0&&r>0)return e;let s=e.closest("[data-game-viewport]");if(s)return s;let n=e.closest(".windowMainScreen");return null!=n?n:e})();if(!r)return;let{clientWidth:n,clientHeight:l}=r;if(n<=0||l<=0)return;let i=Math.min(n/e,l/t),o=e*i,c=t*i,u=window.devicePixelRatio||1;a.style.width="".concat(o,"px"),a.style.height="".concat(c,"px"),a.width=Math.floor(o*u),a.height=Math.floor(c*u),s.setTransform(u*i,0,0,u*i,0,0)};n();let l=a.parentElement,i=null==l?void 0:l.closest("[data-game-viewport]"),o=null==l?void 0:l.closest(".windowMainScreen"),c="undefined"!=typeof ResizeObserver?new ResizeObserver(n):null;return l&&c&&c.observe(l),i&&c&&i!==l&&c.observe(i),o&&c&&o!==l&&c.observe(o),window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n),null==c||c.disconnect()}},[e,t]),r}},43205:(e,t,r)=>{r.r(t),r.d(t,{default:()=>G});var a=r(37876),s=r(14232),n=r(70994),l=r(69106),i=r(30684),o=r(16924),c=r(90209),u=r(67817);let d=["yellow","red","blue"],h=d.map(e=>Array.from({length:3},(t,r)=>"/apps/flappy/skins/".concat(e,"-").concat(r,".svg"))),f=[[[34,139,34],[144,238,144]],[[139,69,19],[222,184,135]],[[70,130,180],[176,196,222]]],p=[{name:"Easy",value:.2},{name:"Normal",value:.4},{name:"Hard",value:.6}],m=(e,t,r)=>Math.min(Math.max(e,t),r);function x(e){let t=e%0x7fffffff;return t<=0&&(t+=0x7ffffffe),()=>((t=16807*t%0x7fffffff)-1)/0x7ffffffe}function g(e,t,r,a){let s=a?0:Math.sin(t/18+e.phase)*e.amplitude,n=e.baseTop+s,l=e.baseBottom+s,i=Math.max(0,20-n);if(i&&(n+=i,l+=i),l>r-20){let e=l-(r-20);n-=e,l-=e}return{top:n,bottom:l}}let b=(e,t,r)=>"rgb(".concat(Math.round(e[0]+(t[0]-e[0])*r),",").concat(Math.round(e[1]+(t[1]-e[1])*r),",").concat(Math.round(e[2]+(t[2]-e[2])*r),")"),y=e=>"flappy-bird-ghosts-".concat(e),w=e=>"flappy-bird-best-".concat(e);function v(e){try{return JSON.parse(window.localStorage.getItem(e)||"null")}catch(e){return null}}function k(e,t){try{window.localStorage.setItem(e,JSON.stringify(t))}catch(e){if(function(e){if(!(e instanceof DOMException))return!1;let t="QuotaExceededError"===e.name||22===e.code||1014===e.code,r="SecurityError"===e.name,a="InvalidStateError"===e.name;return t||r||a}(e))return;throw e}}function j(e,t){let r=v(y(e))||[];r.push(t),r.sort((e,t)=>t.score-e.score),k(y(e),r),k(w(e),r[0])}let M={birdSkin:"flappy-bird-skin",pipeSkin:"flappy-pipe-skin",gravity:"flappy-gravity-variant",practice:"flappy-practice",ghost:"flappy-ghost",reducedMotion:"flappy-reduced-motion",highHz:"flappy-120hz",hitbox:"flappy-hitbox",highScore:"flappy-bird-highscore"},S=e=>{try{return window.localStorage.getItem(e)}catch(e){return null}},N=function(e,t){let{min:r=0,max:a=1/0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=S(e),n=null===s?NaN:Number(s);return!Number.isFinite(n)||n<r||n>a?t:n},E=(e,t)=>{let r=S(e);return null===r?t:"1"===r||"true"===r||"0"!==r&&"false"!==r&&t},P=(e,t)=>{try{window.localStorage.setItem(e,t)}catch(e){}},C=()=>N(M.highScore,0),A=e=>{P(M.highScore,String(e))};var R=r(65422),T=r(84613);let F={gravityVariant:1,practiceMode:!1,showGhost:!0,reducedMotion:!1,highHz:!1,showHitbox:!1},G=function(){var e;let{windowMeta:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=null==(e=null==t?void 0:t.isFocused)||e,k=(0,c.default)(),G=(0,u.default)(),H=(0,o.default)(400,300),I=(0,s.useRef)(null),z=(0,s.useRef)(null),V=(0,s.useRef)(null),B=(0,s.useRef)(null),L=(0,s.useRef)(0),D=(0,s.useRef)(!1),O=(0,s.useRef)(null),q=(0,s.useRef)(null),X=(0,s.useRef)({fire:!1,up:!1}),J=(0,s.useRef)(null),Y=(0,s.useRef)(null),[_,K]=(0,s.useState)(()=>N(M.birdSkin,0,{min:0})),[W,Q]=(0,s.useState)(()=>N(M.pipeSkin,0,{min:0})),[U,Z]=(0,s.useState)(()=>({...F,gravityVariant:N(M.gravity,F.gravityVariant,{min:0,max:p.length-1}),practiceMode:E(M.practice,F.practiceMode),showGhost:E(M.ghost,F.showGhost),reducedMotion:E(M.reducedMotion,k),highHz:E(M.highHz,F.highHz),showHitbox:E(M.hitbox,F.showHitbox)})),$=(0,s.useRef)(U),[ee,et]=(0,s.useState)("menu"),[er,ea]=(0,s.useState)(!1),[es,en]=(0,s.useState)(!1),[el,ei]=(0,s.useState)(0),[eo,ec]=(0,s.useState)(!1),[eu,ed]=(0,s.useState)(0),[eh,ef]=(0,s.useState)(0),[ep,em]=(0,s.useState)([]),[ex,eg]=(0,s.useState)(null),[eb,ey]=(0,s.useState)(null),ew=(0,s.useRef)(null),[ev,ek]=(0,i.default)("flappy-bird",{flap:"Space",pause:"Escape"}),{loading:ej,error:eM}=function(e){let{images:t=[],sounds:r=[]}=e,[a,n]=(0,s.useState)({loading:!0,error:!1});return(0,s.useEffect)(()=>{let e=!1;return Promise.all([...t.map(e=>new Promise((t,r)=>{let a=new Image;a.onload=()=>t(),a.onerror=()=>r(Error("Failed to load image: ".concat(e))),a.src=e})),...r.map(e=>new Promise((t,r)=>{let a=new Audio;a.oncanplaythrough=()=>t(),a.onerror=()=>r(Error("Failed to load audio: ".concat(e))),a.src=e,a.load()}))]).then(()=>{e||n({loading:!1,error:!1})}).catch(()=>{e||n({loading:!1,error:!0})}),()=>{e=!0}},[t,r]),a}({images:h.flat()}),[eS,eN]=(0,s.useState)(()=>h.map(()=>[]));(0,s.useEffect)(()=>{eN(h.map(e=>e.map(e=>{let t=new Image;return t.src=e,t})))},[]);let eE=er||es,eP=(0,s.useCallback)(e=>{I.current&&(I.current.textContent=e)},[]),eC=(0,s.useCallback)(()=>{let e=H.current;e&&requestAnimationFrame(()=>{e.focus()})},[H]),eA=(0,s.useCallback)(e=>{em((v(y(e))||[]).map(e=>e.score).slice(0,5).map((e,t)=>({id:"".concat(e,"-").concat(t),score:e})))},[]),eR=(0,s.useCallback)(e=>{var t;let r=v(w(e));eg(r),ed(null!=(t=null==r?void 0:r.score)?t:0),eA(e)},[eA]);(0,s.useEffect)(()=>{$.current=U,z.current&&z.current.applySettings({gravityVariant:U.gravityVariant,practiceMode:U.practiceMode,reducedMotion:U.reducedMotion}),V.current&&z.current&&V.current.reset(z.current.state.seed,U.reducedMotion)},[U]),(0,s.useEffect)(()=>{P(M.birdSkin,String(_))},[_]),(0,s.useEffect)(()=>{P(M.pipeSkin,String(W))},[W]),(0,s.useEffect)(()=>{P(M.gravity,String(U.gravityVariant))},[U.gravityVariant]),(0,s.useEffect)(()=>{P(M.practice,U.practiceMode?"1":"0")},[U.practiceMode]),(0,s.useEffect)(()=>{P(M.ghost,U.showGhost?"1":"0")},[U.showGhost]),(0,s.useEffect)(()=>{P(M.reducedMotion,U.reducedMotion?"1":"0")},[U.reducedMotion]),(0,s.useEffect)(()=>{P(M.highHz,U.highHz?"1":"0")},[U.highHz]),(0,s.useEffect)(()=>{P(M.hitbox,U.showHitbox?"1":"0")},[U.showHitbox]),(0,s.useEffect)(()=>{(e=>{let t=null;try{t=JSON.parse(S("flappy-records")||"null")}catch(e){t=null}if(t&&"object"==typeof t&&e.forEach(e=>{var r;let a=null==t?void 0:t[e];if(a&&(null==(r=a.run)?void 0:r.pos)&&Array.isArray(a.run.pos))v(w(e))||j(e,{score:Number(a.score)||0,pos:a.run.pos})}),0===C()){let e=N("flappy-highscore",0);e>0&&A(e)}})(p.map(e=>e.name)),ef(C())},[]),(0,s.useEffect)(()=>{var e;let t=null==(e=p[U.gravityVariant])?void 0:e.name;t&&eR(t)},[U.gravityVariant,eR]),(0,s.useEffect)(()=>{V.current||(V.current=function(e,t){let r={skyFrame:0,skyProgress:0,cloudsBack:[],cloudsFront:[],gust:0,gustTimer:0,foliage:[],skylineBack:[],skylineFront:[],starfield:[],groundTiles:[],particles:[],frame:0},a=x(Date.now()),s=r=>({x:a()*e,y:a()*(t/2),speed:r,scale:.5*a()+.5}),n=(e,t,r)=>Array.from({length:e},()=>t+a()*(r-t)),l=(t,r)=>{if(!t)for(let t of r)t.x-=t.speed,t.x<=-e&&(t.x+=e*r.length)},i=(e,t)=>{let r=(t,r,a,s,n)=>{if("function"==typeof e.ellipse)return void e.ellipse(t,r,a,s,n,0,2*Math.PI);e.save(),e.translate(t,r),e.rotate(n),e.scale(a,s),e.arc(0,0,1,0,2*Math.PI),e.restore()};e.save(),e.fillStyle="white",e.beginPath(),r(t.x,t.y,20*t.scale,12*t.scale,0),r(t.x+15*t.scale,t.y+2*t.scale,20*t.scale,12*t.scale,0),r(t.x-15*t.scale,t.y+2*t.scale,20*t.scale,12*t.scale,0),e.fill(),e.restore()},o=(r,a,s,n)=>{if(a.length){for(let l of(r.save(),r.fillStyle=s,r.globalAlpha=n,a)){r.save(),r.translate(l.x,0),r.beginPath(),r.moveTo(0,t);let a=l.peaks.length>1?e/(l.peaks.length-1):e;l.peaks.forEach((e,s)=>{r.lineTo(s*a,t-e)}),r.lineTo(e,t),r.closePath(),r.fill(),r.restore()}r.restore()}},c=(e,t)=>.05*r.frame+t/40;return{reset(l,i){a=x(l),r.skyFrame=0,r.skyProgress=0,r.gust=0,r.gustTimer=0,r.particles=[],r.frame=0;r.cloudsBack=Array.from({length:3},()=>s(.2)),r.cloudsFront=Array.from({length:3},()=>s(.5));let o=Math.ceil(e/24)+2;r.skylineBack=Array.from({length:2},(r,a)=>({x:a*e,speed:.2*!i,peaks:n(6,.25*t,.45*t)})),r.skylineFront=Array.from({length:2},(r,a)=>({x:a*e,speed:.45*!i,peaks:n(6,.4*t,.6*t)})),r.groundTiles=Array.from({length:o},(e,t)=>({x:24*t,speed:1.2})),r.starfield=i?[]:Array.from({length:24},()=>({x:a()*e,y:a()*t*.4,speed:.1+.1*a(),size:1.2*a()+.6,twinkle:a()*Math.PI*2})),r.foliage=Array.from({length:6},()=>({x:a()*e,h:24*a()+20}))},update(s){r.frame+=1,(e=>{if(e){r.gust=0,r.gustTimer=0;return}r.gustTimer>0?(r.gustTimer-=1,r.gustTimer<=0&&(r.gust=0)):.005>a()&&(r.gust=(a()-.5)*2,r.gustTimer=60)})(s);if(!s){for(let t of r.cloudsBack)t.x-=t.speed+.15*r.gust,t.x<-50&&(t.x=e+50*a());for(let t of r.cloudsFront)t.x-=t.speed+.3*r.gust,t.x<-50&&(t.x=e+50*a())}if(l(s,r.skylineBack),l(s,r.skylineFront),r.starfield.length)for(let s of r.starfield)s.x-=s.speed,s.twinkle+=.04,s.x<-2&&(s.x=e+20*a(),s.y=a()*t*.4);if(!s)for(let e of r.groundTiles)e.x-=e.speed,e.x<=-24&&(e.x+=24*r.groundTiles.length);if(r.particles.length)for(let e=r.particles.length-1;e>=0;e-=1){let t=r.particles[e];t.x+=t.vx,t.y+=t.vy,t.vy+=.05,t.life-=1,t.life<=0&&r.particles.splice(e,1)}},render(a,s,n){r.skyProgress=(Math.sin(r.skyFrame/1200*Math.PI*2)+1)/2;let l=a.createLinearGradient(0,0,0,t);l.addColorStop(0,b([135,206,235],[24,32,72],r.skyProgress)),l.addColorStop(1,b([135,206,235],[16,22,48],r.skyProgress)),a.fillStyle=l,a.fillRect(0,0,e,t);if(r.starfield.length){for(let e of(a.save(),a.fillStyle="rgba(255,255,255,0.8)",r.starfield))a.globalAlpha=.5+.5*Math.sin(e.twinkle),a.beginPath(),a.arc(e.x,e.y,e.size,0,2*Math.PI),a.fill();a.restore()}for(let e of(r.skyFrame+=1,o(a,r.skylineBack,"#18324a",.6),o(a,r.skylineFront,"#234c63",.85),r.cloudsBack))i(a,e);for(let e of r.cloudsFront)i(a,e);a.save();let u=t-10;for(let t of(a.fillStyle="#2f1c0d",a.fillRect(0,u,e,10),a.fillStyle="#3b2815",r.groundTiles))a.fillRect(t.x,u-3,20,3);a.restore(),((e,a)=>{if(!a){for(let a of(e.save(),e.strokeStyle="#2c5f2d",e.lineWidth=3,r.foliage)){let s=.5*r.gust+.3*Math.sin((r.frame+a.x)/18),n=a.x+s*a.h,l=t-12-a.h;e.beginPath(),e.moveTo(a.x,t-12),e.lineTo(n,l),e.stroke()}e.restore()}})(a,n.reducedMotion),((e,a,s,n)=>{let[l,i]=n.pipeSkins[n.pipeSkinIndex%n.pipeSkins.length],o=b(l,i,r.skyProgress);for(let r of(e.fillStyle=o,a)){let{top:a,bottom:l}=g(r,s,t,n.reducedMotion);n.practiceMode&&(e.globalAlpha=.4),e.fillRect(r.x,0,40,a),e.fillRect(r.x,l,40,t-l);let i=n.reducedMotion?.2:(Math.sin(c(s,r.x))+1)/2,u=e.createLinearGradient(r.x,0,r.x+40,0);u.addColorStop(0,"rgba(255,255,255,".concat(.2+.1*i,")")),u.addColorStop(1,"rgba(0,0,0,".concat(.4-.1*i,")")),e.fillStyle=u,e.fillRect(r.x,0,40,a),e.fillRect(r.x,l,40,t-l),e.fillStyle=o,e.fillRect(r.x,a-2,40,2),e.fillRect(r.x,l,40,2),n.showHitbox&&(e.strokeStyle="red",e.strokeRect(r.x,0,40,a),e.strokeRect(r.x,l,40,t-l)),n.practiceMode&&(e.globalAlpha=1)}})(a,s.pipes,s.frame,n);if(r.particles.length){for(let e of(a.save(),r.particles))a.globalAlpha=Math.max(e.life/45,0),a.fillStyle=e.color,a.beginPath(),a.arc(e.x,e.y,2,0,2*Math.PI),a.fill();a.restore()}n.showGhost&&n.ghostRun&&s.frame<n.ghostRun.pos.length&&(a.save(),a.globalAlpha=.3,a.fillStyle="gray",a.beginPath(),a.arc(s.bird.x,n.ghostRun.pos[s.frame],10,0,2*Math.PI),a.fill(),a.restore());let d=n.birdFrames[n.birdSkinIndex%n.birdFrames.length]||[],h=d.length?Math.floor(s.frame/6)%d.length:0,f=d[h],p="ready"===s.status?Math.sin(r.frame/12)*(n.reducedMotion?.5:2):0;a.save(),a.translate(s.bird.x,s.bird.y+p),a.rotate("ready"===s.status?0:s.birdAngle),f&&f.complete?a.drawImage(f,-12,-10,24,20):(a.fillStyle="yellow",a.beginPath(),a.arc(0,0,10,0,2*Math.PI),a.fill()),n.showHitbox&&(a.strokeStyle="red",a.strokeRect(-10,-10,20,20)),a.restore()},spawnParticles:function(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:14,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2;for(let i=0;i<n;i+=1)r.particles.push({x:e,y:t,vx:(a()-.5)*l*2,vy:(a()-.2)*l*1.5,life:30+15*a(),color:s})}}}(400,300))},[]),(0,s.useEffect)(()=>{var e;let t=H.current;if(!t)return;let r=t.getContext("2d");r&&(B.current=r,z.current||(z.current=function(){var e,t;let{width:r=400,height:a=300,settings:s={gravityVariant:1,practiceMode:!1,reducedMotion:!1}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=x(Date.now()),l=null,i=0,o={frame:0,seed:Date.now(),score:0,bird:{x:50,y:a/2,vy:0},birdAngle:0,pipes:[],pipeInterval:100,nextPipeFrame:100,gap:s.practiceMode?120:80,gravity:null!=(t=null==(e=p[s.gravityVariant])?void 0:e.value)?t:p[1].value,pipeGlowPhase:0,status:"ready",crashTimer:0},c=[],u=[],d=()=>{let e=o.gap,t=n()*(a-e-40)+20,l=s.reducedMotion?0:6*n()+4,i=n()*Math.PI*2;o.pipes.push({x:r,baseTop:t,baseBottom:t+e,amplitude:l,phase:i,passed:!1})},h=()=>{"crashing"!==o.status&&"gameover"!==o.status&&(o.status="crashing",o.crashTimer=18)},f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();o.seed=e,n=x(e),o.bird={x:50,y:a/2,vy:0},o.frame=0,o.score=0,o.status="ready",o.crashTimer=0,o.pipeGlowPhase=0,o.pipeInterval=100,o.nextPipeFrame=100,o.gap=s.practiceMode?120:80,o.pipes=[],c=[],u=[],i=0},b=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];o.bird.vy=-7,e&&c.push(o.frame)};return{state:o,settings:s,reset:f,start:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();f(e),o.status="running",d()},step:()=>{if("ready"===o.status)return null;if("crashing"===o.status)return(o.bird.vy+=2*o.gravity,o.bird.y+=o.bird.vy,o.birdAngle+=.3,o.crashTimer-=1,o.bird.y+10>a||o.crashTimer<=0)?(o.status="gameover",{gameOver:{seed:o.seed,flaps:c.slice(),positions:u.slice(),score:o.score}}):null;if("running"!==o.status)return null;if(o.frame+=1,o.pipeGlowPhase+=.05*!s.reducedMotion,l&&i<l.length&&o.frame===l[i]&&(b(!1),i+=1),o.frame>=o.nextPipeFrame&&(o.gap=s.practiceMode?120:Math.max(60,80-2*Math.floor(o.score/5)),d(),o.pipeInterval=Math.max(60,100-5*Math.floor(o.score/5)),o.nextPipeFrame=o.frame+o.pipeInterval),o.bird.vy+=o.gravity,o.bird.y+=o.bird.vy,u.push(o.bird.y),o.birdAngle=m(o.bird.vy/10,-.5,.7),o.bird.y+10>a||o.bird.y-10<0)return h(),{crash:!0};let e=0;for(let t=o.pipes.length-1;t>=0;t-=1){let r=o.pipes[t];r.x-=2;let{top:n,bottom:l}=g(r,o.frame,a,s.reducedMotion);if(!s.practiceMode&&r.x<o.bird.x+10&&r.x+40>o.bird.x-10&&(o.bird.y-10<n||o.bird.y+10>l))return h(),{crash:!0};!r.passed&&r.x+40<o.bird.x-10&&(r.passed=!0,e+=1),r.x+40<0&&o.pipes.splice(t,1)}return e?(o.score+=e,{scored:e,milestone:o.score>0&&o.score%10==0?o.score:void 0}):null},flap:b,setReplay:e=>{l=(null==e?void 0:e.length)?[...e]:null,i=0},applySettings:e=>{var t,r,a;let n=m(Number(null!=(r=(s={...s,...e}).gravityVariant)?r:1),0,p.length-1);s.gravityVariant=n,o.gravity=null!=(a=null==(t=p[n])?void 0:t.value)?a:o.gravity,o.gap=s.practiceMode?120:80}}}({settings:{gravityVariant:$.current.gravityVariant,practiceMode:$.current.practiceMode,reducedMotion:$.current.reducedMotion}})),null==(e=V.current)||e.reset(z.current.state.seed,$.current.reducedMotion))},[H]);let eT=(0,s.useCallback)(()=>{var e;if(!z.current)return;let t=Date.now();J.current=t,z.current.reset(t),z.current.setReplay(null),O.current=null,ei(0),ec(!1),ey(null),q.current&&clearTimeout(q.current),et("ready"),L.current=0,null==(e=V.current)||e.reset(t,$.current.reducedMotion),eP("Get ready. Press Space, tap, or click to flap."),eC()},[eP,eC]),eF=(0,s.useCallback)(()=>{var e,t;if(!z.current)return;let r=null!=(t=J.current)?t:Date.now();J.current=null,z.current.start(r),et("running"),L.current=0,null==(e=V.current)||e.reset(z.current.state.seed,$.current.reducedMotion),eP("Score: 0"),eC()},[eP,eC]),eG=(0,s.useCallback)(()=>{eT()},[eT]),eH=(0,s.useCallback)(()=>{et("menu")},[]),eI=(0,s.useCallback)(e=>{if(et("gameover"),O.current=e,e.score>0){var t;let r=null==(t=p[$.current.gravityVariant])?void 0:t.name;r&&(j(r,{score:e.score,pos:e.positions}),eR(r))}ef(t=>{let r=Math.max(t,e.score);return r!==t&&A(r),r}),eP("Game over. Final score: ".concat(e.score))},[eP,eR]),ez=(0,s.useCallback)(()=>{var e;let t=O.current;t&&z.current&&(z.current.start(t.seed),z.current.setReplay(t.flaps||[]),ei(0),ec(!1),ey(null),q.current&&clearTimeout(q.current),et("running"),L.current=0,null==(e=V.current)||e.reset(z.current.state.seed,$.current.reducedMotion),eP("Score: 0"),eC())},[eP,eC]),eV=(0,s.useCallback)(e=>{ea(e),e||eC()},[eC]),eB=(0,s.useCallback)((e,t)=>{if(!t)return!1;let r=t.toLowerCase();return e.key.toLowerCase()===r||e.code.toLowerCase()===r},[]),eL=ej||eM,eD=(0,s.useCallback)(()=>{var e;return!r||eL?void 0:"menu"===ee?void eT():"ready"===ee?void eF():"gameover"===ee?void eT():void(!eE&&(null==(e=z.current)||e.flap()))},[eL,eT,ee,eE,r,eF]);(0,s.useEffect)(()=>{let e=e=>{if((0,R.shouldHandleGameKey)(e,{isFocused:r})){if(eB(e,null==ev?void 0:ev.flap)){(0,R.consumeGameKey)(e),eD();return}"r"===e.key.toLowerCase()&&"gameover"===ee&&((0,R.consumeGameKey)(e),O.current?ez():eG())}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[ee,eD,r,ev,eB,eG,ez]),(0,s.useEffect)(()=>{if(!r){D.current=!0,en(!0);return}r&&D.current&&(D.current=!1,en(!1))},[r]),(0,s.useEffect)(()=>{let e,t=()=>{if(r&&!eL){let e=(0,T.pollTwinStick)(),t=e.moveY<-.6,r=e.fire,a=X.current;(r&&!a.fire||t&&!a.up)&&eD(),a.fire=r,a.up=t}e=requestAnimationFrame(t)};return e=requestAnimationFrame(t),()=>cancelAnimationFrame(e)},[eL,eD,r]);let eO=(0,s.useCallback)(e=>{let t=z.current,r=V.current,a=B.current,s=ew.current;if(!t||!r||!a||!s)return;let n=$.current.highHz?120:60,l=$.current.practiceMode?1/(n/2):1/n;for(L.current+=e;L.current>=l;){let e=t.step();if(r.update($.current.reducedMotion),(null==e?void 0:e.scored)&&(ei(t.state.score),eP("Score: ".concat(t.state.score)),ec(!0),Y.current&&clearTimeout(Y.current),Y.current=setTimeout(()=>{ec(!1)},300)),(null==e?void 0:e.milestone)&&(ey("Milestone! ".concat(e.milestone," points")),q.current&&clearTimeout(q.current),q.current=setTimeout(()=>{ey(null)},2400),r.spawnParticles(t.state.bird.x+10,150,"#8ff7ff",18,3)),(null==e?void 0:e.crash)&&r.spawnParticles(t.state.bird.x,t.state.bird.y,"#fbd34d",24,3),null==e?void 0:e.gameOver){eI(e.gameOver);break}L.current-=l}r.render(a,t.state,s)},[eP,eI]),eq="running"===ee&&r&&!eE&&!eL;(0,s.useEffect)(()=>{let e;if("running"!==ee||!eq)return;let t=performance.now(),r=a=>{let s=(a-t)/1e3;t=a,eO(s),e=requestAnimationFrame(r)};return e=requestAnimationFrame(r),()=>cancelAnimationFrame(e)},[ee,eq,eO]),(0,s.useEffect)(()=>{let e;if("running"===ee||!r||eE||eL)return;let t=V.current,a=B.current,s=ew.current,n=z.current;if(!t||!a||!s||!n)return;let l=performance.now(),i=r=>{r-l>=1e3/30&&(t.update($.current.reducedMotion),t.render(a,n.state,s),l=r),e=requestAnimationFrame(i)};return e=requestAnimationFrame(i),()=>cancelAnimationFrame(e)},[eL,ee,eE,r]),(0,s.useEffect)(()=>{if("running"!==ee||eq)return;let e=z.current,t=V.current,r=B.current,a=ew.current;e&&t&&r&&a&&t.render(r,e.state,a)},[ee,eq]),(0,s.useEffect)(()=>{ew.current={width:400,height:300,pipeSkins:f,birdFrames:eS,birdSkinIndex:_,pipeSkinIndex:W,showHitbox:$.current.showHitbox,showGhost:$.current.showGhost,ghostRun:ex,reducedMotion:$.current.reducedMotion,practiceMode:$.current.practiceMode}},[eS,_,ex,W,U]),(0,s.useEffect)(()=>()=>{q.current&&clearTimeout(q.current),Y.current&&clearTimeout(Y.current)},[]);let eX=(0,a.jsxs)("div",{className:"space-y-4 text-sm text-slate-100",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex flex-col text-sm",children:[(0,a.jsx)("span",{className:"text-xs uppercase tracking-widest text-white/60",children:"Difficulty"}),(0,a.jsx)("select",{className:"mt-1 rounded border border-white/20 bg-white/90 px-3 py-2 text-black",value:U.gravityVariant,onChange:e=>Z(t=>({...t,gravityVariant:parseInt(e.target.value,10)})),children:p.map((e,t)=>(0,a.jsx)("option",{value:t,children:e.name},e.name))})]}),(0,a.jsxs)("label",{className:"flex items-center justify-between gap-4",children:[(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"Practice mode"}),(0,a.jsx)("span",{className:"block text-xs text-white/60",children:"Wider gaps with relaxed collisions."})]}),(0,a.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-white/40 bg-white/80 text-sky-500 focus:ring-sky-400","aria-label":"Practice mode",checked:U.practiceMode,onChange:e=>Z(t=>({...t,practiceMode:e.target.checked}))})]}),(0,a.jsxs)("label",{className:"flex items-center justify-between gap-4",children:[(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"Ghost run"}),(0,a.jsx)("span",{className:"block text-xs text-white/60",children:"Overlay best run."})]}),(0,a.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-white/40 bg-white/80 text-sky-500 focus:ring-sky-400","aria-label":"Ghost run",checked:U.showGhost,onChange:e=>Z(t=>({...t,showGhost:e.target.checked}))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center justify-between gap-4",children:[(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"Reduced motion"}),(0,a.jsx)("span",{className:"block text-xs text-white/60",children:"Calms background animation."})]}),(0,a.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-white/40 bg-white/80 text-sky-500 focus:ring-sky-400","aria-label":"Reduced motion",checked:U.reducedMotion,onChange:e=>Z(t=>({...t,reducedMotion:e.target.checked}))})]}),(0,a.jsxs)("label",{className:"flex items-center justify-between gap-4",children:[(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"120 Hz mode"}),(0,a.jsx)("span",{className:"block text-xs text-white/60",children:"Higher refresh rate."})]}),(0,a.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-white/40 bg-white/80 text-sky-500 focus:ring-sky-400","aria-label":"120 Hz mode",checked:U.highHz,onChange:e=>Z(t=>({...t,highHz:e.target.checked}))})]}),(0,a.jsxs)("label",{className:"flex items-center justify-between gap-4",children:[(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"Hitbox overlay"}),(0,a.jsx)("span",{className:"block text-xs text-white/60",children:"Debug collision bounds."})]}),(0,a.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-white/40 bg-white/80 text-sky-500 focus:ring-sky-400","aria-label":"Hitbox overlay",checked:U.showHitbox,onChange:e=>Z(t=>({...t,showHitbox:e.target.checked}))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"text-xs uppercase tracking-widest text-white/60",children:"Controls"}),(0,a.jsx)(l.default,{mapping:ev,setKey:ek,actions:{flap:"Space",pause:"Escape"}})]})]}),eJ=el>=40?{label:"Platinum",color:"from-slate-200 to-slate-400"}:el>=30?{label:"Gold",color:"from-yellow-300 to-amber-500"}:el>=20?{label:"Silver",color:"from-slate-200 to-slate-500"}:el>=10?{label:"Bronze",color:"from-amber-400 to-orange-600"}:null;return(0,a.jsx)(n.default,{gameId:"flappy-bird",score:el,highScore:eu,onPauseChange:eV,onRestart:eG,pauseHotkeys:[(null==ev?void 0:ev.pause)||"Escape"],settingsPanel:eX,isFocused:r,children:(0,a.jsxs)("div",{className:"relative h-full w-full",children:[eb&&(0,a.jsx)("div",{className:"pointer-events-none absolute left-1/2 top-8 z-30 -translate-x-1/2 rounded-full bg-white/20 px-4 py-2 text-sm font-semibold uppercase tracking-widest text-yellow-200 shadow-lg backdrop-blur transition-opacity duration-300",children:eb}),"running"===ee&&(0,a.jsx)("div",{className:"pointer-events-none absolute left-1/2 top-6 z-30 -translate-x-1/2 text-5xl font-bold tracking-widest text-white drop-shadow-lg transition-transform duration-150 ".concat(eo?"scale-110":"scale-100"),children:el}),(0,a.jsx)("canvas",{ref:H,className:"h-full w-full touch-none bg-black focus:outline-none focus:ring-2 focus:ring-sky-400",role:"img","aria-label":"Flappy Bird game",tabIndex:0,onPointerDown:e=>{e.cancelable&&e.preventDefault(),eD()}}),"menu"===ee&&(0,a.jsxs)("div",{className:"absolute inset-0 z-40 flex flex-col items-center justify-center space-y-6 bg-black/80 p-6 text-white",children:[(0,a.jsxs)("div",{className:"grid w-full max-w-4xl gap-6 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-4 text-left",children:[(0,a.jsxs)("label",{className:"flex flex-col text-sm",children:[(0,a.jsx)("span",{className:"text-xs uppercase tracking-widest text-white/60",children:"Bird Skin"}),(0,a.jsx)("select",{className:"mt-1 rounded border border-white/20 bg-white/90 px-3 py-2 text-black",value:_,onChange:e=>K(parseInt(e.target.value,10)),"aria-label":"Bird Skin",children:d.map((e,t)=>(0,a.jsx)("option",{value:t,children:e},e))})]}),(0,a.jsxs)("label",{className:"flex flex-col text-sm",children:[(0,a.jsx)("span",{className:"text-xs uppercase tracking-widest text-white/60",children:"Pipe Skin"}),(0,a.jsx)("select",{className:"mt-1 rounded border border-white/20 bg-white/90 px-3 py-2 text-black",value:W,onChange:e=>Q(parseInt(e.target.value,10)),"aria-label":"Pipe Skin",children:f.map((e,t)=>(0,a.jsx)("option",{value:t,children:"Skin ".concat(t+1)},t))})]}),eX,(0,a.jsxs)("div",{className:"rounded-lg bg-white/10 p-4 text-xs uppercase tracking-widest text-white/70",children:[(0,a.jsx)("p",{className:"text-white",children:"Controls"}),(0,a.jsx)("p",{className:"mt-2 text-[11px] text-white/70",children:G?"Tap the play area to flap.":"Space or click to flap."}),(0,a.jsx)("p",{className:"mt-1 text-[11px] text-white/60",children:"Gamepad: press A / primary button or push up to flap."}),(0,a.jsx)("p",{className:"mt-2 text-[11px] text-white/60",children:"Use the settings button to remap keys."})]})]}),(0,a.jsxs)("div",{className:"rounded-lg bg-white/10 p-4 backdrop-blur",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"High Scores"}),(0,a.jsxs)("p",{className:"text-sm text-white/70",children:["Best overall:"," ",(0,a.jsx)("span",{className:"font-semibold text-white",children:eh})]}),(0,a.jsx)("ul",{className:"mt-3 space-y-1 text-sm",children:ep.length?ep.map(e=>{let{id:t,score:r}=e;return(0,a.jsxs)("li",{className:"flex items-center justify-between rounded bg-black/30 px-3 py-1",children:[(0,a.jsx)("span",{className:"font-semibold uppercase tracking-wide text-white/80",children:"Run"}),(0,a.jsx)("span",{children:r})]},t)}):(0,a.jsx)("li",{className:"rounded bg-black/30 px-3 py-2 text-white/60",children:"No runs recorded yet."})})]})]}),ej&&(0,a.jsx)("p",{className:"text-xs uppercase tracking-widest text-white/60",children:"Loading assetsâ€¦"}),eM&&(0,a.jsx)("p",{className:"text-xs uppercase tracking-widest text-red-200",children:"Some assets failed to load. Try refreshing."}),(0,a.jsx)("button",{type:"button",className:"w-40 rounded-full bg-sky-500 px-6 py-3 text-sm font-semibold uppercase tracking-widest text-white shadow-lg transition hover:bg-sky-400 focus:outline-none focus:ring-4 focus:ring-sky-300",onClick:eT,disabled:ej,children:"Start"})]}),"ready"===ee&&(0,a.jsx)("div",{className:"absolute inset-0 z-40 flex flex-col items-center justify-center bg-black/40 p-6 text-white",children:(0,a.jsxs)("div",{className:"flex max-w-md flex-col items-center gap-4 text-center",children:[(0,a.jsx)("div",{className:"text-4xl font-bold uppercase tracking-[0.3em] drop-shadow-lg",children:"Get Ready"}),(0,a.jsx)("div",{className:"rounded-lg bg-white/10 px-6 py-4 text-sm uppercase tracking-widest text-white/80 shadow-lg backdrop-blur",children:G?"Tap to flap":"Press Space or click to flap"}),(0,a.jsx)("div",{className:"text-xs uppercase tracking-widest text-white/70",children:"Gamepad: Press A or push up"})]})}),"gameover"===ee&&(0,a.jsxs)("div",{className:"absolute inset-0 z-40 flex flex-col items-center justify-center space-y-6 bg-black/75 p-6 text-white",children:[(0,a.jsxs)("div",{className:"w-full max-w-md rounded-xl bg-white/10 p-6 text-center shadow-xl backdrop-blur",children:[(0,a.jsx)("h3",{className:"text-3xl font-semibold uppercase tracking-widest",children:"Game Over"}),(0,a.jsxs)("div",{className:"mt-6 rounded-lg bg-black/40 p-4 text-left text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"uppercase tracking-widest text-white/70",children:"Score"}),(0,a.jsx)("span",{className:"text-2xl font-bold text-white",children:el})]}),(0,a.jsxs)("div",{className:"mt-2 flex items-center justify-between",children:[(0,a.jsx)("span",{className:"uppercase tracking-widest text-white/60",children:"Best"}),(0,a.jsx)("span",{className:"text-lg font-semibold text-white/90",children:eu})]}),(0,a.jsxs)("div",{className:"mt-2 flex items-center justify-between",children:[(0,a.jsx)("span",{className:"uppercase tracking-widest text-white/40",children:"Global"}),(0,a.jsx)("span",{className:"text-sm text-white/70",children:eh})]}),eJ&&(0,a.jsxs)("div",{className:"mt-4 flex items-center gap-3",children:[(0,a.jsx)("span",{className:"h-10 w-10 rounded-full bg-gradient-to-br ".concat(eJ.color," shadow-inner"),"aria-hidden":"true"}),(0,a.jsxs)("span",{className:"text-xs uppercase tracking-widest text-white/70",children:[eJ.label," Medal"]})]})]}),O.current&&(0,a.jsx)("p",{className:"mt-4 text-xs text-white/60",children:"Press R to replay your last run."})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-3",children:[(0,a.jsx)("button",{type:"button",className:"rounded-full bg-sky-500 px-5 py-2 text-sm font-semibold uppercase tracking-widest text-white shadow hover:bg-sky-400 focus:outline-none focus:ring-4 focus:ring-sky-300",onClick:eT,children:"Play Again"}),O.current&&(0,a.jsx)("button",{type:"button",className:"rounded-full bg-emerald-500 px-5 py-2 text-sm font-semibold uppercase tracking-widest text-white shadow hover:bg-emerald-400 focus:outline-none focus:ring-4 focus:ring-emerald-300",onClick:ez,children:"Replay Last"}),(0,a.jsx)("button",{type:"button",className:"rounded-full bg-white/20 px-5 py-2 text-sm font-semibold uppercase tracking-widest text-white hover:bg-white/30 focus:outline-none focus:ring-4 focus:ring-white/40",onClick:eH,children:"Change Skins"})]})]}),(0,a.jsx)("div",{ref:I,className:"sr-only","aria-live":"polite"})]})})}},67817:(e,t,r)=>{r.d(t,{default:()=>n});var a=r(14232);let s=()=>"function"==typeof window.matchMedia?window.matchMedia("(pointer: coarse)").matches:"ontouchstart"in window||navigator.maxTouchPoints>0;function n(){let[e,t]=(0,a.useState)(s);return(0,a.useEffect)(()=>{var e,r,a;let s=null==(e=(r=window).matchMedia)?void 0:e.call(r,"(pointer: coarse)");if(!s)return;let n=e=>{t(e.matches)};return null==(a=s.addEventListener)||a.call(s,"change",n),()=>{var e;null==(e=s.removeEventListener)||e.call(s,"change",n)}},[]),e}},84613:(e,t,r)=>{r.d(t,{GAMEPAD_PRESETS:()=>s,loadCalibration:()=>n,pollTwinStick:()=>c,saveCalibration:()=>l});let a="gamepad-calibration-",s={Xbox:{vendor:"Xbox",axes:Array.from({length:4},()=>({min:-1,max:1}))},PlayStation:{vendor:"PlayStation",axes:Array.from({length:4},()=>({min:-1,max:1}))}};function n(e){try{let t=window.localStorage.getItem(a+e);return t?JSON.parse(t):null}catch(e){return null}}function l(e,t){try{window.localStorage.setItem(a+e,JSON.stringify(t))}catch(e){}}function i(e,t){if(!t)return e;let r=t.max-t.min;return 0===r?0:(Math.min(Math.max(e,t.min),t.max)-t.min)/r*2-1}class o{on(e,t){this.listeners[e].add(t)}off(e,t){this.listeners[e].delete(t)}emit(e,t){this.listeners[e].forEach(e=>e(t))}start(){null===this.raf&&this.poll()}stop(){null!==this.raf&&(cancelAnimationFrame(this.raf),this.raf=null)}constructor(e=.1){this.listeners={connected:new Set,disconnected:new Set,button:new Set,axis:new Set},this.prevState=new Map,this.raf=null,this.poll=()=>{for(let e of navigator.getGamepads?navigator.getGamepads():[]){if(!e)continue;let t=this.prevState.get(e.index)||{buttons:[],axes:[]};e.buttons.forEach((r,a)=>{let s=t.buttons[a]||0;if(r.value!==s){var n;let t=r.value>.5,l=s>.5;if(this.emit("button",{gamepad:e,index:a,value:r.value,pressed:t}),t&&!l&&(null==(n=e.vibrationActuator)?void 0:n.playEffect))try{e.vibrationActuator.playEffect("dual-rumble",{duration:30,strongMagnitude:1,weakMagnitude:1})}catch(e){}}}),e.axes.forEach((r,a)=>{let s=t.axes[a]||0,n=Math.abs(r)<this.deadzone?0:r;n!==(Math.abs(s)<this.deadzone?0:s)&&this.emit("axis",{gamepad:e,index:a,value:n})}),this.prevState.set(e.index,{buttons:e.buttons.map(e=>e.value),axes:Array.from(e.axes)})}this.raf=requestAnimationFrame(this.poll)},this.deadzone=e,window.addEventListener("gamepadconnected",e=>this.emit("connected",e.gamepad)),window.addEventListener("gamepaddisconnected",e=>this.emit("disconnected",e.gamepad))}}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.25,t={moveX:0,moveY:0,aimX:0,aimY:0,fire:!1};for(let r of navigator.getGamepads?navigator.getGamepads():[]){if(!r)continue;let a=n(r.id),s=(null==a?void 0:a.axes)||[],[l,o,c,u]=r.axes,d=i(l,s[0]),h=i(o,s[1]),f=i(c,s[2]),p=i(u,s[3]);t.moveX=Math.abs(d)>e?d:0,t.moveY=Math.abs(h)>e?h:0,t.aimX=Math.abs(f)>e?f:0,t.aimY=Math.abs(p)>e?p:0,t.fire=r.buttons.some(e=>e.pressed);break}return t}new o}}]);