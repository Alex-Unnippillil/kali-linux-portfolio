"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4412],{44412:(e,t,s)=>{s.r(t),s.d(t,{default:()=>S,displayOpenVAS:()=>C});var i=s(37876),l=s(14232);let a=()=>{let e={source:"Greenbone Community Feed",vtCount:99564,lastUpdate:"2024-02-01",docs:"https://docs.greenbone.net/"};return(0,i.jsxs)("div",{className:"mb-4 rounded-xl border border-white/10 bg-kali-surface-muted/80 p-4 text-white shadow-kali-panel backdrop-blur",children:[(0,i.jsx)("h3",{className:"mb-2 text-sm font-semibold uppercase tracking-wide text-kali-control",children:"VT Feed Status"}),(0,i.jsxs)("p",{className:"text-sm text-white/80",children:["Source: ",e.source]}),(0,i.jsxs)("p",{className:"text-sm text-white/80",children:["VTs: ",e.vtCount.toLocaleString()]}),(0,i.jsxs)("p",{className:"text-sm text-white/80",children:["Last Update: ",e.lastUpdate]}),(0,i.jsxs)("p",{className:"mt-2 text-xs text-white/60",children:["Data based on"," ",(0,i.jsx)("a",{href:e.docs,className:"text-kali-info underline hover:text-kali-info/80",target:"_blank",rel:"noreferrer",children:"Greenbone docs"})," ","(canned demo)"]})]})},o=JSON.parse('[{"time":"08:00","status":"Queued"},{"time":"08:05","status":"Running"},{"time":"08:45","status":"Completed"},{"time":"09:00","status":"Queued"},{"time":"09:05","status":"Running"},{"time":"09:30","status":"Completed"}]'),r=["Queued","Running","Completed"],n={Queued:"fill-kali-info",Running:"fill-kali-primary",Completed:"fill-kali-control"},c=()=>{let e=20*o.length+20,t=o.map((e,t)=>{let s=40-r.indexOf(e.status)/(r.length-1)*40;return"".concat(20*t+10,",").concat(s)}).join(" ");return(0,i.jsxs)("svg",{viewBox:"0 0 ".concat(e," ").concat(50),className:"mb-2 h-24 w-full",role:"img","aria-label":"Task runs and status changes over time",children:[r.map((t,s)=>{let l=40-s/(r.length-1)*40;return(0,i.jsxs)("g",{children:[(0,i.jsx)("line",{x1:"0",y1:l,x2:e,y2:l,className:"stroke-white/20",strokeWidth:"0.75"}),(0,i.jsx)("text",{x:"0",y:l-1,className:"fill-white/70 text-[8px]",children:t})]},t)}),(0,i.jsx)("polyline",{points:t,fill:"none",stroke:"currentColor",className:"stroke-kali-primary",strokeWidth:"1.5"}),o.map((e,t)=>{let s=40-r.indexOf(e.status)/(r.length-1)*40;return(0,i.jsx)("circle",{cx:20*t+10,cy:s,r:"2.5",className:"".concat(n[e.status]," stroke-kali-background stroke-[0.75]")},e.time)})]})},d=()=>(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)(a,{}),(0,i.jsxs)("div",{className:"rounded-xl border border-white/10 bg-kali-surface-muted/80 p-4 text-white shadow-kali-panel backdrop-blur",children:[(0,i.jsx)("h3",{className:"mb-2 text-sm font-semibold uppercase tracking-wide text-kali-control",children:"Demo Task Overview"}),(0,i.jsx)("h4",{className:"mb-1 text-xs font-semibold uppercase tracking-wide text-kali-muted",children:"Run History"}),(0,i.jsx)(c,{}),(0,i.jsx)("ul",{className:"mt-2 space-y-1 text-sm text-white/80",children:[{name:"Internal Network Scan",status:"Completed"},{name:"External Perimeter",status:"Running"},{name:"Web App Audit",status:"Queued"}].map(e=>(0,i.jsxs)("li",{className:"flex items-center justify-between",children:[(0,i.jsx)("span",{children:e.name}),(0,i.jsx)("span",{className:"rounded-full bg-kali-surface-raised/70 px-2 py-0.5 text-xs font-medium text-white/70",children:e.status})]},e.name))}),(0,i.jsx)("p",{className:"mt-2 text-xs text-white/60",children:"All task data is canned for demonstration purposes."})]})]}),u=e=>{let{policy:t}=e,[s,a]=(0,l.useState)(t||{name:"Full and Fast",portList:"OpenVAS Default",maxHosts:"10 concurrent hosts",qod:"70% minimum"}),o=e=>t=>a({...s,[e]:t.target.value});return(0,i.jsxs)("div",{className:"mb-4 rounded-xl border border-white/10 bg-kali-surface-muted/80 p-4 text-white shadow-kali-panel backdrop-blur",children:[(0,i.jsx)("h3",{className:"mb-2 text-sm font-semibold uppercase tracking-wide text-kali-control",children:"Policy Settings"}),(0,i.jsxs)("ul",{className:"space-y-1 text-sm text-white/80",children:[(0,i.jsxs)("li",{children:[(0,i.jsx)("span",{className:"font-semibold text-white",children:"Name:"})," ",s.name]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("span",{className:"font-semibold text-white",children:"Port List:"})," ",s.portList]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("span",{className:"font-semibold text-white",children:"Max Hosts:"})," ",s.maxHosts]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("span",{className:"font-semibold text-white",children:"QoD:"})," ",s.qod]})]}),(0,i.jsxs)("form",{className:"mt-3 space-y-3 text-xs",children:[(0,i.jsxs)("label",{className:"block text-[0.7rem] font-semibold uppercase tracking-wide text-white/70",children:["Policy Name",(0,i.jsx)("input",{"aria-label":"Policy Name",className:"mt-1 w-full rounded-md border border-white/10 bg-kali-surface-raised/80 px-2 py-1 text-sm text-white placeholder-white/40 focus:border-kali-focus focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",value:s.name,onChange:o("name")})]}),(0,i.jsxs)("label",{className:"block text-[0.7rem] font-semibold uppercase tracking-wide text-white/70",children:["Port List",(0,i.jsx)("input",{"aria-label":"Port List",className:"mt-1 w-full rounded-md border border-white/10 bg-kali-surface-raised/80 px-2 py-1 text-sm text-white placeholder-white/40 focus:border-kali-focus focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",value:s.portList,onChange:o("portList")})]}),(0,i.jsxs)("label",{className:"block text-[0.7rem] font-semibold uppercase tracking-wide text-white/70",children:["Max Hosts",(0,i.jsx)("input",{"aria-label":"Max Hosts",className:"mt-1 w-full rounded-md border border-white/10 bg-kali-surface-raised/80 px-2 py-1 text-sm text-white placeholder-white/40 focus:border-kali-focus focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",value:s.maxHosts,onChange:o("maxHosts")})]}),(0,i.jsxs)("label",{className:"block text-[0.7rem] font-semibold uppercase tracking-wide text-white/70",children:["QoD",(0,i.jsx)("input",{"aria-label":"QoD",className:"mt-1 w-full rounded-md border border-white/10 bg-kali-surface-raised/80 px-2 py-1 text-sm text-white placeholder-white/40 focus:border-kali-focus focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",value:s.qod,onChange:o("qod")})]})]}),(0,i.jsxs)("div",{className:"mt-3 flex gap-2 text-xs font-semibold",children:[(0,i.jsx)("button",{type:"button",onClick:()=>{localStorage.setItem("openvasPolicy",JSON.stringify(s))},className:"rounded-md bg-kali-primary px-3 py-1.5 text-white transition hover:bg-kali-primary/90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",children:"Save Policy"}),(0,i.jsx)("button",{type:"button",onClick:()=>{{let e=localStorage.getItem("openvasPolicy");e&&a(JSON.parse(e))}},className:"rounded-md bg-kali-control px-3 py-1.5 text-black transition hover:bg-kali-control/90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",children:"Load Policy"})]}),(0,i.jsx)("p",{className:"mt-3 text-xs text-white/60",children:"Sample configuration shown for demo purposes."})]})},m={PCI:JSON.parse('{"name":"PCI DSS","portList":"OpenVAS Default","maxHosts":"10 concurrent hosts","qod":"70% minimum"}'),HIPAA:JSON.parse('{"name":"HIPAA","portList":"Healthcare Services","maxHosts":"5 concurrent hosts","qod":"80% minimum"}')},x=[{id:"PCI",label:"PCI",icon:(0,i.jsx)(()=>(0,i.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:[(0,i.jsx)("rect",{x:"2",y:"5",width:"20",height:"14",rx:"2"}),(0,i.jsx)("rect",{x:"4",y:"8",width:"16",height:"2"})]}),{})},{id:"HIPAA",label:"HIPAA",icon:(0,i.jsx)(()=>(0,i.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:(0,i.jsx)("path",{d:"M11 2h2v8h8v2h-8v8h-2v-8H3v-2h8z"})}),{})}],h=(e,t)=>{"Notification"in window&&"granted"===Notification.permission?new Notification(e,{body:t}):alert("".concat(e,": ").concat(t))},f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},p=["low","medium","high","critical"],b={low:{surface:"bg-kali-severity-low",chart:"fill-kali-severity-low",text:"text-white"},medium:{surface:"bg-kali-severity-medium",chart:"fill-kali-severity-medium",text:"text-kali-inverse"},high:{surface:"bg-kali-severity-high",chart:"fill-kali-severity-high",text:"text-white"},critical:{surface:"bg-kali-severity-critical",chart:"fill-kali-severity-critical",text:"text-white"}},v=e=>{let{data:t,selected:s,onSelect:l}=e,a=Math.max(...p.map(e=>t[e]||0),1);return(0,i.jsx)("svg",{viewBox:"0 0 100 60",role:"img","aria-label":"OpenVAS findings severity chart",className:"mb-4 h-32 w-full",children:p.map((e,o)=>{var r,n;let c=t[e]||0,d=c/a*50,u=24*o+5,m=s===e,x=()=>l&&l(e);return(0,i.jsxs)("g",{children:[(0,i.jsx)("rect",{x:u,y:55-d,width:"20",height:d,className:"".concat(null!=(n=null==(r=b[e])?void 0:r.chart)?n:""," ").concat(l?"cursor-pointer transition-transform":""," ").concat(m?"stroke-white stroke-2":""),role:l?"button":void 0,tabIndex:l?0:void 0,"aria-label":"".concat(c," ").concat(e," findings"),onClick:x,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),x())}}),(0,i.jsx)("text",{x:u+10,y:"58",textAnchor:"middle",className:"fill-white text-[8px] capitalize",children:e})]},e)})})},g=["All","Low","Medium","High","Critical"],w={low:"Review configuration and apply best practices.",medium:"Update affected software to the latest version.",high:"Apply vendor patches and restrict network access.",critical:"Isolate system and patch immediately."},k=[{severity:"low",impact:"low",likelihood:"low",description:"Outdated banner exposes software version",remediation:w.low,cvss:5,epss:.05},{severity:"high",impact:"high",likelihood:"medium",description:"Remote code execution vulnerability detected",remediation:w.high,cvss:8.2,epss:.6}],j=[{host:"192.168.1.10",risk:"High",summary:{critical:1,high:2,medium:2,low:1},vulns:[{title:"Apache 2.4.49 Path Traversal",cvss:9.8,epss:.76,remediation:["Patch","WAF"]},{title:"OpenSSH 7.2p2",cvss:7.5,epss:.22,remediation:["Update"]}]},{host:"10.0.0.5",risk:"Medium",summary:{critical:0,high:1,medium:3,low:2},vulns:[{title:"SMBv1 Enabled",cvss:6.5,epss:.17,remediation:["Disable SMBv1","Patch"]}]}],y=e=>{localStorage.setItem("openvas/session",JSON.stringify(e))},N=()=>{var e,t;let[a,o]=(0,l.useState)(""),[r,n]=(0,l.useState)(""),[c,N]=(0,l.useState)("PCI"),[S,C]=(0,l.useState)(""),[A,P]=(0,l.useState)(!1),[I,O]=(0,l.useState)(null),[L,H]=(0,l.useState)(k),[R,_]=(0,l.useState)(null),[M,V]=(0,l.useState)("All"),[F,D]=(0,l.useState)(""),[U,q]=(0,l.useState)(0),[E,T]=(0,l.useState)(null),[Q,z]=(0,l.useState)(null),B=(0,l.useRef)(null),J=(0,l.useRef)(!1),W=(0,l.useRef)({});(0,l.useEffect)(()=>{{J.current=window.matchMedia("(prefers-reduced-motion: reduce)").matches,"function"==typeof Worker&&(B.current=new Worker(s.tu(new URL(s.p+s.u(5229),s.b))),B.current.onmessage=e=>{let{type:t,data:s}=e.data||{};"progress"===t&&(q(s),y({...W.current,progress:s})),"result"===t&&H(s.map(e=>({...e,remediation:w[e.severity]})))});let e=(()=>{try{return JSON.parse(localStorage.getItem("openvas/session")||"null")}catch(e){return null}})();e&&(W.current=e,o(e.target||""),n(e.group||""),N(e.profile||"PCI"),q(e.progress||0),e.target&&e.progress<1&&G(e.target,e.group||"",e.profile||"PCI"))}return()=>{var e;return null==(e=B.current)?void 0:e.terminate()}},[]);let G=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c;if(e){W.current={target:e,group:t,profile:s},y({...W.current,progress:0}),o(e),n(t),N(s),P(!0),q(0),C(""),O(null);try{var i;let l=await fetch("/api/openvas?target=".concat(encodeURIComponent(e),"&group=").concat(encodeURIComponent(t),"&profile=").concat(encodeURIComponent(s)));if(!l.ok)throw Error("Request failed with ".concat(l.status));let o=await l.text();C(o),null==(i=B.current)||i.postMessage({text:o});let n=new Blob(["# OpenVAS Scan Summary\n\n- Target: ".concat(a,"\n- Group: ").concat(r,"\n- Profile: ").concat(c,"\n\n## Output\n\n").concat(o)],{type:"text/markdown"});O(URL.createObjectURL(n)),h("OpenVAS Scan Complete","Target ".concat(e," finished"))}catch(e){C(e.message),h("OpenVAS Scan Failed",e.message)}finally{P(!1),localStorage.removeItem("openvas/session"),W.current={}}}},K=e=>{let t=()=>{V(e),D("Showing ".concat(e," severity alerts"))};J.current?t():requestAnimationFrame(t)},Y=R?L.filter(e=>e.likelihood===R.likelihood&&e.impact===R.impact):L,X="All"===M?Y:Y.filter(e=>e.severity===M.toLowerCase()),Z=L.reduce((e,t)=>(e[t.severity]=(e[t.severity]||0)+1,e),{}),$=["low","medium","high","critical"].map(e=>["low","medium","high","critical"].map(t=>L.filter(s=>s.likelihood===e&&s.impact===t)));return(0,i.jsxs)("div",{className:"h-full w-full overflow-auto bg-kali-surface/95 p-4 text-white",children:[(0,i.jsx)(d,{}),(0,i.jsx)(u,{policy:m[c]}),j.length>0&&(0,i.jsx)("div",{className:"grid gap-2 grid-cols-1 sm:grid-cols-2 mb-4",children:j.map(e=>{var t,s,l;let a=null!=(t=b[e.risk.toLowerCase()])?t:{};return(0,i.jsxs)("button",{type:"button",onClick:()=>z(e),className:"rounded-lg border border-white/10 bg-kali-surface p-4 text-left transition hover:bg-kali-surface-raised focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",children:[(0,i.jsx)("div",{className:"font-bold mb-1",children:e.host}),(0,i.jsx)("div",{className:"mb-1",children:(0,i.jsx)("span",{className:"rounded px-2 py-1 text-xs font-semibold ".concat(null!=(s=a.surface)?s:""," ").concat(null!=(l=a.text)?l:"text-white"),children:e.risk})}),(0,i.jsx)("div",{className:"text-xs text-white/70",children:Object.entries(e.summary).map(e=>{let[t,s]=e;return(0,i.jsxs)("span",{className:"mr-2 capitalize",children:[t,": ",s]},t)})})]},e.host)})}),(0,i.jsx)("h2",{className:"mb-2 text-lg font-semibold",children:"OpenVAS Scanner"}),(0,i.jsxs)("div",{className:"mb-4 flex flex-wrap gap-2",children:[(0,i.jsx)("input",{className:"flex-1 min-w-[12rem] rounded-lg bg-kali-surface-muted px-3 py-2 text-sm text-white placeholder-white/60 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",placeholder:"Target (e.g. 192.168.1.1)",value:a,onChange:e=>o(e.target.value),"aria-label":"Scan target"}),(0,i.jsx)("input",{className:"flex-1 min-w-[10rem] rounded-lg bg-kali-surface-muted px-3 py-2 text-sm text-white placeholder-white/60 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",placeholder:"Group (e.g. Servers)",value:r,onChange:e=>n(e.target.value),"aria-label":"Asset group"}),(0,i.jsx)("div",{className:"flex items-center gap-2",role:"tablist","aria-label":"Scan profile",children:x.map(e=>(0,i.jsx)("button",{type:"button",role:"tab","aria-selected":c===e.id,"aria-label":e.label,onClick:()=>N(e.id),className:"flex h-8 w-8 items-center justify-center rounded-md border border-white/10 transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus ".concat(c===e.id?"bg-kali-surface-raised text-kali-control shadow-[0_0_0_1px_rgba(255,255,255,0.12)]":"bg-kali-surface-muted text-white/70 hover:text-white"),children:e.icon},e.id))}),(0,i.jsx)("button",{type:"button",onClick:()=>G(),disabled:A,className:"rounded-lg bg-kali-severity-low px-4 py-2 text-sm font-semibold text-white transition hover:bg-kali-severity-low/90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus disabled:cursor-not-allowed disabled:opacity-60",children:A?"Scanning...":"Scan"})]}),A&&(0,i.jsx)("div",{className:"mb-4 h-2 w-full overflow-hidden rounded-full bg-kali-surface-muted",children:(0,i.jsx)("div",{style:{width:"".concat(U,"%")},className:"h-full transition-all ".concat(null!=(t=null==(e=b.low)?void 0:e.surface)?t:"")})}),(0,i.jsx)(v,{data:Z,selected:"All"===M?null:M.toLowerCase(),onSelect:e=>K(M.toLowerCase()===e?"All":e.charAt(0).toUpperCase()+e.slice(1))}),L.length>0&&(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-5 gap-1 text-center",children:[(0,i.jsx)("div",{}),["low","medium","high","critical"].map(e=>(0,i.jsx)("div",{className:"font-bold capitalize",children:e},e)),["low","medium","high","critical"].map((e,t)=>(0,i.jsxs)(l.Fragment,{children:[(0,i.jsx)("div",{className:"font-bold capitalize flex items-center justify-center",children:e}),["low","medium","high","critical"].map((s,l)=>{var a,o,r;let n=$[t][l].length,c=null!=(a=b[p[Math.min(Math.max(t,l),p.length-1)]])?a:{},d=null!=(o=c.surface)?o:"",u=null!=(r=c.text)?r:"text-white";return(0,i.jsx)("button",{type:"button",onClick:()=>((e,t)=>{let s=()=>{R&&R.likelihood===e&&R.impact===t?(_(null),D("Showing all findings")):(_({likelihood:e,impact:t}),D("Showing ".concat(e," likelihood and ").concat(t," impact findings")))};J.current?s():requestAnimationFrame(s)})(e,s),disabled:0===n,className:"w-full rounded-md p-2 font-semibold ".concat(d," ").concat(u," focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus ").concat(J.current?"":"transition-transform hover:scale-105"," ").concat(R&&R.likelihood===e&&R.impact===s?"ring-2 ring-white/80":""," disabled:cursor-not-allowed disabled:opacity-45"),"aria-label":"".concat(n," findings with ").concat(e," likelihood and ").concat(s," impact"),children:n},"".concat(e,"-").concat(s))})]},e))]}),(0,i.jsx)("div",{role:"radiogroup","aria-label":"Filter alerts by severity",className:"flex flex-wrap gap-2 mt-4",children:g.map(e=>(0,i.jsx)("button",{onClick:()=>K(e),"aria-pressed":M===e,className:"rounded-full border border-white/10 px-3 py-1 text-sm font-medium transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus ".concat(M===e?"bg-kali-control text-black shadow-[0_0_0_1px_rgba(255,255,255,0.25)]":"bg-kali-surface-muted text-white/80 hover:text-white"),children:e},e))}),(0,i.jsx)("div",{className:"flex gap-4 mt-2 text-sm","aria-label":"Severity legend",children:g.filter(e=>"All"!==e).map(e=>{var t,s;return(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"mr-1 h-3 w-3 rounded-sm ".concat(null!=(s=null==(t=b[e.toLowerCase()])?void 0:t.surface)?s:"")}),e]},e)})})]}),X.length>0&&(0,i.jsx)("ul",{className:"mb-4 space-y-2",children:X.map((e,t)=>{var s,l,a,o;return(0,i.jsx)("li",{role:"listitem",className:"rounded-lg p-2 shadow-sm ".concat(null!=(a=null==(s=b[e.severity])?void 0:s.surface)?a:""," ").concat(null!=(o=null==(l=b[e.severity])?void 0:l.text)?o:"text-white"),children:(0,i.jsx)("button",{type:"button",onClick:()=>T(e),"aria-label":"View finding details for ".concat(e.description),className:"w-full text-left transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("span",{dangerouslySetInnerHTML:{__html:f(e.description)}}),(0,i.jsxs)("div",{className:"ml-2 flex gap-1",children:[(0,i.jsxs)("span",{className:"rounded bg-kali-severity-critical px-1 py-0.5 text-xs font-semibold text-white",children:["CVSS ",e.cvss]}),(0,i.jsxs)("span",{className:"rounded bg-kali-info px-1 py-0.5 text-xs font-semibold text-kali-inverse",children:["EPSS ",(100*e.epss).toFixed(1),"%"]})]})]})})},t)})}),Q&&(0,i.jsx)("div",{role:"dialog","aria-modal":"true",className:"fixed inset-0 z-50 flex items-center justify-center bg-kali-overlay/80 p-4 backdrop-blur-sm",children:(0,i.jsxs)("div",{className:"w-full max-w-md rounded-2xl border border-white/10 bg-kali-surface-raised p-4 shadow-lg sm:p-5",children:[(0,i.jsxs)("h3",{className:"mb-3 text-lg font-semibold",children:["Host ",Q.host," Findings"]}),(0,i.jsx)("ul",{className:"max-h-60 space-y-2 overflow-auto pr-1",children:Q.vulns.map((e,t)=>(0,i.jsxs)("li",{className:"rounded-lg border border-white/10 bg-kali-surface-muted/90 p-3 shadow-inner",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("span",{className:"font-semibold",children:e.title}),(0,i.jsxs)("div",{className:"flex gap-1 ml-2",children:[(0,i.jsxs)("span",{className:"rounded-full bg-kali-severity-critical px-2 py-0.5 text-xs font-semibold text-white",children:["CVSS ",e.cvss]}),(0,i.jsxs)("span",{className:"rounded-full bg-kali-info px-2 py-0.5 text-xs font-semibold text-kali-inverse",children:["EPSS ",(100*e.epss).toFixed(1),"%"]})]})]}),(0,i.jsx)("div",{className:"mt-1",children:e.remediation.map(e=>(0,i.jsx)("span",{className:"mr-1 mb-1 inline-block rounded-full border border-white/10 bg-kali-surface-raised/70 px-2 py-0.5 text-xs text-white/80",children:e},e))})]},t))}),(0,i.jsx)("button",{type:"button",onClick:()=>z(null),className:"mt-4 inline-flex items-center justify-center rounded-md bg-kali-primary px-3 py-1.5 text-sm font-semibold text-white transition hover:bg-kali-primary/90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",children:"Close"})]})}),E&&(0,i.jsx)("div",{role:"dialog","aria-modal":"true",className:"fixed inset-0 z-50 flex items-center justify-center bg-kali-overlay/80 p-4 backdrop-blur-sm",children:(0,i.jsxs)("div",{className:"w-full max-w-md rounded-2xl border border-white/10 bg-kali-surface-raised p-4 shadow-lg sm:p-5",children:[(0,i.jsx)("h3",{className:"mb-3 text-lg font-semibold",children:"Issue Detail"}),(0,i.jsx)("p",{className:"mb-3 text-sm text-white/90",dangerouslySetInnerHTML:{__html:f(E.description)}}),(0,i.jsxs)("div",{className:"mb-3 flex flex-wrap gap-2 text-sm",children:[void 0!==E.cvss&&(0,i.jsxs)("span",{className:"rounded-full bg-kali-severity-critical px-2 py-0.5 text-xs font-semibold text-white",children:["CVSS ",E.cvss]}),void 0!==E.epss&&(0,i.jsxs)("span",{className:"rounded-full bg-kali-info px-2 py-0.5 text-xs font-semibold text-kali-inverse",children:["EPSS ",(100*E.epss).toFixed(1),"%"]})]}),E.remediation&&(0,i.jsxs)("p",{className:"mb-4 text-sm text-white/80",children:[(0,i.jsx)("span",{className:"font-bold",children:"Remediation:"})," ",E.remediation]}),(0,i.jsx)("button",{type:"button",onClick:()=>T(null),className:"inline-flex items-center justify-center rounded-md bg-kali-primary px-3 py-1.5 text-sm font-semibold text-white transition hover:bg-kali-primary/90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",children:"Close"})]})}),(0,i.jsx)("div",{"aria-live":"polite",className:"sr-only",children:F}),S&&(0,i.jsx)("div",{className:"overflow-auto rounded-lg border border-white/10 bg-kali-surface-muted text-xs font-mono text-white",children:S.split("\n").map((e,t)=>(0,i.jsx)("div",{className:"px-2 py-1 ".concat(t%2?"bg-kali-surface":"bg-kali-surface-muted/80"),children:e||"\xa0"},t))}),I&&(0,i.jsx)("a",{href:I,download:"openvas-summary.md","aria-label":"Download summary",className:"mt-2 inline-flex h-10 w-10 items-center justify-center rounded-full border border-white/10 bg-kali-primary text-white transition hover:bg-kali-primary/90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",children:(0,i.jsx)("img",{src:"/themes/Yaru/status/download.svg",alt:"",className:"w-4 h-4"})}),(0,i.jsxs)("footer",{className:"mt-4 text-xs text-white/60",children:[(0,i.jsx)("a",{href:"https://www.openvas.org",target:"_blank",rel:"noopener noreferrer",className:"text-kali-info underline hover:text-kali-info/80",children:"Official OpenVAS documentation"}),". Use responsibly and only on systems you own or have permission to test. All data shown here is canned for demonstration."]})]})},S=N,C=()=>(0,i.jsx)(N,{})}}]);