"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5335],{13526:(e,t,r)=>{r.d(t,{colorDefinitions:()=>s});let s=[{name:"Red",className:"text-red-500"},{name:"Blue",className:"text-blue-500"},{name:"Green",className:"text-green-500"},{name:"Yellow",className:"text-yellow-500"}]},52425:(e,t,r)=>{r.d(t,{default:()=>o});var s=r(37876);r(14232);var a=r(95220);let l=[{label:"TCP",expression:"tcp",docUrl:"https://www.wireshark.org/docs/dfref/t/tcp.html"},{label:"UDP",expression:"udp",docUrl:"https://www.wireshark.org/docs/dfref/u/udp.html"},{label:"ICMP",expression:"icmp",docUrl:"https://www.wireshark.org/docs/dfref/i/icmp.html"},{label:"HTTP",expression:"http",docUrl:"https://www.wireshark.org/docs/dfref/h/http.html"},{label:"HTTP traffic",expression:"tcp.port == 80",docUrl:"https://www.wireshark.org/docs/dfref/t/tcp.html"},{label:"HTTPS traffic",expression:"tcp.port == 443",docUrl:"https://www.wireshark.org/docs/dfref/t/tcp.html"},{label:"DNS queries",expression:"udp.port == 53",docUrl:"https://www.wireshark.org/docs/dfref/u/udp.html"},{label:"Host 10.0.0.1",expression:"ip.addr == 10.0.0.1",docUrl:"https://www.wireshark.org/docs/dfref/i/ip.html"}],o=e=>{let{value:t,onChange:r}=e,[o,n]=(0,a.default)("wireshark:recent-filters",[]),[i,c]=(0,a.default)("wireshark:custom-presets",[]),p=[...i,...l],d=Array.from(new Set([...o,...p.map(e=>e.expression)]));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("select",{onChange:e=>{let t=e.target.value;t&&(r(t),n(e=>[t,...e.filter(e=>e!==t)].slice(0,5)))},defaultValue:"","aria-label":"Preset filters",className:"px-2 py-1 bg-gray-800 rounded text-white",children:[(0,s.jsx)("option",{value:"",children:"Preset filters..."}),p.map(e=>{let{label:t,expression:r}=e;return(0,s.jsx)("option",{value:r,children:t},t)})]}),(0,s.jsx)("input",{list:"display-filter-suggestions",value:t,onChange:e=>{r(e.target.value)},onBlur:e=>{let t=e.target.value.trim();t&&n(e=>[t,...e.filter(e=>e!==t)].slice(0,5))},onKeyDown:e=>{if("Enter"===e.key){let t=e.currentTarget.value.trim();t&&n(e=>[t,...e.filter(e=>e!==t)].slice(0,5))}},placeholder:"Quick search (e.g. tcp)","aria-label":"Quick search",className:"px-2 py-1 bg-gray-800 rounded text-white"}),(0,s.jsx)("button",{onClick:()=>{let e=t.trim();if(!e)return;let r=prompt("Preset name");r&&c(t=>[...t.filter(e=>e.label!==r),{label:r,expression:e,docUrl:""}])},"aria-label":"Save filter preset",className:"px-2 py-1 bg-gray-700 rounded text-white",type:"button",children:"Save"}),(0,s.jsx)("button",{onClick:()=>{var e;let r=new URL(window.location.href);t?r.searchParams.set("filter",t):r.searchParams.delete("filter"),null==(e=navigator.clipboard)||e.writeText(r.toString())},"aria-label":"Share filter preset",className:"px-2 py-1 bg-gray-700 rounded text-white",type:"button",children:"Share"}),(0,s.jsx)("datalist",{id:"display-filter-suggestions",children:d.map(e=>(0,s.jsx)("option",{value:e},e))})]})}},55088:(e,t,r)=>{r.d(t,{getRowColor:()=>p,matchesDisplayFilter:()=>c,protocolName:()=>a});var s=r(13526);let a=e=>{switch(e){case 6:return"TCP";case 17:return"UDP";case 1:return"ICMP";default:return e}},l=s.colorDefinitions.reduce((e,t)=>(e[t.name.toLowerCase()]=t.className,e),{}),o=new Map,n=new WeakMap,i=e=>{let t,r=e.trim().toLowerCase();if(o.has(r))return o.get(r);if("tcp"===r)t=e=>6===e.protocol;else if("udp"===r)t=e=>17===e.protocol;else if("icmp"===r)t=e=>1===e.protocol;else{let e=r.match(/^ip\.addr\s*==\s*(\d+\.\d+\.\d+\.\d+)$/);if(e){let r=e[1];t=e=>e.src===r||e.dest===r}else if(e=r.match(/^tcp\.port\s*==\s*(\d+)$/)){let r=parseInt(e[1],10);t=e=>6===e.protocol&&(e.sport===r||e.dport===r)}else if(e=r.match(/^udp\.port\s*==\s*(\d+)$/)){let r=parseInt(e[1],10);t=e=>17===e.protocol&&(e.sport===r||e.dport===r)}else t=e=>e.src.toLowerCase().includes(r)||e.dest.toLowerCase().includes(r)||a(e.protocol).toLowerCase().includes(r)||(e.info||"").toLowerCase().includes(r)||(e.plaintext||e.decrypted||"").toLowerCase().includes(r)}return o.set(r,t),t},c=(e,t)=>!t||("function"==typeof t?t:i(t))(e),p=(e,t)=>{let r=t.find(t=>{let r=n.get(t);if(!r||r.expr!==t.expression){let r={expr:t.expression,fn:i(t.expression)};return n.set(t,r),r.fn(e)}return r.fn(e)});return r&&(l[r.color?r.color.toLowerCase():""]||r.color)||""}},65335:(e,t,r)=>{r.r(t),r.d(t,{default:()=>h});var s=r(37876),a=r(14232),l=r(55088),o=r(52425);let n=JSON.parse('[{"label":"HTTP(S)","expression":"tcp.port == 80 || tcp.port == 443"},{"label":"DNS","expression":"udp.port == 53"},{"label":"SSH","expression":"tcp.port == 22"},{"label":"TLS","expression":"tls"}]'),i=e=>{let{name:t,fields:r}=e,[l,o]=(0,a.useState)(!0);return(0,s.jsxs)("div",{className:"text-xs",children:[(0,s.jsxs)("button",{onClick:()=>o(!l),className:"flex items-center cursor-pointer select-none",type:"button",children:[(0,s.jsx)("svg",{className:"w-4 h-4 mr-1 transition-transform ".concat(l?"rotate-90":""),viewBox:"0 0 16 16","aria-hidden":"true",children:(0,s.jsx)("path",{d:"M5 3l6 5-6 5z",fill:"currentColor"})}),t]}),l&&(0,s.jsx)("ul",{className:"pl-5 mt-1 space-y-0.5",children:Object.entries(r).map(e=>{let[t,r]=e;return(0,s.jsxs)("li",{className:"whitespace-pre-wrap",children:[t,": ",r]},t)})})]})},c={TCP:"bg-blue-900",UDP:"bg-green-900",ICMP:"bg-yellow-800"},p=[{label:"HTTP",path:"/samples/wireshark/http.pcap"},{label:"DNS",path:"/samples/wireshark/dns.pcap"}],d=e=>{if(e.length<34||2048!=(e[12]<<8|e[13]))return{src:"",dest:"",protocol:0,info:""};let t=e[23],r=Array.from(e.slice(26,30)).join("."),s=Array.from(e.slice(30,34)).join("."),a="";if(6===t&&e.length>=54){let l=e[34]<<8|e[35],o=e[36]<<8|e[37];return{src:r,dest:s,protocol:t,info:a="TCP ".concat(l," → ").concat(o),sport:l,dport:o}}if(17===t&&e.length>=42){let l=e[34]<<8|e[35],o=e[36]<<8|e[37];return{src:r,dest:s,protocol:t,info:a="UDP ".concat(l," → ").concat(o),sport:l,dport:o}}return{src:r,dest:s,protocol:t,info:a}},u=async e=>{try{await WebAssembly.instantiateStreaming(fetch("https://unpkg.com/pcap.js@latest/pcap.wasm"),{})}catch(e){}return 0xa0d0d0a===new DataView(e).getUint32(0,!1)?(e=>{let t=new DataView(e),r=0,s=!0,a=[],l=[];for(;r+8<=t.byteLength;){let i=t.getUint32(r,s),c=t.getUint32(r+4,s);if(0xa0d0d0a===i){let e=t.getUint32(r+8,!0);0x1a2b3c4d===e?s=!0:0x4d3c2b1a===e&&(s=!1),c=t.getUint32(r+4,s)}else if(1===i){let e=1e-6,l=r+20;for(;l+4<=r+c-4;){let r=t.getUint16(l,s),a=t.getUint16(l+2,s);if(l+=4,9===r&&1===a){let r=t.getUint8(l);e=128&r?2**-(127&r):10**-r}if(l+=a,l=l+3&-4,0===r)break}a.push({tsres:e})}else if(6===i){var o,n;let i=t.getUint32(r+8,s),c=t.getUint32(r+12,s),p=t.getUint32(r+16,s),u=t.getUint32(r+20,s),f=r+28,h=new Uint8Array(e.slice(f,f+u)),x=d(h),m=((0x100000000*c+p)*(null!=(n=null==(o=a[i])?void 0:o.tsres)?n:1e-6)).toFixed(6);l.push({timestamp:m,src:x.src,dest:x.dest,protocol:x.protocol,info:x.info||"len=".concat(u),sport:x.sport,dport:x.dport,data:h})}r+=c}return l})(e):(e=>{let t,r=new DataView(e),s=r.getUint32(0,!1);if(0xa1b2c3d4===s)t=!1;else if(0xd4c3b2a1===s)t=!0;else throw Error("Unsupported pcap format");let a=24,l=[];for(;a+16<=r.byteLength;){let s=r.getUint32(a,t),o=r.getUint32(a+4,t),n=r.getUint32(a+8,t),i=r.getUint32(a+12,t);if((a+=16)+n>r.byteLength)break;let c=new Uint8Array(e.slice(a,a+n)),p=d(c);l.push({timestamp:"".concat(s,".").concat(o.toString().padStart(6,"0")),src:p.src,dest:p.dest,protocol:p.protocol,info:p.info||"len=".concat(i),sport:p.sport,dport:p.dport,data:c}),a+=n}return l})(e)},f=e=>{let{showLegend:t=!0}=e,[r,d]=(0,a.useState)([]),[f,h]=(0,a.useState)(""),[x,m]=(0,a.useState)(null),[w,g]=(0,a.useState)(["Time","Source","Destination","Protocol","Info"]),[b,y]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=e=>{e.ctrlKey&&e.shiftKey&&"c"===e.key.toLowerCase()&&navigator.clipboard.writeText(f)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[f]),(0,a.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("filter");e&&h(e)},[]),(0,a.useEffect)(()=>{let e=new URL(window.location.href);f?e.searchParams.set("filter",f):e.searchParams.delete("filter"),window.history.replaceState(null,"",e.toString())},[f]);let j=async e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];if(!r)return;let s=await r.arrayBuffer();d(await u(s)),m(null)},v=async e=>{let t=await fetch(e),r=await t.arrayBuffer();d(await u(r)),m(null)},S=r.filter(e=>{if(!f)return!0;let t=f.toLowerCase();return e.src.toLowerCase().includes(t)||e.dest.toLowerCase().includes(t)||(0,l.protocolName)(e.protocol).toLowerCase().includes(t)||(e.info||"").toLowerCase().includes(t)});return(0,s.jsxs)("div",{className:"p-4 text-white bg-ub-cool-grey h-full w-full flex flex-col space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"file",accept:".pcap,.pcapng",onChange:j,className:"text-sm"}),(0,s.jsxs)("select",{onChange:e=>{e.target.value&&v(e.target.value),e.target.value=""},className:"text-sm bg-gray-700 text-white rounded",children:[(0,s.jsx)("option",{value:"",children:"Open sample"}),p.map(e=>{let{label:t,path:r}=e;return(0,s.jsx)("option",{value:r,children:t},r)})]}),(0,s.jsx)("a",{href:"https://wiki.wireshark.org/SampleCaptures",target:"_blank",rel:"noreferrer",className:"text-xs underline",children:"Sample sources"})]}),r.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(o.default,{value:f,onChange:h}),(0,s.jsx)("button",{onClick:()=>navigator.clipboard.writeText(f),className:"px-2 py-1 bg-gray-700 rounded text-xs",type:"button",title:"Copy display filter (Ctrl+Shift+C)",children:"Copy"})]}),(0,s.jsx)("div",{className:"flex space-x-1",children:n.map(e=>{let{label:t,expression:r}=e;return(0,s.jsx)("button",{onClick:()=>h(r),className:"w-4 h-4 rounded ".concat(c[t.toUpperCase()]||"bg-gray-500"),title:t,type:"button"},r)})}),t&&(0,s.jsx)("div",{className:"flex space-x-4 text-xs",children:Object.entries(c).map(e=>{let[t,r]=e;return(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)("span",{className:"w-3 h-3 inline-block ".concat(r)}),(0,s.jsx)("span",{children:t})]},t)})}),(0,s.jsxs)("div",{className:"flex flex-1 overflow-hidden space-x-2",children:[(0,s.jsx)("div",{className:"overflow-auto flex-1",children:(0,s.jsxs)("table",{className:"text-xs w-full font-mono",children:[(0,s.jsx)("thead",{children:(0,s.jsx)("tr",{className:"bg-gray-800",children:w.map(e=>(0,s.jsx)("th",{draggable:!0,onDragStart:()=>y(e),onDragOver:e=>e.preventDefault(),onDrop:()=>{if(!b||b===e)return;let t=[...w],r=t.indexOf(b),s=t.indexOf(e);t.splice(r,1),t.splice(s,0,b),g(t)},className:"px-1 text-left cursor-move",children:e},e))})}),(0,s.jsx)("tbody",{children:S.map((e,t)=>(0,s.jsx)("tr",{className:"cursor-pointer hover:bg-gray-700 ".concat(x===t?"outline outline-2 outline-white":c[(0,l.protocolName)(e.protocol).toString()]||""),onClick:()=>m(t),children:w.map(t=>{let r="";switch(t){case"Time":r=e.timestamp;break;case"Source":r=e.src;break;case"Destination":r=e.dest;break;case"Protocol":r=(0,l.protocolName)(e.protocol);break;case"Info":r=e.info}return(0,s.jsx)("td",{className:"px-1 whitespace-nowrap",children:r},t)})},t))})]})}),(0,s.jsx)("div",{className:"flex-1 bg-black overflow-auto p-2 text-xs font-mono space-y-1",children:null!==x?(0,s.jsxs)(s.Fragment,{children:[(e=>{let t=e.data,r=[];if(t.length>=14){let e=Array.from(t.slice(0,6)).map(e=>e.toString(16).padStart(2,"0")).join(":"),s=Array.from(t.slice(6,12)).map(e=>e.toString(16).padStart(2,"0")).join(":"),a=(t[12]<<8|t[13]).toString(16).padStart(4,"0");r.push({name:"Ethernet",fields:{Destination:e,Source:s,Type:"0x".concat(a)}})}if(t.length>=34){let e=Array.from(t.slice(26,30)).join("."),s=Array.from(t.slice(30,34)).join("."),a=t[23];if(r.push({name:"IPv4",fields:{Source:e,Destination:s,Protocol:(0,l.protocolName)(a)}}),6===a&&t.length>=54){let e=t[34]<<8|t[35],s=t[36]<<8|t[37];r.push({name:"TCP",fields:{"Source Port":e.toString(),"Destination Port":s.toString()}})}else if(17===a&&t.length>=42){let e=t[34]<<8|t[35],s=t[36]<<8|t[37];r.push({name:"UDP",fields:{"Source Port":e.toString(),"Destination Port":s.toString()}})}}return r})(S[x]).map((e,t)=>(0,s.jsx)(i,{name:e.name,fields:e.fields},t)),(0,s.jsx)("pre",{className:"text-green-400",children:Array.from(S[x].data,(e,t)=>"".concat(e.toString(16).padStart(2,"0")).concat((t+1)%16==0?"\n":" ")).join("")})]}):"Select a packet"})]})]})]})},h=()=>{let[e,t]=(0,a.useState)(!0);return(0,s.jsxs)("div",{className:"h-full w-full flex flex-col",children:[(0,s.jsxs)("button",{onClick:()=>t(e=>!e),className:"ml-4 mt-2 mb-2 w-max rounded border border-slate-600 bg-slate-800 px-3 py-1 text-xs font-medium text-slate-200 hover:bg-slate-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50","aria-pressed":e,"aria-label":"Toggle protocol color legend",children:[e?"Hide":"Show"," Legend"]}),(0,s.jsx)(f,{showLegend:e})]})}}}]);