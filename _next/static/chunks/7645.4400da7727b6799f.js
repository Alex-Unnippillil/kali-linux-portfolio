"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7645],{45176:(e,t,r)=>{r.d(t,{default:()=>o,useTab:()=>a});var l=r(37876),i=r(14232);let s=(0,i.createContext)({id:"",active:!1,close:()=>{}}),a=()=>(0,i.useContext)(s),o=e=>{var t;let{initialTabs:r,onNewTab:a,onTabsChange:o,className:n=""}=e,[c,d]=(0,i.useState)(r),[u,m]=(0,i.useState)((null==(t=r[0])?void 0:t.id)||""),p=(0,i.useRef)(""),x=(0,i.useRef)(null),b=(0,i.useRef)(null),h=(0,i.useRef)(new Map),[v,f]=(0,i.useState)(!1),[g,k]=(0,i.useState)(!1),[y,j]=(0,i.useState)([]),[w,N]=(0,i.useState)(!1),C=(0,i.useRef)(null),_=(0,i.useRef)(null);(0,i.useEffect)(()=>{if(p.current!==u){let e=c.find(e=>e.id===p.current),t=c.find(e=>e.id===u);e&&e.onDeactivate&&e.onDeactivate(),t&&t.onActivate&&t.onActivate(),p.current=u}},[u,c]);let A=(0,i.useCallback)(e=>{d(t=>{let r=e(t);return null==o||o(r),r})},[o]),S=(0,i.useCallback)(function(e){let{force:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=h.current.get(e);if(r){if(!t){let e=b.current;if(!e||!e.contains(document.activeElement))return}r.focus({preventScroll:!0})}},[]),F=(0,i.useCallback)(e=>{m(e)},[]),H=(0,i.useCallback)(e=>{A(t=>{let r=t.findIndex(t=>t.id===e),l=t[r],i=t.filter(t=>t.id!==e);if(l&&l.onClose&&l.onClose(),e===u&&i.length>0){let e=i[r]||i[r-1];m(e.id),requestAnimationFrame(()=>S(e.id,{force:!0}))}else if(0===i.length&&a){let e=a();i.push(e),m(e.id)}return i})},[u,S,a,A]),E=(0,i.useCallback)(()=>{if(!a)return;let e=a();A(t=>[...t,e]),m(e.id)},[a,A]),T=(0,i.useCallback)(()=>{let e=b.current;if(!e)return;let t=e.scrollLeft,r=t+e.clientWidth;f(t>0),k(r<e.scrollWidth-1);let l=[];c.forEach(e=>{let i=h.current.get(e.id);if(!i)return;let s=i.offsetLeft,a=s+i.offsetWidth;(s<t||a>r)&&l.push(e.id)}),j(l)},[c]);(0,i.useEffect)(()=>{let e=b.current;if(!e)return;let t=()=>T();T(),e.addEventListener("scroll",t);let r="undefined"!=typeof ResizeObserver?new ResizeObserver(()=>T()):null;return null==r||r.observe(e),window.addEventListener("resize",t),()=>{e.removeEventListener("scroll",t),null==r||r.disconnect(),window.removeEventListener("resize",t)}},[T]),(0,i.useEffect)(()=>{let e=requestAnimationFrame(()=>T());return()=>cancelAnimationFrame(e)},[u,c,T]),(0,i.useEffect)(()=>{let e=b.current,t=h.current.get(u);if(!e||!t)return;let r=t.offsetLeft,l=r+t.offsetWidth,i=e.scrollLeft,s=i+e.clientWidth;r<i?e.scrollTo({left:r,behavior:"smooth"}):l>s&&e.scrollTo({left:l-e.clientWidth,behavior:"smooth"})},[u]),(0,i.useEffect)(()=>{if(!w)return;let e=e=>{var t,r;let l=e.target;(null==(t=C.current)||!t.contains(l))&&(null!=(r=_.current)&&r.contains(l)||N(!1))},t=e=>{"Escape"===e.key&&N(!1)};return document.addEventListener("mousedown",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t)}},[w]),(0,i.useEffect)(()=>{S(u)},[u,S]);let L=(0,i.useMemo)(()=>{if(0===y.length)return[];let e=new Set(y);return c.filter(t=>e.has(t.id))},[y,c]);(0,i.useEffect)(()=>{0===L.length&&w&&N(!1)},[w,L.length]);let R=(0,i.useCallback)(e=>{let t=b.current;if(!t)return;let r=.6*t.clientWidth;t.scrollBy({left:"left"===e?-r:r,behavior:"smooth"})},[]),I=(0,i.useCallback)(e=>{N(!1),F(e),requestAnimationFrame(()=>S(e,{force:!0}))},[S,F]);return(0,l.jsxs)("div",{className:"flex h-full w-full flex-col ".concat(n).trim(),tabIndex:0,onKeyDown:e=>{if(e.ctrlKey&&"w"===e.key.toLowerCase()){e.preventDefault(),H(u);return}if(e.ctrlKey&&"t"===e.key.toLowerCase()){e.preventDefault(),E();return}if(e.ctrlKey&&"Tab"===e.key){e.preventDefault(),d(t=>{if(0===t.length)return t;let r=t.findIndex(e=>e.id===u),l=e.shiftKey?(r-1+t.length)%t.length:(r+1)%t.length,i=t[l];return m(i.id),requestAnimationFrame(()=>S(i.id)),t});return}("ArrowLeft"===e.key||"ArrowRight"===e.key)&&(e.preventDefault(),d(t=>{if(0===t.length)return t;let r=t.findIndex(e=>e.id===u),l="ArrowLeft"===e.key?(r-1+t.length)%t.length:(r+1)%t.length,i=t[l];return m(i.id),requestAnimationFrame(()=>S(i.id)),t}))},children:[(0,l.jsxs)("div",{className:"flex flex-shrink-0 items-center gap-1 border-b border-[color:var(--kali-border)] bg-[color:var(--kali-panel)] px-1 text-sm text-[color:var(--color-text)]",children:[v&&(0,l.jsx)("button",{type:"button",className:"h-full rounded px-2 py-1 transition-colors hover:bg-[var(--kali-panel-highlight)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-ub-orange",onClick:()=>R("left"),"aria-label":"Scroll tabs left",children:"‹"}),(0,l.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,l.jsx)("div",{ref:b,role:"tablist","aria-orientation":"horizontal",className:"flex overflow-x-auto scroll-smooth scrollbar-thin",children:c.map((e,t)=>(0,l.jsxs)("div",{role:"tab","aria-selected":e.id===u,tabIndex:e.id===u?0:-1,ref:t=>{t?h.current.set(e.id,t):h.current.delete(e.id)},className:"group flex flex-shrink-0 cursor-pointer select-none items-center gap-2 rounded-md border border-transparent px-3 py-1.5 text-[color:color-mix(in_srgb,var(--color-text)_92%,transparent)] transition-colors focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-ub-orange ".concat(e.id===u?"border-[color:color-mix(in_srgb,var(--color-ub-orange)_65%,transparent)] bg-ub-orange bg-gray-700 text-black shadow-inner shadow-[inset_0_1px_0_rgba(255,255,255,0.12)]":"hover:border-[color:var(--kali-border)] hover:bg-[var(--kali-panel-highlight)] hover:text-[color:var(--color-text)]"),draggable:!0,onDragStart:e=>{x.current=t,e.dataTransfer.effectAllowed="move"},onDragOver:e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},onDrop:(e=>t=>{t.preventDefault();let r=x.current;null!==r&&r!==e&&A(t=>{let l=[...t],[i]=l.splice(r,1);return l.splice(e,0,i),l})})(t),onClick:()=>F(e.id),onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),F(e.id))},children:[(0,l.jsx)("span",{className:"max-w-[150px] whitespace-nowrap",children:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;if(e.length<=t)return e;let r=Math.floor((t-1)/2);return"".concat(e.slice(0,r),"…").concat(e.slice(e.length-r))}(e.title)}),!1!==e.closable&&c.length>1&&(0,l.jsx)("button",{className:"rounded-sm p-1 text-xs text-[color:color-mix(in_srgb,var(--color-text)_78%,transparent)] transition-colors hover:bg-[var(--kali-panel-highlight)] hover:text-[color:var(--color-text)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-ub-orange",onClick:t=>{t.stopPropagation(),H(e.id)},"aria-label":"Close Tab",children:"\xd7"})]},e.id))})}),g&&(0,l.jsx)("button",{type:"button",className:"h-full rounded px-2 py-1 transition-colors hover:bg-[var(--kali-panel-highlight)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-ub-orange",onClick:()=>R("right"),"aria-label":"Scroll tabs right",children:"›"}),L.length>0&&(0,l.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,l.jsx)("button",{type:"button",ref:C,className:"rounded px-2 py-1 transition-colors hover:bg-[var(--kali-panel-highlight)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-ub-orange",onClick:()=>N(e=>!e),"aria-haspopup":"menu","aria-expanded":w,children:"More ▾"}),w&&(0,l.jsx)("div",{ref:_,role:"menu",className:"absolute right-0 z-10 mt-1 w-48 rounded border border-[color:var(--kali-border)] bg-[color:var(--kali-panel)] py-1 text-[color:var(--color-text)] shadow-lg",children:L.map(e=>(0,l.jsxs)("button",{type:"button",role:"menuitem",className:"flex w-full items-center justify-between px-3 py-1 text-left text-[color:color-mix(in_srgb,var(--color-text)_92%,transparent)] transition-colors hover:bg-[var(--kali-panel-highlight)] hover:text-[color:var(--color-text)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-ub-orange",onClick:()=>I(e.id),children:[(0,l.jsx)("span",{className:"truncate",children:e.title}),e.id===u&&(0,l.jsx)("span",{className:"ml-2 text-xs text-ub-orange",children:"Active"})]},e.id))})]}),a&&(0,l.jsx)("button",{className:"rounded px-2 py-1 transition-colors hover:bg-[var(--kali-panel-highlight)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-ub-orange",onClick:E,"aria-label":"New Tab",children:"+"})]}),(0,l.jsx)("div",{className:"flex-grow relative overflow-hidden",children:c.map(e=>(0,l.jsx)(s.Provider,{value:{id:e.id,active:e.id===u,close:()=>H(e.id)},children:(0,l.jsx)("div",{className:"absolute inset-0 w-full h-full ".concat(e.id===u?"block":"hidden"),children:e.content})},e.id))})]})}},47645:(e,t,r)=>{r.r(t),r.d(t,{SSHBuilder:()=>w,default:()=>N});var l=r(37876),i=r(14232),s=r(45176);let a={user:"",host:"",port:"",identityFile:"",useCompression:!1,enableAgentForwarding:!1,allocateTTY:!1,jumpHost:"",strictHostKeyChecking:"",logLevel:"",serverAliveInterval:"",serverAliveCountMax:"",userKnownHostsFile:"",extraOptions:""},o=[{id:"custom",label:"Start from scratch",description:"Reset every field to defaults and build a fresh SSH command.",config:{...a}},{id:"lab-gateway",label:"Home Lab Gateway",description:"Jump into the home lab bastion with agent forwarding for pivots.",config:{user:"kali",host:"10.13.37.2",port:"22",identityFile:"~/.ssh/lab_ed25519",useCompression:!1,enableAgentForwarding:!0,allocateTTY:!0,jumpHost:"bastion.lab.internal",strictHostKeyChecking:"accept-new",logLevel:"INFO",serverAliveInterval:"45",serverAliveCountMax:"3",userKnownHostsFile:"~/.ssh/known_hosts",extraOptions:"-o ForwardAgent=yes"}},{id:"bug-bounty",label:"Bug Bounty Jump Box",description:"Preset for a hardened jump box with verbose logging and compression.",config:{user:"pentest",host:"bounty.box",port:"2222",identityFile:"~/.ssh/bug-bounty",useCompression:!0,enableAgentForwarding:!1,allocateTTY:!1,jumpHost:"",strictHostKeyChecking:"accept-new",logLevel:"VERBOSE",serverAliveInterval:"60",serverAliveCountMax:"2",userKnownHostsFile:"~/.ssh/known_hosts",extraOptions:"-o LogLevel=VERBOSE -o StrictHostKeyChecking=accept-new"}},{id:"ctf",label:"CTF Target Host",description:"Quick connect to a capture-the-flag VM with password auth.",config:{user:"ctf",host:"172.16.5.10",port:"22",identityFile:"",useCompression:!1,enableAgentForwarding:!1,allocateTTY:!0,jumpHost:"",strictHostKeyChecking:"ask",logLevel:"",serverAliveInterval:"",serverAliveCountMax:"",userKnownHostsFile:"",extraOptions:"-o PreferredAuthentications=password"}},{id:"cloud",label:"Cloud Sandbox",description:"Connect to a cloud sandbox VM with compression enabled.",config:{user:"devops",host:"sandbox.cloud.internal",port:"2201",identityFile:"~/.ssh/sandbox_rsa",useCompression:!0,enableAgentForwarding:!1,allocateTTY:!1,jumpHost:"jump.cloud.internal:22",strictHostKeyChecking:"yes",logLevel:"INFO",serverAliveInterval:"60",serverAliveCountMax:"3",userKnownHostsFile:"~/.ssh/known_hosts",extraOptions:"-o ServerAliveInterval=60"}}],n={min:1,max:65535},c=/[\u0000-\u001F\u007F]/,d=e=>e.replace(/\s+/g," ").trim(),u=e=>d(e.replace(/[\u0000-\u001F\u007F]/g,"")),m=e=>c.test(e),p=e=>Number.isInteger(Number(e))&&Number(e)>0,x=(e,t)=>{e.push(t)},b=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[];x(r,{id:"ssh",label:"SSH client",segment:"ssh",description:"Invoke the OpenSSH client.",kind:"command"});let l=u(e.port),i=u(e.identityFile),s=u(e.jumpHost),a=(e=>{let t=d(e.replace(/[\u0000-\u001F\u007F]/g," "));if(!t)return"";let r=t.replace(/^ssh\s+/i,"").trim();return"ssh"===r.toLowerCase()?"":r})(e.extraOptions),o=u(e.user),n=u(e.host);l&&x(r,{id:"port",label:"Port",segment:"-p ".concat(l),description:"Target SSH port.",kind:"option"}),i&&x(r,{id:"identity",label:"Identity file",segment:"-i ".concat(i),description:"Use a specific private key for authentication.",kind:"option"}),e.useCompression&&x(r,{id:"compression",label:"Compression",segment:"-C",description:"Enable compression to optimize bandwidth.",kind:"option"}),e.enableAgentForwarding&&x(r,{id:"agent-forwarding",label:"Agent forwarding",segment:"-A",description:"Forward the local SSH agent to the remote host.",kind:"option"}),e.allocateTTY&&x(r,{id:"allocate-tty",label:"Allocate TTY",segment:"-t",description:"Force pseudo-terminal allocation.",kind:"option"}),s&&x(r,{id:"jump-host",label:"Jump host",segment:"-J ".concat(s),description:"Route traffic through a bastion or jump box.",kind:"option"}),e.strictHostKeyChecking&&x(r,{id:"strict-host-key",label:"Host key policy",segment:"-o StrictHostKeyChecking=".concat(e.strictHostKeyChecking),description:"Control how new host keys are accepted.",kind:"option"}),e.logLevel&&x(r,{id:"log-level",label:"Log level",segment:"-o LogLevel=".concat(e.logLevel),description:"Tune SSH client verbosity for auditing.",kind:"option"}),e.serverAliveInterval&&x(r,{id:"server-alive-interval",label:"ServerAliveInterval",segment:"-o ServerAliveInterval=".concat(e.serverAliveInterval),description:"Send keepalives every N seconds.",kind:"option"}),e.serverAliveCountMax&&x(r,{id:"server-alive-count",label:"ServerAliveCountMax",segment:"-o ServerAliveCountMax=".concat(e.serverAliveCountMax),description:"Disconnect after missing N keepalives.",kind:"option"}),e.userKnownHostsFile&&x(r,{id:"known-hosts",label:"Known hosts file",segment:"-o UserKnownHostsFile=".concat(u(e.userKnownHostsFile)),description:"Override the known_hosts file location.",kind:"option"}),a&&x(r,{id:"extra-options",label:"Extra options",segment:a,description:"Additional flags supplied manually.",kind:"extra"});let c=n?"".concat(o?"".concat(o,"@"):"").concat(n):"",m=t.includePlaceholder?"<host>":"",p=c||m;return p&&x(r,{id:"destination",label:"Destination",segment:p,description:"Remote target in [user@]host format.",kind:"destination",isPlaceholder:!c}),{segments:r}},h="custom",v=[{value:"",label:"Default (ask)",helper:"Prompt when a host key is new or changed."},{value:"accept-new",label:"Accept new",helper:"Automatically trust new host keys."},{value:"yes",label:"Strict yes",helper:"Reject unknown host keys."},{value:"no",label:"Strict no",helper:"Disable host key checking entirely."},{value:"ask",label:"Ask every time",helper:"Always prompt before writing host keys."}],f=[{value:"",label:"Default"},{value:"QUIET",label:"QUIET"},{value:"FATAL",label:"FATAL"},{value:"ERROR",label:"ERROR"},{value:"INFO",label:"INFO"},{value:"VERBOSE",label:"VERBOSE"},{value:"DEBUG",label:"DEBUG"},{value:"DEBUG1",label:"DEBUG1"},{value:"DEBUG2",label:"DEBUG2"},{value:"DEBUG3",label:"DEBUG3"}],g=e=>{let{command:t,previewCommand:r,isReady:i,copyState:s,onCopy:a,onExportCommand:o,onExportConfig:n}=e,c="copied"===s?"Command copied to clipboard.":"error"===s?"Clipboard unavailable. Try manual copy.":"";return(0,l.jsxs)("section",{className:"rounded-2xl border border-kali-primary/30 bg-[var(--kali-panel)] shadow-lg",children:[(0,l.jsxs)("header",{className:"flex flex-wrap items-center justify-between gap-3 border-b border-kali-primary/20 px-6 py-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"inline-flex items-center rounded-full border border-kali-primary/40 bg-kali-primary/10 px-2 py-0.5 text-[0.6rem] font-semibold uppercase tracking-[0.28em] text-kali-primary",children:"Preview"}),(0,l.jsx)("h2",{className:"mt-2 text-base font-semibold text-kali-primary",children:"Command preview"})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsx)("button",{type:"button",onClick:a,disabled:!i,className:"rounded border border-kali-accent/60 bg-kali-accent/90 px-3 py-1.5 text-xs font-semibold uppercase tracking-wide text-kali-inverse transition hover:bg-kali-accent focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus disabled:cursor-not-allowed disabled:border-kali-accent/20 disabled:bg-kali-accent/20 disabled:opacity-50",children:"Copy command"}),(0,l.jsx)("button",{type:"button",onClick:o,disabled:!i,className:"rounded border border-kali-accent/50 bg-transparent px-3 py-1.5 text-xs font-semibold uppercase tracking-wide text-kali-accent transition hover:bg-kali-accent/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus disabled:cursor-not-allowed disabled:border-kali-accent/15 disabled:text-kali-accent/40 disabled:opacity-60",children:"Export command"}),(0,l.jsx)("button",{type:"button",onClick:n,className:"rounded border border-kali-primary/50 bg-transparent px-3 py-1.5 text-xs font-semibold uppercase tracking-wide text-kali-primary transition hover:bg-kali-primary/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",children:"Export config"})]})]}),(0,l.jsxs)("div",{className:"px-6 pb-6 pt-5",children:[(0,l.jsx)("div",{className:"rounded-lg border border-[color:color-mix(in_srgb,var(--color-terminal)_35%,transparent)] bg-[color:color-mix(in_srgb,var(--kali-terminal)_90%,transparent_10%)] p-4",children:(0,l.jsx)("pre",{className:"max-h-48 overflow-auto text-sm leading-relaxed text-[color:var(--color-terminal)]","aria-live":"polite","aria-label":"SSH command preview",children:i?t:r||"ssh <host>"})}),(0,l.jsx)("div",{className:"mt-3 min-h-[1.5rem] text-xs",role:"status","aria-live":"polite",children:c&&(0,l.jsx)("span",{className:"inline-flex rounded-full border px-3 py-1 font-semibold ".concat("copied"===s?"border-kali-severity-low/45 bg-[color:color-mix(in_srgb,var(--color-severity-low)_16%,transparent)] text-kali-severity-low":"border-kali-severity-high/45 bg-[color:color-mix(in_srgb,var(--color-severity-high)_16%,transparent)] text-kali-severity-high"),children:c})})]})]})},k=e=>{let{segments:t}=e;return(0,l.jsxs)("section",{className:"rounded-2xl border border-kali-primary/30 bg-[var(--kali-panel)] shadow-lg",children:[(0,l.jsxs)("header",{className:"border-b border-kali-primary/20 px-6 py-4",children:[(0,l.jsx)("span",{className:"inline-flex items-center rounded-full border border-kali-primary/40 bg-kali-primary/10 px-2 py-0.5 text-[0.6rem] font-semibold uppercase tracking-[0.28em] text-kali-primary",children:"Breakdown"}),(0,l.jsx)("h2",{className:"mt-2 text-base font-semibold text-kali-primary",children:"Command breakdown"}),(0,l.jsx)("p",{className:"mt-2 text-xs text-kali-text text-opacity-70",children:"Each flag is explained so you can audit the command before using it."})]}),(0,l.jsx)("div",{className:"space-y-3 px-6 pb-6 pt-5",children:t.map(e=>(0,l.jsxs)("article",{className:"rounded-lg border border-kali-primary/20 bg-[color:color-mix(in_srgb,var(--kali-panel)_88%,transparent_12%)] p-4",children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-kali-primary",children:e.label}),e.isPlaceholder&&(0,l.jsx)("span",{className:"rounded-full border border-kali-severity-medium/50 bg-kali-severity-medium/10 px-2 py-0.5 text-[0.6rem] font-semibold uppercase tracking-wide text-kali-severity-medium",children:"Required"})]}),(0,l.jsx)("p",{className:"mt-2 text-xs text-kali-text text-opacity-70",children:e.description}),(0,l.jsx)("div",{className:"mt-3 rounded-md border border-[color:color-mix(in_srgb,var(--color-terminal)_35%,transparent)] bg-[color:color-mix(in_srgb,var(--kali-terminal)_88%,transparent_12%)] px-3 py-2",children:(0,l.jsx)("span",{className:"font-mono text-xs text-[color:var(--color-terminal)]",children:e.segment})})]},e.id))})]})},y=()=>(0,l.jsxs)("section",{className:"rounded-2xl border border-kali-primary/30 bg-[var(--kali-panel)] shadow-lg",children:[(0,l.jsxs)("header",{className:"border-b border-kali-primary/20 px-6 py-4",children:[(0,l.jsx)("span",{className:"inline-flex items-center rounded-full border border-kali-primary/40 bg-kali-primary/10 px-2 py-0.5 text-[0.6rem] font-semibold uppercase tracking-[0.28em] text-kali-primary",children:"Safety"}),(0,l.jsx)("h2",{className:"mt-2 text-base font-semibold text-kali-primary",children:"Safety & notes"})]}),(0,l.jsxs)("div",{className:"space-y-3 px-6 pb-6 pt-5 text-sm text-kali-text text-opacity-80",children:[(0,l.jsx)("p",{children:"Only connect to systems you own or have explicit authorization to access."}),(0,l.jsx)("p",{children:"This builder never initiates connections; it only assembles a command for review."})]})]}),j=e=>{let{steps:t}=e;return(0,l.jsxs)("section",{className:"rounded-2xl border border-kali-primary/30 bg-[var(--kali-panel)] shadow-lg",children:[(0,l.jsxs)("header",{className:"border-b border-kali-primary/20 px-6 py-4",children:[(0,l.jsx)("span",{className:"inline-flex items-center rounded-full border border-kali-primary/40 bg-kali-primary/10 px-2 py-0.5 text-[0.6rem] font-semibold uppercase tracking-[0.28em] text-kali-primary",children:"Timeline"}),(0,l.jsx)("h2",{className:"mt-2 text-base font-semibold text-kali-primary",children:"Compose → Options → Ready"})]}),(0,l.jsx)("ol",{className:"space-y-4 px-6 pb-6 pt-5",children:t.map((e,r)=>(0,l.jsxs)("li",{className:"flex gap-3",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("span",{className:"flex h-6 w-6 items-center justify-center rounded-full border border-kali-primary/40 bg-kali-primary/10 text-[0.65rem] font-semibold text-kali-primary",children:r+1}),r<t.length-1&&(0,l.jsx)("span",{className:"mt-1 h-full w-px bg-kali-primary/30"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-kali-primary",children:e.title}),(0,l.jsx)("p",{className:"mt-1 text-xs text-kali-text text-opacity-70",children:e.detail})]})]},e.id))})]})},w=()=>{var e,t,r;let[s,c]=(0,i.useState)(a),[d,u]=(0,i.useState)(h),[x,w]=(0,i.useState)("idle"),N=(0,i.useMemo)(()=>(e=>{let t={};if(e.host.trim()?m(e.host)&&(t.host="Host cannot include control characters."):t.host="Host is required.",e.user&&m(e.user)&&(t.user="Username cannot include control characters."),e.identityFile&&m(e.identityFile)&&(t.identityFile="Identity file cannot include control characters."),e.jumpHost&&m(e.jumpHost)&&(t.jumpHost="Jump host cannot include control characters."),e.port.trim())if(m(e.port))t.port="Port cannot include control characters.";else{let r=Number(e.port);(!Number.isInteger(r)||r<n.min||r>n.max)&&(t.port="Port must be an integer between ".concat(n.min," and ").concat(n.max,"."))}return e.serverAliveInterval.trim()&&!p(e.serverAliveInterval)&&(t.serverAliveInterval="ServerAliveInterval must be a positive integer."),e.serverAliveCountMax.trim()&&!p(e.serverAliveCountMax)&&(t.serverAliveCountMax="ServerAliveCountMax must be a positive integer."),t})(s),[s]),C=(0,i.useMemo)(()=>0===Object.keys(N).length,[N]),_=(0,i.useMemo)(()=>(e=>{let{segments:t}=b(e);return t.filter(e=>!e.isPlaceholder).map(e=>e.segment).join(" ").trim()})(s),[s]),A=(0,i.useMemo)(()=>b(s,{includePlaceholder:!0}),[s]),S=(0,i.useMemo)(()=>A.segments.map(e=>e.segment).join(" "),[A]),F=(0,i.useMemo)(()=>A.segments.filter(e=>"command"!==e.kind),[A]);(0,i.useEffect)(()=>{if("idle"===x)return;let e=window.setTimeout(()=>w("idle"),2400);return()=>window.clearTimeout(e)},[x]);let H=(0,i.useCallback)(()=>{u(e=>e===h?e:h)},[]),E=(0,i.useCallback)((e,t)=>{H(),c(r=>({...r,[e]:t})),w("idle")},[H]),T=(0,i.useCallback)(e=>{u(e);let t=o.find(t=>t.id===e);t?c({...t.config}):c({...a}),w("idle")},[]),L=(0,i.useCallback)(()=>{c({...a}),u(h),w("idle")},[]),R=async()=>{if(C&&_)try{var e;if("undefined"==typeof navigator||!(null==(e=navigator.clipboard)?void 0:e.writeText))throw Error("Clipboard API unavailable");await navigator.clipboard.writeText(_),w("copied")}catch(e){console.error("Failed to copy command",e),w("error")}},I=(0,i.useMemo)(()=>{let e=s.host.trim()||"<host>",t=s.identityFile.trim()?"Identity file loaded":"Default SSH identity",r=[s.useCompression?"Compression enabled":"No compression",s.enableAgentForwarding?"Agent forwarding on":"Agent forwarding off",s.jumpHost.trim()?"Jump via ".concat(s.jumpHost.trim()):"Direct connection"].join(" \xb7 ");return[{id:"compose",title:"Compose destination",detail:"".concat(s.user.trim()?"".concat(s.user.trim(),"@"):"").concat(e)},{id:"auth",title:"Authentication prep",detail:t},{id:"options",title:"Session options",detail:r},{id:"ready",title:"Ready to launch",detail:"Review the command and run it manually on an authorized system."}]},[s]),D=C&&_.trim().length>0&&"ssh"!==_,K=null!=(r=null==(e=o.find(e=>e.id===d))?void 0:e.description)?r:"";return(0,l.jsxs)("div",{className:"h-full overflow-auto bg-kali-background p-6 text-kali-text",children:[(0,l.jsxs)("header",{className:"mb-6 space-y-3",children:[(0,l.jsx)("span",{className:"inline-flex items-center rounded-full border border-kali-primary/40 bg-kali-primary/10 px-3 py-1 text-[0.65rem] font-semibold uppercase tracking-[0.28em] text-kali-primary",children:"SSH Builder"}),(0,l.jsx)("h1",{className:"text-2xl font-semibold",children:"SSH Command Builder"}),(0,l.jsxs)("p",{className:"text-sm text-kali-text text-opacity-70",children:["Generate an SSH command without executing it. Learn more at"," ",(0,l.jsx)("a",{href:"https://www.openssh.com/",target:"_blank",rel:"noopener noreferrer",className:"text-kali-primary underline decoration-dotted underline-offset-4 hover:opacity-80",children:"the OpenSSH project page"}),"."]})]}),(0,l.jsxs)("div",{className:"grid gap-6 xl:grid-cols-[minmax(0,1.1fr)_minmax(0,0.9fr)]",children:[(0,l.jsxs)("section",{className:"rounded-2xl border border-kali-primary/30 bg-[var(--kali-panel)] shadow-lg",children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3 border-b border-kali-primary/20 px-6 py-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("span",{className:"inline-flex items-center rounded-full border border-kali-primary/40 bg-kali-primary/10 px-2 py-0.5 text-[0.6rem] font-semibold uppercase tracking-[0.28em] text-kali-primary",children:"Builder"}),(0,l.jsx)("h2",{className:"text-sm font-semibold text-kali-primary",children:"Compose simulated SSH sessions"})]}),(0,l.jsx)("button",{type:"button",onClick:L,className:"rounded border border-kali-primary/50 px-3 py-1.5 text-xs font-semibold uppercase tracking-wide text-kali-primary transition hover:bg-kali-primary/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-kali-focus",children:"Reset defaults"})]}),(0,l.jsxs)("form",{onSubmit:e=>e.preventDefault(),className:"space-y-6 px-6 pb-6 pt-5",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"ssh-preset",className:"text-xs font-semibold uppercase tracking-wide text-kali-text text-opacity-80",children:"Preset workflow"}),(0,l.jsx)("select",{id:"ssh-preset",value:d,onChange:e=>T(e.target.value),className:"mt-2 w-full rounded border border-kali-primary/30 bg-[color:color-mix(in_srgb,var(--kali-panel)_82%,transparent_18%)] p-2 text-sm text-kali-text focus:border-kali-accent focus:outline-none focus:ring-1 focus:ring-kali-accent/40",children:o.map(e=>(0,l.jsx)("option",{value:e.id,children:e.label},e.id))}),K&&(0,l.jsx)("p",{className:"mt-2 text-xs text-kali-text text-opacity-60",children:K})]}),(0,l.jsxs)("section",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-kali-primary",children:"Connection target"}),(0,l.jsx)("p",{className:"text-xs text-kali-text text-opacity-60",children:"Define the remote host and optional account used for the session."})]}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{id:"ssh-user-label",htmlFor:"ssh-user",className:"mb-1 block text-sm font-medium",children:"Username"}),(0,l.jsx)("input",{id:"ssh-user",type:"text",className:"w-full rounded border border-kali-primary/30 bg-[color:color-mix(in_srgb,var(--kali-panel)_88%,transparent_12%)] p-2 text-kali-text focus:border-kali-accent focus:outline-none focus:ring-1 focus:ring-kali-accent/40",value:s.user,onChange:e=>E("user",e.target.value),autoComplete:"username","aria-labelledby":"ssh-user-label"}),N.user&&(0,l.jsx)("p",{className:"mt-1 text-xs text-kali-severity-high",children:N.user})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{id:"ssh-host-label",htmlFor:"ssh-host",className:"mb-1 block text-sm font-medium",children:["Host ",(0,l.jsx)("span",{className:"text-kali-severity-high",children:"*"})]}),(0,l.jsx)("input",{id:"ssh-host",type:"text",className:"w-full rounded border border-kali-primary/30 bg-[color:color-mix(in_srgb,var(--kali-panel)_88%,transparent_12%)] p-2 text-kali-text focus:border-kali-accent focus:outline-none focus:ring-1 focus:ring-kali-accent/40",value:s.host,onChange:e=>E("host",e.target.value),placeholder:"server.example.com",required:!0,"aria-invalid":N.host?"true":"false","aria-describedby":N.host?"ssh-host-error":void 0,"aria-labelledby":"ssh-host-label"}),N.host&&(0,l.jsx)("p",{id:"ssh-host-error",className:"mt-1 text-xs text-kali-severity-high",children:N.host})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{id:"ssh-port-label",htmlFor:"ssh-port",className:"mb-1 block text-sm font-medium",children:"Port"}),(0,l.jsx)("input",{id:"ssh-port",type:"number",className:"w-full rounded border border-kali-primary/30 bg-[color:color-mix(in_srgb,var(--kali-panel)_88%,transparent_12%)] p-2 text-kali-text focus:border-kali-accent focus:outline-none focus:ring-1 focus:ring-kali-accent/40",value:s.port,onChange:e=>E("port",e.target.value),min:1,max:65535,placeholder:"22","aria-invalid":N.port?"true":"false","aria-describedby":N.port?"ssh-port-error":void 0,"aria-labelledby":"ssh-port-label"}),N.port&&(0,l.jsx)("p",{id:"ssh-port-error",className:"mt-1 text-xs text-kali-severity-high",children:N.port})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{id:"ssh-identity-label",htmlFor:"ssh-identity",className:"mb-1 block text-sm font-medium",children:"Identity file"}),(0,l.jsx)("input",{id:"ssh-identity",type:"text",className:"w-full rounded border border-kali-primary/30 bg-[color:color-mix(in_srgb,var(--kali-panel)_88%,transparent_12%)] p-2 text-kali-text focus:border-kali-accent focus:outline-none focus:ring-1 focus:ring-kali-accent/40",value:s.identityFile,onChange:e=>E("identityFile",e.target.value),placeholder:"~/.ssh/id_ed25519","aria-labelledby":"ssh-identity-label"}),N.identityFile&&(0,l.jsx)("p",{className:"mt-1 text-xs text-kali-severity-high",children:N.identityFile})]})]})]}),(0,l.jsxs)("section",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-kali-primary",children:"Session behavior"}),(0,l.jsx)("p",{className:"text-xs text-kali-text text-opacity-60",children:"Toggle common SSH switches used during interactive sessions."})]}),(0,l.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,l.jsxs)("label",{className:"flex items-center space-x-2 text-sm",children:[(0,l.jsx)("input",{type:"checkbox",checked:s.useCompression,onChange:e=>E("useCompression",e.target.checked),className:"h-4 w-4 rounded border-kali-primary/40 bg-[color:color-mix(in_srgb,var(--kali-panel)_82%,transparent_18%)] accent-kali-accent","aria-labelledby":"ssh-compression-label"}),(0,l.jsx)("span",{id:"ssh-compression-label",children:"Enable compression (-C)"})]}),(0,l.jsxs)("label",{className:"flex items-center space-x-2 text-sm",children:[(0,l.jsx)("input",{type:"checkbox",checked:s.enableAgentForwarding,onChange:e=>E("enableAgentForwarding",e.target.checked),className:"h-4 w-4 rounded border-kali-primary/40 bg-[color:color-mix(in_srgb,var(--kali-panel)_82%,transparent_18%)] accent-kali-accent","aria-labelledby":"ssh-agent-forward-label"}),(0,l.jsx)("span",{id:"ssh-agent-forward-label",children:"Forward SSH agent (-A)"})]}),(0,l.jsxs)("label",{className:"flex items-center space-x-2 text-sm",children:[(0,l.jsx)("input",{type:"checkbox",checked:s.allocateTTY,onChange:e=>E("allocateTTY",e.target.checked),className:"h-4 w-4 rounded border-kali-primary/40 bg-[color:color-mix(in_srgb,var(--kali-panel)_82%,transparent_18%)] accent-kali-accent","aria-labelledby":"ssh-tty-label"}),(0,l.jsx)("span",{id:"ssh-tty-label",children:"Force TTY allocation (-t)"})]})]})]}),(0,l.jsxs)("section",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-kali-primary",children:"Routing & jump hosts"}),(0,l.jsx)("p",{className:"text-xs text-kali-text text-opacity-60",children:"Add a bastion host to route traffic through before reaching the target."})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{id:"ssh-jump-label",htmlFor:"ssh-jump",className:"mb-1 block text-sm font-medium",children:"Jump host (-J)"}),(0,l.jsx)("input",{id:"ssh-jump",type:"text",className:"w-full rounded border border-kali-primary/30 bg-[color:color-mix(in_srgb,var(--kali-panel)_88%,transparent_12%)] p-2 text-kali-text focus:border-kali-accent focus:outline-none focus:ring-1 focus:ring-kali-accent/40",value:s.jumpHost,onChange:e=>E("jumpHost",e.target.value),placeholder:"bastion.example.com:22","aria-labelledby":"ssh-jump-label"}),N.jumpHost&&(0,l.jsx)("p",{className:"mt-1 text-xs text-kali-severity-high",children:N.jumpHost})]})]}),(0,l.jsxs)("section",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-kali-primary",children:"Hardening options"}),(0,l.jsx)("p",{className:"text-xs text-kali-text text-opacity-60",children:"Map common -o settings to prevent mistakes and keep sessions resilient."})]}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"ssh-host-key",className:"mb-1 block text-sm font-medium",children:"StrictHostKeyChecking"}),(0,l.jsx)("select",{id:"ssh-host-key",value:s.strictHostKeyChecking,onChange:e=>E("strictHostKeyChecking",e.target.value),className:"w-full rounded border border-kali-primary/30 bg-[color:color-mix(in_srgb,var(--kali-panel)_82%,transparent_18%)] p-2 text-sm text-kali-text focus:border-kali-accent focus:outline-none focus:ring-1 focus:ring-kali-accent/40",children:v.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value||"default"))}),(0,l.jsx)("p",{className:"mt-2 text-xs text-kali-text text-opacity-60",children:null==(t=v.find(e=>e.value===s.strictHostKeyChecking))?void 0:t.helper})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"ssh-log-level",className:"mb-1 block text-sm font-medium",children:"LogLevel"}),(0,l.jsx)("select",{id:"ssh-log-level",value:s.logLevel,onChange:e=>E("logLevel",e.target.value),className:"w-full rounded border border-kali-primary/30 bg-[color:color-mix(in_srgb,var(--kali-panel)_82%,transparent_18%)] p-2 text-sm text-kali-text focus:border-kali-accent focus:outline-none focus:ring-1 focus:ring-kali-accent/40",children:f.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value||"default"))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{id:"ssh-alive-interval-label",htmlFor:"ssh-alive-interval",className:"mb-1 block text-sm font-medium",children:"ServerAliveInterval"}),(0,l.jsx)("input",{id:"ssh-alive-interval",type:"number",min:1,placeholder:"60",className:"w-full rounded border border-kali-primary/30 bg-[color:color-mix(in_srgb,var(--kali-panel)_88%,transparent_12%)] p-2 text-kali-text focus:border-kali-accent focus:outline-none focus:ring-1 focus:ring-kali-accent/40",value:s.serverAliveInterval,onChange:e=>E("serverAliveInterval",e.target.value),"aria-labelledby":"ssh-alive-interval-label"}),N.serverAliveInterval&&(0,l.jsx)("p",{className:"mt-1 text-xs text-kali-severity-high",children:N.serverAliveInterval})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{id:"ssh-alive-count-label",htmlFor:"ssh-alive-count",className:"mb-1 block text-sm font-medium",children:"ServerAliveCountMax"}),(0,l.jsx)("input",{id:"ssh-alive-count",type:"number",min:1,placeholder:"3",className:"w-full rounded border border-kali-primary/30 bg-[color:color-mix(in_srgb,var(--kali-panel)_88%,transparent_12%)] p-2 text-kali-text focus:border-kali-accent focus:outline-none focus:ring-1 focus:ring-kali-accent/40",value:s.serverAliveCountMax,onChange:e=>E("serverAliveCountMax",e.target.value),"aria-labelledby":"ssh-alive-count-label"}),N.serverAliveCountMax&&(0,l.jsx)("p",{className:"mt-1 text-xs text-kali-severity-high",children:N.serverAliveCountMax})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{id:"ssh-known-hosts-label",htmlFor:"ssh-known-hosts",className:"mb-1 block text-sm font-medium",children:"UserKnownHostsFile"}),(0,l.jsx)("input",{id:"ssh-known-hosts",type:"text",placeholder:"~/.ssh/known_hosts",className:"w-full rounded border border-kali-primary/30 bg-[color:color-mix(in_srgb,var(--kali-panel)_88%,transparent_12%)] p-2 text-kali-text focus:border-kali-accent focus:outline-none focus:ring-1 focus:ring-kali-accent/40",value:s.userKnownHostsFile,onChange:e=>E("userKnownHostsFile",e.target.value),"aria-labelledby":"ssh-known-hosts-label"})]})]})]}),(0,l.jsxs)("section",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-kali-primary",children:"Extra options"}),(0,l.jsx)("p",{className:"text-xs text-kali-text text-opacity-60",children:"Add any additional flags (one per line). They will remain before the destination host."})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{id:"ssh-extra-label",htmlFor:"ssh-extra",className:"mb-1 block text-sm font-medium",children:"Extra options"}),(0,l.jsx)("textarea",{id:"ssh-extra",className:"min-h-[4rem] w-full rounded border border-kali-primary/30 bg-[color:color-mix(in_srgb,var(--kali-panel)_88%,transparent_12%)] p-2 text-kali-text focus:border-kali-accent focus:outline-none focus:ring-1 focus:ring-kali-accent/40",value:s.extraOptions,onChange:e=>E("extraOptions",e.target.value),placeholder:"-o StrictHostKeyChecking=accept-new","aria-labelledby":"ssh-extra-label"})]})]})]})]}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsx)(g,{command:_,previewCommand:S,isReady:D,copyState:x,onCopy:R,onExportCommand:()=>{if(!C||!_)return;let e=new Blob(["".concat(_,"\n")],{type:"text/plain"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="ssh-command.txt",r.click(),URL.revokeObjectURL(t),w("idle")},onExportConfig:()=>{let e=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="ssh-config.json",r.click(),URL.revokeObjectURL(t),w("idle")}}),(0,l.jsx)(k,{segments:F}),(0,l.jsx)(j,{steps:I}),(0,l.jsx)(y,{})]})]})]})},N=()=>{let e=(0,i.useRef)(1),t=()=>({id:Date.now().toString(),title:"Session ".concat(e.current++),content:(0,l.jsx)(w,{})});return(0,l.jsx)(s.default,{className:"min-h-screen bg-[color:var(--kali-panel)] text-[color:var(--color-text)]",initialTabs:[t()],onNewTab:t})}}}]);