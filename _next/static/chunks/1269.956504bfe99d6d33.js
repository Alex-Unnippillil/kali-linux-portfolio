(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1269],{13526:(e,t,s)=>{"use strict";s.d(t,{colorDefinitions:()=>r});let r=[{name:"Red",className:"text-red-500"},{name:"Blue",className:"text-blue-500"},{name:"Green",className:"text-green-500"},{name:"Yellow",className:"text-yellow-500"}]},37603:(e,t,s)=>{"use strict";var r=s(99742);s(72552);var a=s(14232),l=function(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}(a),n=void 0!==r&&r.env&&!0,i=function(e){return"[object String]"===Object.prototype.toString.call(e)},c=function(){function e(e){var t=void 0===e?{}:e,s=t.name,r=void 0===s?"stylesheet":s,a=t.optimizeForSpeed,l=void 0===a?n:a;o(i(r),"`name` must be a string"),this._name=r,this._deletedRulePlaceholder="#"+r+"-deleted-rule____{}",o("boolean"==typeof l,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=l,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var c=document.querySelector('meta[property="csp-nonce"]');this._nonce=c?c.getAttribute("content"):null}var t,s=e.prototype;return s.setOptimizeForSpeed=function(e){o("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),o(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},s.isOptimizeForSpeed=function(){return this._optimizeForSpeed},s.inject=function(){var e=this;if(o(!this._injected,"sheet already injected"),this._injected=!0,this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(n||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,s){return"number"==typeof s?e._serverSheet.cssRules[s]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),s},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},s.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},s.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},s.insertRule=function(e,t){if(o(i(e),"`insertRule` accepts only strings"),this._optimizeForSpeed){var s=this.getSheet();"number"!=typeof t&&(t=s.cssRules.length);try{s.insertRule(e,t)}catch(t){return n||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var r=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,r))}return this._rulesCount++},s.replaceRule=function(e,t){if(this._optimizeForSpeed){var s=this.getSheet();if(t.trim()||(t=this._deletedRulePlaceholder),!s.cssRules[e])return e;s.deleteRule(e);try{s.insertRule(t,e)}catch(r){n||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),s.insertRule(this._deletedRulePlaceholder,e)}}else{var r=this._tags[e];o(r,"old rule at index `"+e+"` not found"),r.textContent=t}return e},s.deleteRule=function(e){if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];o(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},s.flush=function(){this._injected=!1,this._rulesCount=0,this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]},s.cssRules=function(){var e=this;return this._tags.reduce(function(t,s){return s?t=t.concat(Array.prototype.map.call(e.getSheetForTag(s).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},s.makeStyleTag=function(e,t,s){t&&o(i(t),"makeStyleTag accepts only strings as second parameter");var r=document.createElement("style");this._nonce&&r.setAttribute("nonce",this._nonce),r.type="text/css",r.setAttribute("data-"+e,""),t&&r.appendChild(document.createTextNode(t));var a=document.head||document.getElementsByTagName("head")[0];return s?a.insertBefore(r,s):a.appendChild(r),r},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}();function o(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var d=function(e){for(var t=5381,s=e.length;s;)t=33*t^e.charCodeAt(--s);return t>>>0},u={};function p(e,t){if(!t)return"jsx-"+e;var s=String(t),r=e+s;return u[r]||(u[r]="jsx-"+d(e+"-"+s)),u[r]}function h(e,t){var s=e+t;return u[s]||(u[s]=t.replace(/__jsx-style-dynamic-selector/g,e)),u[s]}var f=function(){function e(e){var t=void 0===e?{}:e,s=t.styleSheet,r=void 0===s?null:s,a=t.optimizeForSpeed,l=void 0!==a&&a;this._sheet=r||new c({name:"styled-jsx",optimizeForSpeed:l}),this._sheet.inject(),r&&"boolean"==typeof l&&(this._sheet.setOptimizeForSpeed(l),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var s=this.getIdAndRules(e),r=s.styleId,a=s.rules;if(r in this._instancesCounts){this._instancesCounts[r]+=1;return}var l=a.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[r]=l,this._instancesCounts[r]=1},t.remove=function(e){var t=this,s=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(s in this._instancesCounts,"styleId: `"+s+"` not found"),this._instancesCounts[s]-=1,this._instancesCounts[s]<1){var r=this._fromServer&&this._fromServer[s];r?(r.parentNode.removeChild(r),delete this._fromServer[s]):(this._indices[s].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[s]),delete this._instancesCounts[s]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],s=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return s[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,s;return t=this.cssRules(),void 0===(s=e)&&(s={}),t.map(function(e){var t=e[0],r=e[1];return l.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:s.nonce?s.nonce:void 0,dangerouslySetInnerHTML:{__html:r}})})},t.getIdAndRules=function(e){var t=e.children,s=e.dynamic,r=e.id;if(s){var a=p(r,s);return{styleId:a,rules:Array.isArray(t)?t.map(function(e){return h(a,e)}):[h(a,t)]}}return{styleId:p(r),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),x=a.createContext(null);x.displayName="StyleSheetContext";var m=l.default.useInsertionEffect||l.default.useLayoutEffect,g=new f;function j(e){var t=g||a.useContext(x);return t&&m(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)]),null}j.dynamic=function(e){return e.map(function(e){return p(e[0],e[1])}).join(" ")},t.style=j},42979:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});var r=s(37876);s(14232);let a=e=>{let{toolName:t,message:s="Deterministic demo output. No live hosts, credentials, or network calls.",className:a=""}=e;return(0,r.jsxs)("div",{className:"mb-3 flex items-start gap-3 rounded-md border border-[color:color-mix(in_srgb,var(--color-accent)_55%,transparent)] bg-[color:color-mix(in_srgb,var(--kali-panel)_88%,var(--kali-overlay)_12%)] px-3 py-2 text-sm text-[color:var(--color-text)] shadow-[0_8px_24px_rgba(0,0,0,0.28)] ".concat(a),role:"status","aria-live":"polite",children:[(0,r.jsx)("span",{"aria-hidden":!0,className:"mt-0.5 inline-flex h-7 w-7 items-center justify-center rounded-full bg-[color:color-mix(in_srgb,var(--color-accent)_30%,transparent)] text-base font-bold text-kali-accent shadow-[0_0_0_1px_color-mix(in_srgb,var(--color-accent)_75%,transparent)]",children:"SIM"}),(0,r.jsxs)("div",{className:"leading-snug",children:[(0,r.jsxs)("p",{className:"font-semibold uppercase tracking-wide text-[color:var(--color-muted)]",children:[t," Simulation"]}),(0,r.jsx)("p",{className:"text-[color:var(--color-text)]",children:s})]})]})}},49096:(e,t,s)=>{"use strict";e.exports=s(37603).style},52425:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var r=s(37876);s(14232);var a=s(95220);let l=[{label:"TCP",expression:"tcp",docUrl:"https://www.wireshark.org/docs/dfref/t/tcp.html"},{label:"UDP",expression:"udp",docUrl:"https://www.wireshark.org/docs/dfref/u/udp.html"},{label:"ICMP",expression:"icmp",docUrl:"https://www.wireshark.org/docs/dfref/i/icmp.html"},{label:"HTTP",expression:"http",docUrl:"https://www.wireshark.org/docs/dfref/h/http.html"},{label:"HTTP traffic",expression:"tcp.port == 80",docUrl:"https://www.wireshark.org/docs/dfref/t/tcp.html"},{label:"HTTPS traffic",expression:"tcp.port == 443",docUrl:"https://www.wireshark.org/docs/dfref/t/tcp.html"},{label:"DNS queries",expression:"udp.port == 53",docUrl:"https://www.wireshark.org/docs/dfref/u/udp.html"},{label:"Host 10.0.0.1",expression:"ip.addr == 10.0.0.1",docUrl:"https://www.wireshark.org/docs/dfref/i/ip.html"}],n=e=>{let{value:t,onChange:s}=e,[n,i]=(0,a.default)("wireshark:recent-filters",[]),[c,o]=(0,a.default)("wireshark:custom-presets",[]),d=[...c,...l],u=Array.from(new Set([...n,...d.map(e=>e.expression)]));return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("select",{onChange:e=>{let t=e.target.value;t&&(s(t),i(e=>[t,...e.filter(e=>e!==t)].slice(0,5)))},defaultValue:"","aria-label":"Preset filters",className:"px-2 py-1 bg-gray-800 rounded text-white",children:[(0,r.jsx)("option",{value:"",children:"Preset filters..."}),d.map(e=>{let{label:t,expression:s}=e;return(0,r.jsx)("option",{value:s,children:t},t)})]}),(0,r.jsx)("input",{list:"display-filter-suggestions",value:t,onChange:e=>{s(e.target.value)},onBlur:e=>{let t=e.target.value.trim();t&&i(e=>[t,...e.filter(e=>e!==t)].slice(0,5))},onKeyDown:e=>{if("Enter"===e.key){let t=e.currentTarget.value.trim();t&&i(e=>[t,...e.filter(e=>e!==t)].slice(0,5))}},placeholder:"Quick search (e.g. tcp)","aria-label":"Quick search",className:"px-2 py-1 bg-gray-800 rounded text-white"}),(0,r.jsx)("button",{onClick:()=>{let e=t.trim();if(!e)return;let s=prompt("Preset name");s&&o(t=>[...t.filter(e=>e.label!==s),{label:s,expression:e,docUrl:""}])},"aria-label":"Save filter preset",className:"px-2 py-1 bg-gray-700 rounded text-white",type:"button",children:"Save"}),(0,r.jsx)("button",{onClick:()=>{var e;let s=new URL(window.location.href);t?s.searchParams.set("filter",t):s.searchParams.delete("filter"),null==(e=navigator.clipboard)||e.writeText(s.toString())},"aria-label":"Share filter preset",className:"px-2 py-1 bg-gray-700 rounded text-white",type:"button",children:"Share"}),(0,r.jsx)("datalist",{id:"display-filter-suggestions",children:u.map(e=>(0,r.jsx)("option",{value:e},e))})]})}},55088:(e,t,s)=>{"use strict";s.d(t,{getRowColor:()=>d,matchesDisplayFilter:()=>o,protocolName:()=>a});var r=s(13526);let a=e=>{switch(e){case 6:return"TCP";case 17:return"UDP";case 1:return"ICMP";default:return e}},l=r.colorDefinitions.reduce((e,t)=>(e[t.name.toLowerCase()]=t.className,e),{}),n=new Map,i=new WeakMap,c=e=>{let t,s=e.trim().toLowerCase();if(n.has(s))return n.get(s);if("tcp"===s)t=e=>6===e.protocol;else if("udp"===s)t=e=>17===e.protocol;else if("icmp"===s)t=e=>1===e.protocol;else{let e=s.match(/^ip\.addr\s*==\s*(\d+\.\d+\.\d+\.\d+)$/);if(e){let s=e[1];t=e=>e.src===s||e.dest===s}else if(e=s.match(/^tcp\.port\s*==\s*(\d+)$/)){let s=parseInt(e[1],10);t=e=>6===e.protocol&&(e.sport===s||e.dport===s)}else if(e=s.match(/^udp\.port\s*==\s*(\d+)$/)){let s=parseInt(e[1],10);t=e=>17===e.protocol&&(e.sport===s||e.dport===s)}else t=e=>e.src.toLowerCase().includes(s)||e.dest.toLowerCase().includes(s)||a(e.protocol).toLowerCase().includes(s)||(e.info||"").toLowerCase().includes(s)||(e.plaintext||e.decrypted||"").toLowerCase().includes(s)}return n.set(s,t),t},o=(e,t)=>!t||("function"==typeof t?t:c(t))(e),d=(e,t)=>{let s=t.find(t=>{let s=i.get(t);if(!s||s.expr!==t.expression){let s={expr:t.expression,fn:c(t.expression)};return i.set(t,s),s.fn(e)}return s.fn(e)});return s&&(l[s.color?s.color.toLowerCase():""]||s.color)||""}},61269:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>k});var r=s(37876),a=s(49096),l=s.n(a),n=s(14232),i=s(54587),c=s.n(i),o=s(55088);let d={TCP:"bg-blue-600",UDP:"bg-green-600",ICMP:"bg-purple-600",default:"bg-gray-600"},u=e=>{let{packets:t,colorRules:s,viewIndex:a,prefersReducedMotion:l}=e,i=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let e=i.current;if(!e)return;if(l){e.style.transform="translateX(-".concat(8*a,"px)");return}let t=requestAnimationFrame(()=>{e.style.transform="translateX(-".concat(8*a,"px)")});return()=>cancelAnimationFrame(t)},[a,l]),(0,r.jsx)("div",{className:"relative h-16 bg-black overflow-hidden border-t border-gray-800",role:"group","aria-label":"Packet waterfall",children:(0,r.jsx)("div",{ref:i,className:"flex absolute top-0 left-0 h-full will-change-transform",children:t.map((e,t)=>{let a=(0,o.getRowColor)(e,s),l=d[(0,o.protocolName)(e.protocol)]||d.default;return(0,r.jsx)("div",{className:"w-2 h-full ".concat(a||l," ").concat(e.burstStart?"ml-1":""),title:"".concat((0,o.protocolName)(e.protocol)," packet at ").concat(e.timestamp),"aria-label":"".concat((0,o.protocolName)(e.protocol)," packet at ").concat(e.timestamp)},t)})})})},p=e=>{let{minutes:t=[]}=e;if(!t.length)return null;let s=Math.max(...t.map(e=>e.count)),a=t.reduce((e,t)=>e+t.count,0)/t.length;return(0,r.jsx)("div",{className:"h-24 bg-black flex items-end overflow-x-auto px-2",role:"img","aria-label":"Traffic bursts by minute",children:t.map(e=>{let t=e.count/s*100,l=e.count>2*a;return(0,r.jsx)("div",{className:"w-4 mx-1 ".concat(l?"bg-red-500":"bg-gray-500"),style:{height:"".concat(t,"%")},title:"Minute ".concat(e.minute,": ").concat(e.count," packets"),"aria-label":"Minute ".concat(e.minute,": ").concat(e.count," packets").concat(l?" burst":"")},e.minute)})})},h=e=>{let{data:t}=e;return t&&"object"==typeof t?(0,r.jsx)("ul",{className:"pl-4 list-disc",children:Object.entries(t).map(e=>{let[t,s]=e;return(0,r.jsxs)("li",{className:"mb-1",children:[(0,r.jsxs)("span",{className:"font-semibold",children:[t,":"]})," ","object"==typeof s?(0,r.jsx)(h,{data:s}):String(s)]},t)})}):null};var f=s(18847),x=s.n(f),m=s(63115);let g=x()(async()=>{let e=(await s.e(9364).then(s.bind(s,58564))).default,t=(await s.e(125).then(s.t.bind(s,60125,23))).default;return e.use(t),(await Promise.all([s.e(9364),s.e(2458)]).then(s.bind(s,52458))).default},{loadableGenerated:{webpack:()=>[52458]},ssr:!1}),j=e=>{let{packets:t}=e,s=(0,n.useRef)(null),a=(0,n.useRef)(null),{elements:l,stats:i}=(0,n.useMemo)(()=>{let e={},s={},r=0;return t.forEach(t=>{var a;e[t.src]||(e[t.src]={data:{id:t.src,label:t.src}}),e[t.dest]||(e[t.dest]={data:{id:t.dest,label:t.dest}});let l="".concat(t.src,"_").concat(t.dest);s[l]||(s[l]={data:{id:l,source:t.src,target:t.dest,count:0}}),s[l].data.count+=1,r+=(null==(a=t.data)?void 0:a.length)||0}),{elements:[...Object.values(e),...Object.values(s).map(e=>({...e,data:{...e.data,label:String(e.data.count)}}))],stats:{packets:t.length,hosts:Object.keys(e).length,conversations:Object.keys(s).length,bytes:r}}},[t]);return(0,n.useEffect)(()=>{s.current&&s.current.layout({name:"cose-bilkent"}).run()},[l]),(0,r.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,r.jsx)("div",{ref:a,className:"w-full h-64 bg-black",children:(0,r.jsx)(g,{elements:l,style:{width:"100%",height:"100%"},cy:e=>{s.current=e}})}),(0,r.jsxs)("div",{className:"flex space-x-4 text-xs text-green-400",children:[(0,r.jsxs)("span",{children:["Packets: ",i.packets]}),(0,r.jsxs)("span",{children:["Hosts: ",i.hosts]}),(0,r.jsxs)("span",{children:["Conversations: ",i.conversations]}),(0,r.jsxs)("span",{children:["Bytes: ",i.bytes]}),(0,r.jsx)("button",{onClick:()=>{a.current&&(0,m.toPng)(a.current).then(e=>{let t=document.createElement("a");t.download="flow-graph.png",t.href=e,t.click()}).catch(()=>{})},className:"ml-auto px-2 py-1 bg-gray-700 rounded",children:"Export PNG"})]})]})};var y=s(52425),b=s(13526);let v=e=>{let{rules:t,onChange:s}=e,a=(0,n.useRef)(null),l=(e,r,a)=>{s(t.map((t,s)=>s===e?{...t,[r]:a}:t))};return(0,r.jsxs)("div",{className:"flex flex-col space-y-1",children:[t.map((e,a)=>(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsx)("input",{value:e.expression,onChange:e=>l(a,"expression",e.target.value),placeholder:"Filter expression",className:"px-1 py-0.5 bg-gray-800 rounded text-white text-xs"}),(0,r.jsxs)("select",{value:e.color,onChange:e=>l(a,"color",e.target.value),"aria-label":"Color",className:"px-1 py-0.5 bg-gray-800 rounded text-white text-xs",children:[(0,r.jsx)("option",{value:"",children:"Select color"}),b.colorDefinitions.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.name))]}),(0,r.jsx)("button",{onClick:()=>{s(t.filter((e,t)=>t!==a))},"aria-label":"Remove rule",className:"px-1 py-0.5 bg-gray-700 rounded text-xs",type:"button",children:"✕"})]},a)),(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsx)("button",{onClick:()=>{s([...t,{expression:"",color:""}])},type:"button",className:"px-1 py-0.5 bg-gray-700 rounded text-xs",children:"Add rule"}),(0,r.jsx)("button",{onClick:()=>{var e;return null==(e=a.current)?void 0:e.click()},type:"button",className:"px-1 py-0.5 bg-gray-700 rounded text-xs",children:"Import JSON"}),(0,r.jsx)("button",{onClick:()=>{var e,s;let r=JSON.stringify(t,null,2);if(null==(s=navigator)||null==(e=s.clipboard)?void 0:e.writeText)try{navigator.clipboard.writeText(r)}catch(e){}else{let e=new Blob([r],{type:"application/json"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="color-rules.json",s.click(),URL.revokeObjectURL(t)}},type:"button",className:"px-1 py-0.5 bg-gray-700 rounded text-xs",children:"Export JSON"})]}),(0,r.jsx)("input",{type:"file",accept:"application/json",ref:a,onChange:e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];if(r){let t=new FileReader;t.onload=()=>{try{let e=JSON.parse(t.result);Array.isArray(e)&&s(e)}catch(e){}},t.readAsText(r),e.target.value=""}},"aria-label":"Color rules JSON file",className:"hidden"})]})},w=e=>{if(e.length<34||2048!=(e[12]<<8|e[13]))return{src:"",dest:"",protocol:0,info:""};let t=e[23],s=Array.from(e.slice(26,30)).join("."),r=Array.from(e.slice(30,34)).join("."),a="";if(6===t&&e.length>=54){let l=e[34]<<8|e[35],n=e[36]<<8|e[37];return{src:s,dest:r,protocol:t,info:a="TCP ".concat(l," → ").concat(n),sport:l,dport:n}}if(17===t&&e.length>=42){let l=e[34]<<8|e[35],n=e[36]<<8|e[37];return{src:s,dest:r,protocol:t,info:a="UDP ".concat(l," → ").concat(n),sport:l,dport:n}}return{src:s,dest:r,protocol:t,info:a}},N=e=>{let t=new DataView(e).getUint32(0,!1);if(0xa1b2c3d4===t||0xd4c3b2a1===t)return(e=>{let t=new DataView(e),s=0xd4c3b2a1===t.getUint32(0,!1),r=24,a=[];for(;r+16<=t.byteLength;){let l=t.getUint32(r,s),n=t.getUint32(r+4,s),i=t.getUint32(r+8,s),c=t.getUint32(r+12,s);if((r+=16)+i>t.byteLength)break;let o=new Uint8Array(e.slice(r,r+i)),d=w(o);a.push({timestamp:"".concat(l,".").concat(n.toString().padStart(6,"0")),len:c,src:d.src,dest:d.dest,protocol:d.protocol,info:d.info||"len=".concat(c),sport:d.sport,dport:d.dport,data:o,layers:{}}),r+=i}return a})(e);if(0xa0d0d0a===t)return(e=>{let t=new DataView(e),s=0,r=!0,a=[];if(0xa0d0d0a!==t.getUint32(s,!1))throw Error("Unsupported pcap format");r=0x4d3c2b1a===t.getUint32(s+8,!1);let l=t.getUint32(s+4,r);for(s+=l;s+8<=t.byteLength;){let n=t.getUint32(s,r);if(l=t.getUint32(s+4,r),6===n){let l=t.getUint32(s+12,r),n=t.getUint32(s+16,r),i=t.getUint32(s+20,r),c=t.getUint32(s+24,r),o=s+28,d=new Uint8Array(e.slice(o,o+i)),u=w(d),p=(BigInt(l)<<32n)+BigInt(n),h=Number(p/1000000n),f=Number(p%1000000n);a.push({timestamp:"".concat(h,".").concat(f.toString().padStart(6,"0")),len:c,src:u.src,dest:u.dest,protocol:u.protocol,info:u.info||"len=".concat(c),sport:u.sport,dport:u.dport,data:d,layers:{}})}s+=l}return a})(e);throw Error("Unsupported pcap format")};var S=s(42979);let _=[{id:"http",label:"HTTP Sample",path:"/samples/wireshark/http.pcap",note:"Simulated web browsing with HTTP requests and responses."},{id:"dns",label:"DNS Sample",path:"/samples/wireshark/dns.pcap",note:"Simulated DNS lookups across internal resolver traffic."}],k=e=>{let{initialPackets:t=[]}=e,[a,i]=(0,n.useState)(t),[d,f]=(0,n.useState)(null),[x,m]=(0,n.useState)(""),[g,b]=(0,n.useState)(""),[w,k]=(0,n.useState)(""),[C,R]=(0,n.useState)(""),[F,P]=(0,n.useState)([]),[T,U]=(0,n.useState)(!1),[z,A]=(0,n.useState)([]),[D,I]=(0,n.useState)([]),[O,E]=(0,n.useState)(0),[L,M]=(0,n.useState)(""),[B,H]=(0,n.useState)(null),[q,W]=(0,n.useState)("packets"),[J,V]=(0,n.useState)(""),[$,G]=(0,n.useState)(_[0].id),[K,Q]=(0,n.useState)(_[0].note),[X,Y]=(0,n.useState)(!1),Z=(0,n.useRef)(null),ee=(0,n.useRef)(!1),et=(0,n.useRef)(!1);(0,n.useEffect)(()=>{{let e=window.localStorage.getItem("wireshark-filter");e&&k(e),et.current=window.matchMedia("(prefers-reduced-motion: reduce)").matches}},[]),(0,n.useEffect)(()=>{if("function"==typeof Worker){let e=new Worker(s.tu(new URL(s.p+s.u(6717),s.b)));return e.onmessage=e=>{"burst"===e.data.type&&M("Burst starting at ".concat(e.data.start)),"timeline"===e.data.type&&A(e.data.timeline),"minutes"===e.data.type&&I(e.data.minutes)},t.forEach(t=>e.postMessage(t)),Z.current=e,()=>e.terminate()}},[t]),(0,n.useEffect)(()=>{ee.current=T},[T]),(0,n.useEffect)(()=>{T||E(Math.max(0,z.length-100))},[z,T]);let es=async e=>{try{let t=await e.arrayBuffer(),s=N(t);i(s),A(s),Q("Loaded custom capture file locally."),V("")}catch(e){V(e.message||"Unsupported file")}},er=async()=>{let e=_.find(e=>e.id===$);if(e)try{let t=await fetch(e.path),s=await t.arrayBuffer(),r=N(s);i(r),A(r),Q(e.note),V("")}catch(e){V(e.message||"Failed to load sample capture")}},ea=()=>{if(d)return;let e=new WebSocket("ws://localhost:8080");e.onopen=()=>{x&&e.send(JSON.stringify({type:"tlsKeys",keys:x}))},e.onmessage=e=>{try{let s=JSON.parse(e.data);if(i(e=>[s,...e].slice(0,500)),!ee.current){var t;null==(t=Z.current)||t.postMessage(s)}}catch(e){}},e.onclose=()=>f(null),f(e)},el=()=>{d&&(d.close(),f(null))},en=Array.from(new Set(a.map(e=>(0,o.protocolName)(e.protocol)))),ei=a.filter(e=>(0,o.matchesDisplayFilter)(e,w)).filter(e=>((e,t)=>{if(!t)return!0;let s=t.trim().toLowerCase();if("tcp"===s)return 6===e.protocol;if("udp"===s)return 17===e.protocol;if("icmp"===s)return 1===e.protocol;let r=s.match(/^port (\d+)$/);if(r){let t=parseInt(r[1],10);return e.sport===t||e.dport===t}let a=s.match(/^host (.+)$/);if(a){let t=a[1];return e.src===t||e.dest===t}return!0})(e,C)).filter(e=>!g||(0,o.protocolName)(e.protocol)===g),ec=!!x,eo=ei.length;return(0,r.jsxs)("div",{onDrop:e=>{var t;e.preventDefault();let s=null==(t=e.dataTransfer.files)?void 0:t[0];s&&(s.name.endsWith(".pcap")||s.name.endsWith(".pcapng"))?es(s):V("Unsupported file format")},onDragOver:e=>{e.preventDefault()},className:"jsx-c975f8956d50a0e7 w-full h-full flex flex-col bg-black text-green-400 [container-type:inline-size]",children:[(0,r.jsxs)("div",{className:"jsx-c975f8956d50a0e7 flex items-center gap-3 px-3 py-2 bg-gradient-to-r from-blue-900 to-blue-700 border-b border-blue-600",children:[(0,r.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"jsx-c975f8956d50a0e7 w-6 h-6 text-blue-200",children:(0,r.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z",className:"jsx-c975f8956d50a0e7"})}),(0,r.jsx)("span",{className:"jsx-c975f8956d50a0e7 text-lg font-semibold text-white tracking-wide",children:"Wireshark"}),(0,r.jsx)("span",{className:"jsx-c975f8956d50a0e7 text-xs text-blue-200",children:"Network Protocol Analyzer (Demo)"})]}),(0,r.jsx)("div",{className:"jsx-c975f8956d50a0e7 p-2 bg-gray-900",children:(0,r.jsx)(S.default,{toolName:"Wireshark",message:"Capture files are bundled for simulations. Live capture is not enabled in this demo."})}),(0,r.jsx)("p",{className:"jsx-c975f8956d50a0e7 text-yellow-300 text-xs p-2 bg-gray-900",children:"Bundled capture for lab use only. No live traffic."}),(0,r.jsxs)("div",{className:"jsx-c975f8956d50a0e7 px-2 pb-2 bg-gray-900 text-xs flex items-center gap-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>Y(e=>!e),"aria-expanded":X,className:"jsx-c975f8956d50a0e7 rounded border border-white/10 px-2 py-1 text-white/80 hover:text-white",children:X?"Hide":"About this tool"}),(0,r.jsx)("span",{className:"jsx-c975f8956d50a0e7 text-white/70",children:"Practice display filters, packet inspection, and protocol decoding in a safe demo."})]}),X&&(0,r.jsxs)("div",{className:"jsx-c975f8956d50a0e7 mx-2 mb-2 rounded border border-white/10 bg-gray-900 p-3 text-xs text-white/80",children:[(0,r.jsx)("p",{className:"jsx-c975f8956d50a0e7 font-semibold text-white",children:"Wireshark learning tips"}),(0,r.jsxs)("ul",{className:"jsx-c975f8956d50a0e7 mt-1 list-disc space-y-1 pl-4",children:[(0,r.jsx)("li",{className:"jsx-c975f8956d50a0e7",children:"Display filters highlight matching packets; BPF filters reduce the capture set before display."}),(0,r.jsxs)("li",{className:"jsx-c975f8956d50a0e7",children:["Try filters like ",(0,r.jsx)("span",{className:"jsx-c975f8956d50a0e7 font-mono",children:"tcp"}),","," ",(0,r.jsx)("span",{className:"jsx-c975f8956d50a0e7 font-mono",children:"http"}),", or"," ",(0,r.jsx)("span",{className:"jsx-c975f8956d50a0e7 font-mono",children:"ip.addr == 10.0.0.5"}),"."]}),(0,r.jsx)("li",{className:"jsx-c975f8956d50a0e7",children:"Packet details explain common fields (IP, TCP, HTTP)."})]})]}),J&&(0,r.jsx)("p",{className:"jsx-c975f8956d50a0e7 text-red-400 text-xs p-2 bg-gray-900",children:J}),(0,r.jsx)("div",{className:"jsx-c975f8956d50a0e7 p-2 grid gap-2 md:grid-cols-2 bg-gray-900",children:[{name:"eth0",type:"wired"},{name:"wlan0",type:"wireless"}].map(e=>(0,r.jsxs)("div",{className:"jsx-c975f8956d50a0e7 flex items-center justify-between bg-gray-800 rounded p-2",children:[(0,r.jsxs)("div",{className:"jsx-c975f8956d50a0e7 flex items-center space-x-2",children:[(0,r.jsx)(c(),{src:(e.type,"/themes/Yaru/status/network-wireless-signal-good-symbolic.svg"),alt:e.type,width:24,height:24}),(0,r.jsx)("span",{className:"jsx-c975f8956d50a0e7 text-white",children:e.name})]}),(0,r.jsxs)("div",{className:"jsx-c975f8956d50a0e7 flex items-center space-x-1",children:[(0,r.jsx)("button",{onClick:ea,"aria-label":"start capture on ".concat(e.name),className:"jsx-c975f8956d50a0e7 p-1",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"jsx-c975f8956d50a0e7 w-6 h-6",children:(0,r.jsx)("path",{d:"M8 5v14l11-7z",className:"jsx-c975f8956d50a0e7"})})}),(0,r.jsx)("button",{onClick:el,"aria-label":"stop capture on ".concat(e.name),className:"jsx-c975f8956d50a0e7 p-1",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"jsx-c975f8956d50a0e7 w-6 h-6",children:(0,r.jsx)("path",{d:"M6 6h12v12H6z",className:"jsx-c975f8956d50a0e7"})})})]})]},e.name))}),(0,r.jsxs)("div",{className:"jsx-c975f8956d50a0e7 p-2 flex space-x-2 bg-gray-900 flex-wrap",children:[(0,r.jsxs)("div",{className:"jsx-c975f8956d50a0e7 flex flex-wrap items-center gap-2",children:[(0,r.jsx)("select",{value:$,onChange:e=>G(e.target.value),"aria-label":"Select sample capture",className:"jsx-c975f8956d50a0e7 px-2 py-1 bg-gray-800 rounded text-white",children:_.map(e=>(0,r.jsx)("option",{value:e.id,className:"jsx-c975f8956d50a0e7",children:e.label},e.id))}),(0,r.jsx)("button",{onClick:er,className:"jsx-c975f8956d50a0e7 px-3 py-1 bg-gray-700 rounded",children:"Load Sample"}),K&&(0,r.jsx)("span",{className:"jsx-c975f8956d50a0e7 text-xs text-gray-300",children:K})]}),(0,r.jsx)("button",{onClick:ea,disabled:!!d,className:"jsx-c975f8956d50a0e7 px-3 py-1 bg-gray-700 rounded disabled:opacity-50",children:"Start"}),(0,r.jsx)("button",{onClick:el,disabled:!d,className:"jsx-c975f8956d50a0e7 px-3 py-1 bg-gray-700 rounded disabled:opacity-50",children:"Stop"}),(0,r.jsx)("input",{type:"file",accept:".keys,.txt,.log",onChange:e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(s){let e=new FileReader;e.onload=()=>m(e.result),e.readAsText(s)}},"aria-label":"TLS key file",className:"jsx-c975f8956d50a0e7 px-2 py-1 bg-gray-800 rounded text-white"}),(0,r.jsx)(y.default,{value:w,onChange:e=>{k(e),window.localStorage.setItem("wireshark-filter",e)}}),(0,r.jsx)("input",{value:C,onChange:e=>{R(e.target.value)},list:"bpf-suggestions",placeholder:"BPF filter (e.g. tcp, port 80)","aria-label":"BPF filter",className:"jsx-c975f8956d50a0e7 px-2 py-1 bg-gray-800 rounded text-white"}),(0,r.jsxs)("datalist",{id:"bpf-suggestions",className:"jsx-c975f8956d50a0e7",children:[(0,r.jsx)("option",{value:"tcp",className:"jsx-c975f8956d50a0e7",children:"tcp"}),(0,r.jsx)("option",{value:"udp",className:"jsx-c975f8956d50a0e7",children:"udp"}),(0,r.jsx)("option",{value:"icmp",className:"jsx-c975f8956d50a0e7",children:"icmp"}),(0,r.jsx)("option",{value:"port 80",className:"jsx-c975f8956d50a0e7",children:"port 80"}),(0,r.jsx)("option",{value:"host 10.0.0.1",className:"jsx-c975f8956d50a0e7",children:"host 10.0.0.1"})]}),(0,r.jsx)("a",{href:"https://www.wireshark.org/docs/dfref/",target:"_blank",rel:"noopener noreferrer",className:"jsx-c975f8956d50a0e7 text-blue-400 underline whitespace-nowrap",children:"Display filter docs"}),(0,r.jsx)(v,{rules:F,onChange:P}),(0,r.jsx)("button",{onClick:()=>{U(e=>{let t=!e;return M(t?"Capture paused":"Capture resumed"),t})},"aria-pressed":T,className:"jsx-c975f8956d50a0e7 px-3 py-1 bg-gray-700 rounded",children:T?"Resume":"Pause"}),(0,r.jsx)("input",{type:"range",min:"0",max:Math.max(0,z.length-100),value:O,onChange:e=>{let t=parseInt(e.target.value,10);E(t),M("Viewing packets starting at index ".concat(t))},"aria-label":"Scrub timeline",className:"jsx-c975f8956d50a0e7 flex-1 waterfall-cq"})]}),(0,r.jsx)("div",{className:"jsx-c975f8956d50a0e7 waterfall-cq",children:(0,r.jsx)(u,{packets:z,colorRules:F,viewIndex:O,prefersReducedMotion:et.current})}),(0,r.jsx)(p,{minutes:D}),(0,r.jsxs)("div",{className:"jsx-c975f8956d50a0e7 p-2 flex space-x-2 bg-gray-900 overflow-x-auto",children:[(0,r.jsxs)("span",{className:"jsx-c975f8956d50a0e7 text-xs text-gray-300 self-center",children:["Showing ",eo," of ",a.length," packets"]}),(0,r.jsx)("button",{onClick:()=>b(""),className:"jsx-c975f8956d50a0e7 "+"px-2 py-1 rounded border ".concat(""===g?"bg-gray-700":"bg-gray-800"),children:"All"}),en.map(e=>(0,r.jsx)("button",{onClick:()=>b(e),className:"jsx-c975f8956d50a0e7 "+"px-2 py-1 rounded border ".concat(g===e?"bg-gray-700":"bg-gray-800"),children:e},e))]}),(0,r.jsxs)("div",{className:"jsx-c975f8956d50a0e7 p-2 flex space-x-2 bg-gray-900",children:[(0,r.jsx)("button",{onClick:()=>W("packets"),className:"jsx-c975f8956d50a0e7 "+"px-2 py-1 rounded border ".concat("packets"===q?"bg-gray-700":"bg-gray-800"),children:"Packets"}),(0,r.jsx)("button",{onClick:()=>W("flows"),className:"jsx-c975f8956d50a0e7 "+"px-2 py-1 rounded border ".concat("flows"===q?"bg-gray-700":"bg-gray-800"),children:"Flows"})]}),"packets"===q?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"jsx-c975f8956d50a0e7 flex-1 overflow-auto",children:(0,r.jsxs)("table",{className:"jsx-c975f8956d50a0e7 min-w-full text-xs",children:[(0,r.jsx)("thead",{className:"jsx-c975f8956d50a0e7 bg-gray-800",children:(0,r.jsxs)("tr",{className:"jsx-c975f8956d50a0e7",children:[(0,r.jsx)("th",{className:"jsx-c975f8956d50a0e7 px-2 py-1 text-left",children:"Time"}),(0,r.jsx)("th",{className:"jsx-c975f8956d50a0e7 px-2 py-1 text-left",children:"Length"}),(0,r.jsx)("th",{className:"jsx-c975f8956d50a0e7 px-2 py-1 text-left",children:"Summary"}),ec&&(0,r.jsx)("th",{className:"jsx-c975f8956d50a0e7 px-2 py-1 text-left",children:"Plaintext"})]})}),(0,r.jsx)("tbody",{className:"jsx-c975f8956d50a0e7",children:ei.map((e,t)=>{let s=(0,o.matchesDisplayFilter)(e,w);return(0,r.jsxs)("tr",{onClick:()=>H(e),className:"jsx-c975f8956d50a0e7 "+"".concat(t%2?"bg-gray-900":"bg-gray-800"," ").concat((0,o.getRowColor)(e,F)," ").concat(s?"bg-yellow-900":""," ").concat(B===e?"outline outline-1 outline-yellow-400":""),children:[(0,r.jsx)("td",{className:"jsx-c975f8956d50a0e7 px-2 py-1 whitespace-nowrap",children:e.timestamp}),(0,r.jsx)("td",{className:"jsx-c975f8956d50a0e7 px-2 py-1 whitespace-nowrap",children:e.len}),(0,r.jsx)("td",{className:"jsx-c975f8956d50a0e7 px-2 py-1",children:e.info}),ec&&(0,r.jsx)("td",{className:"jsx-c975f8956d50a0e7 px-2 py-1",children:e.plaintext||e.decrypted})]},t)})})]})}),(0,r.jsx)("div",{className:"jsx-c975f8956d50a0e7 p-2 bg-gray-900 overflow-auto text-xs h-40",children:B?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h,{data:B.layers}),B.data&&(0,r.jsx)("pre",{className:"jsx-c975f8956d50a0e7 mt-2 whitespace-pre-wrap",children:Array.from(B.data,(e,t)=>"".concat(e.toString(16).padStart(2,"0")).concat((t+1)%16==0?"\n":" ")).join("")}),(0,r.jsxs)("div",{className:"jsx-c975f8956d50a0e7 mt-2 text-xs text-white/70",children:[(0,r.jsx)("p",{className:"jsx-c975f8956d50a0e7 font-semibold text-white",children:"Field guide"}),(0,r.jsxs)("ul",{className:"jsx-c975f8956d50a0e7 mt-1 list-disc space-y-1 pl-4",children:[(0,r.jsx)("li",{className:"jsx-c975f8956d50a0e7",children:"IP: source/destination addresses identify the hosts in the conversation."}),(0,r.jsx)("li",{className:"jsx-c975f8956d50a0e7",children:"TCP/UDP: ports reveal the service (HTTP, DNS, SSH) and flags show connection state."}),(0,r.jsx)("li",{className:"jsx-c975f8956d50a0e7",children:"Info: a short summary of the packet payload and protocol context."})]})]})]}):(0,r.jsx)("p",{className:"jsx-c975f8956d50a0e7 text-gray-400",children:"Select a packet to view details"})})]}):(0,r.jsx)(j,{packets:ei}),(0,r.jsx)("div",{"aria-live":"polite",className:"jsx-c975f8956d50a0e7 sr-only",children:L}),(0,r.jsx)(l(),{id:"c975f8956d50a0e7",children:"@container(max-width:600px){.waterfall-cq.jsx-c975f8956d50a0e7{display:none}}"})]})}},72552:()=>{}}]);