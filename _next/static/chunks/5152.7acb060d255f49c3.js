"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5152],{85152:(e,t,s)=>{s.r(t),s.d(t,{default:()=>i,displayNikto:()=>c});var a=s(37876),l=s(14232);let r={"/admin":"Restrict access to the admin portal or remove it from public view.","/cgi-bin/test":"Remove or secure unnecessary CGI scripts and ensure they are up to date.","/":"Disable or standardize ETag headers to avoid disclosing inodes."},n=()=>{let[e,t]=(0,l.useState)(""),[s,n]=(0,l.useState)(""),[i,c]=(0,l.useState)(!1),[o,d]=(0,l.useState)([]),[h,m]=(0,l.useState)(null),[x,p]=(0,l.useState)([]),[u,b]=(0,l.useState)(""),[j,g]=(0,l.useState)(""),[v,y]=(0,l.useState)("All"),[N,f]=(0,l.useState)("");(0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("/demo-data/nikto/report.json"),t=await e.json();d(t)}catch(e){}})()},[]);let k="nikto -h ".concat(e||"TARGET").concat(s?" -p ".concat(s):"").concat(i?" -ssl":""),w=(0,l.useMemo)(()=>o.reduce((e,t)=>(e[t.severity]=e[t.severity]||[],e[t.severity].push(t),e),{}),[o]),C=(0,l.useMemo)(()=>{let e=o.map(e=>"<tr><td>".concat(e.path,"</td><td>").concat(e.finding,"</td><td>").concat(e.severity,"</td></tr>")).join("");return'<!DOCTYPE html><html><body><h1>Nikto Report</h1><table border="1"><tr><th>Path</th><th>Finding</th><th>Severity</th></tr>'.concat(e,"</table></body></html>")},[o]),S=async()=>{try{var e;await (null==(e=navigator.clipboard)?void 0:e.writeText(C))}catch(e){}},L=(0,l.useCallback)(async e=>{e.preventDefault();let t=e.dataTransfer.files&&e.dataTransfer.files[0];if(t)try{let e=await t.text(),s=[];if(t.name.endsWith(".xml"))s=(e=>{var t;let s=new DOMParser().parseFromString(e,"application/xml");if(s.querySelector("parsererror"))throw Error("Invalid XML");let a=(null==(t=s.querySelector("target > hostname"))?void 0:t.textContent)||"",l=[];return s.querySelectorAll("item").forEach(e=>{var t,s;let r=(null==(t=e.querySelector("uri, url"))?void 0:t.textContent)||"",n=(null==(s=e.querySelector("severity"))?void 0:s.textContent)||"";a&&r&&l.push({host:a,path:r,severity:n})}),l})(e);else if(t.name.endsWith(".txt"))s=(e=>{let t=e.split(/\r?\n/),s=[],a="";return t.forEach(e=>{let t=e.match(/^Host:\s*(.+)$/i);if(t){a=t[1].trim();return}let l=e.match(/^([^\s]+)\s+(Info|Low|Medium|High|Critical)$/i);l&&a&&s.push({host:a,path:l[1],severity:l[2]})}),s})(e);else throw Error("Unsupported file type");if(!s.length)throw Error("No valid findings");p(s),f("")}catch(e){p([]),f(e.message||"Failed to parse file")}},[]),R=(0,l.useMemo)(()=>x.filter(e=>e.host.toLowerCase().includes(u.toLowerCase())&&e.path.toLowerCase().startsWith(j.toLowerCase())&&("All"===v||e.severity.toLowerCase()===v.toLowerCase())),[x,u,j,v]);return(0,a.jsxs)("div",{className:"p-4 bg-gray-900 text-white min-h-screen space-y-4",children:[(0,a.jsx)("h1",{className:"text-2xl mb-4",children:"Nikto Scanner"}),(0,a.jsx)("p",{className:"text-sm text-yellow-300 mb-4",children:"Build a nikto command without running any scans. Data and reports are static and for learning only."}),(0,a.jsxs)("form",{onSubmit:e=>e.preventDefault(),className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"nikto-host",className:"block text-sm mb-1",children:"Host"}),(0,a.jsx)("input",{id:"nikto-host",className:"w-full p-2 rounded text-black",value:e,onChange:e=>t(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"nikto-port",className:"block text-sm mb-1",children:"Port"}),(0,a.jsx)("input",{id:"nikto-port",type:"number",className:"w-full p-2 rounded text-black",value:s,onChange:e=>n(e.target.value)})]}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[(0,a.jsx)("input",{id:"nikto-ssl",type:"checkbox",className:"mr-2",checked:i,onChange:e=>c(e.target.checked)}),(0,a.jsx)("label",{htmlFor:"nikto-ssl",className:"text-sm",children:"SSL"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg mb-2",children:"Command Preview"}),(0,a.jsx)("pre",{className:"bg-black text-green-400 p-2 rounded overflow-auto",children:k})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg mb-2",children:"Findings"}),(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-700",children:[(0,a.jsx)("th",{className:"p-2 text-left",children:"Path"}),(0,a.jsx)("th",{className:"p-2 text-left",children:"Finding"})]})}),(0,a.jsx)("tbody",{children:Object.entries(w).map(e=>{let[t,s]=e;return(0,a.jsxs)(l.Fragment,{children:[(0,a.jsx)("tr",{className:"bg-gray-800",children:(0,a.jsx)("td",{colSpan:2,className:"p-2 font-bold",children:t})}),s.map(e=>(0,a.jsxs)("tr",{className:"odd:bg-gray-900 cursor-pointer hover:bg-gray-700",onClick:()=>m(e),children:[(0,a.jsx)("td",{className:"p-2",children:e.path}),(0,a.jsx)("td",{className:"p-2",children:e.finding})]},e.path))]},t)})})]})]}),h&&(0,a.jsxs)("div",{className:"fixed top-0 right-0 w-80 h-full bg-gray-800 p-4 overflow-auto shadow-lg",children:[(0,a.jsx)("button",{type:"button",onClick:()=>m(null),className:"mb-2 bg-red-600 px-2 py-1 rounded text-sm",children:"Close"}),(0,a.jsx)("h3",{className:"text-xl mb-2",children:h.path}),(0,a.jsx)("p",{className:"mb-2",children:h.finding}),(0,a.jsxs)("p",{className:"mb-2",children:[(0,a.jsx)("span",{className:"font-bold",children:"Severity:"})," ",h.severity]}),(0,a.jsxs)("p",{className:"mb-2",children:[(0,a.jsx)("span",{className:"font-bold",children:"References:"})," ",h.references.join(", ")]}),(0,a.jsx)("p",{className:"mb-4",children:h.details}),(0,a.jsx)("p",{className:"text-sm text-green-300",children:r[h.path]||"No suggestion available."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg mb-2",children:"HTML Report Preview"}),(0,a.jsxs)("div",{className:"flex space-x-2 mb-2",children:[(0,a.jsx)("button",{type:"button",onClick:S,className:"px-2 py-1 bg-blue-600 rounded text-sm",children:"Copy HTML"}),(0,a.jsx)("button",{type:"button",onClick:()=>{let e=new Blob([C],{type:"text/html"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="nikto-report.html",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)},className:"px-2 py-1 bg-blue-600 rounded text-sm",children:"Export HTML"})]}),(0,a.jsx)("iframe",{title:"Nikto HTML Report",srcDoc:C,className:"w-full h-64 bg-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg mb-2",children:"Parse Report"}),(0,a.jsx)("div",{"data-testid":"drop-zone",onDrop:L,onDragOver:e=>e.preventDefault(),className:"border-2 border-dashed border-gray-600 p-4 text-center mb-4",children:"Drop Nikto text or XML report here"}),N&&(0,a.jsx)("p",{className:"text-red-500 mb-2",children:N}),x.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex space-x-2 mb-2",children:[(0,a.jsx)("input",{placeholder:"Filter host",value:u,onChange:e=>b(e.target.value),className:"p-1 rounded text-black flex-1"}),(0,a.jsx)("input",{placeholder:"Filter path",value:j,onChange:e=>g(e.target.value),className:"p-1 rounded text-black flex-1"}),(0,a.jsx)("select",{"aria-label":"Filter severity",value:v,onChange:e=>y(e.target.value),className:"p-1 rounded text-black",children:["All","Info","Low","Medium","High","Critical"].map(e=>(0,a.jsx)("option",{value:e,children:e},e))}),(0,a.jsx)("button",{type:"button",onClick:()=>{let e=new Blob([[["Host","Path","Severity"],...R.map(e=>[e.host,e.path,e.severity])].map(e=>e.map(e=>'"'.concat(String(e).replace(/"/g,'""'),'"')).join(",")).join("\n")],{type:"text/csv"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="nikto.csv",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)},className:"px-2 py-1 bg-blue-600 rounded text-sm",children:"Export CSV"})]}),(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-700",children:[(0,a.jsx)("th",{className:"p-2 text-left",children:"Host"}),(0,a.jsx)("th",{className:"p-2 text-left",children:"Path"}),(0,a.jsx)("th",{className:"p-2 text-left",children:"Severity"})]})}),(0,a.jsx)("tbody",{children:R.map((e,t)=>(0,a.jsxs)("tr",{className:"odd:bg-gray-900",children:[(0,a.jsx)("td",{className:"p-2",children:e.host}),(0,a.jsx)("td",{className:"p-2",children:e.path}),(0,a.jsx)("td",{className:"p-2",children:e.severity})]},t))})]})]})]})]})},i=n,c=()=>(0,a.jsx)(n,{})}}]);