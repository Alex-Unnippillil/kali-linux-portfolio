"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4716],{33840:(e,t,n)=>{n.d(t,{default:()=>r});var a=n(14232);function r(e,t){let[n,r]=(0,a.useState)(()=>{try{let n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(e){return t}});return(0,a.useEffect)(()=>{try{window.localStorage.setItem(e,JSON.stringify(n))}catch(e){}},[e,n]),[n,r]}},44716:(e,t,n)=>{n.d(t,{default:()=>d,useGamePersistence:()=>u,useGameSettings:()=>l});var a=n(14232),r=n(30684),i=n(84613),c=n(33840),s=n(65422);let o={up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",fire:" ",hyperspace:"h"},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",[t,n]=(0,a.useState)(!1),[r,i]=(0,c.default)("game:".concat(e,":speed"),1),[s,o]=(0,c.default)("game:".concat(e,":muted"),!1),[l,u]=(0,c.default)("game:".concat(e,":shake"),!0),[d,h]=(0,c.default)("game:".concat(e,":palette"),"normal"),f=(0,a.useCallback)(()=>n(e=>!e),[]),m=(0,a.useCallback)(()=>o(e=>!e),[o]);return{paused:t,togglePause:f,speed:r,setSpeed:(0,a.useCallback)(e=>i(Math.min(2,Math.max(.5,e))),[i]),muted:s,toggleMute:m,screenShake:l,setScreenShake:u,palette:d,setPalette:h}},u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=(0,a.useCallback)(t=>{try{localStorage.setItem("snapshot:".concat(e),JSON.stringify(t))}catch(e){}},[e]),n=(0,a.useCallback)(()=>{try{let t=localStorage.getItem("snapshot:".concat(e));return t?JSON.parse(t):null}catch(e){return null}},[e]),r=(0,a.useCallback)(()=>{try{return Number(localStorage.getItem("highscore:".concat(e)))||0}catch(e){return 0}},[e]),i=(0,a.useCallback)(t=>{try{let n=r();t>n&&localStorage.setItem("highscore:".concat(e),String(t))}catch(e){}},[e,r]),c=(0,a.useCallback)(()=>{try{return JSON.parse(localStorage.getItem("achievements:".concat(e)))||[]}catch(e){return[]}},[e]),s=(0,a.useCallback)(t=>{try{let n=c();n.includes(t)||(n.push(t),localStorage.setItem("achievements:".concat(e),JSON.stringify(n)))}catch(e){}},[e,c]);return{saveSnapshot:t,loadSnapshot:n,getHighScore:r,setHighScore:i,getAchievements:c,unlockAchievement:s}},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{enabled:c=!0,preventDefault:l=!1,isFocused:u=!0,targetRef:d=null}=n||{},h="function"==typeof e?e:null,f="function"==typeof e?null:e,m=(0,a.useRef)({keys:{},fire:!1,hyperspace:!1,joystick:{x:0,y:0,active:!1,startX:0,startY:0}}),y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.25,[t,n]=(0,a.useState)(()=>(0,i.pollTwinStick)(e));return(0,a.useEffect)(()=>{let t,a=()=>{n((0,i.pollTwinStick)(e)),t=requestAnimationFrame(a)};return t=requestAnimationFrame(a),()=>cancelAnimationFrame(t)},[e]),t}(),v=(0,a.useRef)(0);return(0,a.useEffect)(()=>{let e;if(!h||!c)return;let n=n=>{!n.repeat&&(e||(e=setTimeout(()=>{e=null},100),(e=>{if(!(0,s.shouldHandleGameKey)(e,{isFocused:u}))return;let n=(0,r.getMapping)(t,o);e.key===n.up&&(l&&(0,s.consumeGameKey)(e),h({x:0,y:-1})),e.key===n.down&&(l&&(0,s.consumeGameKey)(e),h({x:0,y:1})),e.key===n.left&&(l&&(0,s.consumeGameKey)(e),h({x:-1,y:0})),e.key===n.right&&(l&&(0,s.consumeGameKey)(e),h({x:1,y:0}))})(n)))};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n),e&&clearTimeout(e)}},[h,t,c,l,u]),(0,a.useEffect)(()=>{if(!h||!c||!u)return;let e=(null==d?void 0:d.current)||window;if(!e)return;let t=0,n=0,a=l?{passive:!1}:void 0,r=e=>{l&&e.cancelable&&e.preventDefault(),t=e.touches[0].clientX,n=e.touches[0].clientY},i=e=>{l&&e.cancelable&&e.preventDefault();let a=e.changedTouches[0].clientX-t,r=e.changedTouches[0].clientY-n;Math.abs(a)>Math.abs(r)?a>30?h({x:1,y:0}):a<-30&&h({x:-1,y:0}):r>30?h({x:0,y:1}):r<-30&&h({x:0,y:-1})};return e.addEventListener("touchstart",r,a),e.addEventListener("touchend",i,a),()=>{e.removeEventListener("touchstart",r,a),e.removeEventListener("touchend",i,a)}},[h,c,u,d,l]),(0,a.useEffect)(()=>{if(!h||!c||!u)return;let e=Date.now();if(e-v.current<100)return;let{moveX:t,moveY:n}=y;(Math.abs(t)>.5||Math.abs(n)>.5)&&(Math.abs(t)>Math.abs(n)?h({x:Math.sign(t),y:0}):h({x:0,y:Math.sign(n)}),v.current=e)},[y,h,c,u]),(0,a.useEffect)(()=>{if(h||!c)return;let e=e=>{if(!(0,s.shouldHandleGameKey)(e,{isFocused:u}))return;let n=(0,r.getMapping)(t,o);e.key===n.fire?m.current.fire=!0:e.key===n.hyperspace?m.current.hyperspace=!0:m.current.keys[e.key]=!0},n=e=>{if(!(0,s.shouldHandleGameKey)(e,{isFocused:u}))return;let n=(0,r.getMapping)(t,o);e.key===n.fire?m.current.fire=!1:e.key===n.hyperspace?m.current.hyperspace=!1:m.current.keys[e.key]=!1};return window.addEventListener("keydown",e),window.addEventListener("keyup",n),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",n)}},[t,h,c,u]),(0,a.useEffect)(()=>{if(h||!(null==f?void 0:f.current)||!c||!u)return;let e=f.current,t=t=>{let n=t.touches[0],a=e.getBoundingClientRect();n.clientX-a.left<a.width/2?(m.current.joystick.active=!0,m.current.joystick.startX=n.clientX,m.current.joystick.startY=n.clientY):n.clientY-a.top<a.height/2?m.current.fire=!0:m.current.hyperspace=!0},n=e=>{if(!m.current.joystick.active)return;let t=e.touches[0],n=(t.clientX-m.current.joystick.startX)/40,a=(t.clientY-m.current.joystick.startY)/40;m.current.joystick.x=Math.max(-1,Math.min(1,n)),m.current.joystick.y=Math.max(-1,Math.min(1,a))},a=()=>{m.current.joystick.active=!1,m.current.joystick.x=0,m.current.joystick.y=0,m.current.fire=!1,m.current.hyperspace=!1};return e.addEventListener("touchstart",t),e.addEventListener("touchmove",n),e.addEventListener("touchend",a),()=>{e.removeEventListener("touchstart",t),e.removeEventListener("touchmove",n),e.removeEventListener("touchend",a)}},[f,h,c,u]),(0,a.useEffect)(()=>{!h&&c&&u&&(m.current.joystick.x=y.moveX,m.current.joystick.y=y.moveY,m.current.fire=y.fire||m.current.fire)},[y,h,c,u]),h?null:m.current}},84613:(e,t,n)=>{n.d(t,{GAMEPAD_PRESETS:()=>r,loadCalibration:()=>i,pollTwinStick:()=>l,saveCalibration:()=>c});let a="gamepad-calibration-",r={Xbox:{vendor:"Xbox",axes:Array.from({length:4},()=>({min:-1,max:1}))},PlayStation:{vendor:"PlayStation",axes:Array.from({length:4},()=>({min:-1,max:1}))}};function i(e){try{let t=window.localStorage.getItem(a+e);return t?JSON.parse(t):null}catch(e){return null}}function c(e,t){try{window.localStorage.setItem(a+e,JSON.stringify(t))}catch(e){}}function s(e,t){if(!t)return e;let n=t.max-t.min;return 0===n?0:(Math.min(Math.max(e,t.min),t.max)-t.min)/n*2-1}class o{on(e,t){this.listeners[e].add(t)}off(e,t){this.listeners[e].delete(t)}emit(e,t){this.listeners[e].forEach(e=>e(t))}start(){null===this.raf&&this.poll()}stop(){null!==this.raf&&(cancelAnimationFrame(this.raf),this.raf=null)}constructor(e=.1){this.listeners={connected:new Set,disconnected:new Set,button:new Set,axis:new Set},this.prevState=new Map,this.raf=null,this.poll=()=>{for(let e of navigator.getGamepads?navigator.getGamepads():[]){if(!e)continue;let t=this.prevState.get(e.index)||{buttons:[],axes:[]};e.buttons.forEach((n,a)=>{let r=t.buttons[a]||0;if(n.value!==r){var i;let t=n.value>.5,c=r>.5;if(this.emit("button",{gamepad:e,index:a,value:n.value,pressed:t}),t&&!c&&(null==(i=e.vibrationActuator)?void 0:i.playEffect))try{e.vibrationActuator.playEffect("dual-rumble",{duration:30,strongMagnitude:1,weakMagnitude:1})}catch(e){}}}),e.axes.forEach((n,a)=>{let r=t.axes[a]||0,i=Math.abs(n)<this.deadzone?0:n;i!==(Math.abs(r)<this.deadzone?0:r)&&this.emit("axis",{gamepad:e,index:a,value:i})}),this.prevState.set(e.index,{buttons:e.buttons.map(e=>e.value),axes:Array.from(e.axes)})}this.raf=requestAnimationFrame(this.poll)},this.deadzone=e,window.addEventListener("gamepadconnected",e=>this.emit("connected",e.gamepad)),window.addEventListener("gamepaddisconnected",e=>this.emit("disconnected",e.gamepad))}}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.25,t={moveX:0,moveY:0,aimX:0,aimY:0,fire:!1};for(let n of navigator.getGamepads?navigator.getGamepads():[]){if(!n)continue;let a=i(n.id),r=(null==a?void 0:a.axes)||[],[c,o,l,u]=n.axes,d=s(c,r[0]),h=s(o,r[1]),f=s(l,r[2]),m=s(u,r[3]);t.moveX=Math.abs(d)>e?d:0,t.moveY=Math.abs(h)>e?h:0,t.aimX=Math.abs(f)>e?f:0,t.aimY=Math.abs(m)>e?m:0,t.fire=n.buttons.some(e=>e.pressed);break}return t}new o}}]);