"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[981],{20981:(e,t,r)=>{r.r(t),r.d(t,{default:()=>D});var o=r(37876),l=r(14232),n=r(70994),a=r(33840);let i=function(e){let t=e.length,r=t>0?e[0].length:0,o=Array.from({length:t},()=>Array(r).fill(!1)),l=(e,o)=>e>=0&&e<t&&o>=0&&o<r,n=[-1,0,1],a=0;for(let i=0;i<t;i++)for(let t=0;t<r;t++){if(e[i][t].mine||o[i][t]||0!==e[i][t].adjacent)continue;a++;let r=[[i,t]],s=0;for(o[i][t]=!0;s<r.length;){let[t,a]=r[s++];for(let i of n)for(let s of n){if(0===i&&0===s)continue;let n=t+i,c=a+s;!l(n,c)||o[n][c]||e[n][c].mine||(o[n][c]=!0,0===e[n][c].adjacent&&r.push([n,c]))}}}for(let l=0;l<t;l++)for(let t=0;t<r;t++)!e[l][t].mine&&!o[l][t]&&a++;return a};function s(e){return e.map(e=>e.map(e=>{let[t,r,o,l,n]=e;return{mine:!!t,revealed:!!r,flagged:!!o,question:!!l,adjacent:n}}))}var c=r(31240);function u(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=Math.max(2,Math.floor(e||0)),l=Math.max(0,Math.floor(t||0)),{safeRadius:n=1,start:a}=r,i=null!=a?a:[Math.floor(o/2),Math.floor(o/2)],s=d(o,i,n).size,c=o*o-s;return{size:o,mines:Math.min(l,Math.max(0,c))}}function d(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,[o,l]=t,n=new Set;for(let t=-r;t<=r;t++)for(let a=-r;a<=r;a++){let r=o+t,i=l+a;r>=0&&r<e&&i>=0&&i<e&&n.add(r*e+i)}return n}function f(e){let t=e.length,r=[-1,0,1];for(let o=0;o<t;o++)for(let l=0;l<t;l++){if(e[o][l].mine)continue;let n=0;for(let a of r)for(let i of r){if(0===a&&0===i)continue;let r=o+a,s=l+i;r>=0&&r<t&&s>=0&&s<t&&e[r][s].mine&&n++}e[o][l].adjacent=n}}function m(e,t,r){let o,l=e.length,n=d(l,t,1),a=e.map(e=>e.map(e=>({...e}))),i=[],s=[];for(let e=0;e<l;e++)for(let t=0;t<l;t++){let r=e*l+t;a[e][t].mine?n.has(r)&&i.push([e,t]):n.has(r)||s.push([e,t])}if(!i.length)return a;let c=(o=r^t[0]<<16^t[1],function(){let e=o+=0x6d2b79f5;return e=Math.imul(e^e>>>15,1|e),(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/0x100000000});for(let e=s.length-1;e>0;e--){let t=Math.floor(c()*(e+1));[s[e],s[t]]=[s[t],s[e]]}let u=0;for(let[e,t]of i){for(;u<s.length&&a[s[u][0]][s[u][1]].mine;)u++;let r=s[u];if(!r)break;let[o,l]=r;a[e][t].mine=!1,a[o][l].mine=!0,u++}return f(a),a}function g(e,t){let r=e.length,o=Array.from({length:r},()=>Array(r).fill(!1)),l=[];(t||[]).forEach(e=>{let[t,n]=e;t>=0&&t<r&&n>=0&&n<r&&!o[t][n]&&(o[t][n]=!0,l.push([t,n]))});let n=[],a=!1,i=0;for(;i<l.length;){let[t,s]=l[i++],c=e[t][s];if(!c.revealed&&!c.flagged){if(n.push([t,s]),c.mine){a=!0;continue}if(0===c.adjacent)for(let e=-1;e<=1;e++)for(let n=-1;n<=1;n++){if(0===e&&0===n)continue;let a=t+e,i=s+n;a>=0&&a<r&&i>=0&&i<r&&!o[a][i]&&(o[a][i]=!0,l.push([a,i]))}}}return{cells:n,hit:a}}function h(e,t,r){let o=[];for(let l=-1;l<=1;l++)for(let n=-1;n<=1;n++){if(0===l&&0===n)continue;let a=t+l,i=r+n;a>=0&&a<e&&i>=0&&i<e&&o.push([a,i])}return o}let p=(e,t)=>"".concat(e,",").concat(t),v=function(e){if(!e)return{risk:[],forcedSafe:new Set,forcedMines:new Set};let t=e.length,r=Array.from({length:t},()=>Array(t).fill(0)),o=new Set,l=new Set;for(let n=0;n<t;n++)for(let a=0;a<t;a++){let i=e[n][a];if(!i.revealed||i.mine||0===i.adjacent)continue;let s=h(t,n,a),c=0,u=[];if(s.forEach(t=>{let[r,o]=t,l=e[r][o];l.flagged?c++:l.revealed||u.push([r,o])}),!u.length)continue;let d=Math.max(0,i.adjacent-c);0===d?u.forEach(e=>{let[t,r]=e;return o.add(p(t,r))}):d===u.length&&u.forEach(e=>{let[t,r]=e;return l.add(p(t,r))});let f=Math.min(1,d/u.length);u.forEach(e=>{let[t,o]=e;r[t][o]=Math.max(r[t][o],f)})}return{risk:r,forcedSafe:o,forcedMines:l}};function x(e){var t;let{size:r=8,mines:o=10,startX:l=0,startY:n=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=u(r,o,{start:[l,n]}),i=Array.from({length:a.size},()=>Array.from({length:a.size},()=>({mine:!1,revealed:!1,flagged:!1,question:!1,adjacent:0}))),s=(t=e,function(){let e=t+=0x6d2b79f5;return e=Math.imul(e^e>>>15,1|e),(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/0x100000000}),c=Array.from({length:a.size*a.size},(e,t)=>t);for(let e=c.length-1;e>0;e--){let t=Math.floor(s()*(e+1));[c[e],c[t]]=[c[t],c[e]]}let m=d(a.size,[l,n]),g=0;for(let e of c){if(g>=a.mines)break;if(m.has(e))continue;let t=Math.floor(e/a.size),r=e%a.size;i[t][r].mine=!0,g++}return f(i),i}let b={beginner:{label:"Beginner",size:8,mines:10},intermediate:{label:"Intermediate",size:16,mines:40},expert:{label:"Expert",size:22,mines:99}},w=["#0000ff","#008000","#ff0000","#000080","#800000","#008080","#000000","#808080"],y=e=>e.map(e=>e.map(e=>({...e}))),j=e=>{if(!e)return{r:0,g:0,b:0};let t=e.trim();if(t.startsWith("#")){let e=t.slice(1),r=Number.parseInt(3===e.length?e.split("").map(e=>e+e).join(""):e,16);return{r:r>>16&255,g:r>>8&255,b:255&r}}let r=t.match(/rgba?\(([^)]+)\)/i);if(r){let e=r[1].split(",").map(e=>Number.parseFloat(e.trim())).filter(e=>!Number.isNaN(e));return{r:e[0]||0,g:e[1]||0,b:e[2]||0}}return{r:0,g:0,b:0}},S=(e,t,r)=>({r:Math.round(e.r*(1-r)+t.r*r),g:Math.round(e.g*(1-r)+t.g*r),b:Math.round(e.b*(1-r)+t.b*r)}),M=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(t,")")},N=(e,t)=>M(S(j(e),{r:255,g:255,b:255},t)),k=(e,t)=>M(S(j(e),{r:0,g:0,b:0},t)),D=()=>{var e;let t=(0,l.useRef)(null),d=(0,l.useRef)(null),f=(0,l.useRef)(null),p=()=>{"function"==typeof Worker?(f.current=new Worker(r.tu(new URL(r.p+r.u(4438),r.b))),f.current.onmessage=e=>{let{id:t}=e.data||{},r=eH.current.get(t);r&&(eH.current.delete(t),r(e.data))}):f.current=null},[S,D]=(0,l.useState)("beginner"),[E,I]=(0,l.useState)(b.beginner),[C,R]=(0,l.useState)(null),[z,L]=(0,l.useState)("ready"),[B,A]=(0,l.useState)(()=>Math.floor(0x80000000*Math.random())),[O,q]=(0,l.useState)(""),[F,P]=(0,l.useState)(null),[T,V]=(0,l.useState)(0),[W,_]=(0,l.useState)({}),[U,J]=(0,l.useState)(0),[G,K]=(0,l.useState)(null),[X,Y]=(0,l.useState)(""),[Q,$]=(0,l.useState)(0),[H,Z]=(0,l.useState)({beginner:[],intermediate:[],expert:[]}),[ee,et]=(0,l.useState)(null),[er,eo]=(0,l.useState)(!1),[el,en]=(0,l.useState)(0),[ea,ei]=(0,l.useState)(!0),[es,ec]=(0,l.useState)(""),eu=(0,l.useRef)(!1),ed=(0,l.useRef)({surface:"#1f2937",surfaceMuted:"#111827",surfaceRaised:"#27303f",accent:"#0f94d2",border:"#0b1621",text:"#f5faff"}),ef=(0,l.useRef)([]),em=(0,l.useRef)("undefined"!=typeof performance?performance.now():0),[eg,eh]=(0,a.default)("minesweeperAssist",!1),ep=(0,l.useMemo)(()=>eg&&C?v(C).risk:null,[C,eg]),[ev,ex]=(0,a.default)("minesweeperQuestion",!1),[eb,ew]=(0,l.useState)(!1),ey=(0,l.useRef)(null),ej=(0,l.useRef)(null),[eS,eM]=(0,l.useState)(!1),[eN,ek]=(0,l.useState)(!1),[eD,eE]=(0,l.useState)(!1),[eI,eC]=(0,l.useState)({x:0,y:0}),[eR,ez]=(0,l.useState)(!1),eL=C?C.length:E.size,eB=32*eL,eA=Math.max(E.mines-Q,0),eO=null!=(e=W[S])?e:null,eq=H[S]||[],eF=T.toFixed(2),eP=null!==G?G.toFixed(2):"--",eT=null!==eO?eO.toFixed(2):"--",eV=(0,l.useRef)(!1),eW=(0,l.useRef)(!1),e_=(0,l.useRef)(!1),eU=(0,l.useRef)({}),[eJ,eG]=(0,l.useState)(""),eK=(e,t,r)=>Math.min(r,Math.max(t,e)),eX=(e,t,r,o,l)=>"".concat(e.toString(36),"-").concat(t,"-").concat(r,"-").concat(o,"-").concat(l);(0,l.useEffect)(()=>(p(),()=>{var e;return null==(e=f.current)?void 0:e.terminate()}),[]),(0,l.useEffect)(()=>{try{let e=localStorage.getItem("minesweeper-scoreboard");if(e){let t=JSON.parse(e),r={beginner:[],intermediate:[],expert:[],...t};Object.keys(r).forEach(e=>{r[e]=(r[e]||[]).map(e=>({...e,time:"number"==typeof e.time?e.time:Number(e.time)||0,date:e.date||Date.now()})).filter(e=>e.time>0).sort((e,t)=>e.time-t.time).slice(0,5)}),Z(r),_({beginner:r.beginner.length?r.beginner[0].time:null,intermediate:r.intermediate.length?r.intermediate[0].time:null,expert:r.expert.length?r.expert[0].time:null})}else{let e=localStorage.getItem("minesweeper-best-time");if(e){let t=parseFloat(e);if(!Number.isNaN(t)){let e={beginner:[{time:t,date:Date.now(),label:"Legacy Personal Best"}],intermediate:[],expert:[]};localStorage.setItem("minesweeper-scoreboard",JSON.stringify(e)),Z(e),_({beginner:t,intermediate:null,expert:null})}}}}catch(e){console.error("Failed to load Minesweeper scoreboard",e)}},[]),(0,l.useEffect)(()=>{let e=document.documentElement,t=()=>{let t=getComputedStyle(e);ed.current={surface:t.getPropertyValue("--color-surface").trim()||ed.current.surface,surfaceMuted:t.getPropertyValue("--color-surface-muted").trim()||ed.current.surfaceMuted,surfaceRaised:t.getPropertyValue("--color-surface-raised").trim()||ed.current.surfaceRaised,accent:t.getPropertyValue("--color-accent").trim()||ed.current.accent,border:t.getPropertyValue("--color-border").trim()||ed.current.border,text:t.getPropertyValue("--color-text").trim()||ed.current.text}};if(t(),"undefined"!=typeof MutationObserver){let r=new MutationObserver(t);return r.observe(e,{attributes:!0,attributeFilter:["data-theme"]}),()=>r.disconnect()}},[]),(0,l.useEffect)(()=>{{let t=localStorage.getItem("minesweeper-state");if(t)try{let r=JSON.parse(t);if(r.config){I(r.config);let e=Object.entries(b).find(e=>{let[,t]=e;return t.size===r.config.size&&t.mines===r.config.mines});e&&D(e[0])}else r.difficulty&&b[r.difficulty]&&(I(b[r.difficulty]),D(r.difficulty));if(r.board){var e;let t=null==(e=r.board[0])?void 0:e[0],o=Array.isArray(t)?s(r.board):r.board;if(R(o),eM(!0),!r.config){let e=o.length,t=Object.entries(b).find(t=>{let[,r]=t;return r.size===e});t?(D(t[0]),I(b[t[0]])):I(t=>({...t,size:e}))}}else eM(!1);r.status&&L(r.status),void 0!==r.seed&&A(r.seed),r.shareCode&&q(r.shareCode),r.bv&&J(r.bv),void 0!==r.bvps&&K(r.bvps),r.flags&&$(r.flags),r.paused&&eo(r.paused),"playing"!==r.status||r.paused?(r.startTime&&P(r.startTime),r.elapsed&&V(r.elapsed)):(P(Date.now()-1e3*(r.elapsed||0)),V(r.elapsed||0))}catch(e){eM(!1)}}},[]),(0,l.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("seed");if(e){let t=parseInt(e,36);if(!Number.isNaN(t))return void A(t)}let t=localStorage.getItem("minesweeper-state");if(t)try{let e=JSON.parse(t);if(void 0!==e.seed)return void A(e.seed)}catch(e){}(0,c.getDailySeed)("minesweeper").then(e=>A((e=>{let t=0;for(let r=0;r<e.length;r+=1)t=Math.imul(31,t)+e.charCodeAt(r);return t>>>0})(e)))},[]),(0,l.useEffect)(()=>{let e=new URLSearchParams(window.location.search);e.set("seed",B.toString(36)),window.history.replaceState({},"","".concat(window.location.pathname,"?").concat(e.toString()))},[B]),(0,l.useEffect)(()=>{if("playing"===z&&!er){let e=setInterval(()=>{V((Date.now()-F)/1e3)},100);return()=>clearInterval(e)}},[z,F,er]),(0,l.useEffect)(()=>{{let e=window.matchMedia("(prefers-reduced-motion: reduce)");eu.current=e.matches;let t=e=>eu.current=e.matches;return e.addEventListener("change",t),()=>e.removeEventListener("change",t)}},[]),(0,l.useEffect)(()=>{let e=t.current;if(!e)return;let r=e.getContext("2d");if(!r)return;e.width=eB,e.height=eB,e.style.width="100%",e.style.maxWidth="".concat(eB,"px"),e.style.height="auto";let o={revealed:!1,flagged:!1,question:!1,adjacent:0,mine:!1},l=()=>{let e="undefined"!=typeof performance?performance.now():Date.now(),t=Math.min((e-em.current)/1e3,.08);em.current=e,r.clearRect(0,0,eB,eB);let{surface:a,surfaceMuted:i,surfaceRaised:s,accent:c,border:u,text:d}=ed.current,f=eB/eL;r.font="".concat(Math.max(12,.6*f),"px 'Ubuntu Mono', monospace"),r.textAlign="center",r.textBaseline="middle";for(let e=0;e<eL;e++)for(let t=0;t<eL;t++){let l=C?C[e][t]:o,n=t*f,g=e*f,h=eR&&eI.x===e&&eI.y===t&&!l.revealed,p=h&&(eV.current||eW.current),v=r.createLinearGradient(n,g,n,g+f);if(l.revealed)v.addColorStop(0,N(s||i||a,.15)),v.addColorStop(1,k(s||i||a,.12));else{let e=h?s:a;v.addColorStop(0,p?k(e,.28):N(e,.1)),v.addColorStop(1,p?k(e,.38):k(e,.2))}r.fillStyle=v,r.fillRect(n,g,f,f),r.strokeStyle=k(u||a,l.revealed?.2:.4),r.lineWidth=Math.max(1,.05*f),r.strokeRect(n,g,f,f),!l.revealed&&h&&(r.save(),r.fillStyle=M(j(c),.14),r.fillRect(n,g,f,f),r.strokeStyle=c,r.lineWidth=Math.max(1,.08*f),r.strokeRect(n+1,g+1,f-2,f-2),r.restore());let x="".concat(e,",").concat(t);if(l.revealed)l.mine?r.fillText("\uD83D\uDCA3",n+f/2,g+f/2):l.adjacent>0&&(r.fillStyle=w[l.adjacent-1]||d,r.fillText(l.adjacent,n+f/2,g+f/2));else{var m;let o=eU.current[x];if(l.flagged||o){let e=1;if(o){let t=Math.min((Date.now()-o.start)/220,1);e=o.dir>0?t:1-t,t>=1&&delete eU.current[x]}(l.flagged||e>0)&&(r.save(),r.translate(n+f/2,g+f/2),r.scale(e,e),r.fillText("\uD83D\uDEA9",0,0),r.restore())}else if(l.question)r.fillStyle=d,r.fillText("?",n+f/2,g+f/2);else if((null==ep||null==(m=ep[e])?void 0:m[t])!==void 0){let o=ep[e][t];o>0&&(r.fillStyle=M({r:248,g:113,b:113},Math.min(.45,.5*o)),r.fillRect(n,g,f,f))}}l.exploded?(r.save(),r.fillStyle="rgba(248, 113, 113, 0.55)",r.fillRect(n,g,f,f),r.fillStyle="#111827",r.fillText("\uD83D\uDCA5",n+f/2,g+f/2),r.restore()):l.wrongFlag&&(r.save(),r.fillStyle="rgba(248, 113, 113, 0.3)",r.fillRect(n,g,f,f),r.fillStyle="#f87171",r.fillText("❌",n+f/2,g+f/2),r.restore())}ef.current=ef.current.filter(e=>{let o=e.life-t;if(o<=0)return!1;e.life=o,e.x+=e.vx*t,e.y+=e.vy*t,e.vy+=e.gravity*t;let l=Math.max(e.life/(e.maxLife||.001),0);return r.save(),r.globalAlpha=l,r.fillStyle=e.color,r.beginPath(),r.arc(e.x,e.y,e.size,0,2*Math.PI),r.fill(),r.restore(),!0}),er&&"playing"===z&&(r.fillStyle="rgba(0,0,0,0.55)",r.fillRect(0,0,eB,eB),r.fillStyle=d,r.font="".concat(Math.max(16,f),"px 'Ubuntu Mono', monospace"),r.fillText("Paused",eB/2,eB/2)),n=requestAnimationFrame(l)},n=requestAnimationFrame(l),a=()=>{e.width=eB,e.height=eB,e.style.maxWidth="".concat(eB,"px")};return window.addEventListener("resize",a),()=>{cancelAnimationFrame(n),window.removeEventListener("resize",a)}},[C,z,er,eg,eI,eR,eB,eL]),(0,l.useEffect)(()=>{if(!ev&&C){let e=y(C),t=!1,r=e.length;for(let o=0;o<r;o++)for(let l=0;l<r;l++)e[o][l].question&&(e[o][l].question=!1,t=!0);t&&R(e)}},[ev,C]),(0,l.useEffect)(()=>{try{let e={board:C?C.map(e=>e.map(e=>[+!!e.mine,+!!e.revealed,+!!e.flagged,+!!e.question,e.adjacent])):null,status:z,seed:B,shareCode:O,startTime:F,elapsed:T,bv:U,bvps:G,flags:Q,paused:er,difficulty:S,config:E};localStorage.setItem("minesweeper-state",JSON.stringify(e)),eM(!!C)}catch(e){}},[C,z,B,O,F,T,U,G,Q,er,S,E]),(0,l.useEffect)(()=>{try{localStorage.setItem("minesweeper-scoreboard",JSON.stringify(H))}catch(e){console.error("Failed to persist Minesweeper scoreboard",e)}},[H]),(0,l.useEffect)(()=>{if(!eJ)return;let e=setTimeout(()=>eG(""),2400);return()=>clearTimeout(e)},[eJ]),(0,l.useEffect)(()=>{var e;if(!eb)return;ej.current=document.activeElement;let t=null==(e=ey.current)?void 0:e.querySelector("input, button, select, textarea");null==t||t.focus();let r=e=>{"Escape"===e.key&&(e.preventDefault(),ew(!1))};return window.addEventListener("keydown",r),()=>{var e;window.removeEventListener("keydown",r),(null==(e=ej.current)?void 0:e.focus)&&ej.current.focus()}},[eb]);let eY=e=>{if(!ea)return;d.current||(d.current=new(window.AudioContext||window.webkitAudioContext));let t=d.current,r=t.createOscillator(),o=t.createGain();r.type="square",r.frequency.value="boom"===e?120:"flag"===e?330:440,r.connect(o),o.connect(t.destination),r.start(),r.stop(t.currentTime+.15)},eQ=function(e,t,r,o){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:110;if(eu.current)return;let n=Array.from({length:r},()=>{let r=Math.random()*Math.PI*2,n=l*(.4+.6*Math.random()),a=.55+.35*Math.random();return{x:e,y:t,vx:Math.cos(r)*n,vy:Math.sin(r)*n,life:a,maxLife:a,size:1.8+1.8*Math.random(),color:o[Math.floor(Math.random()*o.length)],gravity:260}});ef.current=[...ef.current,...n]},e$=e=>{if(!e.flat().every(e=>e.revealed||e.mine))return;let t=y(e),r=0;t.forEach(e=>{e.forEach(e=>{e.mine?(e.flagged||(e.flagged=!0),r+=1):e.flagged=!1,e.question=!1,e.exploded=!1,e.wrongFlag=!1})}),R(t),$(r),L("won");let o=(Date.now()-F)/1e3;V(o);let l=i(e);J(l),K(o>0?l/o:l);let n={time:o,date:Date.now(),seed:O||B.toString(36),bv:l,difficulty:S};Z(e=>{let t={beginner:e.beginner||[],intermediate:e.intermediate||[],expert:e.expert||[]},r=[...t[S]||[],n].sort((e,t)=>e.time-t.time).slice(0,5);return t[S]=r,_(e=>({...e,[S]:r.length?r[0].time:null})),t}),et(n)},eH=(0,l.useRef)(new Map),eZ=(0,l.useRef)(0),e0=(e,t)=>{if(f.current){let r=eZ.current++;return new Promise(o=>{eH.current.set(r,o),f.current.postMessage({id:r,board:e,cells:t})})}return Promise.resolve(g(e,t))},e1=async(e,t,r,o)=>{let{cells:l}=await e0(e,[[t,r]]);(t=>{let r=0,l=()=>{let n=0;for(;r<t.length&&n<8;){let[o,l]=t[r++],a=e[o][l];!a.revealed&&!a.flagged&&(a.revealed=!0,n++)}R(y(e)),r<t.length?requestAnimationFrame(l):null==o||o(t.length)};requestAnimationFrame(l)})(l)},e2=(e,t)=>{var r;let o=y(e);o.forEach((e,r)=>{e.forEach((e,o)=>{e.mine?e.revealed=!0:e.flagged&&(e.wrongFlag=!0),e.question=!1,e.exploded=!1,t&&t[0]===r&&t[1]===o&&(e.exploded=!0)})}),R(o),L("lost");let l=(Date.now()-F)/1e3;V(l);let n=i(o);J(n),K(l>0?n/l:n),eY("boom"),t&&(r=t[0],eQ((t[1]+.5)*32,(r+.5)*32,24,["#f87171","#facc15","#f97316"],160)),ec("Boom! Game over")},e3=async(e,t)=>{eU.current={};let r=u(E.size,E.mines,{start:[e,t]}),o=m(x(B,{size:r.size,mines:r.mines,startX:e,startY:t}),[e,t],B);I(e=>({...e,...r})),R(o),L("playing"),P(Date.now()),q(eX(B,r.size,r.mines,e,t)),J(i(o)),K(null),$(0),eo(!1);let l=e=>{ec("Revealed ".concat(e," cells")),e$(o)};if(eu.current){let{cells:r}=await e0(o,[[e,t]]);r.forEach(e=>{let[t,r]=e;o[t][r].revealed=!0}),R(y(o)),l(r.length)}else e1(o,e,t,l)},e5=async(e,t)=>{if("lost"===z||"won"===z||er)return;if(!C){await e3(e,t),eY("reveal");return}let r=y(C),o=r[e][t];if(o.revealed)return void await e4(e,t);if(o.mine){let{cells:o}=await e0(r,[[e,t]]);o.forEach(e=>{let[t,o]=e;r[t][o].revealed=!0}),e2(r,[e,t]);return}if(eY("reveal"),0===o.adjacent&&!eu.current)return void e1(r,e,t,e=>{ec("Revealed ".concat(e," cells")),e$(r)});{let{cells:o}=await e0(r,[[e,t]]);o.forEach(e=>{let[t,o]=e;r[t][o].revealed=!0}),ec("Revealed cell at row ".concat(e+1,", column ").concat(t+1))}R(r),e$(r)},e8=(e,t)=>{if("playing"!==z||er||!C)return;let r=y(C),o=r[e][t];o.revealed||(o.flagged?(o.flagged=!1,$(e=>e-1),eU.current["".concat(e,",").concat(t)]={start:Date.now(),dir:-1},ev?(o.question=!0,ec("Question marked cell at row ".concat(e+1,", column ").concat(t+1))):ec("Unflagged cell at row ".concat(e+1,", column ").concat(t+1))):o.question?(o.question=!1,ec("Cleared mark at row ".concat(e+1,", column ").concat(t+1))):(o.flagged=!0,$(e=>e+1),eU.current["".concat(e,",").concat(t)]={start:Date.now(),dir:1},ec("Flagged cell at row ".concat(e+1,", column ").concat(t+1)),eQ((t+.5)*32,(e+.5)*32,14,[ed.current.accent,"#ffffff"],90)),R(r),eY("flag"))},e4=async(e,t)=>{if("playing"!==z||er||!C)return;let r=function(e,t,r){var o;let l,n=null==(o=e[t])?void 0:o[r];if(!n||!n.revealed||0===n.adjacent||(l=0,h(e.length,t,r).forEach(t=>{let[r,o]=t;e[r][o].flagged&&l++}),l!==n.adjacent))return null;let a=h(e.length,t,r).filter(t=>{let[r,o]=t,l=e[r][o];return!l.revealed&&!l.flagged});return a.length?g(e,a):{cells:[],hit:!1}}(C,e,t);if(!r)return;let{hit:o,cells:l}=r,n=function(e,t){let r=e.map(e=>e.map(e=>({...e})));return t.forEach(e=>{let[t,o]=e,l=r[t][o];l.flagged||(l.revealed=!0,l.question=!1)}),r}(C,l);if(R(n),o){if(l.length){let[e,t]=l[0];e2(n,[e,t]);return}e2(n,null);return}e$(n)},e6=()=>{var e;null==(e=f.current)||e.terminate(),p(),eU.current={},R(null),L("ready"),A(Math.floor(0x80000000*Math.random())),q(""),P(null),V(0),J(0),K(null),Y(""),$(0),eo(!1),ec(""),ek(!1),eE(!1),eC({x:0,y:0}),ez(!1),et(null)},e7=async()=>{var e;if(!X)return;let t=X.trim().split("-"),r=parseInt(t[0],36);if(Number.isNaN(r))return;let o=t.length>=5?parseInt(t[1],10):E.size,l=t.length>=5?parseInt(t[2],10):E.mines,n=t.length>=5?parseInt(t[3],10):parseInt(t[1],10),a=t.length>=5?parseInt(t[4],10):parseInt(t[2],10),s=u(o,l,{start:[Number.isNaN(n)?Math.floor(o/2):n,Number.isNaN(a)?Math.floor(o/2):a]}),c=Number.isNaN(n)?Math.floor(s.size/2):eK(n,0,s.size-1),d=Number.isNaN(a)?Math.floor(s.size/2):eK(a,0,s.size-1);if(null==(e=f.current)||e.terminate(),p(),eU.current={},A(r),q(""),R(null),L("ready"),P(null),V(0),J(0),K(null),$(0),eo(!1),1===t.length)return void Y("");if(3===t.length||t.length>=5){I(e=>({...e,...s}));let e=((e,t)=>{var r,o;return null!=(o=null==(r=Object.entries(b).find(r=>{let[,o]=r;return o.size===e&&o.mines===t}))?void 0:r[0])?o:null})(s.size,s.mines);e&&D(e);let t=m(x(r,{size:s.size,mines:s.mines,startX:c,startY:d}),[c,d],r);R(t),L("playing"),P(Date.now()),q(eX(r,s.size,s.mines,c,d)),J(i(t)),$(0);let o=e=>{ec("Revealed ".concat(e," cells")),e$(t)};if(eu.current){let{cells:e}=await e0(t,[[c,d]]);e.forEach(e=>{let[r,o]=e;t[r][o].revealed=!0}),R(y(t)),o(e.length)}else e1(t,c,d,o)}Y("")},e9=()=>{"playing"===z&&(er?(eo(!1),P(e=>e+(Date.now()-el))):(eo(!0),en(Date.now())))},te="won"===z?"\uD83D\uDE0E":"lost"===z?"\uD83D\uDE35":eN?"\uD83D\uDE2E":"\uD83D\uDE42";return(0,o.jsx)(n.default,{gameId:"minesweeper",children:(0,o.jsxs)("div",{className:"relative flex h-full w-full justify-center overflow-y-auto bg-[color:var(--color-secondary)] p-4 text-[color:var(--color-text)]",children:[(0,o.jsxs)("div",{className:"flex w-full max-w-4xl flex-col gap-4",children:[(0,o.jsxs)("div",{className:"rounded-2xl border border-[color:var(--color-border)] bg-[color:var(--color-surface-raised)] p-4 shadow-lg shadow-black/20",children:[(0,o.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,o.jsxs)("div",{className:"flex items-center gap-3",children:[(0,o.jsx)("button",{className:"flex h-12 w-12 items-center justify-center rounded-xl border text-2xl shadow-inner transition active:translate-y-[1px] ".concat(eD?"border-[color:var(--color-accent)] bg-[color:var(--color-surface)]":"border-[color:var(--color-border)] bg-[color:var(--color-surface-muted)] hover:bg-[color:var(--color-surface)]"),onMouseDown:()=>{eE(!0),ek(!0)},onMouseUp:()=>{eE(!1),ek(!1),e6()},onMouseLeave:()=>{eE(!1),ek(!1)},"aria-label":"Reset game",children:te}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-sm font-mono text-[color:var(--kali-text-subtle)]",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("span",{className:"text-[color:var(--color-accent)]",children:"⏱"}),(0,o.jsxs)("span",{children:[eF,"s"]})]}),(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("span",{className:"text-[color:var(--color-accent)]",children:"\uD83C\uDFC1"}),(0,o.jsx)("span",{children:"--"===eP?"--":"".concat(eP)})]}),(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("span",{className:"text-[color:var(--color-accent)]",children:"\uD83E\uDDE8"}),(0,o.jsx)("span",{children:eA})]}),(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("span",{className:"text-[color:var(--color-accent)]",children:"⭐"}),(0,o.jsxs)("span",{children:[eT,"s"]})]})]})]}),(0,o.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:Object.entries(b).map(e=>{let[t,r]=e;return(0,o.jsx)("button",{onClick:()=>(e=>{b[e]&&(D(e),I(b[e]),e6())})(t),"aria-pressed":S===t,className:"rounded-full border px-3 py-1 text-xs font-semibold uppercase tracking-wide transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--color-focus-ring)] ".concat(S===t?"border-transparent bg-[color:var(--color-accent)] text-[color:var(--color-inverse)] shadow-sm":"border-[color:var(--color-border)] bg-[color:var(--color-surface)] text-[color:var(--kali-text-subtle)] hover:bg-[color:var(--color-surface-muted)]"),children:r.label},t)})})]}),(0,o.jsxs)("div",{className:"mt-4 flex flex-wrap items-center gap-2 text-sm",children:[(0,o.jsx)("span",{className:"rounded-full bg-[color:var(--color-surface-muted)] px-2 py-1 font-semibold uppercase tracking-wide text-[color:var(--color-accent)]",children:"Seed"}),(0,o.jsx)("code",{className:"rounded bg-[color:var(--color-surface)] px-2 py-1 font-mono text-[color:var(--kali-text)]",children:B.toString(36)}),O&&(0,o.jsx)("button",{onClick:()=>{"undefined"!=typeof navigator&&O&&navigator.clipboard.writeText(O).then(()=>{eG("Share code copied to clipboard."),ec("Share code copied to clipboard.")}).catch(()=>{eG("Unable to copy share code."),ec("Unable to copy share code.")})},className:"rounded-full border border-[color:var(--color-border)] bg-[color:var(--color-surface)] px-3 py-1 text-xs font-semibold uppercase tracking-wide text-[color:var(--color-accent)] transition hover:bg-[color:var(--color-surface-muted)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--color-focus-ring)]",children:"Copy share"}),eJ&&(0,o.jsx)("span",{className:"rounded-full bg-[color:var(--color-surface-muted)] px-2 py-1 text-xs text-[color:var(--kali-text-subtle)]",children:eJ})]}),(0,o.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-2 text-sm",children:[(0,o.jsx)("label",{htmlFor:"minesweeper-share-input",className:"font-medium text-[color:var(--kali-text-subtle)]",children:"Load seed or code"}),(0,o.jsx)("input",{id:"minesweeper-share-input",className:"min-w-[160px] flex-1 rounded-lg border border-[color:var(--color-border)] bg-[color:var(--color-surface)] px-3 py-1.5 font-mono text-[color:var(--color-text)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--color-focus-ring)]",value:X,onChange:e=>Y(e.target.value),placeholder:"seed-size-mines-x-y","aria-label":"Load seed or code"}),(0,o.jsx)("button",{onClick:e7,className:"rounded-lg bg-[color:var(--color-accent)] px-3 py-1.5 text-xs font-semibold uppercase tracking-wide text-[color:var(--color-inverse)] shadow-sm transition hover:bg-[color:color-mix(in_srgb,var(--color-accent)_88%,transparent)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--color-focus-ring)]",children:"Load"})]})]}),(0,o.jsxs)("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1fr)_280px]",children:[(0,o.jsxs)("div",{className:"rounded-2xl border border-[color:var(--color-border)] bg-[color:var(--color-surface-raised)] p-4 shadow-lg shadow-black/20",children:[(0,o.jsx)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:(0,o.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[eS&&(0,o.jsx)("button",{onClick:()=>{let e=localStorage.getItem("minesweeper-state");if(e)try{var t,r;let o=JSON.parse(e);if(o.config){let e=u(o.config.size,o.config.mines);I(e);let t=Object.entries(b).find(t=>{let[,r]=t;return r.size===e.size&&r.mines===e.mines});t&&D(t[0])}if(o.board){let e=null==(t=o.board[0])?void 0:t[0],r=Array.isArray(e)?s(o.board):o.board;if(R(r),eM(!0),!o.config){let e=Object.entries(b).find(e=>{let[,t]=e;return t.size===r.length});e&&(D(e[0]),I(b[e[0]]))}}else eM(!1);if(o.status&&L(o.status),void 0!==o.seed&&A(o.seed),void 0!==o.shareCode&&q(o.shareCode),void 0!==o.bv&&J(o.bv),void 0!==o.bvps&&K(o.bvps),void 0!==o.flags&&$(o.flags),void 0!==o.paused&&eo(o.paused),"playing"!==o.status||o.paused)void 0!==o.startTime&&P(o.startTime),void 0!==o.elapsed&&V(o.elapsed);else{let e=null!=(r=o.elapsed)?r:0;P(Date.now()-1e3*e),V(e)}}catch(e){eM(!1)}},className:"rounded-lg border border-[color:var(--color-border)] bg-[color:var(--color-surface)] px-3 py-1.5 text-xs font-semibold uppercase tracking-wide text-[color:var(--kali-text-subtle)] transition hover:bg-[color:var(--color-surface-muted)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--color-focus-ring)]",children:"Load save"}),(0,o.jsx)("button",{onClick:e9,className:"rounded-lg border border-[color:var(--color-border)] bg-[color:var(--color-surface)] px-3 py-1.5 text-xs font-semibold uppercase tracking-wide text-[color:var(--kali-text-subtle)] transition hover:bg-[color:var(--color-surface-muted)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--color-focus-ring)]",children:er?"Resume":"Pause"}),(0,o.jsx)("button",{onClick:()=>ei(e=>!e),className:"rounded-lg border border-[color:var(--color-border)] bg-[color:var(--color-surface)] px-3 py-1.5 text-xs font-semibold uppercase tracking-wide text-[color:var(--kali-text-subtle)] transition hover:bg-[color:var(--color-surface-muted)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--color-focus-ring)]",children:ea?"Sound on":"Sound off"}),(0,o.jsx)("button",{onClick:()=>ew(!0),className:"rounded-lg border border-[color:var(--color-border)] bg-[color:var(--color-surface)] px-3 py-1.5 text-xs font-semibold uppercase tracking-wide text-[color:var(--color-accent)] transition hover:bg-[color:var(--color-surface-muted)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--color-focus-ring)]",children:"Settings"})]})}),(0,o.jsx)("div",{className:"mt-4 flex justify-center",children:(0,o.jsx)("canvas",{ref:t,width:eB,height:eB,onMouseDown:e=>{var r;null==(r=t.current)||r.focus();let o=t.current.getBoundingClientRect(),l=o.width/eL,n=o.height/eL,a=Math.min(eL-1,Math.max(0,Math.floor((e.clientX-o.left)/l))),i=Math.min(eL-1,Math.max(0,Math.floor((e.clientY-o.top)/n)));eC({x:i,y:a}),ez(!0),ek(!0),0===e.button?eV.current=!0:2===e.button?(eW.current=!0,e.preventDefault()):1===e.button&&e4(i,a)},onMouseUp:e=>{let r=t.current.getBoundingClientRect(),o=r.width/eL,l=r.height/eL,n=Math.min(eL-1,Math.max(0,Math.floor((e.clientX-r.left)/o))),a=Math.min(eL-1,Math.max(0,Math.floor((e.clientY-r.top)/l)));eC({x:a,y:n}),ek(!1),0===e.button?(eW.current?(e4(a,n),eW.current=!1,e_.current=!0):e_.current||e5(a,n),eV.current=!1):2===e.button&&(eV.current?(e4(a,n),eV.current=!1,e_.current=!0):e_.current||e8(a,n),eW.current=!1),eV.current||eW.current||(e_.current=!1)},onMouseMove:e=>{let r=t.current.getBoundingClientRect(),o=r.width/eL,l=r.height/eL,n=Math.min(eL-1,Math.max(0,Math.floor((e.clientX-r.left)/o)));eC({x:Math.min(eL-1,Math.max(0,Math.floor((e.clientY-r.top)/l))),y:n}),ez(!0)},onMouseLeave:()=>{eV.current=!1,eW.current=!1,e_.current=!1,ez(!1),ek(!1)},onContextMenu:e=>{e.preventDefault(),0===e.clientX&&0===e.clientY&&e8(eI.x,eI.y)},tabIndex:0,onKeyDown:e=>{let t=e.key.toLowerCase();"arrowup"===t?(e.preventDefault(),eC(e=>({x:Math.max(0,e.x-1),y:e.y})),ez(!0)):"arrowdown"===t?(e.preventDefault(),eC(e=>({x:Math.min(eL-1,e.x+1),y:e.y})),ez(!0)):"arrowleft"===t?(e.preventDefault(),eC(e=>({x:e.x,y:Math.max(0,e.y-1)})),ez(!0)):"arrowright"===t?(e.preventDefault(),eC(e=>({x:e.x,y:Math.min(eL-1,e.y+1)})),ez(!0)):"f"===t?(e.preventDefault(),e8(eI.x,eI.y)):" "===t||"enter"===t?(e.preventDefault(),e5(eI.x,eI.y)):"contextmenu"===t||"f10"===t&&e.shiftKey?(e.preventDefault(),e8(eI.x,eI.y)):"p"===t?(e.preventDefault(),e9()):"n"===t?(e.preventDefault(),e6()):"escape"===t&&eb&&(e.preventDefault(),ew(!1))},"aria-label":"Minesweeper grid",className:"w-full max-w-[min(100%,520px)] rounded-xl bg-[color:var(--color-surface)] shadow-inner focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-4 focus-visible:outline-[color:var(--color-focus-ring)]",style:{imageRendering:"pixelated",aspectRatio:"1 / 1"}})}),(0,o.jsx)("p",{className:"mt-4 text-center text-sm text-[color:var(--kali-text-muted)]",children:"ready"===z?"Click or press Enter on any tile to begin.":"playing"===z?er?"Game paused.":"Sweep the field, flag suspected mines with right click or F.":"won"===z?"Victory! 3BV ".concat(U," in ").concat(eF,"s."):"Boom! Game over. 3BV ".concat(U,".")})]}),(0,o.jsx)("aside",{className:"space-y-4",children:(0,o.jsxs)("div",{className:"rounded-2xl border border-[color:var(--color-border)] bg-[color:var(--color-surface-raised)] p-4 shadow-lg shadow-black/20",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("h3",{className:"text-sm font-semibold uppercase tracking-wide text-[color:var(--kali-text-subtle)]",children:"Leaderboard"}),(0,o.jsx)("span",{className:"rounded-full bg-[color:var(--color-surface-muted)] px-2 py-0.5 text-xs font-mono text-[color:var(--color-accent)]",children:b[S].label})]}),ee&&ee.difficulty===S&&(0,o.jsxs)("div",{className:"mt-3 rounded-lg border border-[color:var(--color-accent)] bg-[color:color-mix(in_srgb,var(--color-accent)_18%,transparent)] px-3 py-2 text-xs text-[color:var(--color-text)]",children:[(0,o.jsx)("strong",{className:"font-semibold",children:"New record:"})," ",ee.time.toFixed(2),"s on seed ",ee.seed]}),eq.length?(0,o.jsx)("ol",{className:"mt-3 space-y-2 text-sm font-mono",children:eq.map((e,t)=>{let r=ee&&ee.difficulty===S&&e.time===ee.time&&e.seed===ee.seed;return(0,o.jsxs)("li",{className:"flex items-center justify-between gap-2 rounded-lg border px-3 py-2 transition ".concat(r?"border-[color:var(--color-accent)] bg-[color:color-mix(in_srgb,var(--color-accent)_18%,transparent)] text-[color:var(--color-text)]":"border-transparent bg-[color:var(--color-surface)] text-[color:var(--kali-text-subtle)]"),children:[(0,o.jsxs)("span",{className:"flex items-center gap-3",children:[(0,o.jsxs)("span",{className:"text-[color:var(--color-accent)]",children:["#",t+1]}),(0,o.jsxs)("span",{children:[e.time.toFixed(2),"s"]})]}),(0,o.jsx)("span",{className:"text-xs text-[color:var(--kali-text-faint)]",children:new Date(e.date).toLocaleDateString()})]},"".concat(e.seed,"-").concat(e.time,"-").concat(e.date))})}):(0,o.jsx)("p",{className:"mt-3 text-sm text-[color:var(--kali-text-faint)]",children:"Sweep the board to earn a spot on the leaderboard."})]})})]})]}),eb&&(0,o.jsx)("div",{className:"absolute inset-0 z-30 flex items-center justify-center bg-[color:rgba(7,12,18,0.78)] backdrop-blur-sm",children:(0,o.jsxs)("div",{ref:ey,role:"dialog","aria-modal":"true","aria-labelledby":"minesweeper-settings-title",className:"w-full max-w-sm space-y-4 rounded-2xl border border-[color:var(--color-border)] bg-[color:var(--color-surface-raised)] p-5 text-sm shadow-xl shadow-black/30",children:[(0,o.jsx)("h2",{id:"minesweeper-settings-title",className:"text-center text-base font-semibold text-[color:var(--kali-text)]",children:"Game settings"}),(0,o.jsxs)("label",{className:"flex items-center justify-between gap-3 text-[color:var(--kali-text-subtle)]",children:[(0,o.jsx)("span",{children:"Enable question marks"}),(0,o.jsx)("input",{type:"checkbox",checked:ev,"aria-label":"Enable question marks",onChange:e=>ex(e.target.checked)})]}),(0,o.jsxs)("label",{className:"flex items-center justify-between gap-3 text-[color:var(--kali-text-subtle)]",children:[(0,o.jsx)("span",{children:"Show solver assist"}),(0,o.jsx)("input",{type:"checkbox",checked:eg,"aria-label":"Show solver assist",onChange:e=>eh(e.target.checked)})]}),(0,o.jsx)("button",{onClick:()=>ew(!1),className:"w-full rounded-lg bg-[color:var(--color-accent)] px-3 py-2 text-sm font-semibold uppercase tracking-wide text-[color:var(--color-inverse)] shadow-sm transition hover:bg-[color:color-mix(in_srgb,var(--color-accent)_88%,transparent)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--color-focus-ring)]",children:"Close"})]})}),(0,o.jsx)("div",{"aria-live":"polite",className:"sr-only",children:es})]})})}},31240:(e,t,r)=>{r.d(t,{getDailySeed:()=>u});var o=r(35326);let l="seeds",n="replays",a=null;function i(){return a||(a=(0,o.getDb)("kali-games",1,{upgrade(e){e.objectStoreNames.contains(l)||e.createObjectStore(l),e.objectStoreNames.contains(n)||e.createObjectStore(n)}})),a}async function s(e,t){try{let r=i();if(!r)return;let o=await r;return await o.get(l,"".concat(e,"-").concat(t))}catch(e){return}}async function c(e,t,r){try{let o=i();if(!o)return;let n=await o;await n.put(l,r,"".concat(e,"-").concat(t))}catch(e){}}async function u(e){let t=new Date().toISOString().split("T")[0];if("serviceWorker"in navigator&&navigator.serviceWorker.controller){let r=new MessageChannel,o=navigator.serviceWorker.controller;return new Promise(l=>{r.port1.onmessage=e=>{l(e.data.seed)},o.postMessage({type:"seed",game:e,date:t},[r.port2])})}let r=await s(e,t);return r||(r=Math.random().toString(36).slice(2,10),await c(e,t,r)),r}},31730:(e,t,r)=>{r.d(t,{hasIndexedDB:()=>l,isBrowser:()=>o});let o="undefined"!=typeof document,l=o&&"undefined"!=typeof indexedDB},33840:(e,t,r)=>{r.d(t,{default:()=>l});var o=r(14232);function l(e,t){let[r,l]=(0,o.useState)(()=>{try{let r=window.localStorage.getItem(e);return r?JSON.parse(r):t}catch(e){return t}});return(0,o.useEffect)(()=>{try{window.localStorage.setItem(e,JSON.stringify(r))}catch(e){}},[e,r]),[r,l]}},35326:(e,t,r)=>{let o,l;r.d(t,{getDb:()=>x});let n=new WeakMap,a=new WeakMap,i=new WeakMap,s=new WeakMap,c=new WeakMap,u={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return a.get(e);if("objectStoreNames"===t)return e.objectStoreNames||i.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return d(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function d(e){if(e instanceof IDBRequest){let t=new Promise((t,r)=>{let o=()=>{e.removeEventListener("success",l),e.removeEventListener("error",n)},l=()=>{t(d(e.result)),o()},n=()=>{r(e.error),o()};e.addEventListener("success",l),e.addEventListener("error",n)});return t.then(t=>{t instanceof IDBCursor&&n.set(t,e)}).catch(()=>{}),c.set(t,e),t}if(s.has(e))return s.get(e);let t=function(e){if("function"==typeof e)return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(l||(l=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(f(this),t),d(n.get(this))}:function(...t){return d(e.apply(f(this),t))}:function(t,...r){let o=e.call(f(this),t,...r);return i.set(o,t.sort?t.sort():[t]),d(o)};return e instanceof IDBTransaction&&function(e){if(a.has(e))return;let t=new Promise((t,r)=>{let o=()=>{e.removeEventListener("complete",l),e.removeEventListener("error",n),e.removeEventListener("abort",n)},l=()=>{t(),o()},n=()=>{r(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",l),e.addEventListener("error",n),e.addEventListener("abort",n)});a.set(e,t)}(e),(o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(t=>e instanceof t)?new Proxy(e,u):e}(e);return t!==e&&(s.set(e,t),c.set(t,e)),t}let f=e=>c.get(e),m=["get","getKey","getAll","getAllKeys","count"],g=["put","add","delete","clear"],h=new Map;function p(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(h.get(t))return h.get(t);let r=t.replace(/FromIndex$/,""),o=t!==r,l=g.includes(r);if(!(r in(o?IDBIndex:IDBObjectStore).prototype)||!(l||m.includes(r)))return;let n=async function(e,...t){let n=this.transaction(e,l?"readwrite":"readonly"),a=n.store;return o&&(a=a.index(t.shift())),(await Promise.all([a[r](...t),l&&n.done]))[0]};return h.set(t,n),n}u=(e=>({...e,get:(t,r,o)=>p(t,r)||e.get(t,r,o),has:(t,r)=>!!p(t,r)||e.has(t,r)}))(u);var v=r(31730);function x(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;return v.hasIndexedDB?function(e,t,{blocked:r,upgrade:o,blocking:l,terminated:n}={}){let a=indexedDB.open(e,t),i=d(a);return o&&a.addEventListener("upgradeneeded",e=>{o(d(a.result),e.oldVersion,e.newVersion,d(a.transaction),e)}),r&&a.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),i.then(e=>{n&&e.addEventListener("close",()=>n()),l&&e.addEventListener("versionchange",e=>l(e.oldVersion,e.newVersion,e))}).catch(()=>{}),i}(e,t,r):null}}}]);