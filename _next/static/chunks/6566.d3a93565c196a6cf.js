"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6566],{16924:(e,t,l)=>{l.d(t,{default:()=>a});var r=l(14232);function a(e,t){let l=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let r=l.current;if(!r)return;let a=r.getContext("2d");if(!a)return;let n=()=>{let l=(()=>{let e=r.parentElement;if(!e)return null;let{clientWidth:t,clientHeight:l}=e;if(t>0&&l>0)return e;let a=e.closest("[data-game-viewport]");if(a)return a;let n=e.closest(".windowMainScreen");return null!=n?n:e})();if(!l)return;let{clientWidth:n,clientHeight:i}=l;if(n<=0||i<=0)return;let c=Math.min(n/e,i/t),o=e*c,s=t*c,u=window.devicePixelRatio||1;r.style.width="".concat(o,"px"),r.style.height="".concat(s,"px"),r.width=Math.floor(o*u),r.height=Math.floor(s*u),a.setTransform(u*c,0,0,u*c,0,0)};n();let i=r.parentElement,c=null==i?void 0:i.closest("[data-game-viewport]"),o=null==i?void 0:i.closest(".windowMainScreen"),s="undefined"!=typeof ResizeObserver?new ResizeObserver(n):null;return i&&s&&s.observe(i),c&&s&&c!==i&&s.observe(c),o&&s&&o!==i&&s.observe(o),window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n),null==s||s.disconnect()}},[e,t]),l}},22358:(e,t,l)=>{l.r(t),l.d(t,{default:()=>m});var r=l(37876),a=l(14232),n=l(16924),i=l(44716),c=l(95220),o=l(74273),s=l(41058);let u={WIDTH:600,HEIGHT:400,PADDLE_WIDTH:10,PADDLE_HEIGHT:80,BALL_SIZE:8,SERVE_SPEED:240,MAX_BALL_SPEED:600,MAX_BOUNCE_ANGLE_DEG:60,TIME_RAMP_RATE:1.2,HIT_BOOST:30,PRACTICE_SPEED_MULTIPLIER:1,spinMaxAngleDeg:12,aiDifficulty:{easy:{reactionDelay:.25,aimError:30,maxSpeed:260,accel:1800},normal:{reactionDelay:.14,aimError:16,maxSpeed:320,accel:2200},hard:{reactionDelay:.08,aimError:6,maxSpeed:400,accel:2600}},spinEnabled:!0};function d(e,t,l){return Math.min(Math.max(e,t),l)}function p(e){return e*Math.PI/180}function y(e){return e.rngSeed=(1664525*e.rngSeed+0x3c6ef35f)%0x100000000,e.rngSeed/0x100000000}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"cpu",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"normal",a={paddles:{left:{y:e.HEIGHT/2-e.PADDLE_HEIGHT/2,vy:0},right:{y:e.HEIGHT/2-e.PADDLE_HEIGHT/2,vy:0}},ball:{x:e.WIDTH/2,y:e.HEIGHT/2,vx:0,vy:0},score:{left:0,right:0},rally:0,mode:l,ai:{timeUntilUpdate:0,targetY:null,difficulty:r},rngSeed:t};return f(a,"cpu"===l?1:void 0,e),a}function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y(e)>.5?1:-1,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u,r="practice"===e.mode?l.PRACTICE_SPEED_MULTIPLIER:1,a=l.SERVE_SPEED*r;e.ball.x=l.WIDTH/2,e.ball.y=l.HEIGHT/2;let n=(y(e)-.5)*p(30);e.ball.vx=Math.cos(n)*a*t,e.ball.vy=Math.sin(n)*a,e.rally=0}function E(e,t,l,r){let a=e.y;null!==t.touchY&&void 0!==t.touchY?(e.y=t.touchY-l.PADDLE_HEIGHT/2,e.vy=(e.y-a)/r):(t.up&&(e.vy-=2e3*r),t.down&&(e.vy+=2e3*r),t.up||t.down||(e.vy>0?e.vy=Math.max(0,e.vy-2e3*r):e.vy<0&&(e.vy=Math.min(0,e.vy+2e3*r))),e.vy=d(e.vy,-420,420),e.y+=e.vy*r),e.y<0?(e.y=0,e.vy=0):e.y>l.HEIGHT-l.PADDLE_HEIGHT&&(e.y=l.HEIGHT-l.PADDLE_HEIGHT,e.vy=0)}let g=1e3/60,v=()=>{let e=(0,n.default)(600,400),t=(0,a.useRef)(null),l=(0,a.useRef)(null),v=(0,a.useRef)(null),m=(0,a.useRef)(0),x=(0,a.useRef)(null),[D,L]=(0,a.useState)({player:0,opponent:0}),{difficulty:b,setDifficulty:H}=(0,s.useSettings)(),[I,w]=(0,a.useState)({player:0,opponent:0}),[S,A]=(0,a.useState)(null),[_,T]=(0,a.useState)("cpu"),[P,C]=(0,a.useState)(""),[M,N]=(0,a.useState)(""),[G,R]=(0,a.useState)(!1),j=(0,a.useRef)(null),[k,B]=(0,a.useState)(!0),[O,W]=(0,a.useState)(!1),Z=(0,a.useRef)(!1),[U,Y]=(0,a.useState)(0),{pongSpin:J}=(0,o.useSettings)(),[X,F]=(0,c.default)("pong_highscore",0,e=>"number"==typeof e),[z,q]=(0,a.useState)(1),[K,V]=(0,a.useState)(()=>{try{return JSON.parse(localStorage.getItem("pongHistory"))||[]}catch(e){return[]}});(0,a.useEffect)(()=>{Z.current=O},[O]),(0,a.useEffect)(()=>{U>X&&F(U)},[U,X,F]);let Q=(0,a.useCallback)(e=>{if(k)try{j.current||(j.current=new(window.AudioContext||window.webkitAudioContext));let t=j.current,l=t.createOscillator(),r=t.createGain();l.frequency.value=e,l.connect(r),r.connect(t.destination),l.start(),l.stop(t.currentTime+.1)}catch(e){}},[k]),$=(0,a.useRef)((0,i.default)(e));(0,a.useEffect)(()=>{let t=e.current;if(!t)return;let l=e=>{let l=t.getBoundingClientRect();$.current.touchY=null,$.current.touchY2=null;for(let t=0;t<e.touches.length;t+=1){let r=e.touches[t],a=r.clientX-l.left,n=r.clientY-l.top;a<l.width/2?$.current.touchY=n:$.current.touchY2=n}},r=()=>{$.current.touchY=null,$.current.touchY2=null};return t.addEventListener("touchstart",l),t.addEventListener("touchmove",l),t.addEventListener("touchend",r),t.addEventListener("touchcancel",r),()=>{t.removeEventListener("touchstart",l),t.removeEventListener("touchmove",l),t.removeEventListener("touchend",r),t.removeEventListener("touchcancel",r)}},[e]),(0,a.useEffect)(()=>{if("online"!==_||!v.current)return;let e=()=>{v.current.send(JSON.stringify({type:"input",frame:m.current+1,up:$.current.keys.ArrowUp||!1,down:$.current.keys.ArrowDown||!1}))};return window.addEventListener("keydown",e),window.addEventListener("keyup",e),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",e)}},[_,J]),(0,a.useEffect)(()=>{let l,r=e.current;if(!r)return;let a=r.getContext("2d"),n={...u,WIDTH:600,HEIGHT:400,PRACTICE_SPEED_MULTIPLIER:z,spinEnabled:J},i=[],c=window.matchMedia("(prefers-reduced-motion: reduce)"),o=c.matches,s=e=>{o=e.matches};c.addEventListener?c.addEventListener("change",s):c.addListener&&c.addListener(s);let D=e=>({paddles:{left:{...e.paddles.left},right:{...e.paddles.right}},ball:{...e.ball},score:{...e.score},rally:e.rally,mode:e.mode,ai:{...e.ai},rngSeed:e.rngSeed});x.current=h(n,1,_,b),m.current=0,L({player:0,opponent:0}),Y(0);let H={up:!1,down:!1,touchY:null},I=[],T=performance.now(),P=0,C=0,M=0;t.current=()=>{x.current=h(n,1,_,b),m.current=0,C=0,M=0,L({player:0,opponent:0}),w({player:0,opponent:0}),A(null),W(!1),Z.current=!1,Y(0)};let N=e=>{m.current+=1;let t=function(e,t,l){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:u,a=[],n="practice"===e.mode?r.PRACTICE_SPEED_MULTIPLIER:1,i=r.MAX_BALL_SPEED*n;E(e.paddles.left,t.left,r,l),"cpu"===e.mode?function(e,t,l,r){let a=t.aiDifficulty[e.ai.difficulty];if(!a)return;e.ai.timeUntilUpdate-=l;let n=r>0&&e.ball.vx>0;if(e.ai.timeUntilUpdate<=0)if(e.ai.timeUntilUpdate=a.reactionDelay,n){let l=(t.WIDTH-2*t.PADDLE_WIDTH-e.ball.x)/e.ball.vx,r=function(e,t,l){let r=(l-t)*2,a=(e-t)%r;return a<0&&(a+=r),a>l-t&&(a=r-a),a+t}(e.ball.y+e.ball.vy*l,t.BALL_SIZE,t.HEIGHT-t.BALL_SIZE),n=d(Math.hypot(e.ball.vx,e.ball.vy)/t.MAX_BALL_SPEED,0,1),i=(a.aimError+n*a.aimError*.5)*(y(e)-.5)*2;e.ai.targetY=r+i}else e.ai.targetY=t.HEIGHT/2;if(null===e.ai.targetY)return;let i=d(e.ai.targetY,t.BALL_SIZE,t.HEIGHT-t.BALL_SIZE),c=d(6*(i-(e.paddles.right.y+t.PADDLE_HEIGHT/2)),-a.maxSpeed,a.maxSpeed);c>e.paddles.right.vy?e.paddles.right.vy=d(e.paddles.right.vy+a.accel*l,-a.maxSpeed,c):e.paddles.right.vy=d(e.paddles.right.vy-a.accel*l,c,a.maxSpeed),e.paddles.right.y+=e.paddles.right.vy*l,e.paddles.right.y=d(e.paddles.right.y,0,t.HEIGHT-t.PADDLE_HEIGHT)}(e,r,l,Math.sign(e.ball.vx)):"practice"===e.mode?(e.paddles.right.y=0,e.paddles.right.vy=0):E(e.paddles.right,t.right,r,l);let c=Math.hypot(e.ball.vx,e.ball.vy),o=c+(i-c)*r.TIME_RAMP_RATE*l;if(o>0&&c>0){let t=d(o/c,0,i/c);e.ball.vx*=t,e.ball.vy*=t}if(e.ball.x+=e.ball.vx*l,e.ball.y+=e.ball.vy*l,e.ball.y<r.BALL_SIZE?(e.ball.y=r.BALL_SIZE,e.ball.vy*=-1,a.push({type:"wall"})):e.ball.y>r.HEIGHT-r.BALL_SIZE&&(e.ball.y=r.HEIGHT-r.BALL_SIZE,e.ball.vy*=-1,a.push({type:"wall"})),e.ball.x<-r.BALL_SIZE)return e.score.right+=1,f(e,1,r),a.push({type:"score",side:"right"}),a;if(e.ball.x>r.WIDTH+r.BALL_SIZE)return e.score.left+=1,f(e,-1,r),a.push({type:"score",side:"left"}),a;let s=(t,l,i,c)=>{let o=e.ball.y+r.BALL_SIZE>i&&e.ball.y-r.BALL_SIZE<i+r.PADDLE_HEIGHT,s="left"===t&&e.ball.vx<0&&e.ball.x-r.BALL_SIZE<l+r.PADDLE_WIDTH,u="right"===t&&e.ball.vx>0&&e.ball.x+r.BALL_SIZE>l;if(o&&(s||u)){e.ball.x="left"===t?l+r.PADDLE_WIDTH+r.BALL_SIZE:l-r.BALL_SIZE;let o=function(e,t,l,r,a,n){var i,c,o;let s=d((e.ball.y-(l+a.PADDLE_HEIGHT/2))/(a.PADDLE_HEIGHT/2),-1,1),u=p(a.MAX_BOUNCE_ANGLE_DEG),y=s*u,{spin:h}=(c=e.ball.y,o=a.PADDLE_HEIGHT,a.spinEnabled?function(e,t,l,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:200,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.1,i=(e-(t+l/2))/(l/2);return{spin:r*n+i*a,relative:i}}(c,l,o,r):{spin:0,relative:(c-(l+o/2))/(o/2)}),f=p(null!=(i=a.spinMaxAngleDeg)?i:10),E=d(Math.hypot(e.ball.vx,e.ball.vy)+a.HIT_BOOST,0,a.MAX_BALL_SPEED*n),g=d(h/Math.max(E,1),-f,f);return{vx:Math.cos(y=d(y+g,-u,u))*E*("left"===t?1:-1),vy:Math.sin(y)*E,speed:E}}(e,t,i,c,r,n);e.ball.vx=o.vx,e.ball.vy=o.vy,e.rally+=1,a.push({type:"hit",paddle:t})}};return s("left",r.PADDLE_WIDTH,e.paddles.left.y,e.paddles.left.vy),"practice"!==e.mode?s("right",r.WIDTH-2*r.PADDLE_WIDTH,e.paddles.right.y,e.paddles.right.vy):e.ball.x+r.BALL_SIZE>r.WIDTH-r.PADDLE_WIDTH&&(e.ball.x=r.WIDTH-r.PADDLE_WIDTH-r.BALL_SIZE,e.ball.vx=-Math.abs(e.ball.vx),e.rally+=1,a.push({type:"hit",paddle:"right"})),a}(x.current,(()=>{var e,t;let l={up:$.current.keys.ArrowUp,down:$.current.keys.ArrowDown,touchY:null!=(e=$.current.touchY)?e:null};return"local"===_?{left:l,right:{up:$.current.keys.w||$.current.keys.W,down:$.current.keys.s||$.current.keys.S,touchY:null!=(t=$.current.touchY2)?t:null}}:"online"===_?{left:l,right:H}:{left:l,right:{}}})(),e,n);if(!o){i.push({x:x.current.ball.x,y:x.current.ball.y});let e=Math.round(1+ +Math.min(1,Math.hypot(x.current.ball.vx,x.current.ball.vy)/(n.MAX_BALL_SPEED*z)));for(;i.length>e;)i.shift()}I[m.current%240]={frame:m.current,state:D(x.current)},(e=>{let t=x.current;e.forEach(e=>{if("hit"===e.type)Y(t.rally),Q(440);else if("wall"===e.type)Q(300);else if("score"===e.type&&(Y(0),Q(200),C=t.score.left,M=t.score.right,L({player:C,opponent:M}),"practice"!==_&&(C>=5||M>=5))){let e=C>M;w(t=>{let l={...t};if(e?l.player+=1:l.opponent+=1,l.player>=2||l.opponent>=2){let t=e?"Player":"Opponent";A(t),V(e=>{let r=[...e,{player:l.player,opponent:l.opponent,winner:t}];try{localStorage.setItem("pongHistory",JSON.stringify(r))}catch(e){}return r})}return l}),C=0,M=0,x.current.score={left:0,right:0},L({player:0,opponent:0}),x.current.paddles.left.y=n.HEIGHT/2-n.PADDLE_HEIGHT/2,x.current.paddles.left.vy=0,x.current.paddles.right.y=n.HEIGHT/2-n.PADDLE_HEIGHT/2,x.current.paddles.right.vy=0,f(x.current,e?-1:1,n)}}),t.rally!==U&&Y(t.rally)})(t)},G=()=>{let e=performance.now(),t=Math.min((e-T)/1e3,.1);if(T=e,!Z.current&&!S){P+=t;let e=g/1e3;for(P=Math.min(P,.25);P>=e;)N(e),P-=e}(()=>{let e=x.current;if(a.fillStyle="black",a.fillRect(0,0,n.WIDTH,n.HEIGHT),!o){a.fillStyle="white";for(let e=0;e<i.length;e+=1){let t=i[e],l=(e+1)/i.length;a.globalAlpha=.3*l,a.beginPath(),a.arc(t.x,t.y,n.BALL_SIZE*l,0,2*Math.PI),a.fill()}a.globalAlpha=1}a.fillStyle="white",a.fillRect(n.PADDLE_WIDTH,e.paddles.left.y,n.PADDLE_WIDTH,n.PADDLE_HEIGHT),"practice"!==_?a.fillRect(n.WIDTH-2*n.PADDLE_WIDTH,e.paddles.right.y,n.PADDLE_WIDTH,n.PADDLE_HEIGHT):a.fillRect(n.WIDTH-n.PADDLE_WIDTH,0,n.PADDLE_WIDTH,n.HEIGHT),a.beginPath(),a.arc(e.ball.x,e.ball.y,n.BALL_SIZE,0,2*Math.PI),a.fill()})(),l=requestAnimationFrame(G)};return"online"===_&&v.current&&(v.current.onmessage=e=>{try{let t=JSON.parse(e.data);if("input"===t.type){let{frame:e,up:l,down:r}=t;if(H.up=l,H.down=r,e<m.current&&(e=>{let t=I[e%240];return!!t&&t.frame===e&&(x.current=D(t.state),!0)})(e)){let t=m.current;m.current=e;for(let l=e;l<t;l+=1)N(g/1e3)}}}catch(e){}}),f(x.current,void 0,n),T=performance.now(),G(),()=>{cancelAnimationFrame(l),c.removeEventListener?c.removeEventListener("change",s):c.removeListener&&c.removeListener(s)}},[b,_,G,S,$,e,Q,J,z,U]);let ee=(0,a.useCallback)(()=>{t.current&&t.current()},[]),et=(0,a.useCallback)(async()=>{let e=new RTCPeerConnection,t=e.createDataChannel("pong");t.onopen=()=>R(!0),t.onmessage=e=>{try{let t=JSON.parse(e.data);t&&t.type}catch(e){}},v.current=t,l.current=e;let r=await e.createOffer();await e.setLocalDescription(r),e.onicecandidate=t=>{t.candidate||C(JSON.stringify(e.localDescription))}},[]),el=(0,a.useCallback)(async()=>{let e=l.current;if(e)try{let t=JSON.parse(M);await e.setRemoteDescription(t)}catch(e){}},[M]),er=(0,a.useCallback)(async()=>{let e=new RTCPeerConnection;e.ondatachannel=e=>{let t=e.channel;t.onopen=()=>R(!0),t.onmessage=e=>{try{let t=JSON.parse(e.data);t&&t.type}catch(e){}},v.current=t},l.current=e;try{let t=JSON.parse(P);await e.setRemoteDescription(t)}catch(e){return}let t=await e.createAnswer();await e.setLocalDescription(t),e.onicecandidate=t=>{t.candidate||N(JSON.stringify(e.localDescription))}},[P]);return(0,r.jsxs)("div",{className:"h-full w-full flex flex-col items-center justify-center bg-ub-cool-grey text-white",children:[(0,r.jsx)("canvas",{ref:e,className:"bg-black w-full h-full touch-none"}),"practice"===_?(0,r.jsxs)("div",{className:"mt-2 font-mono text-center","aria-live":"polite",role:"status",children:["Rally: ",U," (Best: ",X,")"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mt-2 font-mono text-center","aria-live":"polite",role:"status",children:"local"===_?"P1: ".concat(D.player," | P2: ").concat(D.opponent):"Player: ".concat(D.player," | Opponent: ").concat(D.opponent)}),(0,r.jsxs)("div",{className:"mt-1",children:["Games: ",I.player," | ",I.opponent]}),(0,r.jsxs)("div",{className:"mt-1",children:["Rally: ",U]}),S&&(0,r.jsxs)("div",{className:"mt-1 text-lg",children:["Winner: ",S]})]}),"practice"===_?(0,r.jsxs)("div",{className:"mt-2 flex items-center space-x-2",children:[(0,r.jsxs)("label",{children:["Speed: ",z.toFixed(1),"x"]}),(0,r.jsx)("input",{type:"range",min:"0.8",max:"1.5",step:"0.1",value:z,onChange:e=>q(parseFloat(e.target.value)),"aria-label":"Speed multiplier"})]}):"cpu"===_?(0,r.jsxs)("div",{className:"mt-2 flex items-center space-x-2",children:[(0,r.jsxs)("label",{children:["AI Difficulty: ",b]}),(0,r.jsxs)("select",{value:b,onChange:e=>H(e.target.value),"aria-label":"AI difficulty",className:"text-black p-1",children:[(0,r.jsx)("option",{value:"easy",children:"Easy"}),(0,r.jsx)("option",{value:"normal",children:"Normal"}),(0,r.jsx)("option",{value:"hard",children:"Hard"})]})]}):null,(0,r.jsxs)("div",{className:"mt-2 space-x-2",children:[(0,r.jsx)("button",{className:"px-2 py-1 bg-gray-700 rounded",onClick:()=>T("cpu"),children:"vs CPU"}),(0,r.jsx)("button",{className:"px-2 py-1 bg-gray-700 rounded",onClick:()=>T("local"),children:"2 Players"}),(0,r.jsx)("button",{className:"px-2 py-1 bg-gray-700 rounded",onClick:()=>T("online"),children:"Online"}),(0,r.jsx)("button",{className:"px-2 py-1 bg-gray-700 rounded",onClick:()=>T("practice"),children:"Practice"})]}),"online"===_&&!G&&(0,r.jsxs)("div",{className:"mt-2 flex flex-col items-center space-y-2 w-full px-4",children:[(0,r.jsx)("button",{className:"px-2 py-1 bg-gray-700 rounded",onClick:et,children:"Create"}),P&&(0,r.jsx)("textarea",{className:"w-full text-black",value:P,readOnly:!0,"aria-label":"Generated offer SDP"}),(0,r.jsx)("textarea",{className:"w-full text-black",placeholder:"Paste remote SDP",value:M,onChange:e=>N(e.target.value),"aria-label":"Remote SDP"}),(0,r.jsx)("button",{className:"px-2 py-1 bg-gray-700 rounded",onClick:P?el:er,children:P?"Set Answer":"Join"})]}),(0,r.jsxs)("div",{className:"mt-2 space-x-2",children:[(0,r.jsx)("button",{className:"px-4 py-1 bg-gray-700 hover:bg-gray-600 rounded",onClick:()=>W(e=>!e),children:O?"Resume":"Pause"}),(0,r.jsxs)("button",{className:"px-4 py-1 bg-gray-700 hover:bg-gray-600 rounded",onClick:()=>B(e=>!e),children:["Sound: ",k?"On":"Off"]}),(0,r.jsx)("button",{className:"px-4 py-1 bg-gray-700 hover:bg-gray-600 rounded",onClick:ee,children:"Reset"})]}),K.length>0&&(0,r.jsx)("div",{className:"mt-2 max-h-24 overflow-y-auto text-sm",children:K.map((e,t)=>(0,r.jsxs)("div",{children:[e.player," - ",e.opponent," (",e.winner,")"]},t))})]})},m=()=>(0,r.jsx)(s.SettingsProvider,{children:(0,r.jsx)(v,{})})},30684:(e,t,l)=>{l.d(t,{default:()=>o,getMapping:()=>n});var r=l(14232);let a={},n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a[e]?{...t,...a[e]}:t};async function i(e,t){try{let l=await navigator.storage.getDirectory(),r=await l.getDirectoryHandle("controls",{create:!0}),n=await r.getFileHandle("".concat(e,".json")),i=await n.getFile(),c=JSON.parse(await i.text());return a[e]=c,{...t,...c}}catch(e){return t}}async function c(e,t){try{let l=await navigator.storage.getDirectory(),r=await l.getDirectoryHandle("controls",{create:!0}),n=await r.getFileHandle("".concat(e,".json"),{create:!0}),i=await n.createWritable();await i.write(JSON.stringify(t)),await i.close(),a[e]=t}catch(e){}}function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[l,a]=(0,r.useState)(t);return(0,r.useEffect)(()=>{var l;let r=!0;return(null==(l=navigator.storage)?void 0:l.getDirectory)&&i(e,t).then(e=>{r&&a(e)}),()=>{r=!1}},[e,t]),[l,(t,l)=>{let r=null;return a(a=>{let n={...a};return Object.keys(n).forEach(e=>{e!==t&&n[e]===l&&(r=e,delete n[e])}),n[t]=l,c(e,n),n}),r}]}},41058:(e,t,l)=>{l.d(t,{SettingsProvider:()=>c,useSettings:()=>o});var r=l(37876),a=l(14232),n=l(33840);let i=(0,a.createContext)(void 0),c=e=>{let{children:t}=e,[l,a]=(0,n.default)("settings:difficulty","normal"),[c,o]=(0,n.default)("settings:assists",!0),[s,u]=(0,n.default)("settings:palette","default"),[d,p]=(0,n.default)("settings:highContrast",!1),[y,h]=(0,n.default)("settings:quality",1);return(0,r.jsx)(i.Provider,{value:{difficulty:l,setDifficulty:a,assists:c,setAssists:o,palette:s,setPalette:u,highContrast:d,setHighContrast:p,quality:y,setQuality:h},children:t})},o=()=>{let e=(0,a.useContext)(i);if(!e)throw Error("useSettings must be used within SettingsProvider");return e}},65422:(e,t,l)=>{l.d(t,{consumeGameKey:()=>a,formatGameKey:()=>n,shouldHandleGameKey:()=>r});let r=function(e){let{isFocused:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!(!t||(e=>{if(!e||!(e instanceof HTMLElement))return!1;let t=e.tagName;return"INPUT"===t||"TEXTAREA"===t||e.isContentEditable})(e.target))},a=e=>{(null==e?void 0:e.cancelable)&&e.preventDefault(),(null==e?void 0:e.stopPropagation)&&e.stopPropagation()},n=e=>{if(!e)return"";if(" "===e)return"Space";let t=e.toLowerCase();return"escape"===t?"Esc":"arrowup"===t?"ArrowUp":"arrowdown"===t?"ArrowDown":"arrowleft"===t?"ArrowLeft":"arrowright"===t?"ArrowRight":1===e.length?e.toUpperCase():e}}}]);