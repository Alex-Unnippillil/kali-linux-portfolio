(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4693],{17886:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>Z});var a=s(37876),l=s(49096),r=s.n(l),n=s(14232),i=s(70186),o=s.n(i);let c=(e,t,s)=>t*s+e,d=(e,t)=>({x:e%t,y:Math.floor(e/t)}),u=(e,t,s)=>e>=0&&t>=0&&e<s&&t<s,h=(e,t,s,a,l)=>{let r=[];for(let n=0;n<a;n++){let a=e+(0===s?n:0),i=t+(1===s?n:0);if(!u(a,i,l))return null;r.push(c(a,i,l))}return r},f=function(e,t){let s=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=s?[[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],[-1,1],[0,1],[1,1]]:[[0,-1],[1,0],[0,1],[-1,0]],l=new Set;return e.forEach(s=>{let{x:r,y:n}=d(s,t);a.forEach(s=>{let[a,i]=s,o=r+a,d=n+i;if(!u(o,d,t))return;let h=c(o,d,t);e.includes(h)||l.add(h)})}),Array.from(l)},p=(e,t)=>t.every(t=>"hit"===e[t]),x=(e,t)=>{var s,a;let{size:l,noTouch:r}=t,n=new Set;for(let t of e)if(null==t||null==(s=t.cells)?void 0:s.length){if(t.cells.length!==t.len)return{ok:!1,reason:"length-mismatch"};for(let e of t.cells){let{x:t,y:s}=d(e,l);if(!u(t,s,l))return{ok:!1,reason:"out-of-bounds"};if(n.has(e))return{ok:!1,reason:"overlap"};n.add(e)}}if(r){let t=new Set;for(let s of(e.forEach(e=>{var s;(null==e||null==(s=e.cells)?void 0:s.length)&&f(e.cells,l).forEach(e=>t.add(e))}),e))if(null==s||null==(a=s.cells)?void 0:a.length){for(let e of s.cells)if(t.has(e))return{ok:!1,reason:"adjacent"}}}return{ok:!0}},m=e=>"number"==typeof e?(e=>{let t=e>>>0;return()=>{let e=Math.imul((t+=0x6d2b79f5)^t>>>15,1|t);return(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/0x100000000}})(e):Math.random,b=[5,4,3,3,2],g=(e,t)=>Math.floor(t()*e),y=(e,t)=>{for(let s=e.length-1;s>0;s--){let a=g(s+1,t);[e[s],e[a]]=[e[a],e[s]]}return e};function v(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:m(),l=Array(100).fill(0),r=new Set;t.forEach(e=>{e>=0&&e<l.length&&(l[e]=-1)}),e.forEach(e=>{e>=0&&e<l.length&&(l[e]=2,r.add(e))});let n=[],i=(e,t,a,r)=>{let n=h(e,t,a,r,10);if(!n)return null;for(let e of n)if(-1===l[e]||1===l[e])return null;if(s){for(let e of f(n,10))if(1===l[e]||2===l[e])return null}return n},o=y(b.slice(),a),c=e=>{if(e>=o.length)return!0;let t=o[e],s=[];for(let e=0;e<2;e++){let a=e,l=0===e?10-t:9,r=1===e?10-t:9;for(let e=0;e<=l;e++)for(let l=0;l<=r;l++){let r=i(e,l,a,t);r&&s.push({x:e,y:l,dir:a,len:t,cells:r})}}for(let t of(y(s,a),s)){if(t.cells.forEach(e=>l[e]=1),n.push(t),c(e+1))return!0;n.pop(),t.cells.forEach(e=>l[e]=2*!!r.has(e))}return!1};if(!c(0))return null;let d=new Set;for(let t of(n.forEach(e=>e.cells.forEach(e=>d.add(e))),e))if(!d.has(t))return null;return n}function j(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=m(s.seed),l=null!=(e=s.maxAttempts)?e:50;for(let e=0;e<l;e++){let e=v(new Set,new Set,t,a);if(e)return e}let r=[{x:0,y:0,dir:0,len:5,cells:[]},{x:2,y:2,dir:0,len:4,cells:[]},{x:1,y:4,dir:0,len:3,cells:[]},{x:5,y:6,dir:1,len:3,cells:[]},{x:7,y:1,dir:1,len:2,cells:[]}].map(e=>({...e,cells:h(e.x,e.y,e.dir,e.len,10)||[]})).filter(e=>!!e.cells.length);if(x(r,{size:10,noTouch:t}).ok)return r;throw Error("Failed to generate fallback layout")}class w{record(e,t){(t?this.hits:this.misses).add(e)}markBlocked(e){e.forEach(e=>this.misses.add(e))}getHeatmap(){return this.lastScores}nextMove(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,t=Array(100).fill(0);for(let s=0;s<e;s++){let e=v(this.hits,this.misses,this.noAdjacency,this.rng);if(!e)continue;let s=new Set;e.forEach(e=>e.cells.forEach(e=>s.add(e)));for(let e=0;e<t.length;e++)!(this.hits.has(e)||this.misses.has(e))&&s.has(e)&&t[e]++}this.lastScores=t;let s=-1,a=-1;for(let e=0;e<t.length;e++)!(this.hits.has(e)||this.misses.has(e))&&t[e]>a&&(a=t[e],s=e);return s>=0?s:null}constructor({noAdjacency:e=!1,rng:t}={}){this.hits=new Set,this.misses=new Set,this.noAdjacency=e,this.lastScores=Array(100).fill(0),this.rng=null!=t?t:m()}}class k{record(e,t){if(this.available.delete(e),t){let t=e%10,s=Math.floor(e/10);[[t+1,s],[t-1,s],[t,s+1],[t,s-1]].forEach(e=>{let[t,s]=e;if(t>=0&&s>=0&&t<10&&s<10){let e=10*s+t;this.available.has(e)&&!this.queue.includes(e)&&this.queue.push(e)}})}}markBlocked(e){e.forEach(e=>{this.available.delete(e),this.queue=this.queue.filter(t=>t!==e)})}nextMove(){if(this.queue.length)return this.queue.shift();let e=Array.from(this.available);if(!e.length)return null;let t=e[g(e.length,this.rng)];return this.available.delete(t),t}constructor({rng:e}={}){this.available=new Set(Array.from({length:100},(e,t)=>t)),this.queue=[],this.rng=null!=e?e:m()}}class N{record(e){this.available.delete(e)}markBlocked(e){e.forEach(e=>this.available.delete(e))}nextMove(){let e=Array.from(this.available);if(!e.length)return null;let t=e[g(e.length,this.rng)];return this.available.delete(t),t}constructor({rng:e}={}){this.available=new Set(Array.from({length:100},(e,t)=>t)),this.rng=null!=e?e:m()}}let S=e=>{let{color:t,reduced:s}=e;return s?null:(0,a.jsx)("span",{className:"absolute inset-0 rounded-full pointer-events-none ".concat(t),style:{animation:"ping 0.6s cubic-bezier(0,0,0.2,1) forwards",opacity:.5},"aria-hidden":"true"})},_=e=>{let{colorblind:t,reduced:s}=e;return(0,a.jsxs)("div",{className:"pointer-events-none absolute inset-0 z-10",children:[(0,a.jsx)(S,{color:t?"bg-blue-500":"bg-red-500",reduced:s}),(0,a.jsxs)("svg",{className:"h-full w-full",viewBox:"0 0 32 32",stroke:t?"blue":"red",strokeWidth:"4","aria-hidden":"true",children:[(0,a.jsx)("line",{x1:"4",y1:"4",x2:"28",y2:"28",children:!s&&(0,a.jsx)("animate",{attributeName:"stroke-opacity",from:"0",to:"1",dur:"0.2s",fill:"freeze"})}),(0,a.jsx)("line",{x1:"28",y1:"4",x2:"4",y2:"28",children:!s&&(0,a.jsx)("animate",{attributeName:"stroke-opacity",from:"0",to:"1",dur:"0.2s",fill:"freeze"})})]})]})},C=e=>{let{colorblind:t,reduced:s}=e;return(0,a.jsxs)("div",{className:"pointer-events-none absolute inset-0 z-10",children:[(0,a.jsx)(S,{color:t?"bg-orange-400":"bg-blue-300",reduced:s}),(0,a.jsx)("svg",{className:"h-full w-full",viewBox:"0 0 32 32",stroke:t?"orange":"white",strokeWidth:"3",fill:"none","aria-hidden":"true",children:(0,a.jsxs)("circle",{cx:"16",cy:"16",r:"10",opacity:"1",children:[!s&&(0,a.jsx)("animate",{attributeName:"r",from:"0",to:"10",dur:"0.2s",fill:"freeze"}),!s&&(0,a.jsx)("animate",{attributeName:"stroke-opacity",from:"0",to:"1",dur:"0.2s",fill:"freeze"})]})})]})},E=e=>{let{colorblind:t}=e;return(0,a.jsx)("span",{className:"shot-particles","aria-hidden":"true",children:Array.from({length:6}).map((e,s)=>(0,a.jsx)("span",{className:"particle particle-".concat(s),style:{background:t?"#60a5fa":"#f87171"}},s))})},M=()=>(0,a.jsx)("span",{className:"shot-particles","aria-hidden":"true",children:Array.from({length:6}).map((e,t)=>(0,a.jsx)("span",{className:"particle particle-".concat(t),style:{background:"#38bdf8"}},t))}),R=e=>{let{outcome:t,colorblind:s,reduced:l}=e;return l?(0,a.jsx)("div",{className:"pointer-events-none absolute inset-0 rounded-lg border-2 ".concat("hit"===t?"border-red-400":"border-cyan-200"," opacity-80"),"aria-hidden":"true"}):(0,a.jsxs)("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:[(0,a.jsx)("span",{className:"shot-trail","aria-hidden":"true"}),(0,a.jsx)("span",{className:"shot-impact ".concat("hit"===t?"shot-impact-hit":"shot-impact-miss"),"aria-hidden":"true"}),"hit"===t?(0,a.jsx)(E,{colorblind:s}):(0,a.jsx)(M,{})]})},A=e=>{let{board:t,cellSize:s,label:l,isEnemy:r=!1,hideInfo:n=!1,showHeatmap:i=!1,heatmap:o,heatmapTone:c="cool",selectedTargets:d=[],cursorIndex:u,onTargetSelect:h,preview:f,effects:p,lastShots:x=[],sunkCells:m,colorblind:b=!1,reducedMotion:g=!1,onPlacementHover:y,onPlacementLeave:v,onPlacementClick:j,placementCursor:w,showPlacementCursor:k=!1,showCoordinates:N=!0}=e,S=null!=o?o:[],E=S.length?Math.max(...S):0,M=Array.from({length:10},(e,t)=>String.fromCharCode(65+t));return(0,a.jsx)("div",{className:"battle-card",children:(0,a.jsxs)("div",{className:"board-surface relative border border-cyan-500/20 bg-gradient-to-br from-slate-950/95 via-slate-900/80 to-slate-950/95 p-4",children:[(0,a.jsx)("div",{className:"sr-only","aria-live":"polite",children:l}),(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[N?(0,a.jsx)("div",{className:"flex flex-col gap-[2px] pt-[30px] text-[10px] font-semibold uppercase text-cyan-200/70",children:Array.from({length:10},(e,t)=>(0,a.jsx)("div",{style:{height:s},className:"flex items-center justify-center",children:t+1},t))}):null,(0,a.jsxs)("div",{children:[N?(0,a.jsx)("div",{className:"grid gap-[2px] pb-2 text-[10px] font-semibold uppercase text-cyan-200/70",style:{gridTemplateColumns:"repeat(".concat(10,", ").concat(s,"px)")},children:M.map(e=>(0,a.jsx)("div",{className:"text-center",children:e},e))}):null,(0,a.jsx)("div",{className:"grid relative",style:{gridTemplateColumns:"repeat(".concat(10,", ").concat(s,"px)"),gridTemplateRows:"repeat(".concat(10,", ").concat(s,"px)"),background:"linear-gradient(135deg, rgba(15,118,110,0.35), rgba(14,116,144,0.25))"},onMouseMove:e=>{if(!y)return;let t=e.currentTarget.getBoundingClientRect(),a=e.clientX-t.left,l=e.clientY-t.top,r=Math.floor(a/s),n=Math.floor(l/s);if(r<0||n<0||r>=10||n>=10){null==v||v();return}y(r,n)},onMouseLeave:v,children:t.map((e,t)=>{var l,o;let y=S[t],v=E?y/E:0,N=r&&d.includes(t),M=null==f||null==(l=f.cells)?void 0:l.includes(t),A=M&&(null==f?void 0:f.valid),T=null==m?void 0:m.has(t),F=x.includes(t),z=k&&w===t,I=null!=(o=null==p?void 0:p.get(t))?o:[];return(0,a.jsxs)("div",{className:"relative border border-ub-dark-grey/60",style:{width:s,height:s},children:[r&&h&&!["hit","miss"].includes(null!=e?e:"")?(0,a.jsx)("button",{type:"button",className:"h-full w-full",onClick:()=>h(t),"aria-label":"Select target at ".concat(Math.floor(t/10)+1,",").concat(t%10+1),"aria-pressed":N}):null,!r&&j?(0,a.jsx)("button",{type:"button",className:"absolute inset-0",onClick:()=>j(t%10,Math.floor(t/10)),"aria-label":"Place ship at ".concat(Math.floor(t/10)+1,",").concat(t%10+1)}):null,"hit"===e&&!n&&(0,a.jsx)(_,{colorblind:b,reduced:g}),"miss"===e&&!n&&(0,a.jsx)(C,{colorblind:b,reduced:g}),(0,a.jsx)("div",{className:"pointer-events-none absolute inset-0",style:{background:i&&y?"warm"===c?"rgba(251,191,36,".concat(.7*v,")"):"rgba(56,189,248,".concat(.6*v,")"):"transparent",zIndex:0},"aria-hidden":"true"}),M&&(0,a.jsx)("div",{className:"pointer-events-none absolute inset-0 ".concat(A?"bg-emerald-400/35":"bg-rose-500/35"),style:{transition:"opacity 0.2s ease"}}),N&&(0,a.jsx)("div",{className:"pointer-events-none absolute inset-0 rounded-md border-2 border-yellow-300/90 bg-yellow-200/30"}),F&&(0,a.jsx)("div",{className:"pointer-events-none absolute inset-0 rounded-md border border-white/50 shadow-[0_0_12px_rgba(255,255,255,0.35)]"}),"hit"===e&&T&&(0,a.jsx)("div",{className:"pointer-events-none absolute inset-0 rounded-md border-2 border-amber-300/80 bg-amber-200/10"}),n&&(0,a.jsx)("div",{className:"absolute inset-0 bg-slate-900","aria-hidden":"true"}),r&&u===t&&(0,a.jsx)("div",{className:"pointer-events-none absolute inset-0 rounded-md border-2 border-cyan-300/80"}),z&&(0,a.jsx)("div",{className:"pointer-events-none absolute inset-0 rounded-md border border-emerald-200/70 shadow-[0_0_10px_rgba(16,185,129,0.45)]"}),I.map(e=>(0,a.jsx)(R,{outcome:e.outcome,colorblind:b,reduced:g},e.id))]},t)})})]})]})]})})},T=e=>{let{id:t,text:s,children:l}=e;return(0,a.jsxs)("span",{className:"relative inline-flex items-center group focus-within:z-10",children:[n.cloneElement(l,{...l.props,"aria-describedby":t}),(0,a.jsx)("span",{role:"tooltip",id:t,className:"pointer-events-none absolute left-1/2 top-full mt-2 -translate-x-1/2 whitespace-nowrap rounded bg-black/90 px-2 py-1 text-xs opacity-0 shadow-lg transition-opacity duration-150 group-hover:opacity-100 group-focus-within:opacity-100",children:s})]})},F=e=>{let{ships:t,selectedShipId:s,onSelectShip:l,onRotateShip:r,disabled:n=!1}=e;return(0,a.jsxs)("div",{className:"rounded-2xl border border-cyan-400/20 bg-slate-950/60 p-4",children:[(0,a.jsx)("p",{className:"mb-3 text-xs uppercase tracking-wide text-cyan-200/80",children:"Ship Inventory"}),(0,a.jsx)("ul",{className:"grid gap-3 md:grid-cols-2",children:null==t?void 0:t.map(e=>{let t=Array.isArray(e.cells)&&e.cells.length===e.len,i=s===e.id;return(0,a.jsx)("li",{children:(0,a.jsxs)("div",{className:"flex items-center justify-between gap-3 rounded-xl border px-3 py-3 transition ".concat(i?"border-cyan-400/70 bg-cyan-500/20 shadow-[0_12px_24px_rgba(0,180,255,0.25)]":"border-white/10 bg-white/5 hover:border-cyan-400/40 hover:bg-cyan-500/10"),children:[(0,a.jsxs)("button",{type:"button",className:"flex flex-1 flex-col items-start text-left focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-300",onClick:()=>l(e.id),disabled:n,children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-white",children:e.name}),(0,a.jsxs)("span",{className:"text-xs uppercase tracking-wide text-white/60",children:["Length ",e.len]}),(0,a.jsx)("span",{className:"mt-1 inline-flex items-center rounded-full px-2 py-1 text-[10px] font-semibold uppercase tracking-wide ".concat(t?"bg-emerald-500/20 text-emerald-200":"bg-amber-500/20 text-amber-200"),children:t?"Deployed":"Awaiting orders"})]}),(0,a.jsx)(T,{id:"rotate-".concat(e.id),text:"Rotate ship",children:(0,a.jsx)("button",{type:"button",className:"rounded-lg border border-white/20 bg-slate-950/80 px-2 py-1 text-xs uppercase tracking-wide text-white/70 transition hover:bg-slate-900 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-300 disabled:cursor-not-allowed disabled:opacity-40",onClick:()=>r(e.id),disabled:!t||n,children:"Rotate"})})]})},e.id)})})]})},z={info:"from-cyan-500/90 via-sky-500/70 to-blue-500/60 border-cyan-300/70",success:"from-emerald-500/90 via-teal-500/70 to-cyan-500/60 border-emerald-300/70",warning:"from-amber-500/90 via-orange-500/70 to-yellow-500/60 border-amber-300/70",error:"from-rose-600/90 via-red-600/80 to-orange-600/60 border-rose-300/70"},I=e=>{let{label:t,value:s}=e;return(0,a.jsxs)("div",{className:"flex flex-col rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs uppercase tracking-wide",children:[(0,a.jsx)("span",{className:"text-[10px] text-white/60",children:t}),(0,a.jsx)("span",{className:"text-lg font-semibold text-white",children:s})]})},H=e=>{var t,s,l,n,i,o,c,d,u,h;let{children:f,difficulty:p,onDifficultyChange:x,mode:m,onModeChange:b,onRestart:g,stats:y,showGuessHeat:v,onToggleGuessHeat:j,showAiHeat:w,onToggleAiHeat:k,salvo:N,onSalvoChange:S,fog:_,onFogChange:C,noTouch:E,onNoTouchChange:M,colorblind:R,onColorblindChange:A,toast:T,onDismissToast:H,ships:P,onRotateShip:D,onSelectShip:B,selectedShipId:G,phase:L,battleLog:O,onResetStats:W,helpStats:q}=e,K=T?null!=(t=z[T.type])?t:z.info:"";return(0,a.jsxs)("div",{className:"jsx-c11f166c774ffea4 flex h-full w-full flex-col items-center justify-start gap-4 overflow-auto bg-ub-cool-grey p-4 font-ubuntu text-white",children:[T?(0,a.jsx)("div",{role:"status","aria-live":"assertive",className:"jsx-c11f166c774ffea4 "+"relative w-full max-w-4xl rounded-2xl border px-4 py-3 shadow-[0_20px_40px_rgba(0,0,0,0.45)] backdrop-blur transition-opacity duration-300 ".concat(K),children:(0,a.jsxs)("div",{className:"jsx-c11f166c774ffea4 flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{className:"jsx-c11f166c774ffea4",children:[(0,a.jsx)("p",{className:"jsx-c11f166c774ffea4 text-sm font-semibold uppercase tracking-wide text-white/70",children:T.title}),(0,a.jsx)("p",{className:"jsx-c11f166c774ffea4 text-base font-medium text-white",children:T.message})]}),(0,a.jsx)("button",{type:"button",onClick:H,className:"jsx-c11f166c774ffea4 rounded-full border border-white/20 bg-black/20 px-2 py-1 text-xs uppercase tracking-wide text-white/70 transition hover:bg-black/40 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-300",children:"Close"})]})}):null,(0,a.jsxs)("section",{className:"jsx-c11f166c774ffea4 w-full max-w-5xl space-y-3 rounded-3xl border border-white/10 bg-slate-900/60 p-4 shadow-[0_30px_60px_rgba(5,12,40,0.45)] backdrop-blur-xl",children:[(0,a.jsxs)("div",{className:"jsx-c11f166c774ffea4 flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[(0,a.jsxs)("div",{className:"jsx-c11f166c774ffea4 grid w-full gap-3 sm:grid-cols-2 lg:w-2/3",children:[(0,a.jsxs)("label",{className:"jsx-c11f166c774ffea4 flex flex-col rounded-xl border border-white/10 bg-white/5 p-3 text-xs uppercase tracking-wide text-white/70",children:[(0,a.jsx)("span",{className:"jsx-c11f166c774ffea4 mb-1",children:"Game Mode"}),(0,a.jsxs)("select",{value:m,onChange:e=>b(e.target.value),className:"jsx-c11f166c774ffea4 rounded-lg border border-white/20 bg-slate-950/80 px-3 py-2 text-base font-semibold text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400",children:[(0,a.jsx)("option",{value:"ai",className:"jsx-c11f166c774ffea4",children:"Vs AI"}),(0,a.jsx)("option",{value:"hotseat",className:"jsx-c11f166c774ffea4",children:"Local two-player (hotseat)"})]})]}),(0,a.jsxs)("label",{className:"jsx-c11f166c774ffea4 flex flex-col rounded-xl border border-white/10 bg-white/5 p-3 text-xs uppercase tracking-wide text-white/70",children:[(0,a.jsx)("span",{className:"jsx-c11f166c774ffea4 mb-1",children:"Difficulty"}),(0,a.jsxs)("select",{value:p,onChange:e=>x(e.target.value),disabled:"ai"!==m,className:"jsx-c11f166c774ffea4 rounded-lg border border-white/20 bg-slate-950/80 px-3 py-2 text-base font-semibold text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400",children:[(0,a.jsx)("option",{value:"easy",className:"jsx-c11f166c774ffea4",children:"Easy — Patrol AI"}),(0,a.jsx)("option",{value:"medium",className:"jsx-c11f166c774ffea4",children:"Medium — Tactical AI"}),(0,a.jsx)("option",{value:"hard",className:"jsx-c11f166c774ffea4",children:"Hard — Monte Carlo AI"})]})]}),(0,a.jsxs)("div",{className:"jsx-c11f166c774ffea4 flex items-center justify-between gap-2 rounded-xl border border-white/10 bg-white/5 p-3",children:[(0,a.jsx)("button",{type:"button",onClick:g,className:"jsx-c11f166c774ffea4 flex-1 rounded-lg bg-gradient-to-br from-cyan-500/90 to-blue-600/90 px-3 py-2 text-sm font-semibold uppercase tracking-wide shadow-lg transition hover:from-cyan-400 hover:to-blue-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-300",children:"Reset Grid"}),(0,a.jsx)("button",{type:"button",onClick:()=>j(!v),disabled:"ai"!==m,className:"jsx-c11f166c774ffea4 flex-1 rounded-lg border border-cyan-400/60 bg-slate-950/70 px-3 py-2 text-sm font-semibold uppercase tracking-wide text-cyan-200 transition hover:bg-slate-900 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-300",children:v?"Hide Targeting Heatmap":"Show Targeting Heatmap"})]}),(0,a.jsxs)("div",{className:"jsx-c11f166c774ffea4 flex flex-wrap items-center gap-2 rounded-xl border border-white/10 bg-white/5 p-3 text-sm",children:[(0,a.jsxs)("div",{className:"jsx-c11f166c774ffea4 flex items-center gap-2 rounded-lg border border-white/20 bg-slate-950/60 px-3 py-2",children:[(0,a.jsx)("input",{id:"battleship-salvo",type:"checkbox",checked:N,onChange:e=>S(e.target.checked),"aria-label":"Toggle salvo mode",className:"jsx-c11f166c774ffea4 h-4 w-4 accent-cyan-400"}),(0,a.jsx)("label",{htmlFor:"battleship-salvo",className:"jsx-c11f166c774ffea4 cursor-pointer text-sm text-white/80",children:"Salvo Mode"})]}),(0,a.jsxs)("div",{className:"jsx-c11f166c774ffea4 flex items-center gap-2 rounded-lg border border-white/20 bg-slate-950/60 px-3 py-2",children:[(0,a.jsx)("input",{id:"battleship-heat-ai",type:"checkbox",checked:w,onChange:e=>k(e.target.checked),"aria-label":"Toggle enemy prediction heatmap",disabled:"ai"!==m,className:"jsx-c11f166c774ffea4 h-4 w-4 accent-cyan-400"}),(0,a.jsx)("label",{htmlFor:"battleship-heat-ai",className:"jsx-c11f166c774ffea4 cursor-pointer text-sm text-white/80",children:"Enemy prediction heatmap (cheat)"})]}),(0,a.jsxs)("div",{className:"jsx-c11f166c774ffea4 flex items-center gap-2 rounded-lg border border-white/20 bg-slate-950/60 px-3 py-2",children:[(0,a.jsx)("input",{id:"battleship-no-touch",type:"checkbox",checked:E,onChange:e=>M(e.target.checked),"aria-label":"Toggle no-touch adjacency rule",className:"jsx-c11f166c774ffea4 h-4 w-4 accent-cyan-400"}),(0,a.jsx)("label",{htmlFor:"battleship-no-touch",className:"jsx-c11f166c774ffea4 cursor-pointer text-sm text-white/80",children:"Enforce No-Touch Rule"})]}),(0,a.jsxs)("div",{className:"jsx-c11f166c774ffea4 flex items-center gap-2 rounded-lg border border-white/20 bg-slate-950/60 px-3 py-2",children:[(0,a.jsx)("input",{id:"battleship-fog",type:"checkbox",checked:_,onChange:e=>C(e.target.checked),"aria-label":"Toggle fog of war",className:"jsx-c11f166c774ffea4 h-4 w-4 accent-cyan-400"}),(0,a.jsx)("label",{htmlFor:"battleship-fog",className:"jsx-c11f166c774ffea4 cursor-pointer text-sm text-white/80",children:"Hide my fleet during battle"})]}),(0,a.jsxs)("div",{className:"jsx-c11f166c774ffea4 flex items-center gap-2 rounded-lg border border-white/20 bg-slate-950/60 px-3 py-2",children:[(0,a.jsx)("input",{id:"battleship-colorblind",type:"checkbox",checked:R,onChange:e=>A(e.target.checked),"aria-label":"Toggle colorblind assist",className:"jsx-c11f166c774ffea4 h-4 w-4 accent-cyan-400"}),(0,a.jsx)("label",{htmlFor:"battleship-colorblind",className:"jsx-c11f166c774ffea4 cursor-pointer text-sm text-white/80",children:"Colorblind Assist"})]})]})]}),(0,a.jsxs)("div",{className:"jsx-c11f166c774ffea4 flex w-full flex-col gap-2 rounded-2xl border border-white/10 bg-gradient-to-br from-slate-950/90 via-slate-900/70 to-slate-950/90 p-3 lg:w-1/3",children:[(0,a.jsx)("p",{className:"jsx-c11f166c774ffea4 text-xs uppercase tracking-wide text-white/60",children:"Battle Brief"}),(0,a.jsxs)("div",{className:"jsx-c11f166c774ffea4 flex flex-wrap gap-2",children:[(0,a.jsx)(I,{label:"Wins",value:null!=(s=null==y?void 0:y.wins)?s:0}),(0,a.jsx)(I,{label:"Losses",value:null!=(l=null==y?void 0:y.losses)?l:0}),(0,a.jsx)(I,{label:"Shots",value:null!=(n=null==y?void 0:y.shotsFired)?n:0}),(0,a.jsx)(I,{label:"Hit rate",value:"".concat(null!=(i=null==q?void 0:q.hitRate)?i:0,"%")}),(0,a.jsx)(I,{label:"Avg turns",value:null!=(o=null==q?void 0:q.avgTurns)?o:0}),(0,a.jsx)(I,{label:"Phase",value:"placement"===L?"Deployment":"battle"===L?"Engagement":"Debrief"})]}),O?(0,a.jsxs)("p",{className:"jsx-c11f166c774ffea4 text-xs text-white/70",children:["Last result: ",(0,a.jsx)("span",{className:"jsx-c11f166c774ffea4 font-semibold text-white",children:O.lastResult?O.lastResult:"—"}),O.lastPlayed?(0,a.jsxs)("span",{className:"jsx-c11f166c774ffea4 ml-1 text-white/60",children:["(",new Date(O.lastPlayed).toLocaleString(),")"]}):null]}):null,(0,a.jsxs)("p",{className:"jsx-c11f166c774ffea4 text-xs text-white/70",children:["Current streak: ",(0,a.jsx)("span",{className:"jsx-c11f166c774ffea4 font-semibold text-white",children:null!=(c=null==y?void 0:y.currentStreak)?c:0})," ","\xb7 Best: ",(0,a.jsx)("span",{className:"jsx-c11f166c774ffea4 font-semibold text-white",children:null!=(d=null==y?void 0:y.bestStreak)?d:0})]}),(0,a.jsxs)("div",{className:"jsx-c11f166c774ffea4 flex items-center gap-2 text-xs text-white/70",children:[(0,a.jsx)("span",{className:"jsx-c11f166c774ffea4",children:"Hotseat wins:"}),(0,a.jsxs)("span",{className:"jsx-c11f166c774ffea4 font-semibold text-white",children:["P1 ",null!=(u=null==y?void 0:y.player1Wins)?u:0]}),(0,a.jsxs)("span",{className:"jsx-c11f166c774ffea4 font-semibold text-white",children:["P2 ",null!=(h=null==y?void 0:y.player2Wins)?h:0]})]}),(0,a.jsx)("button",{type:"button",onClick:W,className:"jsx-c11f166c774ffea4 rounded-lg border border-rose-300/40 bg-rose-500/10 px-3 py-1 text-xs uppercase tracking-wide text-rose-100 transition hover:bg-rose-500/20 focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-300",children:"Reset stats"})]})]}),(0,a.jsx)(F,{ships:P,selectedShipId:G,onSelectShip:B,onRotateShip:D}),(0,a.jsxs)("div",{className:"jsx-c11f166c774ffea4 rounded-2xl border border-white/10 bg-white/5 p-4 text-xs text-white/70",children:[(0,a.jsx)("p",{className:"jsx-c11f166c774ffea4 mb-2 text-xs uppercase tracking-wide text-cyan-200/80",children:"Controls"}),(0,a.jsxs)("ul",{className:"jsx-c11f166c774ffea4 space-y-1",children:[(0,a.jsxs)("li",{className:"jsx-c11f166c774ffea4",children:[(0,a.jsx)("strong",{className:"jsx-c11f166c774ffea4",children:"Keyboard:"})," arrows move cursor, Enter selects/place, R rotates, F fires, Esc clears selection."]}),(0,a.jsxs)("li",{className:"jsx-c11f166c774ffea4",children:[(0,a.jsx)("strong",{className:"jsx-c11f166c774ffea4",children:"Touch:"})," tap ship to select, tap grid to place/target, use Rotate and Fire buttons."]}),(0,a.jsxs)("li",{className:"jsx-c11f166c774ffea4",children:[(0,a.jsx)("strong",{className:"jsx-c11f166c774ffea4",children:"Mouse:"})," drag ships to place, click cells to target."]})]})]})]}),(0,a.jsx)("div",{className:"jsx-c11f166c774ffea4 flex w-full max-w-5xl flex-1 flex-col items-center gap-4",children:f}),(0,a.jsx)(r(),{id:"c11f166c774ffea4",children:".battle-card{perspective:1600px}.battle-card .board-surface{border-radius:1.25rem;box-shadow:0 30px 60px rgba(0,0,0,.45);transform:rotatex(6deg)rotatey(-4deg)translatey(0);transition:transform.5s ease,box-shadow.5s ease;will-change:transform,box-shadow}.battle-card:hover .board-surface,.battle-card:focus-within .board-surface{transform:rotatex(0deg)rotatey(0deg)translatey(-8px);box-shadow:0 45px 80px rgba(0,200,255,.25)}@media(prefers-reduced-motion:reduce){.battle-card .board-surface{transform:none!important;transition:none!important;box-shadow:0 20px 45px rgba(0,0,0,.35)}}"})]})};var P=s(44716),D=s(90209),B=s(65422),G=s(95220);let L={info:"Command Update",success:"Victory Report",warning:"Tactical Advisory",error:"Critical Alert"},O=[{id:0,name:"Carrier",len:5},{id:1,name:"Battleship",len:4},{id:2,name:"Cruiser",len:3},{id:3,name:"Submarine",len:3},{id:4,name:"Destroyer",len:2}],W=()=>Array(100).fill(null),q=e=>{let t=O.slice();return e.map(e=>{var s,a,l;let r=t.findIndex(t=>t.len===e.len),n=r>=0?t.splice(r,1)[0]:t.shift();return{...e,id:null!=(a=null!=(s=null==n?void 0:n.id)?s:e.id)?a:Math.random(),name:null!=(l=null==n?void 0:n.name)?l:"Ship ".concat(e.len)}})},K=e=>({board:e.length?e.reduce((e,t)=>{var s;return null==(s=t.cells)||s.forEach(t=>{e[t]="ship"}),e},W()):W(),ships:e,sunkIds:new Set,lastShots:[]}),Y=e=>"function"==typeof(null==e?void 0:e.getHeatmap)?e.getHeatmap():null,U=(e,t,s)=>{let a=[];for(let l=0;l<e.len;l++){let r=t+(0===e.dir?l:0),n=s+(1===e.dir?l:0);r<0||n<0||r>=10||n>=10||a.push(10*n+r)}return a},V=(e,t)=>{let s;return e?(s=t.board,t.ships.filter(e=>e.cells&&!p(s,e.cells)).length):1},J=()=>({wins:0,losses:0,shotsFired:0,shotsHit:0,totalGames:0,totalTurns:0,currentStreak:0,bestStreak:0,player1Wins:0,player2Wins:0}),X=e=>{let{reduced:t}=e;return t?null:(0,a.jsx)("div",{className:"confetti-field","aria-hidden":"true",children:Array.from({length:24}).map((e,t)=>(0,a.jsx)("span",{className:"confetti-piece",style:{"--offset":"".concat(t%12*8,"px"),"--delay":"".concat(t%6*.12,"s"),"--duration":"".concat(2+t%5*.3,"s"),background:t%2?"#38bdf8":"#fbbf24"}},t))})},Q=e=>{let{type:t,onClose:s,onRestart:l,stats:r,reduced:n}=e;return(0,a.jsx)("div",{className:"fixed inset-0 z-[80] flex items-center justify-center bg-black/80 p-4 backdrop-blur-sm",children:(0,a.jsxs)("div",{role:"dialog","aria-modal":"true",className:"relative w-full max-w-md overflow-hidden rounded-3xl border border-cyan-400/40 bg-slate-950/95 p-6 shadow-[0_40px_80px_rgba(0,0,0,0.6)]",children:["victory"===t?(0,a.jsx)(X,{reduced:n}):null,(0,a.jsxs)("div",{className:"relative space-y-4 text-center",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold text-white",children:"victory"===t?"Victory Achieved!":"Defeat Recorded"}),(0,a.jsx)("p",{className:"text-sm text-white/70",children:"victory"===t?"All enemy vessels have been destroyed. Bask in the glory of the fleet!":"Our hulls are breached. Regroup, rethink, and return fire next time."}),r?(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-4 text-white/80",children:[(0,a.jsxs)("span",{children:["Wins: ",(0,a.jsx)("strong",{className:"text-white",children:r.wins})]}),(0,a.jsxs)("span",{children:["Losses: ",(0,a.jsx)("strong",{className:"text-white",children:r.losses})]}),(0,a.jsxs)("span",{children:["Shots: ",(0,a.jsx)("strong",{className:"text-white",children:r.shotsFired})]})]}):null,(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-3",children:[(0,a.jsx)("button",{type:"button",className:"rounded-full bg-gradient-to-br from-emerald-500 to-cyan-500 px-5 py-2 text-sm font-semibold uppercase tracking-wide text-white shadow-lg transition hover:from-emerald-400 hover:to-cyan-400 focus:outline-none focus-visible:ring-2 focus-visible:ring-emerald-200",onClick:()=>{l(),s()},children:"Deploy Again"}),(0,a.jsx)("button",{type:"button",className:"rounded-full border border-white/20 bg-slate-900/80 px-4 py-2 text-sm font-semibold uppercase tracking-wide text-white/80 transition hover:bg-slate-900 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-300",onClick:s,children:"Close Briefing"})]})]})]})})},Z=()=>{let e=(0,D.default)(),[t,s]=(0,n.useState)(!1),{settings:l,setDifficulty:i,setNoTouch:c,setSalvo:d,setFog:u,setColorblind:b,setShowGuessHeat:g,setShowAiHeat:y,setMode:v,stats:S,resetStats:_,toast:C,message:E,dismissToast:M,phase:R,battleLog:T,players:F,activePlayer:z,placementPlayer:I,passScreen:O,selectedTargets:X,cursor:Z,placementCursor:$,dragHint:ee,hoverPreview:et,selectedShipId:es,modal:ea,shotEffects:el,guessHeat:er,aiHeat:en,sunkEnemyCells:ei,sunkPlayerCells:eo,activePlayerState:ec,opponentState:ed,activeShotLimit:eu,placementShipsReady:eh,helpStats:ef,fleetStatus:ep,opponentFleetStatus:ex,setSelectedShipId:em,setActiveShipId:eb,setHoverPreview:eg,setModal:ey,setSelectedTargets:ev,restart:ej,startBattle:ew,rotateShip:ek,rotateSelectedShip:eN,randomize:eS,handleDragStart:e_,handleDrag:eC,handleDragStop:eE,placementHover:eM,placeSelectedShip:eR,toggleTarget:eA,fireSelected:eT,handlePassScreenReady:eF,placeCursorMove:ez,battleCursorMove:eI,placeAtCursor:eH,selectTargetAtCursor:eP}=(()=>{let[e,t]=(0,G.default)("battleship-difficulty","easy"),[s,a]=(0,G.default)("battleship-no-touch",!0),[l,r]=(0,G.default)("battleship-salvo",!1),[i,o]=(0,G.default)("battleship-fog",!1),[c,d]=(0,G.default)("battleship-colorblind",!1),[u,b]=(0,G.default)("battleship-heat-guess",!0),[g,y]=(0,G.default)("battleship-heat-ai",!1),[v,S]=(0,G.default)("battleship-mode","ai"),[_,C]=(0,G.default)("battleship-stats",J()),[E,M]=(0,G.default)("battleship-progress",{lastResult:null,lastPlayed:null}),{toast:R,message:A,announce:T,dismiss:F}=(()=>{let[e,t]=(0,n.useState)(null),[s,a]=(0,n.useState)(""),l=(0,n.useRef)(null),r=(0,n.useCallback)(()=>{t(null),l.current&&(window.clearTimeout(l.current),l.current=null)},[]),i=(0,n.useCallback)((e,s,r)=>{t({type:e,title:null!=r?r:L[e],message:s}),a(s),l.current&&window.clearTimeout(l.current),l.current=window.setTimeout(()=>{t(null),l.current=null},4500)},[]);return(0,n.useEffect)(()=>()=>r(),[r]),{toast:e,message:s,announce:i,dismiss:r}})(),[z,I]=(0,n.useState)("placement"),[H,P]=(0,n.useState)(()=>{let e=q(j(!0,{maxAttempts:50}));return[K(e),K(e)]}),[D,B]=(0,n.useState)(0),[O,X]=(0,n.useState)(0),[Q,Z]=(0,n.useState)(!1),[$,ee]=(0,n.useState)([]),[et,es]=(0,n.useState)(0),[ea,el]=(0,n.useState)(0),[er,en]=(0,n.useState)(null),[ei,eo]=(0,n.useState)(null),[ec,ed]=(0,n.useState)(!1),[eu,eh]=(0,n.useState)(null),[ef,ep]=(0,n.useState)(null),[ex,em]=(0,n.useState)(null),[eb,eg]=(0,n.useState)([]),[ey,ev]=(0,n.useState)(Array(100).fill(0)),[ej,ew]=(0,n.useState)(Array(100).fill(0)),[ek,eN]=(0,n.useState)(0),eS=(0,n.useRef)(null),e_=(0,n.useRef)(null),eC=(0,n.useRef)(0),eE=(0,n.useRef)(new Map),eM=(0,n.useRef)(null),eR=(0,n.useMemo)(()=>new Set(H[+(0===D)].ships.flatMap(e=>e.cells||[])),[H,D]),eA=(0,n.useMemo)(()=>{let e=H[+(0===D)];return new Set(e.ships.filter(t=>e.sunkIds.has(t.id)).flatMap(e=>e.cells||[]))},[H,D]),eT=(0,n.useMemo)(()=>{let e=H[D];return new Set(e.ships.filter(t=>e.sunkIds.has(t.id)).flatMap(e=>e.cells||[]))},[H,D]),eF=H[O],ez=H[D],eI=H[+(0===D)],eH=(0,n.useCallback)((e,t,a,l)=>{let r=eF.ships.find(t=>t.id===e);if(!r)return null;let n=h(t,a,l,r.len,10);return n&&x(eF.ships.map(s=>s.id===e?{...s,x:t,y:a,dir:l,cells:n}:s),{size:10,noTouch:s}).ok?n:null},[eF.ships,s]),eP=(0,n.useCallback)((e,t)=>{P(s=>{let a=[...s];return a[e]=t(s[e]),a})},[]),eD=(0,n.useCallback)((e,t,s,a)=>{let l=eH(e,t,s,a);return l?(eP(O,r=>{let n=r.ships.map(r=>r.id===e?{...r,x:t,y:s,dir:a,cells:l}:r),i=W();return n.forEach(e=>{var t;return null==(t=e.cells)?void 0:t.forEach(e=>{i[e]="ship"})}),{...r,ships:n,board:i}}),l):null},[O,eH,eP]),eB=(0,n.useCallback)(e=>{let t=eF.ships.find(t=>t.id===e);if(!t)return;let s=+(0===t.dir),a=eH(e,t.x,t.y,s);a&&eP(O,t=>{let l=t.ships.map(t=>t.id===e?{...t,dir:s,cells:a}:t),r=W();return l.forEach(e=>{var t;return null==(t=e.cells)?void 0:t.forEach(e=>{r[e]="ship"})}),{...t,ships:l,board:r}})},[eF.ships,O,eH,eP]),eG=(0,n.useCallback)(()=>{eP(O,()=>{let e=q(j(s,{maxAttempts:50})),t=W();return e.forEach(e=>{var s;return null==(s=e.cells)?void 0:s.forEach(e=>{t[e]="ship"})}),{board:t,ships:e,sunkIds:new Set,lastShots:[]}}),eh(null),ep(null),T("warning","Fleet redeployed with a fresh random layout.","Randomize")},[T,s,O,eP]),eL=(0,n.useCallback)((e,t,s)=>{let a=eC.current++;eg(l=>[...l,{id:a,board:e,idx:t,outcome:s}]);{let e=window.setTimeout(()=>{eg(e=>e.filter(e=>e.id!==a)),eE.current.delete(a)},1200);eE.current.set(a,e)}},[]),eO=(0,n.useCallback)(()=>{C(J())},[C]),eW=(0,n.useCallback)(a=>{var n,i,o,c,d;let u=null!=(n=null==a?void 0:a.diff)?n:e,h=null!=(i=null==a?void 0:a.salvoMode)?i:l,f=null!=(o=null==a?void 0:a.modeOverride)?o:v,p=Date.now(),x=q(j(s,{maxAttempts:50,seed:p})),b=q(j(s,{maxAttempts:50,seed:p+1}));I("placement"),X(0),B(0),Z(!1),ee([]),es(0),el(0),en(null),eo(null),ed(!1),eh(null),ep(null),em(null),eg([]),eN(0);let g=W();x.forEach(e=>{var t;return null==(t=e.cells)?void 0:t.forEach(e=>{g[e]="ship"})});let y=W();if("hotseat"===f&&b.forEach(e=>{var t;return null==(t=e.cells)?void 0:t.forEach(e=>{y[e]="ship"})}),P([{board:g,ships:x,sunkIds:new Set,lastShots:[]},{board:y,ships:b,sunkIds:new Set,lastShots:[]}]),"ai"===f){let e;eS.current=e="hard"===u?new w({noAdjacency:s,rng:m(p+2)}):"medium"===u?new k({rng:m(p+2)}):new N({rng:m(p+2)}),Y(e)?(e.nextMove(),ew(null!=(d=null==(c=Y(e))?void 0:c.slice())?d:Array(100).fill(0))):ew(Array(100).fill(0));let t=new w({noAdjacency:s,rng:m(p+3)});t.nextMove(),e_.current=t,ev(t.getHeatmap().slice())}else eS.current=null,e_.current=null,ew(Array(100).fill(0)),ev(Array(100).fill(0));T("info","Fresh deployment grid established.","Deployment Reset"),t(u),r(h),S(f)},[T,e,v,s,l,t,S,r]);(0,n.useEffect)(()=>{eW()},[]),(0,n.useEffect)(()=>()=>{eE.current.forEach(e=>window.clearTimeout(e)),eE.current.clear(),eM.current&&(window.clearTimeout(eM.current),eM.current=null)},[]);let eq=(0,n.useCallback)(e=>{ed(!0),eh(e),ep(e)},[]),eK=(0,n.useCallback)((e,t,s)=>{let a=eF.ships.find(t=>t.id===e);if(!a)return;let l=eH(e,t,s,a.dir);l?en({cells:l,valid:!0}):en({cells:U(a,t,s),valid:!1})},[eF.ships,eH]),eY=(0,n.useCallback)((e,t,s)=>{let a=eF.ships.find(t=>t.id===e);a&&(eH(e,t,s,a.dir)&&eD(e,t,s,a.dir),en(null),ed(!1))},[eF.ships,eH,eD]),eU=(0,n.useCallback)((e,t)=>{if("placement"!==z||ec)return;let s=null!=eu?eu:ef;if(null==s)return void eo(null);let a=eF.ships.find(e=>e.id===s);if(!a)return;let l=eH(s,e,t,a.dir);eo({cells:l||U(a,e,t),valid:!!l})},[z,ec,eu,ef,eF.ships,eH]),eV=(0,n.useCallback)((e,t)=>{if("placement"!==z)return;let s=null!=eu?eu:ef;if(null==s)return void T("warning","Select a ship before placing.");let a=eF.ships.find(e=>e.id===s);a&&(eD(s,e,t,a.dir)||T("warning","That placement is invalid."))},[z,eu,ef,eF.ships,eD,T]),eJ=(0,n.useCallback)(()=>{if(H[O].ships.some(e=>!e.cells))return void T("warning","Place every vessel before starting the mission.");if("hotseat"===v&&0===O){X(1),ep(null),eh(null),Z(!0),T("info","Player 2: Deploy your fleet.","Switch Players");return}if("hotseat"===v){I("battle"),B(0),Z(!0),ee([]),eN(0),T("info","Player 1, prepare to strike.","Engagement Begins");return}I("battle"),ee([]),eN(0),T("info","Deployment complete. Your turn to strike!","Engagement Begins")},[T,v,O,H]),eX=(0,n.useCallback)((e,t)=>{"battle"===z&&(eI.board[e]||ee(s=>s.includes(e)?s.filter(t=>t!==e):s.length>=t?s:[...s,e]))},[z,eI.board]),eQ=(0,n.useCallback)((e,t)=>{let a=H[e],l=a.ships.filter(e=>e.cells&&p(t,e.cells)&&!a.sunkIds.has(e.id));if(!l.length)return{board:t,sunkIds:a.sunkIds};let r=new Set([...a.sunkIds,...l.map(e=>e.id)]),n=t;if(s){let t=Array.from(new Set(l.flatMap(e=>f(e.cells||[],10))));if(n=((e,t)=>{let s=e.slice();return t.forEach(e=>{e<0||e>=s.length||null==s[e]&&(s[e]="miss")}),s})(n,t),"ai"===v){var i,o,c,d;0===e&&(null==(o=eS.current)||null==(i=o.markBlocked)||i.call(o,t)),1===e&&(null==(d=e_.current)||null==(c=d.markBlocked)||c.call(d,t))}}return eP(e,e=>({...e,sunkIds:r})),{board:n,sunkIds:r}},[H,s,v,eP]),eZ=(0,n.useCallback)(e=>{let t=0===e,s="hotseat"===v?"Player ".concat(e+1):"Commander";I("done"),em(t||"hotseat"===v?"victory":"defeat"),C(s=>{let a=s.totalGames+1,l=s.totalTurns+ek;return{...s,totalGames:a,totalTurns:l,shotsFired:s.shotsFired,shotsHit:s.shotsHit,wins:s.wins+("ai"===v&&t?1:0),losses:s.losses+ +("ai"===v&&!t),currentStreak:"ai"===v?t?s.currentStreak+1:0:s.currentStreak,bestStreak:"ai"===v?Math.max(s.bestStreak,t?s.currentStreak+1:0):s.bestStreak,player1Wins:s.player1Wins+ +("hotseat"===v&&0===e),player2Wins:s.player2Wins+ +("hotseat"===v&&1===e)}}),eP(+(0===e),e=>({...e})),M({lastResult:"hotseat"===v?s:t?"victory":"defeat",lastPlayed:Date.now()}),T(t?"success":"error","".concat(s," secures the win."),t?"Victory":"Defeat")},[T,v,M,C,ek,eP]),e$=(0,n.useCallback)(()=>{B(e=>+(0===e)),ee([]),Z(!0)},[]),e0=(0,n.useCallback)((e,t)=>{var s,a,l,r,n;let i=H[0].board.slice(),o=ej.slice(),c=[];for(let t=0;t<e;t++){let e=null==(s=eS.current)?void 0:s.nextMove();if(null==e)break;c.push(e);let t=Y(eS.current);t?o=t.slice():o[e]+=1;let l="ship"===i[e];i[e]=l?"hit":"miss",null==(a=eS.current)||a.record(e,l),eL("player",e,l?"hit":"miss")}let{board:d}=eQ(0,i);if(eP(0,e=>({...e,board:d,lastShots:c})),H[0].ships.every(e=>e.cells&&p(d,e.cells)))return void eZ(1);Y(eS.current)&&(null==(l=eS.current)||l.nextMove(),o=null!=(n=null==(r=Y(eS.current))?void 0:r.slice())?n:o),ew(o),T(t?"warning":"info",t?"Enemy is retaliating after your strike!":"Enemy salvos splashed harmlessly.")},[ej,T,eZ,H,eQ,eL,eP]),e1=(0,n.useCallback)(()=>{if("battle"!==z||!$.length)return;let e=V(l,ez),t=$.slice(0,e),s=new Set(t.filter(e=>eR.has(e)));t.forEach(e=>{let t=s.has(e);eL("enemy",e,t?"hit":"miss")});let{board:a,hits:r}=function(e,t,s){let a=e.slice(),l=[],r=[];for(let e of t){if(e<0||e>=a.length)continue;let t=a[e];"hit"!==t&&"miss"!==t&&((s?s.has(e):"ship"===t)?(a[e]="hit",l.push(e)):null==t&&(a[e]="miss",r.push(e)))}return{board:a,hits:l,misses:r}}(eI.board,t,eR),{board:n}=eQ(+(0===D),a);if(eP(+(0===D),e=>({...e,board:n,lastShots:t})),ee([]),C(e=>({...e,shotsFired:e.shotsFired+t.length,shotsHit:e.shotsHit+r.length})),"ai"===v&&e_.current&&(t.forEach(e=>{var t;null==(t=e_.current)||t.record(e,s.has(e))}),e_.current.nextMove(),ev(e_.current.getHeatmap().slice())),eI.ships.every(e=>e.cells&&p(n,e.cells)))return void eZ(D);if(eN(e=>e+1),"hotseat"===v){e$(),T("info","Pass the device to the next player.","Turn Complete");return}let i=V(l,eI);eM.current&&window.clearTimeout(eM.current),eM.current=window.setTimeout(()=>e0(i,r.length>0),150),T(r.length?"success":"warning",r.length?"Direct hit! Brace for counter-fire.":"Shots splashed – adjust targeting.")},[D,ez,e0,T,eR,eZ,e$,v,eI,z,eQ,l,$,C,eL,eP]),e6=(0,n.useCallback)(()=>{Z(!1),ee([]),es(0),"battle"===z&&T("info","Player ".concat(D+1,", take your turn."))},[D,T,z]),e4=(0,n.useCallback)((e,t)=>{"placement"===z&&el(s=>{let a=s%10+e,l=Math.floor(s/10)+t;return a<0||l<0||a>=10||l>=10?s:10*l+a})},[z]),e5=(0,n.useCallback)((e,t)=>{"battle"===z&&es(s=>{let a=s%10+e,l=Math.floor(s/10)+t;return a<0||l<0||a>=10||l>=10?s:10*l+a})},[z]),e2=(0,n.useCallback)(()=>{if("placement"!==z)return;let e=Math.floor(ea/10);eV(ea%10,e)},[z,ea,eV]),e3=(0,n.useCallback)(e=>{"battle"===z&&eX(et,e)},[et,z,eX]),e7=(0,n.useCallback)(()=>{let e=null!=eu?eu:ef;null!=e&&eB(e)},[eu,eB,ef]),e9=(0,n.useMemo)(()=>V(l,ez),[l,ez]),e8=(0,n.useMemo)(()=>eF.ships.every(e=>e.cells&&e.cells.length===e.len),[eF.ships]),te=(0,n.useMemo)(()=>({hitRate:_.shotsFired?Math.round(_.shotsHit/_.shotsFired*100):0,avgTurns:_.totalGames?Math.round(_.totalTurns/_.totalGames):0}),[_]),tt=(0,n.useMemo)(()=>ez.ships.map(e=>({id:e.id,name:e.name,len:e.len,sunk:ez.sunkIds.has(e.id)})),[ez]),ts=(0,n.useMemo)(()=>eI.ships.map(e=>({id:e.id,name:e.name,len:e.len,sunk:eI.sunkIds.has(e.id)})),[eI]);return{settings:{difficulty:e,noTouch:s,salvo:l,fog:i,colorblind:c,showGuessHeat:u,showAiHeat:g,mode:v},setDifficulty:t,setNoTouch:a,setSalvo:r,setFog:o,setColorblind:d,setShowGuessHeat:b,setShowAiHeat:y,setMode:S,stats:_,setStats:C,resetStats:eO,battleLog:E,toast:R,message:A,dismissToast:F,announce:T,phase:z,players:H,activePlayer:D,placementPlayer:O,passScreen:Q,selectedTargets:$,cursor:et,placementCursor:ea,dragHint:er,hoverPreview:ei,isDragging:ec,activeShipId:eu,selectedShipId:ef,modal:ex,shotEffects:eb,guessHeat:ey,aiHeat:ej,sunkEnemyCells:eA,sunkPlayerCells:eT,enemyShipSet:eR,activePlayerState:ez,opponentState:eI,activeShotLimit:e9,placementShipsReady:e8,helpStats:te,fleetStatus:tt,opponentFleetStatus:ts,setSelectedShipId:ep,setActiveShipId:eh,setDragHint:en,setHoverPreview:eo,setIsDragging:ed,setModal:em,setSelectedTargets:ee,setCursor:es,restart:eW,startBattle:eJ,rotateShip:eB,rotateSelectedShip:e7,randomize:eG,handleDragStart:eq,handleDrag:eK,handleDragStop:eY,placementHover:eU,placeSelectedShip:eV,toggleTarget:eX,fireSelected:e1,handlePassScreenReady:e6,placeCursorMove:e4,battleCursorMove:e5,placeAtCursor:e2,selectTargetAtCursor:e3}})(),eD="hotseat"===l.mode,eB=ep.filter(e=>!e.sunk).length,eG=ex.filter(e=>!e.sunk).length,eL=Array.from({length:10},(e,t)=>String.fromCharCode(65+t)),eO=(e,t)=>e.map(e=>({idx:e,coord:(e=>{let t=Math.floor(e/10);return"".concat(eL[e%10]).concat(t+1)})(e),outcome:"hit"===t[e]?"Hit":"Miss"}));(0,P.default)(e=>{let{x:t,y:s}=e;"placement"===R&&ez(t,s),"battle"===R&&eI(t,s)},"battleship",{enabled:t,preventDefault:!0,isFocused:t}),(0,n.useEffect)(()=>{"placement"===R&&eM($%10,Math.floor($/10))},[R,$,eM]),(0,n.useEffect)(()=>{let e=e=>{(0,B.shouldHandleGameKey)(e,{isFocused:t})&&("placement"===R&&(("r"===e.key||"R"===e.key)&&((0,B.consumeGameKey)(e),eN()),"Enter"===e.key&&((0,B.consumeGameKey)(e),eH()),"Escape"===e.key&&((0,B.consumeGameKey)(e),em(null),eb(null),eg(null))),"battle"===R&&(("Enter"===e.key||" "===e.key)&&((0,B.consumeGameKey)(e),eP(eu)),("f"===e.key||"F"===e.key)&&((0,B.consumeGameKey)(e),eT()),"Escape"===e.key&&((0,B.consumeGameKey)(e),ev([]))))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[eu,eT,t,R,eH,eN,eP,eb,eg,em,ev]);let eW=(0,n.useMemo)(()=>{let e={player:new Map,enemy:new Map};return el.forEach(t=>{var s;let a=e[t.board];a.has(t.idx)||a.set(t.idx,[]),null==(s=a.get(t.idx))||s.push(t)}),e},[el]);return(0,a.jsxs)("div",{onFocusCapture:()=>s(!0),onBlurCapture:e=>{e.currentTarget.contains(e.relatedTarget)||s(!1)},tabIndex:0,className:"jsx-e6b06efe515413a6 h-full w-full",children:[(0,a.jsxs)(H,{difficulty:l.difficulty,onDifficultyChange:e=>{i(e),ej({diff:e})},mode:l.mode,onModeChange:e=>{v(e),ej({modeOverride:e})},onRestart:()=>ej(),stats:S,showGuessHeat:l.showGuessHeat,onToggleGuessHeat:e=>g(e),showAiHeat:l.showAiHeat,onToggleAiHeat:e=>y(e),salvo:l.salvo,onSalvoChange:e=>{d(e),ej({salvoMode:e})},fog:l.fog,onFogChange:e=>u(e),noTouch:l.noTouch,onNoTouchChange:e=>{c(e),ej({salvoMode:l.salvo})},colorblind:l.colorblind,onColorblindChange:e=>b(e),toast:C,onDismissToast:M,ships:F[I].ships,onRotateShip:ek,onSelectShip:e=>em(t=>t===e?null:e),selectedShipId:es,phase:R,battleLog:T,onResetStats:()=>{window.confirm("Reset all Battleship stats? This cannot be undone.")&&_()},helpStats:ef,children:[(0,a.jsx)("div",{role:"status","aria-live":"polite",className:"jsx-e6b06efe515413a6 sr-only",children:E}),"done"===R&&(0,a.jsx)("button",{type:"button",onClick:()=>ej(),className:"jsx-e6b06efe515413a6 rounded-lg bg-cyan-600 px-3 py-2 text-sm font-semibold uppercase tracking-wide shadow-lg transition hover:bg-cyan-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-200",children:"Play Again"}),"placement"===R&&(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 flex flex-col items-center gap-6 lg:flex-row",children:[(0,a.jsxs)("div",{style:{width:352,height:352},className:"jsx-e6b06efe515413a6 relative rounded-[1.5rem] border border-cyan-500/30 bg-slate-950/70 p-4 shadow-[0_20px_45px_rgba(0,0,0,0.45)]",children:[(0,a.jsx)("div",{className:"jsx-e6b06efe515413a6 absolute left-4 top-4",children:(0,a.jsxs)("span",{className:"jsx-e6b06efe515413a6 rounded-full bg-cyan-500/30 px-3 py-1 text-xs uppercase tracking-wide text-cyan-100",children:["Deployment Grid — Player ",I+1]})}),(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 absolute inset-4",children:[(0,a.jsx)(A,{board:F[I].board,cellSize:32,label:"Deployment grid",hideInfo:!1,preview:ee||et,effects:eW.player,colorblind:l.colorblind,reducedMotion:e,onPlacementHover:(e,t)=>eM(e,t),onPlacementLeave:()=>eg(null),onPlacementClick:(e,t)=>eR(e,t),placementCursor:$,showPlacementCursor:!0}),F[I].ships.map(e=>(0,a.jsx)(o(),{grid:[32,32],position:{x:32*e.x,y:32*e.y},onStart:(t,s)=>{e_(e.id),eC(e.id,Math.round(s.x/32),Math.round(s.y/32))},onDrag:(t,s)=>eC(e.id,Math.round(s.x/32),Math.round(s.y/32)),onStop:(t,s)=>eE(e.id,Math.round(s.x/32),Math.round(s.y/32)),disabled:"placement"!==R,children:(0,a.jsx)("div",{"aria-hidden":"true",style:{width:(0===e.dir?e.len:1)*32,height:(1===e.dir?e.len:1)*32,background:"linear-gradient(135deg, rgba(14,165,233,0.85), rgba(29,78,216,0.7))",borderRadius:"12px",boxShadow:"0 20px 35px rgba(14,165,233,0.35)",transition:"transform 0.25s ease, box-shadow 0.25s ease",outline:es===e.id?"2px solid rgba(165,243,252,0.9)":"none"},onDoubleClick:()=>ek(e.id),className:"jsx-e6b06efe515413a6 "+"ship-draggable ".concat(es===e.id?"ship-selected":"")})},e.id))]})]}),(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 flex w-full max-w-xs flex-col gap-3 rounded-2xl border border-cyan-400/20 bg-slate-950/60 p-4 shadow-[0_20px_45px_rgba(0,0,0,0.45)]",children:[(0,a.jsx)("button",{type:"button",onClick:eS,className:"jsx-e6b06efe515413a6 w-full rounded-xl bg-gradient-to-br from-cyan-500 to-blue-600 px-4 py-2 text-sm font-semibold uppercase tracking-wide shadow-lg transition hover:from-cyan-400 hover:to-blue-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-200",children:"Randomize Fleet"}),(0,a.jsx)("button",{type:"button",onClick:ew,disabled:!eh,className:"jsx-e6b06efe515413a6 w-full rounded-xl border border-cyan-300/40 bg-slate-900/80 px-4 py-2 text-sm font-semibold uppercase tracking-wide text-cyan-200 transition hover:bg-slate-900 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-300",children:"Begin Battle"}),(0,a.jsx)("button",{type:"button",onClick:eN,className:"jsx-e6b06efe515413a6 w-full rounded-xl border border-white/20 bg-slate-900/60 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-white/70 transition hover:bg-slate-900 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-200",children:"Rotate Selected Ship (R)"}),(0,a.jsx)("p",{className:"jsx-e6b06efe515413a6 text-xs text-white/60",children:"Tap a ship to select it, then tap the grid to place. Drag-and-drop still works on desktop."})]})]}),"placement"!==R&&(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 flex flex-col items-center gap-6",children:[(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 w-full max-w-5xl rounded-2xl border border-cyan-400/20 bg-slate-950/70 p-4 text-xs text-white/80",children:[(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 flex flex-wrap items-center justify-between gap-3",children:[(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6",children:[(0,a.jsx)("p",{className:"jsx-e6b06efe515413a6 text-xs uppercase tracking-wide text-cyan-200/80",children:"Turn"}),(0,a.jsx)("p",{className:"jsx-e6b06efe515413a6 text-sm font-semibold text-white",children:eD?"Player ".concat(z+1):"Commander"})]}),(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 flex flex-wrap items-center gap-4",children:[(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6",children:[(0,a.jsx)("p",{className:"jsx-e6b06efe515413a6 text-[10px] uppercase tracking-wide text-white/60",children:"Your fleet"}),(0,a.jsxs)("p",{className:"jsx-e6b06efe515413a6 text-sm font-semibold text-white",children:[eB," ships remaining"]})]}),(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6",children:[(0,a.jsx)("p",{className:"jsx-e6b06efe515413a6 text-[10px] uppercase tracking-wide text-white/60",children:"Enemy fleet"}),(0,a.jsxs)("p",{className:"jsx-e6b06efe515413a6 text-sm font-semibold text-white",children:[eG," ships remaining"]})]})]})]}),(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 mt-3 grid gap-2 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6",children:[(0,a.jsx)("p",{className:"jsx-e6b06efe515413a6 text-[10px] uppercase tracking-wide text-cyan-200/80",children:"Your ships"}),(0,a.jsx)("ul",{className:"jsx-e6b06efe515413a6 mt-1 flex flex-wrap gap-2",children:ep.map(e=>(0,a.jsx)("li",{className:"jsx-e6b06efe515413a6 "+"rounded-full px-2 py-1 text-[10px] uppercase tracking-wide ".concat(e.sunk?"bg-rose-500/30 text-rose-100 line-through":"bg-emerald-500/20 text-emerald-200"),children:e.name},e.id))})]}),(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6",children:[(0,a.jsx)("p",{className:"jsx-e6b06efe515413a6 text-[10px] uppercase tracking-wide text-cyan-200/80",children:"Enemy ships"}),(0,a.jsx)("ul",{className:"jsx-e6b06efe515413a6 mt-1 flex flex-wrap gap-2",children:ex.map(e=>(0,a.jsx)("li",{className:"jsx-e6b06efe515413a6 "+"rounded-full px-2 py-1 text-[10px] uppercase tracking-wide ".concat(e.sunk?"bg-amber-500/30 text-amber-100":"bg-white/10 text-white/70"),children:e.sunk?"".concat(e.name," sunk"):"".concat(e.name," unknown")},e.id))})]})]}),(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 mt-3 grid gap-3 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6",children:[(0,a.jsx)("p",{className:"jsx-e6b06efe515413a6 text-[10px] uppercase tracking-wide text-cyan-200/80",children:"Your last salvo"}),(0,a.jsx)("div",{className:"jsx-e6b06efe515413a6 mt-1 flex flex-wrap gap-2",children:ed.lastShots.length?eO(ed.lastShots,ed.board).map(e=>(0,a.jsxs)("span",{className:"jsx-e6b06efe515413a6 "+"rounded-full px-2 py-1 text-[10px] uppercase tracking-wide ".concat("Hit"===e.outcome?"bg-rose-500/30 text-rose-100":"bg-sky-500/20 text-sky-100"),children:[e.coord," ",e.outcome]},"shot-".concat(e.idx))):(0,a.jsx)("span",{className:"jsx-e6b06efe515413a6 text-[10px] text-white/60",children:"No shots yet."})})]}),(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6",children:[(0,a.jsx)("p",{className:"jsx-e6b06efe515413a6 text-[10px] uppercase tracking-wide text-cyan-200/80",children:"Incoming fire"}),(0,a.jsx)("div",{className:"jsx-e6b06efe515413a6 mt-1 flex flex-wrap gap-2",children:ec.lastShots.length?eO(ec.lastShots,ec.board).map(e=>(0,a.jsxs)("span",{className:"jsx-e6b06efe515413a6 "+"rounded-full px-2 py-1 text-[10px] uppercase tracking-wide ".concat("Hit"===e.outcome?"bg-amber-500/30 text-amber-100":"bg-white/10 text-white/70"),children:[e.coord," ",e.outcome]},"incoming-".concat(e.idx))):(0,a.jsx)("span",{className:"jsx-e6b06efe515413a6 text-[10px] text-white/60",children:"No shots yet."})})]})]})]}),(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 flex flex-col gap-6 lg:flex-row",children:[(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 rounded-[1.5rem] border border-cyan-500/30 bg-slate-950/70 p-4 shadow-[0_20px_45px_rgba(0,0,0,0.45)]",children:[(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 mb-3 flex items-center justify-between text-xs uppercase tracking-wide text-cyan-200/80",children:[(0,a.jsx)("span",{className:"jsx-e6b06efe515413a6",children:"Your Fleet"}),eD?(0,a.jsxs)("span",{className:"jsx-e6b06efe515413a6",children:["Player ",z+1]}):null]}),(0,a.jsx)(A,{board:ec.board,cellSize:32,label:"Your fleet",hideInfo:l.fog&&"battle"===R,showHeatmap:l.showAiHeat&&"ai"===l.mode,heatmap:en,heatmapTone:"warm",effects:eW.player,lastShots:ec.lastShots,sunkCells:eo,colorblind:l.colorblind,reducedMotion:e})]}),(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 rounded-[1.5rem] border border-cyan-500/30 bg-slate-950/70 p-4 shadow-[0_20px_45px_rgba(0,0,0,0.45)]",children:[(0,a.jsx)("div",{className:"jsx-e6b06efe515413a6 mb-3 text-xs uppercase tracking-wide text-cyan-200/80",children:"Enemy Waters"}),(0,a.jsx)(A,{board:ed.board,cellSize:32,label:"Enemy waters",isEnemy:!0,showHeatmap:l.showGuessHeat&&"ai"===l.mode,heatmap:er,heatmapTone:"cool",selectedTargets:X,cursorIndex:Z,onTargetSelect:e=>eA(e,eu),effects:eW.enemy,lastShots:ed.lastShots,sunkCells:ei,colorblind:l.colorblind,reducedMotion:e})]})]}),"battle"===R&&(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 flex flex-col items-center gap-2",children:[(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 text-sm text-white/80",children:["Selected ",X.length,"/",eu]}),(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 flex flex-wrap items-center gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:eT,disabled:!X.length,className:"jsx-e6b06efe515413a6 rounded-xl bg-gradient-to-br from-rose-500 to-orange-500 px-4 py-2 text-sm font-semibold uppercase tracking-wide text-white shadow-lg transition hover:from-rose-400 hover:to-orange-400 focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-200 disabled:cursor-not-allowed disabled:opacity-60",children:"Fire Salvo (F)"}),(0,a.jsx)("button",{type:"button",onClick:()=>ev([]),disabled:!X.length,className:"jsx-e6b06efe515413a6 rounded-xl border border-white/20 bg-slate-900/70 px-4 py-2 text-sm font-semibold uppercase tracking-wide text-white/70 transition hover:bg-slate-900 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-200 disabled:cursor-not-allowed disabled:opacity-60",children:"Clear Selection (Esc)"})]})]})]})]}),O&&eD?(0,a.jsx)("div",{className:"jsx-e6b06efe515413a6 fixed inset-0 z-[70] flex items-center justify-center bg-black/80 p-6 text-center",children:(0,a.jsxs)("div",{className:"jsx-e6b06efe515413a6 max-w-md rounded-3xl border border-cyan-400/40 bg-slate-950/90 p-6 text-white shadow-[0_30px_60px_rgba(0,0,0,0.6)]",children:[(0,a.jsx)("h2",{className:"jsx-e6b06efe515413a6 text-2xl font-semibold",children:"Pass the device"}),(0,a.jsxs)("p",{className:"jsx-e6b06efe515413a6 mt-2 text-sm text-white/70",children:["Player ","placement"===R?I+1:z+1,", take control when ready."]}),(0,a.jsx)("button",{type:"button",onClick:eF,className:"jsx-e6b06efe515413a6 mt-4 rounded-full bg-gradient-to-br from-cyan-500 to-blue-600 px-6 py-2 text-sm font-semibold uppercase tracking-wide shadow-lg transition hover:from-cyan-400 hover:to-blue-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-200",children:"Ready"})]})}):null,ea?(0,a.jsx)(Q,{type:ea,onClose:()=>ey(null),onRestart:()=>ej(),stats:S,reduced:e}):null,(0,a.jsx)(r(),{id:"e6b06efe515413a6",children:".ship-draggable{transition:transform.25s cubic-bezier(.22,.61,.36,1);will-change:transform}.ship-draggable.ship-selected{z-index:10}.ship-draggable:active{cursor:grabbing}.shot-trail{position:absolute;width:6px;height:120%;background:linear-gradient(to bottom,rgba(255,255,255,.9),rgba(59,130,246,0));border-radius:9999px;animation:shotTrail.35s ease forwards}.shot-impact{position:absolute;width:48px;height:48px;border-radius:9999px;opacity:0;transform:scale(.4)}.shot-impact-hit{background:radial-gradient(circle,rgba(248,113,113,.95),rgba(127,29,29,.1));animation:shotImpactHit.6s ease forwards}.shot-impact-miss{background:radial-gradient(circle,rgba(96,165,250,.9),rgba(2,132,199,.1));animation:shotImpactMiss.6s ease forwards}.shot-particles{position:absolute;inset:0;display:block}.shot-particles .particle{position:absolute;width:6px;height:6px;border-radius:50%;opacity:0;animation:particleBurst.7s ease forwards}.shot-particles .particle-0{top:50%;left:50%}.shot-particles .particle-1{top:35%;left:60%}.shot-particles .particle-2{top:65%;left:40%}.shot-particles .particle-3{top:30%;left:40%}.shot-particles .particle-4{top:70%;left:60%}.shot-particles .particle-5{top:50%;left:30%}.confetti-field{pointer-events:none;position:absolute;inset:0}.confetti-piece{position:absolute;top:-20px;left:var(--offset);width:6px;height:16px;border-radius:2px;animation:confettiFall var(--duration)linear var(--delay)infinite}@keyframes shotTrail{0%{transform:translatey(-120%)scaley(.3);opacity:.8}100%{transform:translatey(0)scaley(1);opacity:0}}@keyframes shotImpactHit{0%{transform:scale(.4);opacity:0}40%{transform:scale(1);opacity:1}100%{transform:scale(1.2);opacity:0}}@keyframes shotImpactMiss{0%{transform:scale(.3);opacity:0}60%{transform:scale(.9);opacity:.8}100%{transform:scale(1);opacity:0}}@keyframes particleBurst{0%{transform:translate3d(0,0,0)scale(.5);opacity:1}100%{transform:translate3d(var(--dx,12px),var(--dy,-18px),0)scale(.1);opacity:0}}.shot-particles .particle-0{--dx:12px;--dy:-20px}.shot-particles .particle-1{--dx:-10px;--dy:-14px}.shot-particles .particle-2{--dx:14px;--dy:-4px}.shot-particles .particle-3{--dx:-14px;--dy:-6px}.shot-particles .particle-4{--dx:8px;--dy:-18px}.shot-particles .particle-5{--dx:-6px;--dy:-16px}@keyframes confettiFall{0%{transform:translate3d(0,-10px,0)rotate(0deg);opacity:1}100%{transform:translate3d(0,160px,0)rotate(540deg);opacity:0}}"})]})}},30684:(e,t,s)=>{"use strict";s.d(t,{default:()=>o,getMapping:()=>r});var a=s(14232);let l={},r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l[e]?{...t,...l[e]}:t};async function n(e,t){try{let s=await navigator.storage.getDirectory(),a=await s.getDirectoryHandle("controls",{create:!0}),r=await a.getFileHandle("".concat(e,".json")),n=await r.getFile(),i=JSON.parse(await n.text());return l[e]=i,{...t,...i}}catch(e){return t}}async function i(e,t){try{let s=await navigator.storage.getDirectory(),a=await s.getDirectoryHandle("controls",{create:!0}),r=await a.getFileHandle("".concat(e,".json"),{create:!0}),n=await r.createWritable();await n.write(JSON.stringify(t)),await n.close(),l[e]=t}catch(e){}}function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[s,l]=(0,a.useState)(t);return(0,a.useEffect)(()=>{var s;let a=!0;return(null==(s=navigator.storage)?void 0:s.getDirectory)&&n(e,t).then(e=>{a&&l(e)}),()=>{a=!1}},[e,t]),[s,(t,s)=>{let a=null;return l(l=>{let r={...l};return Object.keys(r).forEach(e=>{e!==t&&r[e]===s&&(a=e,delete r[e])}),r[t]=s,i(e,r),r}),a}]}},37603:(e,t,s)=>{"use strict";var a=s(99742);s(72552);var l=s(14232),r=function(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}(l),n=void 0!==a&&a.env&&!0,i=function(e){return"[object String]"===Object.prototype.toString.call(e)},o=function(){function e(e){var t=void 0===e?{}:e,s=t.name,a=void 0===s?"stylesheet":s,l=t.optimizeForSpeed,r=void 0===l?n:l;c(i(a),"`name` must be a string"),this._name=a,this._deletedRulePlaceholder="#"+a+"-deleted-rule____{}",c("boolean"==typeof r,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=r,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var o=document.querySelector('meta[property="csp-nonce"]');this._nonce=o?o.getAttribute("content"):null}var t,s=e.prototype;return s.setOptimizeForSpeed=function(e){c("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),c(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},s.isOptimizeForSpeed=function(){return this._optimizeForSpeed},s.inject=function(){var e=this;if(c(!this._injected,"sheet already injected"),this._injected=!0,this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(n||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,s){return"number"==typeof s?e._serverSheet.cssRules[s]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),s},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},s.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},s.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},s.insertRule=function(e,t){if(c(i(e),"`insertRule` accepts only strings"),this._optimizeForSpeed){var s=this.getSheet();"number"!=typeof t&&(t=s.cssRules.length);try{s.insertRule(e,t)}catch(t){return n||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var a=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,a))}return this._rulesCount++},s.replaceRule=function(e,t){if(this._optimizeForSpeed){var s=this.getSheet();if(t.trim()||(t=this._deletedRulePlaceholder),!s.cssRules[e])return e;s.deleteRule(e);try{s.insertRule(t,e)}catch(a){n||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),s.insertRule(this._deletedRulePlaceholder,e)}}else{var a=this._tags[e];c(a,"old rule at index `"+e+"` not found"),a.textContent=t}return e},s.deleteRule=function(e){if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];c(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},s.flush=function(){this._injected=!1,this._rulesCount=0,this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]},s.cssRules=function(){var e=this;return this._tags.reduce(function(t,s){return s?t=t.concat(Array.prototype.map.call(e.getSheetForTag(s).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},s.makeStyleTag=function(e,t,s){t&&c(i(t),"makeStyleTag accepts only strings as second parameter");var a=document.createElement("style");this._nonce&&a.setAttribute("nonce",this._nonce),a.type="text/css",a.setAttribute("data-"+e,""),t&&a.appendChild(document.createTextNode(t));var l=document.head||document.getElementsByTagName("head")[0];return s?l.insertBefore(a,s):l.appendChild(a),a},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}();function c(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var d=function(e){for(var t=5381,s=e.length;s;)t=33*t^e.charCodeAt(--s);return t>>>0},u={};function h(e,t){if(!t)return"jsx-"+e;var s=String(t),a=e+s;return u[a]||(u[a]="jsx-"+d(e+"-"+s)),u[a]}function f(e,t){var s=e+t;return u[s]||(u[s]=t.replace(/__jsx-style-dynamic-selector/g,e)),u[s]}var p=function(){function e(e){var t=void 0===e?{}:e,s=t.styleSheet,a=void 0===s?null:s,l=t.optimizeForSpeed,r=void 0!==l&&l;this._sheet=a||new o({name:"styled-jsx",optimizeForSpeed:r}),this._sheet.inject(),a&&"boolean"==typeof r&&(this._sheet.setOptimizeForSpeed(r),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var s=this.getIdAndRules(e),a=s.styleId,l=s.rules;if(a in this._instancesCounts){this._instancesCounts[a]+=1;return}var r=l.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[a]=r,this._instancesCounts[a]=1},t.remove=function(e){var t=this,s=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(s in this._instancesCounts,"styleId: `"+s+"` not found"),this._instancesCounts[s]-=1,this._instancesCounts[s]<1){var a=this._fromServer&&this._fromServer[s];a?(a.parentNode.removeChild(a),delete this._fromServer[s]):(this._indices[s].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[s]),delete this._instancesCounts[s]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],s=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return s[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,s;return t=this.cssRules(),void 0===(s=e)&&(s={}),t.map(function(e){var t=e[0],a=e[1];return r.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:s.nonce?s.nonce:void 0,dangerouslySetInnerHTML:{__html:a}})})},t.getIdAndRules=function(e){var t=e.children,s=e.dynamic,a=e.id;if(s){var l=h(a,s);return{styleId:l,rules:Array.isArray(t)?t.map(function(e){return f(l,e)}):[f(l,t)]}}return{styleId:h(a),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),x=l.createContext(null);x.displayName="StyleSheetContext";var m=r.default.useInsertionEffect||r.default.useLayoutEffect,b=new p;function g(e){var t=b||l.useContext(x);return t&&m(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)]),null}g.dynamic=function(e){return e.map(function(e){return h(e[0],e[1])}).join(" ")},t.style=g},49096:(e,t,s)=>{"use strict";e.exports=s(37603).style},65422:(e,t,s)=>{"use strict";s.d(t,{consumeGameKey:()=>l,formatGameKey:()=>r,shouldHandleGameKey:()=>a});let a=function(e){let{isFocused:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!(!t||(e=>{if(!e||!(e instanceof HTMLElement))return!1;let t=e.tagName;return"INPUT"===t||"TEXTAREA"===t||e.isContentEditable})(e.target))},l=e=>{(null==e?void 0:e.cancelable)&&e.preventDefault(),(null==e?void 0:e.stopPropagation)&&e.stopPropagation()},r=e=>{if(!e)return"";if(" "===e)return"Space";let t=e.toLowerCase();return"escape"===t?"Esc":"arrowup"===t?"ArrowUp":"arrowdown"===t?"ArrowDown":"arrowleft"===t?"ArrowLeft":"arrowright"===t?"ArrowRight":1===e.length?e.toUpperCase():e}},72552:()=>{},90209:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var a=s(14232),l=s(74273);function r(){let{reducedMotion:e}=(0,l.useSettings)(),[t,s]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e=window.matchMedia("(prefers-reduced-motion: reduce)"),t=()=>s(e.matches);return(t(),"function"==typeof e.addEventListener)?(e.addEventListener("change",t),()=>e.removeEventListener("change",t)):(e.addListener(t),()=>e.removeListener(t))},[]),e||t}}}]);