{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ExtensionManifest",
  "description": "Schema describing runtime extension manifests for Kali Linux Portfolio extensions.",
  "type": "object",
  "additionalProperties": false,
  "required": ["name", "version", "permissions", "entry"],
  "properties": {
    "name": {
      "type": "string",
      "minLength": 1,
      "maxLength": 120,
      "pattern": "^[^\\s].*$",
      "description": "Human readable extension name. Leading whitespace is not permitted."
    },
    "version": {
      "type": "string",
      "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-[0-9A-Za-z-]+(?:\\.[0-9A-Za-z-]+)*)?(?:\\+[0-9A-Za-z-]+(?:\\.[0-9A-Za-z-]+)*)?$",
      "description": "Semantic version string (MAJOR.MINOR.PATCH with optional prerelease/build metadata)."
    },
    "description": {
      "type": "string",
      "maxLength": 280,
      "description": "Optional description displayed in the extension catalog."
    },
    "permissions": {
      "type": "array",
      "minItems": 1,
      "uniqueItems": true,
      "items": {
        "type": "string",
        "minLength": 1,
        "pattern": "^[a-z]+(?::[a-zA-Z0-9._-]+)*$",
        "description": "Permission scope in the form 'domain' or 'domain:capability'."
      },
      "description": "List of permission scopes required by the extension."
    },
    "entry": {
      "type": "string",
      "minLength": 1,
      "pattern": "^(?!\\/)(?!.*\\s)(?!.*\\.{2}\\/)(?:\\.\\/)?(?:[A-Za-z0-9@._-]+\\/)*[A-Za-z0-9@._-]+(?:\\.(?:js|cjs|mjs|ts|tsx))?$",
      "description": "Relative path to the extension entry module. Absolute paths and directory traversal are disallowed."
    },
    "config": {
      "type": "object",
      "additionalProperties": true,
      "description": "Optional configuration object consumed by the entry module."
    }
  }
}
