# Security Policy

This application enforces a strict Content Security Policy (CSP) and additional headers.

## External origins
The site loads resources from the following external origins:

- https://vercel.live
- https://platform.twitter.com
- https://syndication.twitter.com
- https://cdn.syndication.twimg.com
- https://*.twitter.com
- https://*.twimg.com
- https://*.x.com
- https://www.youtube.com
- https://www.google.com
- https://www.gstatic.com
- https://sdk.scdn.co
- https://cdn.jsdelivr.net
- https://cdnjs.cloudflare.com
- https://stackblitz.com
- https://open.spotify.com
- https://react.dev
- https://example.com

## Content Security Policy
A per-request nonce is generated by `middleware.ts` and applied to all script tags.
Inline execution is disallowed; scripts must present the correct `nonce`.

## Security headers
`next.config.js` sets:

- `X-Content-Type-Options: nosniff`
- `Referrer-Policy: strict-origin-when-cross-origin`
- `Permissions-Policy: camera=(), microphone=(), geolocation=(), interest-cohort=()`
- `X-Frame-Options: SAMEORIGIN`

## Verification
1. Run `yarn test __tests__/gedit.test.tsx __tests__/sticky_notes.test.ts`
   to verify that script injection attempts are sanitized.
2. Inspect response headers to confirm the CSP nonce and security headers are present.
